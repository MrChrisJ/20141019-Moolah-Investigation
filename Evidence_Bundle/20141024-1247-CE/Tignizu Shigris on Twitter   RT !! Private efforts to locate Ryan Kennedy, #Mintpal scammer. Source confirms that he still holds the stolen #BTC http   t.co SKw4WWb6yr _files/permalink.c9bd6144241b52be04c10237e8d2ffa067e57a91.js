define("app/ui/permalink_keyboard_support",["module","require","exports","core/component","app/ui/with_block_kb_shortcut_helpers","app/ui/with_focus_highlight"],function(module, require, exports) {
function permalinkKeyboard(){this.defaultAttrs({permalinkOverlay:".PermalinkOverlay",permalinkOverlayTweetSelector:".PermalinkOverlay .permalink-tweet",permalinkPageTweetSelector:".route-permalink .permalink-tweet",ownTweetSelector:".my-tweet"}),this.getNode=function(){return this.select("permalinkOverlay").is(":visible")?this.select("permalinkOverlayTweetSelector"):this.select("permalinkPageTweetSelector")},this.triggerBlock=function(){this.triggerBlockActionOnNode(this.getNode(),"uiOpenBlockUserDialog")},this.triggerMute=function(){this.triggerBlockActionOnNode(this.getNode(),"uiDidMuteUser")},this.after("initialize",function(){this.on(document,"uiShortcutBlock",this.triggerBlock),this.on(document,"uiShortcutMuteUser",this.triggerMute)})}var defineComponent=require("core/component"),withBlockKBShortcutHelpers=require("app/ui/with_block_kb_shortcut_helpers"),withFocusHighlight=require("app/ui/with_focus_highlight");module.exports=defineComponent(permalinkKeyboard,withBlockKBShortcutHelpers,withFocusHighlight)
});
define("app/ui/hidden_ancestors",["module","require","exports","core/component","app/utils/chrome"],function(module, require, exports) {
function hiddenAncestors(){this.defaultAttrs({ancestorAdjustmentClass:"multiple-ancestors-adjustment",amtToShowFromBtmOfFrstNonImdiateAncstr:10,tweetsSelector:".ancestor",scrollContainerSelector:window,doBottomPaddingAdjustment:!0,pageContainerSelector:"#page-container",scrollContentSelector:document}),this.showHiddenAncestors=function(){var a=this.select("tweetsSelector"),b=$(this.attr.scrollContainerSelector);if(!a.length)return;$("body").removeClass(this.attr.ancestorAdjustmentClass);var c=this.getTopOffset(a.last());if(this.attr.doBottomPaddingAdjustment){var d=c-$(this.attr.scrollContentSelector).height()+b.height();$(this.attr.pageContainerSelector).css("padding-bottom",d)}b.scrollTop(c-this.attr.amtToShowFromBtmOfFrstNonImdiateAncstr)},this.getTopOffset=function(a){return this.attr.scrollContainerSelector==window?chrome.getCanvasYOffset(a)-1:a.position().top-chrome.getGlobalYOffset()-1},this.after("initialize",function(){this.on(document,"uiPageChanged uiSwiftLoaded",this.showHiddenAncestors)})}var defineComponent=require("core/component"),chrome=require("app/utils/chrome");module.exports=defineComponent(hiddenAncestors)
});
define("app/ui/hidden_descendants",["module","require","exports","core/component"],function(module, require, exports) {
function hiddenDescendants(){this.defaultAttrs({repliesSelector:".replies-to .stream-items .tweet",hasRepliesClass:"has-replies"}),this.updateRepliesState=function(){var a=this.select("repliesSelector");a.length?this.$node.addClass(this.attr.hasRepliesClass):this.$node.removeClass(this.attr.hasRepliesClass)},this.after("initialize",function(){this.on(document,"uiTweetInserted uiTweetRemoved",this.updateRepliesState)})}var defineComponent=require("core/component");module.exports=defineComponent(hiddenDescendants)
});
define("app/ui/dialogs/sms_codes",["module","require","exports","core/component","app/ui/with_dialog"],function(module, require, exports) {
function smsCodesDialog(){this.defaultAttrs({dialogSelector:"#sms-codes-dialog",triggerSelector:".sms-codes-link"}),this.after("initialize",function(){this.$dialog=this.select("dialogSelector")})}var defineComponent=require("core/component"),withDialog=require("app/ui/with_dialog"),SMSCodesDialog=defineComponent(smsCodesDialog,withDialog);module.exports=SMSCodesDialog
});
define("app/ui/permalink_tweet",["module","require","exports","core/component"],function(module, require, exports) {
function permalinkTweet(){this.defaultAttrs({permalinkTweetSelector:".permalink-tweet",permalinkTweetForm:".permalink-tweet-container + .inline-reply-tweetbox .tweet-form"}),this.homePath="/",this.expandTweetBox=function(a,b){var c=$(a.target);c.is(this.attr.permalinkTweetSelector)&&this.trigger(this.select("permalinkTweetForm"),"uiTweetBoxExpand",b)},this.redirectHome=function(a,b){var c=this.$node.find('[data-tweet-id="'+b.sourceEventData.id+'"]');c.is(this.attr.permalinkTweetSelector)&&window.location.replace(this.homePath)},this.after("initialize",function(){if(!this.attr.loggedIn)return;this.on("uiReplyToTweet",this.expandTweetBox),this.on(document,"dataDidDeleteTweet",this.redirectHome)})}var component=require("core/component"),PermalinkTweet=component(permalinkTweet);module.exports=PermalinkTweet
});
define("app/ui/timelines/conversations/descendant_timeline",["module","require","exports","core/component","app/ui/timelines/base_timeline","app/ui/timelines/with_old_items","app/ui/timelines/with_min_max_pagination","app/ui/with_item_actions","app/utils/string","app/ui/gallery/with_gallery"],function(module, require, exports) {
function descendantTimeline(){this.defaultAttrs({itemType:"tweet",tweetSelector:".tweet",hiddenRepliesContainerSelector:".hidden-replies-container"}),this.injectOwnReply=function(a,b){if(this.attr.tweetId!==b.in_reply_to_status_id)return;(this.reachedTheEnd()?this.$repliesContainer:this.$hiddenRepliesContainer).append(b.tweet_html),this.$node.removeClass("hidden"),this.trigger("uiTweetInserted",b)},this.restoreHiddenReplies=function(a,b){this.$hiddenRepliesContainer.children().each(function(a,b){var c=$(b),d=c.find(this.attr.tweetSelector).attr("data-tweet-id");this.$repliesContainer.children().each(function(a,b){var e=$(b),f=e.find(this.attr.tweetSelector).attr("data-tweet-id"),g=stringUtils.compare(d,f);if(g===0)return c.remove(),!1;if(g<0)return c.insertBefore(e),!1}.bind(this))}.bind(this)),this.reachedTheEnd()&&(this.$repliesContainer.append(this.$hiddenRepliesContainer.html()),this.$hiddenRepliesContainer.html(""))},this.reachedTheEnd=function(){return!this.select("timelineEndSelector").hasClass("has-more-items")},this.hideReplies=function(a,b){this.select("genericItemSelector").length||this.$node.addClass("hidden")},this.after("initialize",function(){this.$repliesContainer=this.select("itemsSelector"),this.$hiddenRepliesContainer=this.select("hiddenRepliesContainerSelector"),this.on("uiTweetRemoved",this.hideReplies),this.on(document,"dataTweetSuccess",this.injectOwnReply),this.on("uiHasInjectedOldTimelineItems",this.restoreHiddenReplies)})}var defineComponent=require("core/component"),BaseTimeline=require("app/ui/timelines/base_timeline"),withOldItems=require("app/ui/timelines/with_old_items"),withMinMaxPagination=require("app/ui/timelines/with_min_max_pagination"),withItemActions=require("app/ui/with_item_actions"),stringUtils=require("app/utils/string"),withGallery=require("app/ui/gallery/with_gallery");module.exports=BaseTimeline.mixin(descendantTimeline,withOldItems,withMinMaxPagination,withItemActions,withGallery)
});
define("app/ui/timelines/with_simple_new_items",["module","require","exports"],function(module, require, exports) {
function withSimpleNewItems(){this.defaultAttrs({endOfStreamSelector:".stream-footer",errorMessageSelector:".stream-fail-container",tryAgainSelector:".try-again-after-whale"}),this.getNewItems=function(a){a&&a.stopPropagation(),this.shouldGetNewItems()&&this.trigger("uiWantsMoreTimelineItems",this.getNewItemsData())},this.notifyNewItems=function(a,b){this.injectNewItems(a,b)},this.injectNewItems=function(a){this.resetStateVariables(a);var b=this.$document.height();this.injectItems("prepend",a.items_html,"uiHasInjectedNewTimelineItems"),this.$window.scrollTop(this.$document.height()-b),a.has_more_items||this.select("endOfStreamSelector").remove()},this.notifyNewItemsError=function(a){},this.after("initialize",function(){var a=this.attr.inOverlay?".PermalinkOverlay":window;this.on(a,"uiNearTheTop",this.getNewItems),this.$document=$(document),this.$window=$(window),this.on("click",{tryAgainSelector:this.tryAgainAfterWhale})})}module.exports=withSimpleNewItems
});
define("app/ui/timelines/conversations/ancestor_timeline",["module","require","exports","core/component","app/ui/timelines/base_timeline","app/ui/timelines/with_simple_new_items","app/ui/timelines/with_min_max_pagination","app/ui/with_item_actions","app/ui/gallery/with_gallery"],function(module, require, exports) {
function ancestorTimeline(){this.defaultAttrs({itemType:"tweet",tweetSelector:".tweet"}),this.removeAncestors=function(){this.select("genericItemSelector").length||this.$node.remove()},this.after("initialize",function(){this.on("uiTweetRemoved",this.removeAncestors)})}var defineComponent=require("core/component"),BaseTimeline=require("app/ui/timelines/base_timeline"),withSimpleNewItems=require("app/ui/timelines/with_simple_new_items"),withMinMaxPagination=require("app/ui/timelines/with_min_max_pagination"),withItemActions=require("app/ui/with_item_actions"),withGallery=require("app/ui/gallery/with_gallery");module.exports=BaseTimeline.mixin(ancestorTimeline,withSimpleNewItems,withMinMaxPagination,withItemActions,withGallery)
});
define("app/ui/related_tweets",["module","require","exports","core/component"],function(module, require, exports) {
function relatedTweets(){this.displayRelatedTweets=function(a,b){b&&b.items_html?(this.$node.html(b.items_html),this.trigger("uiRelatedTweetsResults")):this.trigger("uiRelatedTweetsEmpty")},this.after("initialize",function(){this.trigger(document,"uiGetRelatedTweets",{id:this.attr.id}),this.on(document,"dataGotRelatedTweets",this.displayRelatedTweets)})}var defineComponent=require("core/component");module.exports=defineComponent(relatedTweets)
});
define("app/data/related_tweets",["module","require","exports","core/component","app/data/with_data"],function(module, require, exports) {
function relatedTweetsData(){this.getRelatedTweets=function(a,b){if(!b||!b.id)return;this.get({url:"/i/related_tweets?id="+b.id,eventData:b,success:"dataGotRelatedTweets",error:"dataGotRelatedTweetsError"})},this.after("initialize",function(){this.on("uiGetRelatedTweets",this.getRelatedTweets)})}var defineComponent=require("core/component"),withData=require("app/data/with_data");module.exports=defineComponent(relatedTweetsData,withData)
});
define("app/ui/with_permalinktweet_tweet_actions",["module","require","exports"],function(module, require, exports) {
function withPermalinkTweetTweetActions(){this.defaultAttrs({permalinkTweetSelector:".permalink-tweet",ownTweetSelector:".my-tweet",shareViaEmailSelector:".js-action-share-via-email"}),this.getPermalinkTweet=function(a,b,c){var d=this.select("permalinkTweetSelector"),e=!!d.length;return e&&(c.$tweet=d),e},this.isNotMyTweet=function(a,b,c){return!c.$tweet.is(this.attr.ownTweetSelector)},this.after("initialize",function(){if(!this.attr.loggedIn)return;var a=this.mkTweetDataCollectorForAction(this.interactionDataWithCard),b=this.mkTweetDataCollectorForAction(this.interactionDataWithCard,this.getDataForReply);this.on(document,"uiShortcutFavorite",this.composeHandler(this.getPermalinkTweet,a,this.toggleFavorite)),this.on(document,"uiShortcutRetweet",this.composeHandler(this.getPermalinkTweet,this.isNotMyTweet,a,this.toggleRetweet)),this.on(document,"uiShortcutReply",this.composeHandler(this.getPermalinkTweet,b,this.triggerTweetAction("uiReplyToTweet"))),this.on("click",{shareViaEmailSelector:this.composeHandler(this.preventDefault,this.getClosestTweet,a,this.triggerTweetAction("uiNeedsShareViaEmailDialog"))})})}module.exports=withPermalinkTweetTweetActions
});
define("app/ui/with_inline_reply",["module","require","exports"],function(module, require, exports) {
function withInlineReply(){this.after("initialize",function(){this.on("uiReplyToTweet","expandTweetByReply")})}module.exports=withInlineReply
});
define("app/data/embed_stats_scribe",["module","require","exports","core/component","core/utils","app/data/with_scribe","app/data/with_interaction_data_scribe","app/utils/scribe_item_types"],function(module, require, exports) {
function embedStatsScribe(){this.scribeOutboundClick=function(a,b){this.scribe({component:"embed_stats",element:"link",action:"click"},{items:[{id:b.tweetId,item_type:itemTypes.tweet}],url:b.url})},this.scribeMoreStatsClick=function(a,b){this.scribe({component:"embed_stats",element:"more",action:"click"},{items:[{id:b.tweetId,item_type:itemTypes.tweet}]})},this.after("initialize",function(){this.on(document,"uiClickedEmbeddedTweetLink",this.scribeOutboundClick),this.on(document,"uiExpandedMoreEmbeddedTweetLinks",this.scribeMoreStatsClick)})}var defineComponent=require("core/component"),utils=require("core/utils"),withScribe=require("app/data/with_scribe"),withInteractionDataScribe=require("app/data/with_interaction_data_scribe"),itemTypes=require("app/utils/scribe_item_types");module.exports=defineComponent(embedStatsScribe,withScribe,withInteractionDataScribe)
});
define("app/data/permalink_scribe",["module","require","exports","core/component","app/data/with_interaction_data_scribe","app/data/with_card_metadata"],function(module, require, exports) {
function permalinkScribe(){this.defaultAttrs({permalinkTweetSelector:".permalink-tweet"}),this.scribePermalinkImpression=function(){var a=this.select("permalinkTweetSelector"),b=this.getCardDataFromTweet(a);b.tweetHasCard&&this.scribeCardInteraction("show",b)},this.after("initialize",function(){this.scribePermalinkImpression()})}var defineComponent=require("core/component"),withInteractionDataScribe=require("app/data/with_interaction_data_scribe"),withCardMetadata=require("app/data/with_card_metadata");module.exports=defineComponent(permalinkScribe,withInteractionDataScribe,withCardMetadata)
});
define("app/pages/permalink",["module","require","exports","app/ui/permalink_keyboard_support","app/ui/hidden_ancestors","app/ui/hidden_descendants","app/ui/dialogs/sms_codes","app/ui/permalink_tweet","app/ui/timelines/conversations/descendant_timeline","app/ui/timelines/conversations/ancestor_timeline","app/boot/logged_out","app/ui/tweet_injector","app/ui/embed_stats","app/boot/timeline","app/boot/tweets","app/ui/related_tweets","app/data/related_tweets","app/ui/tweet_actions","app/ui/profile/highline_tweet_stats","app/ui/with_permalinktweet_tweet_actions","app/ui/with_tweet_translation","app/ui/with_inline_reply","app/ui/tweets","core/utils","app/boot/app","app/data/embed_stats_scribe","app/data/permalink_scribe","app/utils/tweet_helper","app/boot/trends","app/ui/more_tweet_actions_dropdown","app/ui/multiline_ellipses"],function(module, require, exports) {
var PermalinkKeyboardSupport=require("app/ui/permalink_keyboard_support"),HiddenAncestors=require("app/ui/hidden_ancestors"),HiddenDescendants=require("app/ui/hidden_descendants"),SMSCodesDialog=require("app/ui/dialogs/sms_codes"),PermalinkTweet=require("app/ui/permalink_tweet"),DescendantTimeline=require("app/ui/timelines/conversations/descendant_timeline"),AncestorTimeline=require("app/ui/timelines/conversations/ancestor_timeline"),loggedOutBoot=require("app/boot/logged_out"),TweetInjector=require("app/ui/tweet_injector"),EmbedStats=require("app/ui/embed_stats"),timelineBoot=require("app/boot/timeline"),tweetsBoot=require("app/boot/tweets"),RelatedTweets=require("app/ui/related_tweets"),RelatedTweetsData=require("app/data/related_tweets"),TweetActionsUI=require("app/ui/tweet_actions"),HighlineTweetStats=require("app/ui/profile/highline_tweet_stats"),withPermalinkTweetTweetActions=require("app/ui/with_permalinktweet_tweet_actions"),withTweetTranslation=require("app/ui/with_tweet_translation"),withInlineReply=require("app/ui/with_inline_reply"),Tweets=require("app/ui/tweets"),utils=require("core/utils"),bootApp=require("app/boot/app"),EmbedStatsScribe=require("app/data/embed_stats_scribe"),PermalinkScribe=require("app/data/permalink_scribe"),tweetHelper=require("app/utils/tweet_helper"),trends=require("app/boot/trends"),MoreTweetActionsDropdown=require("app/ui/more_tweet_actions_dropdown"),MultilineEllipses=require("app/ui/multiline_ellipses");module.exports=function(a){function g(b){return utils.merge(a,{eventData:{scribeContext:{component:b}},itemType:"tweet",lastItemSelector:".tweet:last",disableProfilePopup:a.inOverlay,inOverlay:a.inOverlay})}var b=a.inOverlay?".PermalinkOverlay":"#page-container.wrapper-permalink",c=b+" div.permalink-tweet-container",d="div.permalink-tweet",e=b+" .embed-stats-container",f=b+" #related-tweets-container";bootApp(a),loggedOutBoot(a),MultilineEllipses.attachTo(document),tweetsBoot(b,utils.merge(a,{preexpandedTweetSelector:d,preexpandedOpenTweetSelector:d,generalTweetSelector:d})),EmbedStats.attachTo(e,a),EmbedStatsScribe.attachTo(document),PermalinkKeyboardSupport.attachTo(document),PermalinkScribe.attachTo(document);var h,i;a.loggedIn?(timelineBoot(a),h=DescendantTimeline,i=AncestorTimeline):h=i=Tweets,a.inOverlay?HiddenAncestors.attachTo(".PermalinkOverlay div.in-reply-to",{scrollContainerSelector:".PermalinkOverlay",doBottomPaddingAdjustment:!1}):HiddenAncestors.attachTo("div.in-reply-to"),HiddenDescendants.attachTo(".permalink"),Tweets.attachTo(c,g("tweet")),PermalinkTweet.attachTo(".permalink",g("tweet")),HighlineTweetStats.attachTo(document),TweetActionsUI.mixin.apply(this,[withTweetTranslation,withPermalinkTweetTweetActions]).attachTo(c,g("tweet")),MoreTweetActionsDropdown.attachTo(c,g("tweet")),i.attachTo(".in-reply-to",g("conversation")),TweetActionsUI.mixin(withTweetTranslation).attachTo(".in-reply-to",g("conversation")),MoreTweetActionsDropdown.attachTo(".in-reply-to",g("conversation")),h.attachTo(".replies-to",g("replies")),TweetActionsUI.mixin(withTweetTranslation).attachTo(".replies-to",g("replies")),MoreTweetActionsDropdown.attachTo(".replies-to",g("replies")),a.loggedIn?$(b).find(".inline-reply-tweetbox .tweet-form").trigger("uiInitTweetbox",{condensable:!0,preventTweetingDefaultText:!1,impressionId:a.impressionId,inReplyToStatusId:a.tweetId,eventData:{scribeContext:{component:"inline_reply"}},inReplyToTweetData:{screenNames:tweetHelper.extractMentionsForReply($(d),a.screenName)}}):SMSCodesDialog.attachTo("body"),trends(utils.merge(a,{show_context:!1})),a.showRelatedTweets&&(RelatedTweetsData.attachTo(document),Tweets.attachTo(f,g("related_tweets")),TweetActionsUI.mixin(withInlineReply).attachTo(f,g("related_tweets")),MoreTweetActionsDropdown.attachTo(f,g("related_tweets")),RelatedTweets.attachTo(f,{id:a.tweetId}))}
});