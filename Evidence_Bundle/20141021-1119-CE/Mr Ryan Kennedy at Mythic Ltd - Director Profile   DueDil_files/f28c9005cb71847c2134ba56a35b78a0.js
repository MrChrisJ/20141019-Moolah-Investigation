/* app-director.js */
define("director/Duedil.profile.director",["jquery","common","jquery-duedilFollow"],function(e,t){t.Director=t.profile.subclass("Director",{uses:function(){return[]},init:function(){e("#follows-form").duedilFollow({entity:"director",id:this.raw_data.pnr}),t.Tutorials._init(this.raw_data.tutorial_state)},guid:function(){return"director"+this.raw_data.pnr},destroy:function(){if(this.plotted)for(var e in this.plotted)this.plotted[e].setMap&&this.plotted[e].setMap(null),delete this.plotted[e]},internal_pjax:["#widget-tab-contents"],isInternal:function(e){return(new RegExp("^/director/"+this.raw_data.pnr+"/")).test(e)},dealrId:function(){return this.raw_data.pnr},dealrWidgetMap:{director_social:"socialaccountswidget"}})}),define("director/Duedil.widgets.director",["jquery","common","Highcharts","highcharts-exporting"],function(e,t,n){t.widgets.director={directoroverviewwidget:{chart:null,init:function(){var r=e("#widget_directoroverviewwidget"),i=r.find(".button").first().data("counts"),s={chart:{renderTo:e("#directorships-chart")[0],type:"column",height:200,spacingLeft:0,spacingRight:3,spacingTop:20},title:{text:""},colors:["#88afcf","#cf8888","#bad6ed"],tooltip:{headerFormat:"<h4>{series.name}</h4><br />",pointFormat:"<span><b>{point.y}</b>"},plotOptions:{column:{animation:!1,pointPadding:.2,borderWidth:0,colorByPoint:!1,colors:["#88afcf","#cf8888","#bad6ed"],shadow:!1}},legend:{enabled:!0},yAxis:{allowDecimals:!1,title:{text:null},labels:{enabled:!0,x:10,y:-2,align:"left"}},xAxis:{allowDecimals:!1,title:{text:null},labels:{enabled:!1},tickmarkPlacement:"on"},series:i,exporting:{enabled:!1},credits:{enabled:!1}},o=this;n.setOptions(t.helpers.tooltipStyle),this.chart=new n.Chart(s);var u=r.find(".button");u.on("click",function(t){s.series=e(t.target).data("counts"),o.chart.destroy(),o.chart=new n.Chart(s),e(this).siblings().removeClass("depressed"),e(this).addClass("depressed")}),t.widgets.helpers.create_datatable(this,this.table,{iDisplayLength:5,aaSortingFixed:[[1,"desc"]],bSortable:!1,aoColumnDefs:[{bVisible:!1,aTargets:[0,1]}],fnDrawCallback:function(n){t.widgets.helpers.dataTablesGroupRows(e(this).find("tbody tr"),n)}})},destroy:function(){this.chart&&this.chart.destroy instanceof Function&&this.chart.destroy(),this.chart=null}},directordirectorshipsdocwidget:{destroy:function(){t.widgets.helpers.destroy_datatable(this)},init:function(){function l(e){h(e),n.find(".js-popover").popover({container:"body",trigger:"hover",html:!0})}function c(t){var n=0;return s.each(function(){var r=e(this),s=e.extend({},t,r.data("state")),o=i[s.status||""][s.type||""][s.trading||""];r.hasClass("selected")&&(n=o),r.find("span.count").text(""+o)}),n}function h(e){var t="Showing ";!e.status&&!e.type?t+="all ":(e.status&&(t+=e.status+" "),e.type=="directors"?t+="directorial ":e.type=="secretaries"&&(t+="secretarial ")),t+="directorships",e.trading&&(t+=" at "+(e.trading=="trading"?"trading":"non-trading")+" companies"),n.find(".dropdown-label").text(t)}var t=this,n=e("#widget_directordirectorshipsdocwidget"),r=this.table=n.find("table"),i=r.data("counts"),s=n.find("a[data-state]"),o="";s.tickList();var u=s.getListState(),a=c(u);l(u);var f=this.dt=r.duedilTable({bSort:!1,iDisplayLength:r.data("size"),iDeferLoading:a,bServerSide:!0,sAjaxSource:r.data("source")});s.on("update",function(e,t){u=t,c(t),f&&f.fnSetParams(t)}),r.on("load-finish",function(){l(u)})}},possiblematcheswidget:{init:function(){t.widgets.helpers.create_datatable(this,"#widget_possiblematcheswidget table",{iDisplayLength:3,bSort:!1,aoColumnDefs:[{sType:"string",aTargets:[0]}],oLanguage:{sEmptyTable:"No Possible Matches Found"}})},destroy:function(){t.widgets.helpers.destroy_datatable(this)}},relateddirectorswidget:{init:function(){t.widgets.helpers.create_datatable(this,"#widget_relateddirectorswidget .data-table",{iDisplayLength:3})},destroy:function(){t.widgets.helpers.destroy_datatable(this)}},socialaccountswidget:{klout:{profile:null,score:null,nick:null,topics:null},linkedin:{wrapper:null,loading:null,profile:null,pic:null,name:null,headline:null,location:null,additional:null,connect:null},twitter:{loading:null,tweets:null},widget:null,init:function(t){this.widget=e("#widget_socialaccountswidget"),this.klout.profile=e("#klout_profile"),this.klout.score=e(".score",this.klout.profile),this.klout.nick=e(".nick",this.klout.profile),this.klout.topics=e(".topics .items",this.klout.profile),this.klout.avatar=e(".avatar img",this.klout.profile),this.linkedin.wrapper=e("#linkedin_profile"),this.linkedin.loading=e(".loading",this.linkedin.wrapper),this.linkedin.profile=e(".profile",this.linkedin.profile),this.linkedin.pic=e(".avatar img",this.linkedin.wrapper),this.linkedin.name=e(".name",this.linkedin.wrapper),this.linkedin.headline=e(".headline",this.linkedin.wrapper),this.linkedin.location=e(".location",this.linkedin.wrapper),this.linkedin.additional=e(".additional",this.linkedin.wrapper),this.linkedin.connect=e(".connect",this.linkedin.wrapper)},update:function(e,t){if(!t.property)return;if(!this.widget)return;switch(t.property){case"klout":this.update_klout(e);break;case"linkedin":this.update_linkedin(e)}},update_klout:function(t){var n=this;if(t.error){this.klout.profile.hide();return}var r=Math.round(t.klout_score);this.klout.score.text(r),r==100?this.klout.score.addClass("hundred"):this.klout.score.removeClass("hundred");var s=this.klout.nick.find("a");s.attr("href","http://www.klout.com/"+t.klout_nickname),s.text(t.klout_nickname.charAt(0).toUpperCase()+t.klout_nickname.slice(1)),t.twitter_avatar&&this.klout.avatar.attr("src",t.twitter_avatar);var o,u;this.klout.topics.empty(),this.klout.topics.parent().addClass("hidden");for(i in t.klout_topics){if(i>=5)break;o=t.klout_topics[i],u=e("<a />"),u.attr("target","_blank"),u.attr("href","http://www.klout.com/topic/"+o.slug),u.text(o.displayName.toLowerCase()),i>0&&this.klout.topics.append("<span> &bull; </span>"),this.klout.topics.append(u),this.klout.topics.parent().removeClass("hidden")}this.klout.profile.hasClass("hidden")&&this.klout.profile.fadeIn(250,function(){n.klout.profile.removeClass("hidden")})},update_linkedin:function(t){var n=this;if(t.error){this.linkedin.wrapper.hide();return}this.linkedin.name.text(t.name),t.headline?this.linkedin.headline.text(t.headline):this.linkedin.headline.hide(),t.profile_pic&&this.linkedin.pic.attr("src",t.profile_pic),t.location?this.linkedin.location.text(t.location):this.linkedin.location.hide();var r={};if(t.current_positions.length>0){var s,o;r.Current=[];for(i in t.current_positions)s=t.current_positions[i],o=e("<p />"),o.text(s.title+" at "+s.company.name),r.Current.push(o)}if(t.positions.length>0){var s,o;r.Past=[];for(i in t.positions)s=t.positions[i],o=e("<p />"),o.text(s.title+" at "+s.company.name),r.Past.push(o)}if(t.educations.length>0){var u,a;r.Education=[];for(i in t.educations)u=t.educations[i],a=e("<p />"),a.text(u.name),r.Education.push(a)}if(t.connections){var f=e("<p />");f.text(t.connections+" Connections"),r.Connections=[f]}if(t.profile_url){var f=e("<p />"),l=e("<a />");l.attr("target","_blank"),l.attr("href",t.profile_url),l.text(t.profile_url),r["Public profile"]=[f.append(l)],this.linkedin.connect.attr("href",t.profile_url)}var c,h,p;for(key in r){c=e('<li class="clearfix" />'),h=e("<span />"),h.text(key),c.append(h);for(i in r[key])p=e('<div class="value" />'),p.append(r[key][i]),c.append(p);this.linkedin.additional.append(c)}this.linkedin.loading.hide(),this.linkedin.profile.fadeIn(250),this.linkedin.connect.fadeIn(250)},destroy:function(){this.widget=null}},directormapwidget:{init:function(){var n=e("#widget_directormapwidget .google-map"),r=new t.map(n.data("address"),n)}}}}),define("app/app-director",["jquery","common","director/Duedil.profile.director","director/Duedil.widgets.director"],function(e,t){return t});