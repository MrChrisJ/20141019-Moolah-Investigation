Atoshonetwork.Editorial={_arroStorefronts:{},_arroUrlData:null,_oMixPanel:null,arriZones:[],_arroOnPageProducts:[],onPageProductAdded:function(a){Atoshonetwork.Event.listen("atosho.onPageProductAdded",a)},generateHubs:function(e){var c=Atoshonetwork.Editorial;if(e&&Atoshonetwork.getConfig("Source").hubs){var d=Atoshonetwork.$;var b=Atoshonetwork.getConfig("Source").hubs;for(i=b.length-1;i>=0;i--){var a=b[i];if(a.hubid!=-1&&window.location.href.match(new RegExp(a.regex))){if(a.hubid==0){return}Atoshonetwork.loadContextCSS();if(typeof c._arroStorefronts.hub==="undefined"){c._arroStorefronts.hub={}}d(a.selector).each(function(g){if(typeof d(this).attr("atosho_sf")==="undefined"){if(g==0){c.arriZones.push(a.id)}d(this).attr("atosho_sf",true);switch(d(this).prop("tagName").toLowerCase()){case"img":c._arroStorefronts.hub[a.hubid]=new c.Hub.Image(d(this),a);break;default:var f=Atoshonetwork._arrsMainConfig.Source.id;if(f==8093||f==8077||f==8083){c._arroStorefronts.hub[a.hubid]=new c.Hub.Dock(d(this),a)}else{if(f==8100){a.config={};a.config.rows=2;c._arroStorefronts.hub[a.hubid]=new c.Hub.ExpandedMosaic(d(this),a)}else{c._arroStorefronts.hub[a.hubid]=new c.Hub.Mosaic(d(this),a)}}break}}})}}}Atoshonetwork.Event.fireOnce("atosho.stats.onPageViewed",[c.arriZones.length?1:0,c.arriZones])},addOnPageProduct:function(a){Atoshonetwork.Editorial._arroOnPageProducts.push(a);Atoshonetwork.Event.fire("atosho.onPageProductAdded",[a])},getOnPageProduct:function(){return Atoshonetwork.Editorial._arroOnPageProducts},load:function(){var a=Atoshonetwork.Editorial;a._oMixPanel=new Atoshonetwork.MixPanel(Atoshonetwork._arrsConfig.MixPanel);if(parseInt(Atoshonetwork.getConfig("Source").customization.globalBasketEnabled)!=0||Atoshonetwork.getConfig().basketEnabled){a.addBasketWidget()}var b=true;Atoshonetwork.Getter.Url(Atoshonetwork._arrsConfig.keyurl,function(h,p,t,r){switch(h){case"success":var l=Atoshonetwork.$;var c=[];a._arroUrlData=t;var k=false;for(var q in t.Zones){if(t.Zones.hasOwnProperty(q)){var g=false;var m=false;var j=t.Zones[q];switch(j.type){case"Image":case"Editorial.Image":case"Editorial.Image.Hub":case"Editorial.ImageDock":case"Editorial.ImageDock.Hub":try{var f=l('img[src="'+j.selector+'"]');if(!f.length){f=l('img[src="'+j.selector.replace(/%20/g," ")+'"]');if(!f.length){var d=encodeURIComponent(j.selector.replace("%20"," ").replace(/\//g,"----").replace(/:/g,"...."));d=d.replace(/----/g,"/").replace(/\.\.\.\./g,":");var f=l("img").filter(function(){return l(this).attr("src").toLowerCase()==d.toLowerCase()})}}f.filter(function(){return l(this).height()>100&&l(this).width()>100&&typeof l(this).attr("atosho_load")==="undefined"}).each(function(e){l(this).attr("atosho_load",true);l(this).attr("atosho_sf",true);if(!a._arroStorefronts[j.type]){a._arroStorefronts[j.type]={}}if(e==0){a.arriZones.push(j.id)}if(j.dataid&&j.dataid!=null){j.hubid=j.dataid;j.zone={id:j.id};if(j.type=="Editorial.ImageDock.Hub"){a._arroStorefronts[j.type][q]=new a.Hub.ImageDock(l(this),j)}else{a._arroStorefronts[j.type][q]=new a.Hub.Image(l(this),j)}}else{if(j.type=="Editorial.ImageDock"&&!Atoshonetwork.Common.getBrowserInfo().isMobile){a._arroStorefronts[j.type][q]=new a.ImageDock(l(this),j)}else{a._arroStorefronts[j.type][q]=new a.Image(l(this),j)}}})}catch(o){Atoshonetwork.stats("error",{url:window.location.href,error:"SYS_SF_IMG",msg:o.message})}break;case"Editorial.Mosaic.Hub":try{var f=l("atosho").filter("[position='"+j.selector+"']");if(f.length){if(!a._arroStorefronts[j.type]){a._arroStorefronts[j.type]={}}f.attr("atosho_sf",true);a.arriZones.push(j.id);j.hubid=j.dataid;j.zone={id:j.id};a._arroStorefronts[j.type][q]=new a.Hub.ExpandedMosaic(f,j);b=false}}catch(o){Atoshonetwork.stats("error",{url:window.location.href,error:"SYS_SF_MOSAIC_HUB",msg:o.message})}break;case"Editorial.ExpandedMosaic.Hub":try{var f=l("atosho").filter("[position='"+j.selector+"']");if(f.length){if(!a._arroStorefronts[j.type]){a._arroStorefronts[j.type]={}}f.attr("atosho_sf",true);a.arriZones.push(j.id);j.hubid=j.dataid;j.zone={id:j.id};a._arroStorefronts[j.type][q]=new a.Hub.ExpandedMosaic(f,j);b=false}}catch(o){Atoshonetwork.stats("error",{url:window.location.href,error:"SYS_SF_MOSAIC_HUB",msg:o.message})}break;case"Editorial.Mosaic":try{var f=l("atosho").filter("[position='"+j.selector+"']");if(f.length){if(!a._arroStorefronts[j.type]){a._arroStorefronts[j.type]={}}f.attr("atosho_sf",true);a.arriZones.push(j.id);a._arroStorefronts[j.type][q]=new a.Mosaic(f,j);b=false}}catch(o){Atoshonetwork.stats("error",{url:window.location.href,error:"SYS_SF_MOSAIC",msg:o.message})}break;case"Editorial.Dock.Hub":try{var f=l("atosho").filter("[position='"+j.selector+"']");if(f.length){if(!a._arroStorefronts[j.type]){a._arroStorefronts[j.type]={}}f.attr("atosho_sf",true);a.arriZones.push(j.id);j.hubid=j.dataid;j.zone={id:j.id};a._arroStorefronts[j.type][q]=new a.Hub.Dock(f,j);b=false}}catch(o){Atoshonetwork.stats("error",{url:window.location.href,error:"SYS_SF_MOSAIC_HUB",msg:o.message})}break;case"Text":case"Editorial.Link":try{var n=j.selector.split("|");if(n.length>2&&l(n[0]).length&&l(n[0]).html().match(new RegExp("(\\b"+n[1]+"\\b)","g"))!=null){if(!a._arroStorefronts[j.type]){a._arroStorefronts[j.type]={}}a.arriZones.push(j.id);a._arroStorefronts[j.type][q]=new a.Text(l("body").find(n[0]).first(),j)}}catch(o){Atoshonetwork.stats("error",{url:window.location.href,error:"SYS_SF_INTEXT",msg:o.message})}break;case"ExpandedButton":case"Editorial.ExpandedButton":try{var f=l("atosho").filter("[position='"+j.selector+"']");if(f.length){if(!a._arroStorefronts[j.type]){a._arroStorefronts[j.type]={}}f.attr("atosho_sf",true);a.arriZones.push(j.id);a._arroStorefronts[j.type][q]=new a.ExpandedButton(f,j);b=false}}catch(o){Atoshonetwork.stats("error",{url:window.location.href,error:"SYS_SF_EBUTTON",msg:o.message})}break;case"Button":case"Editorial.Button":try{var f=l("atosho").filter("[position='"+j.selector+"']");if(f.length){if(!a._arroStorefronts[j.type]){a._arroStorefronts[j.type]={}}f.attr("atosho_sf",true);a.arriZones.push(j.id);a._arroStorefronts[j.type][q]=new a.Button(f,j);b=false}}catch(o){Atoshonetwork.stats("error",{url:window.location.href,error:"SYS_SF_BUTTON",msg:o.message})}break;case"Editorial.Dock":try{var f=l("atosho").filter("[position='"+j.selector+"']");if(f.length){if(!a._arroStorefronts[j.type]){a._arroStorefronts[j.type]={}}f.attr("atosho_sf",true);a.arriZones.push(j.id);a._arroStorefronts[j.type][q]=new a.Dock(f,j);b=false}}catch(o){Atoshonetwork.stats("error",{url:window.location.href,error:"SYS_SF_DBUTTON",msg:o.message})}break}}}Atoshonetwork.$("img").on("load",a.onImageLoaded);break}if(h=="success"||h=="error"){Atoshonetwork.Editorial.generateHubs(b)}},true)},addBasketWidget:function(){var a=Atoshonetwork.Editorial;if(!a._arroStorefronts.basket){a._arroStorefronts.basket={}}Atoshonetwork.loadTranslation(function(){a._arroStorefronts.basket[0]=new a.ShoppingAssistant();Atoshonetwork.$("body").append(a._arroStorefronts.basket[0].render())})},onImageLoaded:function(){var h=Atoshonetwork.Editorial;var d=Atoshonetwork.$;var d=Atoshonetwork.$;var f=d(this);var j=false;var a=d(this).attr("src").toLowerCase();var e=null;if(h._arroUrlData.Zones){for(var k in h._arroUrlData.Zones){var c=h._arroUrlData.Zones[k];var g=c.selector.toLowerCase();if(c.type=="Editorial.Image"){if(g!=a){if(g.replace(/%20/g," ")!=a){var b=encodeURIComponent(g.replace("%20"," ").replace(/\//g,"----").replace(/:/g,"....")).replace(/----/g,"/").replace(/\.\.\.\./g,":");j=(b==a)}else{j=true}}else{j=true}if(j){e=c;break}}}}if(e!=null){if(!h._arroStorefronts["Editorial.Image.RT"]){h._arroStorefronts["Editorial.Image.RT"]={}}h._arroStorefronts["Editorial.Image.RT"][k]=new h.Image(f,e)}},unload:function(){var c=Atoshonetwork.Editorial;Atoshonetwork.$("img").off("load",c.onImageLoaded);for(var b in c._arroStorefronts){if(c._arroStorefronts.hasOwnProperty(b)){for(var a in c._arroStorefronts[b]){if(c._arroStorefronts[b].hasOwnProperty(a)&&c._arroStorefronts[b][a].destroy){c._arroStorefronts[b][a].destroy();delete c._arroStorefronts[b][a]}}}}if(c._oMixPanel){c._oMixPanel.disable()}delete c._oMixPanel}};Atoshonetwork.Accordian=function(){Atoshonetwork.SuperClass.call(this);this.options={};this.customization=Atoshonetwork.getConfig("Source").customization;this.currency=Atoshonetwork.getConfig("Source").currency;this.$accordian=null;this.expanded=false;this.oSectionData={};var a="";if((a=Atoshonetwork.Common.getCookie("atoshonetwork_sa_state"))!=""){this.oSectionData=Atoshonetwork.$.extend(this.oSectionData,Atoshonetwork.$.parseJSON(a))}};Atoshonetwork.Accordian.onStateChanged=function(a){Atoshonetwork.Event.listen("Atoshonetwork.AtoshoBasketWidget.accordian.stateChange",a)};Atoshonetwork.Accordian.prototype=Atoshonetwork.$.extend(true,Object.create(Atoshonetwork.SuperClass.prototype),{init:function(){var b=Atoshonetwork.$;var a=this;a.$accordian=b('<div id="AtoshoAccordian"></div>');Atoshonetwork.Accordian.onStateChanged(function(){Atoshonetwork.Common.setCookie("atoshonetwork_sa_state",JSON.stringify(a.oSectionData),4)});return a.$accordian},addSection:function(a,k,d,f){var l=0;var b="";var e=1;var h=false;var c=Atoshonetwork.$;var m=this;if(m.oSectionData[a]){e=m.oSectionData[a].state;if(m.oSectionData[a].clicked){h=m.oSectionData[a].clicked}}if(e==2){l=500;b="atoshoFlipArrow"}var c=Atoshonetwork.$;var g="";g="<div id='"+a+"_holder' sectionName='"+a+"' class='atoshoModuleHolder' style='margin-top:2px;background-color:"+m.customization.backgroundColor+";border-radius: 2px 0px 0px 2px;color: white;overflow:hidden;max-height:500px;display:"+f+";'>";g+="<div class='atoshoBasketModuleGradient' sectionName='"+a+"' style='display:table;height:50px;width:100%;cursor: pointer;'>";g+="<div style='display: table-cell;vertical-align: middle;text-align: left;width: 167px;font-weight: bold;font-style: normal;font-size: 14px;color: #fff;'><div class='atoshoHead' style='padding: 0px 5px 0px 12px;'>"+k+"</div></div>";g+="<div style='width: 34px;display: table-cell;vertical-align: middle;'><div style='width: 22px;height: 22px;display: block;' class='atoshoBasketArrowDown "+b+"'></div></div>";g+="</div><div class='atoshoModuleContent' style='max-height:"+l+"px;position: relative;overflow: hidden;'></div></div>";var j=c(g);c("div.atoshoBasketModuleGradient",j).click(function(){var n=c(this);var p=1;var o=n.attr("sectionName");if(m.oSectionData[o].state==2){c("div.atoshoModuleContent",n.parents(".atoshoModuleHolder")).animate({"max-height":"0px"},200,function(){c("div.atoshoBasketArrowDown",n).removeClass("atoshoFlipArrow")});p=1}else{c("div.atoshoBasketArrowDown",n).addClass("atoshoFlipArrow");c("div.atoshoModuleContent",n.parents("div.atoshoModuleHolder")).animate({"max-height":"500px"},200);p=2}m.oSectionData[o]={state:p,clicked:true};Atoshonetwork.Event.fire("Atoshonetwork.AtoshoBasketWidget.accordian.stateChange",[o,p])});m.$accordian.append(j);c("div.atoshoModuleContent",j).append(d);m.oSectionData[a]={state:e,clicked:h}},updateSection:function(a,b){var c=Atoshonetwork.$;c("div#"+a+"_holder div.atoshoModuleContent").empty();c("div#"+a+"_holder div.atoshoModuleContent").append(b)},setSectionDisplay:function(b,f,c){var e=Atoshonetwork.$;var a=this;var d=e("div#"+b+"_holder",a.$accordian);if(!c){c=false}if(c||a.oSectionData[b].clicked==null||(a.oSectionData[b]!=null!=null&&!a.oSectionData[b].clicked)){switch(f){case 0:d.css({display:"none","max-height":"0px"});break;case 1:d.css({"max-height":"500px"});e("div.atoshoBasketArrowDown",d).removeClass("atoshoFlipArrow");e("div.atoshoModuleContent",d).css({"max-height":"0px"});break;case 2:d.css({"max-height":"500px"});e("div.atoshoModuleContent",d).css({display:"block","max-height":"500px"});e("div.atoshoBasketArrowDown",d).addClass("atoshoFlipArrow");break}this.oSectionData[b]={state:f};Atoshonetwork.Event.fire("Atoshonetwork.AtoshoBasketWidget.accordian.stateChange",[b,f])}},getSectionDisplay:function(a){return this.oSectionData[a].state}});Atoshonetwork.Editorial.DOMStorefront=function(e,b){Atoshonetwork.SuperClass.call(this);this.$oContainer=e;this.iID=Math.floor(Math.random()*10000000000);this.$oPlaceHolder=e;this.$oPlaceHolder.attr("atosho_id",this.iID);this.$oElement=null;this.iCurrentProductId=null;this.oCSS={};if(this.$oPlaceHolder.attr("css")!==undefined){var f=this.$oPlaceHolder.attr("css");var a=f.split(";");for(var c=0;c<a.length;c++){if(a[c]!=null&&a[c].trim()!=""){var d=a[c].split(":");this.oCSS[d[0].trim()]=d[1].trim()}}}};Atoshonetwork.Editorial.DOMStorefront.prototype=Atoshonetwork.$.extend(true,Object.create(Atoshonetwork.SuperClass.prototype),{destroy:function(){this.$oPlaceHolder.removeAttr("atosho_id");this.$oPlaceHolder.removeAttr("atosho_sf");this.$oPlaceHolder.removeAttr("atosho_load");if(this.$oElement){this.$oElement.remove()}}});Atoshonetwork.Editorial.Button=function(a,b){Atoshonetwork.Editorial.DOMStorefront.call(this,a,b);this.defaultConfiguration={config:{"z-index":"10000",mixpanel:0}};Atoshonetwork.$.extend(true,this.defaultConfiguration,b);this.timeoutID=null;this.$oPreview=null;this.oShop=new Atoshonetwork.Shop(this);this.init()};Atoshonetwork.Editorial.Button.prototype=Atoshonetwork.$.extend(true,Object.create(Atoshonetwork.Editorial.DOMStorefront.prototype),{init:function(){var a=this;var b=Atoshonetwork.$;a.$oElement=b("<atoshonetwork>",{id:a.iID,"class":"atoshonetwork",style:"display: inline-block;"}).css({"margin-top":"5px","margin-bottom":"5px"}).css(a.oCSS);a.$oElement.insertAfter(a.$oPlaceHolder);a.initEditorialButton();a.initPreview()},initEditorialButton:function(){var a=this;var f=Atoshonetwork.$;var d=f("<div/>",{id:"buttonBody",style:"cursor: pointer; display: none; "});var b=f('<div class="atosho-buttonimage atoshonetwork" style="background-color: '+Atoshonetwork.getConfig("Source").customization.backgroundColor+';"><div id="basket-icon" class="atoshonetwork basket-icon" style="background-color: '+Atoshonetwork.getConfig("Source").customization.storefrontButtonColor+';height: 36px;width: 36px;border-radius: 50%;margin: 10% 0 0 10%;opacity: 1;"/></div>');var c=f('<div class="button-text-container atoshonetwork" style="background-color: '+Atoshonetwork.getConfig("Source").customization.backgroundColor+';"/>');var g=f('<span class="button-text-center atoshonetwork atoshoBody"/>');var e=this.defaultConfiguration.config["button-text"];e=e.replace("%WEBSITENAME%",Atoshonetwork.getConfig("Source").name);g.html(e);c.append(g);d.append(b);d.append(c);d.appendTo(a.$oElement);d.mouseenter(function(){window.clearTimeout(a.timeoutID);a.displayPreview()});d.mouseleave(function(){a.timeoutID=window.setTimeout(function(){a.hidePreview()},20)});d.click(function(h){if(typeof h.stopPropagation!=="undefined"){h.stopPropagation();h.preventDefault()}else{if(window.event){window.event.cancelBubble=true}}a.openShop(false)})},initPreview:function(){var k=this;var d=Atoshonetwork.$;var j=k.$oElement.attr("id");var e=d("<div/>",{id:"previewContainer","class":"atosho-preview-container atoshonetwork",atosho_id:j}).css({"max-width":"10000px",height:".1px","z-index":this.defaultConfiguration.config["z-index"],"background-color":Atoshonetwork.getConfig("Source").customization.backgroundColors}).appendTo("body");this.$oPreview=e;e.mouseleave(function(){k.timeoutID=window.setTimeout(function(){k.hidePreview()},20)});e.mouseenter(function(){window.clearTimeout(k.timeoutID)});var h=Atoshonetwork.Common.createPreviewItem();var g=this.defaultConfiguration.config.products;var b=g.length;var a=d("div#buttonBody",k.$oElement);var c=false;for(var f=0;f<b;f++){(function(l){Atoshonetwork.Getter.InStockProduct(g[l],function(r,m,q){if(r=="success"){if(q.stock.stockcount!=0){c=true;Atoshonetwork.Editorial.addOnPageProduct(m);var n=".jpg";var p=h.clone().appendTo(e);if(k.iCurrentProductId==null){k.iCurrentProductId=m}var t=Atoshonetwork.Common.getFirstElement(q.sheet.images);if(t.type!=null&&t.type!=""){n="."+t.type}p.mouseenter(function(v){if(typeof v.preventDefault!=="undefined"){v.preventDefault()}d("div.new-preview-arrow.atoshonetwork",this).animate({"margin-left":"2px"},100);d("div.new-preview-arrow.atoshonetwork span",this).animate({width:"52px"},100);d("div.new-preview-arrow.atoshonetwork span",this).html(Atoshonetwork.getConfig("Source").translations.DETAILS_BUTTON)}).mouseleave(function(v){if(typeof v.preventDefault!=="undefined"){v.preventDefault()}d("div.new-preview-arrow.atoshonetwork",this).animate({"margin-left":"29px"},100);d("div.new-preview-arrow.atoshonetwork span",this).animate({width:"0px"},100);d("div.new-preview-arrow.atoshonetwork span",this).html("")}).click(function(v){if(typeof v.preventDefault!=="undefined"){v.preventDefault()}k.iCurrentProductId=m;d("div.preview-column",d(this).parent()).css("background-color",Atoshonetwork.getConfig("Source").customization.backgroundColor);d(this).css("background-color","#a8a9b8");k.openShop(true)});d("div.preview-center-image",p).css("background-image","url("+t.url+"500x500_trim"+n+")");d("p.productTitle",p).html(q.sheet.name);var u=d("span.button-text-center",a).text();u=u.replace("%PRODUCTNAME%",q.sheet.name);d("span.button-text-center",a).html(u);p.attr("id",q.sheet.id);d("div.preview-text",p).dotdotdot({});if(d("div.preview-column",e).length>2){a.css({width:e.width()});d("div.button-text-container",a).css({width:e.width()-d("div.atosho-buttonimage",a).width()-1})}d("div.preview-price",p).html(q.getPrice());d("div.preview-originalPrice",p).html(q.getOriginalPrice());a.css({display:"inline-block"});var o=q.getSavedPercentage();if(o>=7){d("div.atosho-discount-badge",p).css({display:"block"});d("div.atosho-discount-badge",p).text("-"+o+"%")}else{d("div.atosho-discount-badge",p).css({display:"none"})}}else{if(l==b-1&&c==false){k.$oElement.remove()}}}else{if(r=="error"){if(l==b-1&&c==false){k.$oElement.remove()}}}})})(f)}},displayPreview:function(){var b=this;var d=Atoshonetwork.$;var e=b.$oElement.attr("id");var c=d("div.atosho-preview-container[atosho_id="+e+"]");if(!d("div.atosho-shop-container[atosho_id="+e+"]","body").length>0){var a=0;if(Atoshonetwork.$("body").attr("style")!=null&&Atoshonetwork.$("body").attr("style")!=""&&Atoshonetwork.$("body").attr("style").indexOf("relative")!=-1){a=d("body").offset().top}c.css({top:b.$oElement.offset().top+d("div#buttonBody",b.$oElement).outerHeight()+1-a,left:b.$oElement.offset().left});c.animate({height:d("div.preview-column",c).height()},200)}},hidePreview:function(){var a=this;var c=Atoshonetwork.$;var d=a.$oElement.attr("id");var b=c("div.atosho-preview-container[atosho_id="+d+"]");if(!c("div.atosho-shop-container[atosho_id="+d+"]","body").length>0){b.animate({height:".1px"},300)}},openShop:function(c){var b=this;var d=Atoshonetwork.$;var f=b.$oElement.attr("id");var e=d("atoshonetwork[id="+f+"]").offset().left;if(Atoshonetwork._arrsConfig.shopContainerSelector!=null&&Atoshonetwork._arrsConfig.shopContainerSelector!=""){e=d(Atoshonetwork._arrsConfig.shopContainerSelector).offset().left}Atoshonetwork.Event.fire("atosho.editorial.storefront.onClick",[b.iCurrentProductId,this.defaultConfiguration]);var a=0;if(d("body").css("position")=="relative"){a=d("body").offset().top}this.oShop.openOneToOneGrid(b.$oElement.offset().top+d("div#buttonBody",b.$oElement).outerHeight()+1-a,e,b.iCurrentProductId,this.defaultConfiguration.id,b.defaultConfiguration.config.products,c);this.oShop.removePreviewCover(true,function(){d.get(Atoshonetwork._arrsConfig.url+"/shop/openimpression/productid/"+b.iCurrentProductId+"/zoneid/"+b.defaultConfiguration.id);Atoshonetwork.Event.fire("atosho.editorial.storefront.onClick",[b.iCurrentProductId,b.defaultConfiguration])})}});Atoshonetwork.Editorial.ExpandedButton=function(a,b){Atoshonetwork.Editorial.DOMStorefront.call(this,a,b);this.defaultConfiguration={config:{"z-index":"10000",mixpanel:0}};Atoshonetwork.$.extend(true,this.defaultConfiguration,b);this.$oPreview=null;this.oShop=new Atoshonetwork.Shop(this);this.init()};Atoshonetwork.Editorial.ExpandedButton.prototype=Atoshonetwork.$.extend(true,Object.create(Atoshonetwork.Editorial.DOMStorefront.prototype),{init:function(){var a=this;var b=Atoshonetwork.$;a.$oElement=b("<atoshonetwork>",{id:a.iID}).css({display:"inline-block","margin-top":"5px","margin-bottom":"5px"}).css(a.oCSS);a.$oElement.insertAfter(a.$oPlaceHolder);a.initExpandedButton();a.initPreview()},initExpandedButton:function(){var a=this;var f=Atoshonetwork.$;var d=f("<div/>",{id:"buttonBody",style:"cursor: pointer; display: none; min-height:45px;"});var b=f('<div class="atosho-buttonimage atoshonetwork" style="background-color: '+Atoshonetwork.getConfig("Source").customization.backgroundColor+';"><div id="basket-icon" class="atoshonetwork basket-icon" style="height: 36px;width: 36px;background-color: '+Atoshonetwork.getConfig("Source").customization.storefrontButtonColor+';border-radius: 50%;margin: 10% 0 0 10%;opacity: 1;"/></div>');var c=f('<div class="button-text-container atoshonetwork" style="background-color: '+Atoshonetwork.getConfig("Source").customization.backgroundColor+';"/>');var g=f('<span class="button-text-center atoshonetwork atoshoBody"/>');var e=this.defaultConfiguration.config["button-text"];e=e.replace("%WEBSITENAME%",Atoshonetwork.getConfig("Source").name);g.html(e);c.append(g);c.append('<span id="extraStoreText" style="font-size: 10px;color: #b1b1b1;margin: 0px 10px 5px 0px;display: inline-block;position: absolute;bottom: 0px;right: 0px;vertical-align: text-bottom;line-height: 1em;">'+Atoshonetwork.getConfig("Source").customization.advertisingText+"</span>");d.append(b);d.append(c);d.appendTo(a.$oElement);d.click(function(h){if(typeof h.stopPropagation!=="undefined"){h.stopPropagation();h.preventDefault()}else{if(window.event){window.event.cancelBubble=true}}a.openShop()})},initPreview:function(){var j=this;var c=Atoshonetwork.$;var e=c("div#buttonBody",j.$oElement);var d=c("<div/>",{id:"previewContainer","class":"atosho-expandedbutton-preview atoshonetwork",style:"max-width:10000px;background-color :"+Atoshonetwork.getConfig("Source").customization.backgroundColor+";"}).insertAfter(e);this.$oPreview=d;var h=Atoshonetwork.Common.createPreviewItem();var g=this.defaultConfiguration.config.products;var a=g.length;var b=false;for(var f=0;f<a;f++){(function(k){Atoshonetwork.Getter.InStockProduct(g[k],function(q,l,p){if(q=="success"){if(p.stock.stockcount!=0){b=true;Atoshonetwork.Editorial.addOnPageProduct(l);var m=".jpg";var o=h.clone();if(j.iCurrentProductId==null){j.iCurrentProductId=l}var r=Atoshonetwork.Common.getFirstElement(p.sheet.images);if(r.type!=null&&r.type!=""){m="."+r.type}o.mouseenter(function(u){if(typeof u.preventDefault!=="undefined"){u.preventDefault()}c("div.new-preview-arrow.atoshonetwork",this).animate({"margin-left":"2px"},100);c("div.new-preview-arrow.atoshonetwork span",this).animate({width:"52px"},100);c("div.new-preview-arrow.atoshonetwork span",this).html(Atoshonetwork.getConfig("Source").translations.DETAILS_BUTTON)}).mouseleave(function(u){if(typeof u.preventDefault!=="undefined"){u.preventDefault()}c("div.new-preview-arrow.atoshonetwork",this).animate({"margin-left":"29px"},100);c("div.new-preview-arrow.atoshonetwork span",this).animate({width:"0px"},100);c("div.new-preview-arrow.atoshonetwork span",this).html("")}).click(function(u){if(typeof u.preventDefault!=="undefined"){u.preventDefault()}j.iCurrentProductId=l;c("div.preview-column",c(this).parent()).css("background-color",Atoshonetwork.getConfig("Source").customization.backgroundColor);c(this).css("background-color","#a8a9b8");j.openShop()});c("div.preview-center-image",o).css("background-image","url("+r.url+"500x500_trim"+m+")");c("p.productTitle",o).html(p.sheet.name);var t=c("span.button-text-center",e).text().replace("%PRODUCTNAME%",p.sheet.name);c("span.button-text-center",e).html(t);o.attr("id",p.sheet.id);c("div.preview-price",o).html(p.getPrice());c("div.preview-originalPrice",o).html(p.getOriginalPrice());c("div#buttonBody",j.$oElement).css({display:"block"});var n=p.getSavedPercentage();if(n>=7){c("div.atosho-discount-badge",o).css({display:"block"});c("div.atosho-discount-badge",o).text("-"+n+"%")}else{c("div.atosho-discount-badge",o).css({display:"none"})}d.append(o);if(c("div.preview-column",d).length>=2){e.css({width:d.outerWidth()});c("span.button-text-center",e).css({width:d.outerWidth()-c("div.atosho-buttonimage",e).outerWidth()+32})}c("div.preview-text",o).dotdotdot({});c("div.atosho-buttonimage",e).css({height:c("div.button-text-container",e).outerHeight()})}else{if(k==a-1&&b==false){j.$oElement.remove()}}}else{if(q=="error"){if(k==a-1&&b==false){j.$oElement.remove()}}}})})(f)}},openShop:function(){var b=this;var c=Atoshonetwork.$;var e=b.$oElement.attr("id");var d=c("atoshonetwork[id="+e+"] #previewContainer").offset().left;if(Atoshonetwork._arrsConfig.shopContainerSelector!=null&&Atoshonetwork._arrsConfig.shopContainerSelector!=""){d=c(Atoshonetwork._arrsConfig.shopContainerSelector).offset().left}Atoshonetwork.Event.fire("atosho.editorial.storefront.onClick",[b.iCurrentProductId,this.defaultConfiguration]);var a=0;if(c("body").css("position")=="relative"){a=c("body").offset().top}this.oShop.openShop(c("atoshonetwork[id="+e+"] #previewContainer").offset().top-a,d,b.iCurrentProductId,this.defaultConfiguration.id,this.$oPreview)}});Atoshonetwork.Editorial.Image=function(a,c){Atoshonetwork.SuperClass.call(this);this.defaultConfiguration={config:{"z-index":"10000",mixpanel:0,"horizontal-position":"left","vertical-position":"bottom","button-text":""}};Atoshonetwork.$.extend(true,this.defaultConfiguration,c);this.$oImage=a;if(this.$oImage.attr("atosho_id")==undefined){this.$oImage.attr("atosho_id","img_"+Math.floor(Math.random()*10000000000))}this.$oElement=null;this.$previewItem=null;this.$oContainer=null;this.timeoutID=null;this.iCurrentProductId=null;this.bSingleProduct=false;this.hasExpanded=false;this.oShop=null;var b=this;this.init(function(){b.binder()})};Atoshonetwork.Editorial.Image.prototype=Atoshonetwork.$.extend(true,Object.create(Atoshonetwork.SuperClass.prototype),{init:function(e){var a=this;var d=Atoshonetwork.$;var c=a.$oImage;var b=d("<atoshonetwork>",{id:c.attr("atosho_id")});if(a.$oImage.css("float")=="right"){b.css({"float":"right"})}b.appendTo("body");this.$oElement=b;a.initImageButton(function(){a.initPreview(function(){a.positionOverlay();e&&e()})})},destroy:function(){var a=Atoshonetwork.$;this.$oImage.removeAttr("atosho_load");this.$oElement.remove();delete this},initImageButton:function(e){var l=this;var c=Atoshonetwork.$;var b=0;var f=0;var g=l.$oImage;var a=0;var k=-1;l.$oImage.parents().each(function(){var m=c(this).css("z-index");if(!isNaN(parseFloat(m))&&isFinite(m)&&k<parseInt(m)){k=parseInt(m)}});if(k<0){k=this.defaultConfiguration.config["z-index"]}var d=c('<div id="atosho-image-container"></div>').css({position:"absolute","z-index":k,cursor:"pointer"});l.$oElement.append(d);l.$oContainer=d;Atoshonetwork.Event.listen("atosho.shop.onClose",function(){l.$oContainer.css({"z-index":k})});d.mouseenter(function(){window.clearTimeout(l.timeoutID);l.displayPreview()}).mouseleave(function(){l.timeoutID=window.setTimeout(function(){l.hidePreview()},20)}).click(function(m){if(typeof m.stopPropagation!=="undefined"){m.stopPropagation();m.preventDefault()}else{if(window.event){window.event.cancelBubble=true}}l.openShop()});var j=c("<div/>",{id:"atoshoImageOverlay","class":"basket-image-small atosho-init-layer atoshonetwork",style:"display:none;",width:"45px"}).css({position:"relative","z-index":k,"float":"left"}).append('<div id="basket-icon" aid="'+g.attr("atosho_id")+'" class="atoshonetwork basket-icon" style="height: 80%;width: 80%;background-color: '+Atoshonetwork.getConfig("Source").customization.storefrontButtonColor+';border-radius: 50%;margin: 10% 0 0 10%;opacity: 1;"/>');j.appendTo(d);var h=c("<div/>",{id:"atoshoImageTextOverlay","class":"image-text-overlay atoshonetwork",style:"display:block;"}).css({height:"45px",position:"relative","z-index":k,"background-color":Atoshonetwork.getConfig("Source").customization.backgroundColor,"float":"left"});if(l.defaultConfiguration.config["horizontal-position"]=="left"){h.css({"margin-left":"1px"}).insertAfter(j)}else{h.css({"margin-right":"1px"}).insertBefore(j)}if(l.$oImage.css("float")=="left"||l.$oImage.css("float")=="right"){f=l.$oImage.height()}h.append('<span class="image-text atoshonetwork atoshoBody"></span>');h.append('<div style="height: 20px;position: absolute;right: 10px;bottom: 0px;"><span id="extraStoreText" style="font-size: 10px;color: #b1b1b1;margin-right: 10px;display: inline-block;height: 12px;">'+Atoshonetwork.getConfig("Source").customization.advertisingText+'</span><div class="text-arrow atoshonetwork" style="background-color: '+Atoshonetwork.getConfig("Source").customization.storefrontButtonColor+';"><span class="atoshoBody">'+Atoshonetwork.getConfig("Source").translations.DETAILS_BUTTON+"</span></div></div>");c(window).resize(function(){l.positionOverlay()});Atoshonetwork.onImageLoaded(function(){l.positionOverlay()});if(Atoshonetwork.Common.isScrolledIntoView(j)){window.setTimeout(function(){j.addClass("orange")},200);l.displayPreview();l.hasExpanded=true;l.timeoutID=window.setTimeout(function(){l.hidePreview()},2500)}e&&e()},positionOverlay:function(){var b=this;var f=Atoshonetwork.$;var e=b.$oImage;var h=e.offset();var d=f("#atoshoImageOverlay",b.$oElement);if(isNaN(b.defaultConfiguration.config["horizontal-position"])){switch(b.defaultConfiguration.config["horizontal-position"]){case"left":var c=h.left;break;case"right":var c=h.left+e.width()-d.width();break}}var a=0;if(f("body").css("position")=="relative"){a=f("body").offset().top}if(isNaN(b.defaultConfiguration.config["vertical-position"])){switch(b.defaultConfiguration.config["vertical-position"]){case"bottom":var g=h.top-a+e.height()-45;break;case"top":var g=h.top-a;break}}f("#atosho-image-container",b.$oElement).css({top:g,left:c})},initPreview:function(c){var a=this;var b=Atoshonetwork.$;Atoshonetwork.Getter.loadArray(this.defaultConfiguration.config.products,"InStockProduct",function(e){if(!e.length){a.$oElement.remove()}else{if(e.length==1){a.bSingleProduct=true;a.iCurrentProductId=e[0].sheet.id}for(var d=0;d<e.length;d++){Atoshonetwork.Editorial.addOnPageProduct(e[d].sheet.id);if(d==0){var f=a.defaultConfiguration.config["button-text"];f=f.replace("%WEBSITENAME%",Atoshonetwork.getConfig("Source").name);f=f.replace("%PRODUCTNAME%",e[d].sheet.name);b("span.image-text",a.$oElement).html(f)}}b("div#atoshoImageOverlay",a.$oElement).css({display:"block"});c&&c()}})},binder:function(){var c=Atoshonetwork.$;var a=this;var b=c("div#atoshoImageOverlay",a.$oElement);this.$oImage.mouseenter(function(){window.clearTimeout(a.timeoutID);a.displayPreview()}).mouseleave(function(){a.timeoutID=window.setTimeout(function(){a.hidePreview()},300)});Atoshonetwork.$(window).scroll(function(){if(Atoshonetwork.Common.isScrolledIntoView(b)){a.positionOverlay();window.setTimeout(function(){b.addClass("orange")},200);if(!a.hasExpanded){a.hasExpanded=true;window.setTimeout(function(){a.displayPreview()},500);a.timeoutID=window.setTimeout(function(){a.hidePreview()},2500)}}else{b.removeClass("orange");a.hasExpanded=false}})},displayPreview:function(){var d=Atoshonetwork.$;var b=this;var c=d("div#atoshoImageOverlay",b.$oElement);var a=d("div#atoshoImageTextOverlay",b.$oElement);if(b.defaultConfiguration.config["horizontal-position"]=="left"){a.animate({width:b.$oImage.width()-c.width()-1},200)}else{a.animate({width:b.$oImage.width()-c.width()-1,"margin-left":-(b.$oImage.width()-c.width()-1)},200)}c.addClass("active");c.css({"background-color":Atoshonetwork.getConfig("Source").customization.backgroundColor})},hidePreview:function(){var b=this;var d=Atoshonetwork.$;var c=d("div#atoshoImageOverlay",b.$oElement);var a=d("div#atoshoImageTextOverlay",b.$oElement);if(this.oShop==null||!this.oShop.isOpen()){if(b.defaultConfiguration.config["horizontal-position"]=="left"){a.animate({width:0},200)}else{a.animate({width:0,"margin-left":0},200)}c.removeClass("active");c.css({"background-color":"transparent"})}},openShop:function(){var b=this;var c=Atoshonetwork.$;var d=b.$oImage.offset().left;Atoshonetwork.Event.fire("atosho.editorial.storefront.onClick",[b.iCurrentProductId,this.defaultConfiguration]);if(this.oShop==null){this.oShop=new Atoshonetwork.Shop(this);this.oShop.onClose(function(){b.hidePreview()})}var a=0;if(c("body").css("position")=="relative"){a=c("body").offset().top}b.$oContainer.css({"z-index":"421"});this.oShop.openOneToOneGrid(b.$oImage.offset().top-a+b.$oImage.height(),d,b.iCurrentProductId,this.defaultConfiguration.id,b.defaultConfiguration.config.products,b.bSingleProduct);this.oShop.removePreviewCover(true,function(){})}});Atoshonetwork.Editorial.ImageDock=function(a,b){Atoshonetwork.SuperClass.call(this);this.defaultConfiguration={config:{"z-index":"10000",mixpanel:0,"horizontal-position":"left","vertical-position":"bottom","button-text":""}};Atoshonetwork.$.extend(true,this.defaultConfiguration,b);this.$oImage=a;if(this.$oImage.attr("atosho_id")==undefined){this.$oImage.attr("atosho_id","img_"+Math.floor(Math.random()*10000000000))}this.$oElement=null;this.$previewItem=null;this.timeoutID=null;this.iCurrentProductId=null;this.hasExpanded=false;this.oShop=null;this.$oThumbnailContainer=null;this.activeTimeout=null;this.$oContainer=null;this.init();this.binder()};Atoshonetwork.Editorial.ImageDock.prototype=Atoshonetwork.$.extend(true,Object.create(Atoshonetwork.SuperClass.prototype),{init:function(){var a=this;var c=Atoshonetwork.$;var b=a.$oImage;$oContainer=c("<atoshonetwork>",{id:b.attr("atosho_id")});if(a.$oImage.css("float")=="right"){$oContainer.css({"float":"right"})}$oContainer.appendTo("body");a.$oElement=$oContainer;a.initImageDock()},destroy:function(){var a=Atoshonetwork.$;this.$oImage.removeAttr("atosho_load");this.$oElement.remove();delete this},initImageDock:function(){var r=this;var h=Atoshonetwork.$;var f=0;var l=0;var m=r.$oImage;var e=0;var q=-1;r.$oImage.parents().each(function(){var t=h(this).css("z-index");if(!isNaN(parseFloat(t))&&isFinite(t)&&q<parseInt(t)){q=parseInt(t)}});if(q<0){q=this.defaultConfiguration.config["z-index"]}var k=h('<div id="atosho-image-container" class="atoshoImageDockContainer"></div>').css({position:"absolute","z-index":q,cursor:"pointer",width:r.$oImage.width(),display:"none"});r.$oElement.append(k);r.$oContainer=k;Atoshonetwork.Event.listen("atosho.shop.onClose",function(){r.$oContainer.css({"z-index":q})});var p=h("<div/>",{id:"atoshoImageOverlay","class":"atoshoImageDockIconHolder atosho-init-layer atoshonetwork",style:"display:block;"}).css({position:"relative","z-index":q,"float":"left"}).append('<div class="atoshoImageDockBackground" style="display:none;background-color:'+Atoshonetwork.getConfig("Source").customization.backgroundColor+';"></div><div id="basket-icon" aid="'+m.attr("atosho_id")+'" class="atoshonetwork basket-icon" style="position: absolute;height: 80%;width: 80%;background-color: '+Atoshonetwork.getConfig("Source").customization.storefrontButtonColor+';border-radius: 50%;margin: 10% 0 0 10%;opacity: 1;"/>');p.appendTo(k);var o=h("<div/>",{id:"atoshoImageTextOverlay","class":"atoshoImageDockTextOverlay atoshonetwork",style:"display:block;"}).css({position:"relative","z-index":q,"float":"left"});if(r.defaultConfiguration.config["horizontal-position"]=="left"){o.css({"margin-left":"1px"}).insertAfter(p)}else{o.css({"margin-right":"1px"}).insertBefore(p)}if(r.$oImage.css("float")=="left"||r.$oImage.css("float")=="right"){l=r.$oImage.height()}o.css({height:p.height(),width:r.$oImage.width()-p.width()-1});o.append('<div class="atoshonetwork atoshoImageDockBackground" style="display:none;background-color:'+Atoshonetwork.getConfig("Source").customization.backgroundColor+';"></div>');o.append('<span class="atoshoImageDockText atoshonetwork atoshoBody"></span>');o.append('<div style="height:15px;position: absolute;right: 10px;bottom: 0px;"><span id="extraStoreText" style="font-size: 10px;color: #b1b1b1;margin-right: 10px;display: inline-block;height: 12px;line-height: 1em;">'+Atoshonetwork.getConfig("Source").customization.advertisingText+"</span></div>");r.$oExpandedThumbnailContainer=h('<div style="display:none;" class="atoshoImageDockExpandedThumbnailHolder"></div>');o.append(r.$oExpandedThumbnailContainer);var c=h('<div class="atoshoImageDockThumbnailRow"></div>');r.$oExpandedThumbnailContainer.append(c);var n=r.defaultConfiguration.config.products;var b=n.length;var g=false;var a=0;var d=0;var j=Math.floor(o.width()/48)-2;if(j>0){Atoshonetwork.Getter.loadArray(this.defaultConfiguration.config.products,"InStockProduct",function(t){if(!t.length){r.$oElement.remove()}else{r.resizeOnApproach(h("div.atoshoImageDockThumbnail",r.$oThumbnailContainer),{});var u=r.defaultConfiguration.config["button-text"];u=u.replace("%WEBSITENAME%",Atoshonetwork.getConfig("Source").name);u=u.replace("%PRODUCTNAME%",t[0].sheet.name);h("span.atoshoImageDockText",o).html(u);r.positionOverlay()}},function(w,u,v){if(w=="success"){if(d<j){Atoshonetwork.Editorial.addOnPageProduct(u);d++;var x=h('<div class="atoshoImageDockThumbnail" style="background-image:url('+v.getFirstImageURL(500)+');"></div>');var t=h('<div class="atoshoImageDockToolTip" style="display:none;"><div class="atoshoToolTipTitle">'+v.sheet.name+'</div><div class="atoshoToolTipPrice">'+v.getPrice()+'</div><div class="atoshoToolTipOriginalPrice">'+v.getOriginalPrice()+'</div><div class="atoshoToolTipArrow"></div></div>');x.append(t);c.append(x);var y=null;x.hover(function(){r.iCurrentProductId=u;y=setTimeout(function(){r.openShop(false)},150)},function(){clearTimeout(y)});x.on("click",function(){r.openShop(true)});k.css({display:"block"})}if(a==b-1){r.fire("allProductsLoaded")}a++}})}h(window).resize(function(){r.positionOverlay()});h(document).on("DOMNodeInserted",function(t){r.positionOverlay()});Atoshonetwork.onImageLoaded(function(){r.positionOverlay()});if(Atoshonetwork.Common.isScrolledIntoView(p)){r.displayPreview();r.timeoutID=window.setTimeout(function(){r.hidePreview()},2500)}r.$oImage.on("mouseenter",function(){r.setActive(true)});r.$oImage.on("mouseleave",function(){r.setActive(false)});k.on("mouseenter",function(){r.setActive(true);clearTimeout(r.timeoutID)});k.on("mouseleave",function(){r.setActive(false)});c.on("mouseenter",function(){h("div.atoshoImageDockBackground",p).fadeIn();h("div.atoshoImageDockBackground",r.$oElement).fadeIn()});r.positionOverlay()},positionOverlay:function(){var b=this;var f=Atoshonetwork.$;var e=b.$oImage;var h=e.offset();var d=f("div#atoshoImageOverlay",b.$oElement);var c=0;var g=0;if(isNaN(b.defaultConfiguration.config["horizontal-position"])){switch(b.defaultConfiguration.config["horizontal-position"]){case"left":c=h.left;break;case"right":c=h.left+e.width()-d.width();break}}var a=0;if(f("body").css("position")=="relative"){a=f("body").offset().top}if(isNaN(b.defaultConfiguration.config["vertical-position"])){switch(b.defaultConfiguration.config["vertical-position"]){case"bottom":g=h.top-a+e.height()-d.height();break;case"top":g=h.top-a;break}}f("div#atosho-image-container",b.$oElement).css({top:g,left:c});f("div#atoshoImageTextOverlay",b.$oElement).css({width:b.$oImage.width()-d.width()-1});f("div#atosho-image-container",b.$oElement).css({width:b.$oImage.width()})},binder:function(){var c=Atoshonetwork.$;var a=this;var b=c("div#atoshoImageOverlay",a.$oElement);Atoshonetwork.$(window).scroll(function(){if(Atoshonetwork.Common.isScrolledIntoView(b)){a.positionOverlay();if(!a.hasExpanded){a.hasExpanded=true;window.setTimeout(function(){a.displayPreview()},500);a.timeoutID=window.setTimeout(function(){a.hidePreview()},2500)}}else{b.removeClass("orange");a.hasExpanded=false}})},displayPreview:function(){var f=Atoshonetwork.$;var d=this;var c=f("div.atoshoImageDockExpandedThumbnailHolder",d.$oElement);var a=f("span.atoshoImageDockText",d.$oElement);var b=f("div.atoshoImageDockBackground",d.$oElement);var e=f("div#atoshoImageOverlay",d.$oElement);c.fadeIn();a.fadeOut()},hidePreview:function(){var f=Atoshonetwork.$;var d=this;var c=f("div.atoshoImageDockExpandedThumbnailHolder",d.$oElement);var a=f("span.atoshoImageDockText",d.$oElement);var b=f("div.atoshoImageDockBackground",d.$oElement);var e=f("div#atoshoImageOverlay",d.$oElement);clearTimeout(d.timeoutID);e.addClass("active");if((this.oShop==null||!this.oShop.isOpen())&&b.css("display")!="block"){c.fadeOut();a.fadeIn()}},setActive:function(a){var g=Atoshonetwork.$;var e=this;var d=g("div.atoshoImageDockExpandedThumbnailHolder",e.$oElement);var b=g("span.atoshoImageDockText",e.$oElement);var c=g("div.atoshoImageDockBackground",e.$oElement);var f=g("div#atoshoImageOverlay",e.$oElement);if(a){clearTimeout(e.activeTimeout);d.fadeIn();b.fadeOut()}else{e.activeTimeout=setTimeout(function(){if(e.oShop!=null&&e.oShop.isPreviewOpen()){e.oShop.closeShop()}if(e.oShop==null||(e.oShop!=null&&!e.oShop.isOpen())){d.fadeOut();b.fadeIn();c.fadeOut();g("div.atoshoImageDockBackground",f).fadeOut()}},500)}},openShop:function(c){var b=this;var d=Atoshonetwork.$;var e=b.$oImage.offset().left;if(this.oShop==null){this.oShop=new Atoshonetwork.Shop(this);this.oShop.onClose(function(){b.setActive(false)})}var a=0;if(d("body").css("position")=="relative"){a=d("body").offset().top}this.oShop.openOneToOneGrid(b.$oImage.offset().top-a+b.$oImage.height(),e,b.iCurrentProductId,this.defaultConfiguration.id,b.defaultConfiguration.config.products,true);b.$oContainer.css({"z-index":"421"});if(c){Atoshonetwork.Event.fire("atosho.editorial.storefront.onClick",[b.iCurrentProductId,b.defaultConfiguration]);d.get(Atoshonetwork._arrsConfig.url+"/shop/openimpression/productid/"+b.iCurrentProductId+"/zoneid/"+b.defaultConfiguration.id);this.oShop.removePreviewCover(true,function(){})}},resizeOnApproach:function(m,e){var n=this;var f=Atoshonetwork.$;var d={elementDefault:44,elementClosest:88,triggerDistance:96,setWidthAndHeight:true};if(e){f.extend(d,e)}var a=d.setWidthAndHeight;var b=m;var k=d.elementDefault;var h=d.elementClosest;var c=d.triggerDistance;var l=h-k;var j=l/c;var g=false;f(document).ready(function(){b.each(function(){this.style.width=k+"px";if(a){this.style.height=k+"px"}})});f(document).mousemove(function(q){var p=q.pageX;var o=q.pageY;b.each(function(){var v=f(this).offset();var t=f(this).width();var u=n.distToSqEdge(t,v.left+(t/2),v.top+(t/2),p,o);if(u<c){if(u<0){u=0}g=true;var r=k+(l-(u*j));f(this).css({height:r+"px",width:r+"px","margin-top":(-1*(r-k-4))+"px"});if(r==h){f("div.atoshoImageDockToolTip",f(this)).css({display:"block"})}else{f("div.atoshoImageDockToolTip",f(this)).css({display:"none"})}}else{f("div.atoshoImageDockToolTip",f(this)).css({display:"none"});f(this).css({height:k+"px",width:k+"px","margin-top":"4px"})}})})},distToSqEdge:function(f,b,h,d,c){var e=Math.sqrt((b-d)*(b-d)+(h-c)*(h-c));vx=d-b;vy=c-h;var a=0;var g=0;if(vx>vy){if(vx>-vy){a=1}else{g=1}}else{if(vx>-vy){g=-1}else{a=-1}}vlength=Math.sqrt((vx*vx)+(vy*vy));vux=vx/vlength;vuy=vy/vlength;cosA=vux*a+vuy*g;centreToSqEdge=Math.abs((0.5*f)/cosA);mouseToSquareEdge=vlength-centreToSqEdge;return mouseToSquareEdge}});Atoshonetwork.Editorial.Text=function(b,a){Atoshonetwork.SuperClass.call(this);this.defaultConfiguration={config:{"z-index":"10000",mixpanel:0}};Atoshonetwork.$.extend(true,this.defaultConfiguration,a);this.$oSelector=b;this.iCurrentProductId=null;this.$oElement=null;this.timeoutID=null;this.atoshoId=Math.floor(Math.random()*10000000000);this.$oPreview=null;this.$previewContainer=null;if(this.textLinkId==null){this.textLinkId=0}this.textLinkId++;this.oShop=null;this.wrapText();this.initPreview()};Atoshonetwork.Editorial.Text.prototype=Atoshonetwork.$.extend(true,Object.create(Atoshonetwork.SuperClass.prototype),{wrapText:function(){var h=this;var g=Atoshonetwork.$;var m=this.defaultConfiguration.selector.split("|");var d="(\\b"+m[1]+"\\b)";var e=m[0]||"body";var n=m[1]||"";var k=m[2]||1;var j=h.$oSelector;var b=0;var l=new RegExp("(\\b"+n+"\\b)","g");if(j.children().length==0){s=j.html().replace(l,function(o){b++;return(b==k)?'<atosho atosho_id="'+h.atoshoId+'" id="'+h.atoshoId+'" type="text" style="color:'+Atoshonetwork.getConfig("Source").customization.storefrontButtonColor+"; background-color:"+Atoshonetwork.getConfig("Source").customization.textlinkInactiveBackgroundColor+';" id="'+h.textLinkId+'">'+o+"</atosho>":o});j.html(s)}else{j.find(":not(iframe):not(atoshosearchable)").addBack().contents().filter(function(){return this.nodeType==3}).wrap("<atoshoSearchable></atoshoSearchable>");g("atoshoSearchable").each(function(){g(this).html(g(this).html().replace(new RegExp(d,"g"),'<atoshotemp type="text" id="'+h.textLinkId+'">'+m[1]+"</atoshotemp>"))});g("atoshoSearchable").replaceWith(function(){return this.innerHTML});var c=g('atoshotemp[type="text"]',h.$oElement);var a=0;var k=m[2];c.each(function(){a++;if(a==k){g(this).wrap('<atosho atosho_id="'+h.atoshoId+'" id="'+h.atoshoId+'" type="text" style="color:'+Atoshonetwork.getConfig("Source").customization.storefrontButtonColor+"; background-color:"+Atoshonetwork.getConfig("Source").customization.textlinkInactiveBackgroundColor+';" id="'+h.textLinkId+'">')}});c.replaceWith(function(){return this.innerHTML})}var f=g('atosho[type="text"]',h.$oSelector);f.each(function(){if(g(this).find(":has(span)").length==0){g(this).prepend('<span class="Atoshonetwork AtoshoTextSpan" id="'+h.atoshoId+'" style="display:inline-block; height:'+(g(this).height()-4)+"px; width:"+(g(this).height()+3)+'px;"><span class="atoshonetwork basket-icon" style="height:'+(g(this).height()-4)+"px; width:"+(g(this).height()-4)+"px;background-color: "+Atoshonetwork.getConfig("Source").customization.storefrontButtonColor+';border-radius: 50%;margin: 10% 0 0 10%;opacity: 1;display: block;background-size: 70%;"></span></span>')}});h.$oElement=g('atosho[id="'+h.atoshoId+'"]');h.oShop=new Atoshonetwork.Shop(h);h.binder()},displayPreview:function(k){var f=this;var e=Atoshonetwork.$;var h=k.attr("id");var n=f.$previewContainer;var l=f.$oSelector.width();var m=f.$oSelector.offset().left;var b=n.outerWidth();var j=k.outerWidth();var d=k.offset().left;var g=d+(j/2);var c=e("body").width()-g;var a=k.offset().top+k.height();if(g>(b/2)&&c>(b/2)){n.css({left:d+(j/2)-(b/2),top:a})}else{if(g>c&&(g+(j/2))>b){n.css({left:d+j-b,top:a})}else{if(c>g&&(c+(j/2))>b){n.css({left:d,top:a})}else{n.css({left:0,top:a})}}}k.css({"background-color":Atoshonetwork.getConfig("Source").customization.backgroundColor});k.addClass("active");k.css({"background-color":"#a8a9b8"});n.animate({height:e("div.preview-column",n).height()},100)},hidePreview:function(){var a=this;var c=Atoshonetwork.$;var b=a.$previewContainer;if(!c("div.atosho-shop-container[atosho_id="+a.atoshoId+"]").length>0){c('atosho[atosho_id="'+a.atoshoId+'"]').removeClass("active");c('atosho[atosho_id="'+a.atoshoId+'"]').css({"background-color":Atoshonetwork.getConfig("Source").customization.textlinkInactiveBackgroundColor});b.animate({height:".1px"},50)}},openShop:function(){var a=this;var c=Atoshonetwork.$;var b=a.$previewContainer;var e;var d=a.$oSelector.parent().offset().left;if(Atoshonetwork._arrsConfig.shopContainerSelector!=null&&Atoshonetwork._arrsConfig.shopContainerSelector!=""){d=c(Atoshonetwork._arrsConfig.shopContainerSelector).offset().left}Atoshonetwork.Event.fire("atosho.editorial.storefront.onClick",[a.iCurrentProductId,this.defaultConfiguration]);a.oShop.openShop(a.$previewContainer.offset().top,d,a.iCurrentProductId,this.defaultConfiguration.id,b)},binder:function(){var b=Atoshonetwork.$;var a=this;var c=a.$oSelector;c.on("mouseenter",'atosho[atosho_id="'+a.atoshoId+'"]',function(){$calledOpen=Atoshonetwork.$(this);a.$calledOpen=$calledOpen;window.clearTimeout(a.timeoutID);a.timeoutID=window.setTimeout(function(){a.displayPreview($calledOpen)},300)});c.on("mouseleave",'atosho[atosho_id="'+a.atoshoId+'"]',function(){window.clearTimeout(a.timeoutID);a.timeoutID=window.setTimeout(function(){a.hidePreview()},20)})},initPreview:function(){var b=this;var f=Atoshonetwork.$;var h=b.atoshoId;var e=f("<div/>",{id:"previewContainer","class":"atosho-preview-container atoshonetwork",atosho_id:h}).css({"max-width":"10000px",height:".1px","z-index":this.defaultConfiguration.config["z-index"],"background-color":Atoshonetwork.getConfig("Source").customization.backgroundColors}).appendTo("body");b.$previewContainer=e;e.mouseleave(function(){b.timeoutID=window.setTimeout(function(){b.hidePreview()},20)});e.mouseenter(function(){window.clearTimeout(b.timeoutID)});var d=Atoshonetwork.Common.createPreviewItem();var g=this.defaultConfiguration.config.products;var a=g.length;for(var c=0;c<a;c++){Atoshonetwork.Getter.Product(g[c],function(o,j,n){if(o=="success"&&n.stock.stockcount!=0){Atoshonetwork.Editorial.addOnPageProduct(j);var k=".jpg";var m=d.clone().appendTo(e);if(b.iCurrentProductId==null){b.iCurrentProductId=j}var p=Atoshonetwork.Common.getFirstElement(n.sheet.images);if(p.type!=null&&p.type!=""){k="."+p.type}m.mouseenter(function(q){if(typeof q.preventDefault!=="undefined"){q.preventDefault()}f("div.new-preview-arrow.atoshonetwork",this).animate({"margin-left":"2px"},100);f("div.new-preview-arrow.atoshonetwork span",this).animate({width:"52px"},100);f("div.new-preview-arrow.atoshonetwork span",this).html(Atoshonetwork.getConfig("Source").translations.DETAILS_BUTTON)}).mouseleave(function(q){if(typeof q.preventDefault!=="undefined"){q.preventDefault()}f("div.new-preview-arrow.atoshonetwork",this).animate({"margin-left":"29px"},100);f("div.new-preview-arrow.atoshonetwork span",this).animate({width:"0px"},100);f("div.new-preview-arrow.atoshonetwork span",this).html("")}).click(function(q){if(typeof q.preventDefault!=="undefined"){q.preventDefault()}f("div.preview-column",f(this).parent()).css("background-color",Atoshonetwork.getConfig("Source").customization.backgroundColor);f(this).css("background-color","#a8a9b8");b.iCurrentProductId=j;b.openShop()});f("div.preview-center-image",m).css("background-image","url("+p.url+"500x500_trim"+k+")");f("p.productTitle",m).html(n.sheet.name);m.attr("id",n.sheet.id);f("div.preview-price",m).html(n.getPrice());f("div.preview-text",m).dotdotdot({});f("div.preview-price",m).html(n.getPrice());f("div.preview-originalPrice",m).html(n.getOriginalPrice());var l=n.getSavedPercentage();if(l>=7){f("div.atosho-discount-badge",m).css({display:"block"});f("div.atosho-discount-badge",m).text("-"+l+"%")}else{f("div.atosho-discount-badge",m).css({display:"none"})}}})}},previewPrice:function(c,b){var a=this;var f=Atoshonetwork.$;var e;switch(c){case"success":var d=Atoshonetwork.getConfig("Source").currency.format;e=(Atoshonetwork.getConfig("Currency").rates[b.currency.id]*b.price.current).formatMoney(d.substr(5,1),d.substr(1,1));f("div#prod_"+b.product_id,a.$oSelector).html(Atoshonetwork.getConfig("Currency").iso+" "+e);break;case"error":break;case"complete":break;case"beforesend":break}},destroy:function(){var b=Atoshonetwork.$;var a=this;b('atosho[atosho_id="'+a.atoshoId+'"]').replaceWith(function(){return this.innerHTML});b('.Atoshonetwork.AtoshoTextSpan[id="'+a.atoshoId+'"]').remove();b('.atosho-preview-container.atoshonetwork[atosho_id="'+a.atoshoId+'"]').remove();delete this}});if(!Atoshonetwork.Editorial.Hub){Atoshonetwork.Editorial.Hub={}}Atoshonetwork.Editorial.Hub.Mosaic=function(b,a){Atoshonetwork.Editorial.DOMStorefront.call(this,b,a);var c=this;this.defaultConfiguration={config:{"z-index":"10000",mixpanel:0,container:{padding:2},cell:{margin:1,width:70,height:70},formats:{small:{"max-items":2,col:6,row:2},medium:{"max-items":5,col:6,row:3},large:{"max-items":8,col:8,row:3},"x-large":{"max-items":11,col:9,row:3}}}};this.formatBehavior=[[],[[3,0,2,2]],[[3,0,2,2],[2,0,1,1]],[[3,0,3,3],[2,0,1,1],[1,2,1,1]],[[3,0,3,3],[2,0,1,1],[1,2,1,1],[1,0,1,1]],[[3,0,3,3],[0,2,1,1],[2,2,1,1],[1,0,1,1],[2,0,1,1]],[[2,0,1,1],[0,2,1,1],[1,2,1,1],[2,2,1,1],[3,0,3,3],[6,0,2,2]],[[1,0,1,1],[2,0,1,1],[0,2,1,1],[1,2,1,1],[2,2,1,1],[5,0,3,3],[3,0,2,2]],[[1,0,1,1],[2,0,1,1],[0,2,1,1],[1,2,1,1],[2,2,1,1],[5,0,3,3],[3,0,2,2],[3,2,1,1]],[[1,0,1,1],[2,0,1,1],[0,2,1,1],[1,2,1,1],[3,0,3,3],[6,0,2,2],[8,0,1,1],[6,2,1,1],[7,2,1,1]],[[1,0,1,1],[2,0,1,1],[0,2,1,1],[1,2,1,1],[2,2,1,1],[3,0,3,3],[6,0,2,2],[8,0,1,1],[8,1,1,1],[7,2,1,1]],[[1,0,1,1],[2,0,1,1],[0,2,1,1],[1,2,1,1],[2,2,1,1],[5,0,3,3],[3,0,2,2],[8,0,1,1],[8,1,1,1],[3,2,1,1],[8,2,1,1]]];this.formatSpecialBehavior=[[],[[0,0,1,1,"icon"],[5,1,1,1,"show_all"],[0,1,3,1,"title"]],[[0,0,1,1,"icon"],[5,1,1,1,"show_all"],[0,1,3,1,"title"]],[[0,0,1,1,"icon"],[2,2,1,1,"show_all"],[0,1,3,1,"title"]],[[0,0,1,1,"icon"],[2,2,1,1,"show_all"],[0,1,3,1,"title"]],[[0,0,1,1,"icon"],[1,2,1,1,"show_all"],[0,1,3,1,"title"]],[[0,0,1,1,"icon"],[7,2,1,1,"show_all"],[0,1,3,1,"title"]],[[0,0,1,1,"icon"],[4,2,1,1,"show_all"],[0,1,3,1,"title"]],[[0,0,1,1,"icon"],[4,2,1,1,"show_all"],[0,1,3,1,"title"]],[[0,0,1,1,"icon"],[2,2,1,1,"show_all"],[0,1,3,1,"title"]],[[0,0,1,1,"icon"],[6,2,1,1,"show_all"],[0,1,3,1,"title"]],[[0,0,1,1,"icon"],[4,2,1,1,"show_all"],[0,1,3,1,"title"]]];this.oSelectedFormat=null;this.oMainHubData=a;this.iHubId=a.hubid;this.oHub=null;this.oShop=null;this.iParentWidth=b.parent().width();this.arroProducts=[];this.arriProduct=[];this.arroCollections=[];this.buttonText="";Atoshonetwork.Getter.Hub(this.iHubId,function(e,d,f){if(e=="success"){Atoshonetwork.loadTranslation(function(){c.oHub=f;var g=Atoshonetwork.$.map(c.oHub.collections,function(j,h){return[j]});Atoshonetwork.Getter.loadArray(g,"Collection",function(j,h){if(j.length){c.init()}},function(k,j,h){if(k=="success"){c.arroCollections.push(h);c.arriProduct=Atoshonetwork.Common.shuffleArray(c.arriProduct.concat(h.products))}})})}})};Atoshonetwork.Editorial.Hub.Mosaic.onAllProductLoaded=function(a){Atoshonetwork.Event.listen("atosho.editorial.hub.onAllProductLoaded",a)};Atoshonetwork.Editorial.Hub.Mosaic.prototype=Atoshonetwork.$.extend(true,Object.create(Atoshonetwork.Editorial.DOMStorefront.prototype),{init:function(){var l=this;var e=Atoshonetwork.$;var g=l.$oPlaceHolder;l.$oElement=e("<atoshonetwork>",{id:g.attr("atosho_id"),"class":"atoshonetwork",style:"display: inline-block;"}).css({position:"relative",padding:this.defaultConfiguration.config.container.padding+"px","margin-top":"5px","margin-bottom":"5px"}).css(l.oCSS);l.$oElement.insertAfter(g);var f=this.defaultConfiguration.config.formats;var d=this.defaultConfiguration.config.cell;var b={};var c=0;for(var k in f){if(f.hasOwnProperty(k)){var a=f[k];if(this.iParentWidth>(a.col*d.width+this.defaultConfiguration.config.container.padding*2)){b[a["max-items"]]=a;if(a["max-items"]>c){c=a["max-items"]}}}}var h=null;this.loadProducts(c,function(m){for(var n in b){if(b.hasOwnProperty(n)){if(parseInt(n)==m){h=b[n];break}else{if(parseInt(n)>m&&(h==null||h["max-items"]>b[n]["max-items"])){h=b[n]}}}}l.initGrid(h,m)});l.$oElement.on("mouseleave",function(){window.setTimeout(function(){if(l.oShop!=null&&l.oShop.isPreviewOpen()){l.oShop.closeShop()}},200)});var j=0;if(l.$oElement.css("zIndex")){j=l.$oElement.css("zIndex")}Atoshonetwork.Event.listen("atosho.shop.onClose",function(){l.$oElement.css({"z-index":j})})},loadProducts:function(c,b){var a=this;Atoshonetwork.Getter.loadArray(a.arriProduct.slice(0,c),"InStockProduct",function(d){a.arroProducts=d;if(a.arroProducts.length<c&&a.arriProduct.length>c){Atoshonetwork.Getter.loadArray(a.arriProduct.slice(c,c+3),"InStockProduct",function(e){a.arroProducts=a.arroProducts.concat(e).slice(0,c);Atoshonetwork.Event.fire("atosho.editorial.hub.onAllProductLoaded",[a.arroProducts.length]);b&&b(a.arroProducts.length)})}else{Atoshonetwork.Event.fire("atosho.editorial.hub.onAllProductLoaded",[a.arroProducts.length]);b&&b(a.arroProducts.length)}})},initGrid:function(k,j){var f=Atoshonetwork.$;var n=this;var e=this.defaultConfiguration.config.cell;var g=(((e.height-(2*e.margin))/2));var b=k.col*e.width;var a=k.row*e.height;this.$oElement.css({"background-color":"rgb(168, 169, 184)","border-color":"rgb(168, 169, 184)",cursor:"pointer"}).width(b).height(a);var c=this.formatBehavior[j];for(i=0;i<c.length;i++){this.addToGrid(c[i][0],c[i][1],c[i][2],c[i][3],this.generateProductIcon(this.arroProducts[i],c[i][2]*c[i][3]))}var h=this.formatSpecialBehavior[j];for(i=0;i<h.length;i++){switch(h[i][4]){case"icon":var m=f("<div/>").css({width:"100%",height:"100%","background-color":Atoshonetwork.getConfig("Source").customization.backgroundColor,overflow:"auto"}).append('<div id="basket-icon" class="atoshonetwork basket-icon" style="height: 70%;width: 70%;background-color: '+Atoshonetwork.getConfig("Source").customization.storefrontButtonColor+';border-radius: 50%;margin: 15%;opacity: 1;"/>');break;case"show_all":var m=f("<div/>").css({height:(g*2)+"px","text-align":"center",width:"100%","font-weight":"bold","font-style":"normal","font-size":"10px",color:"#fff","line-height":g+"px","background-color":Atoshonetwork.getConfig("Source").customization.backgroundColor,"float":"left"}).append('<div style="font-size: 10px;padding-left: 12px;display: table-cell;vertical-align: middle;">'+Atoshonetwork.oTranslation.get("editorial_shop","SHOW_ALL")+"</div>");var l=f("<div>").css({width:"100%",height:g+"px","vertical-align":"bottom",position:"absolute",bottom:"0px","line-height":g+"px","text-align":"center","font-weight":"bold",color:"#252525","font-size":"10px"}).addClass("atoshoTransparentWhiteBack").html(f("<div>").addClass("atosho-hub-image-arrow-white").css({display:"inline-block","margin-top":(g/2-3)+"px"}));m.append(l);break;case"title":n.buttonText=this.oHub.alias;n.buttonText=n.buttonText.replace("%COLLECTION_0%",n.arroCollections[0].alias);var d=Atoshonetwork.Common.shuffleArray(n.arroCollections);n.buttonText=n.buttonText.replace("%COLLECTION_X%",d[0].alias);var m=f("<div/>").css({height:"100%",display:"table","text-align":"left",width:"100%","font-style":"normal","font-size":"14px",color:"#fff","background-color":Atoshonetwork.getConfig("Source").customization.backgroundColor,"float":"left"}).append('<div style="padding: 0px 12px;display: table-cell;vertical-align: middle;line-height: 1em;">'+n.buttonText+"</div>");m.append('<span id="extraStoreText" style="font-size: 10px;color: #b1b1b1;margin-right: 5px;display: inline-block;height: 12px;position: absolute;right: 0;bottom: 0;">'+Atoshonetwork.getConfig("Source").customization.advertisingText+"</span>");break;default:var m=f("<div/>").css({"background-color":Atoshonetwork.getConfig("Source").customization.backgroundColor}).append(h[i][4]);break}m.click(function(){n.openShop()});this.addToGrid(h[i][0],h[i][1],h[i][2],h[i][3],m)}},openShop:function(a){var b=this;var c=Atoshonetwork.$;var d=b.$oPlaceHolder.offset().left;if(Atoshonetwork._arrsConfig.shopContainerSelector!=null&&Atoshonetwork._arrsConfig.shopContainerSelector!=""){d=c(Atoshonetwork._arrsConfig.shopContainerSelector).offset().left}Atoshonetwork.Event.fire("atosho.editorial.hub.mosaic.storefront.onClick");Atoshonetwork.Event.fire("atosho.editorial.storefront.onClick",[a,{type:"Editorial.Mosaic",id:b.oMainHubData.zone.id,name:b.oMainHubData.zone.name,config:{"button-text":b.oHub.alias}}]);if(this.oShop==null){this.oShop=new Atoshonetwork.Shop(b)}b.$oElement.css({"z-index":"421"});this.oShop.openPreviewHub(b.$oElement.offset().top+b.$oElement.outerHeight(),d,b.iHubId,a,b.oMainHubData.zone.id,true);this.oShop.removePreviewCover(true)},generateProductIcon:function(k,t){var j=this;var d=Atoshonetwork.$;var f=500;switch(t){case 1:f=80;break;case 4:f=120;break;default:f=500;break}var h=this.getFirstImage(k,f);var o=d("<div>").css({"background-color":"white","background-size":"contain","background-position":"center","background-repeat":"no-repeat","background-image":"url('"+h+"')",height:"100%",width:"100%"});var q=this.defaultConfiguration.config.cell;var m=k.getPrice();var n=(((q.height-(2*q.margin))/2));var l=d("<div>").css({width:"100%",height:"68px","vertical-align":"bottom",position:"absolute",bottom:"-29px","text-align":"center","font-weight":"bold",color:"#252525","font-size":"10px"}).addClass("atoshoTransparentWhiteBack");var g=d("<div>").css({height:"31px","padding-top":"8px","font-size":"10px"});var a=d("<div>").css({"line-height":"12px","font-size":"10px",color:"#252525"}).html(m);g.append(a);var b=k.getSavedPercentage();if(b>8){var r=Atoshonetwork.oTranslation.get("editorial_shop","SAVE",{discount:b+"%"});var c=Atoshonetwork.getConfig("Currency");if(c.id==6){r=Atoshonetwork.oTranslation.get("editorial_shop","SAVE",{discount:k.getSavedAmount()})}var e=d("<div>").css({"line-height":"12px","font-size":"10px",color:"#ca4747"}).html(r);g.append(e)}l.append(g);var p=d("<div>").css({"line-height":"28px","margin-right":"5px","margin-left":"5px","border-top":"1px solid rgb(168, 169, 184)","font-size":"10px",color:"#252525"}).html(Atoshonetwork.getConfig("Source").translations.DETAILS_BUTTON).append(d("<div>").addClass("atosho-hub-image-arrow-grey").css({display:"inline-block","margin-left":"5px"}));l.append(p);o.append(l);o.bind("click",function(){j.openShop(k.sheet.id)}).bind("mouseenter",function(){l.animate({bottom:"0px"},100)}).bind("mouseleave",function(){l.animate({bottom:"-29px"},100)});o.hover(function(){d.data(this,"timer",setTimeout(function(){var u=j.$oPlaceHolder.offset().left;if(Atoshonetwork._arrsConfig.shopContainerSelector!=null&&Atoshonetwork._arrsConfig.shopContainerSelector!=""){u=d(Atoshonetwork._arrsConfig.shopContainerSelector).offset().left}if(j.oShop==null){j.oShop=new Atoshonetwork.Shop(j)}j.oShop.openPreviewHub(j.$oElement.offset().top+j.$oElement.outerHeight(),u,j.iHubId,k.sheet.id,j.oMainHubData.zone.id,true)},250))},function(){clearTimeout(d.data(this,"timer"))});return o},addToGrid:function(c,f,a,g,b){var d=this.defaultConfiguration.config.cell;var e=Atoshonetwork.$;var h=e("<div>",{id:"atosho-grid-cell"}).css({margin:d.margin+"px",overflow:"hidden",position:"absolute","line-height":"1em",left:this.defaultConfiguration.config.container.padding+d.width*c,top:this.defaultConfiguration.config.container.padding+d.height*f,width:d.width*a-(2*d.margin),height:d.height*g-(2*d.margin)}).html(b).appendTo(this.$oElement)},getFirstImage:function(a,b){for(sIndex in a.sheet.images){if((a.sheet.images[sIndex].url!==null&&a.sheet.images[sIndex].url!=="")||(a.sheet.images[sIndex].type!==null&&a.sheet.images[sIndex].type!=="")){return a.sheet.images[sIndex].url+b+"x"+b+"_trim."+a.sheet.images[sIndex].type}}}});if(!Atoshonetwork.Editorial.Hub){Atoshonetwork.Editorial.Hub={}}Atoshonetwork.Editorial.Hub.Image=function(b,a){var c=this;this.defaultConfiguration={config:{"z-index":"10000",mixpanel:0,"horizontal-position":"left","vertical-position":"bottom","button-text":""}};this.$oImage=b;if(this.$oImage.attr("atosho_id")==undefined){this.$oImage.attr("atosho_id","hub_img_"+Math.floor(Math.random()*10000000000))}this.oMainHubData=a;this.iHubId=a.hubid;this.oHubData=null;this.oShop=null;this.$oElement=null;this.$oIcon=null;this.$oTextOverlay=null;this.$previewItem=null;this.timeoutID=null;this.$oPreview=null;this.hasExpanded=false;Atoshonetwork.Getter.Hub(this.iHubId,function(e,d,f){if(e=="success"){c.oHubData=f;c.init()}})};Atoshonetwork.Editorial.Hub.Image.prototype={init:function(){var a=this;var d=Atoshonetwork.$;var c=a.$oImage;var b=d("<atoshonetwork>",{id:c.attr("atosho_id")});if(a.$oImage.css("float")=="right"){b.css({"float":"right"})}b.appendTo("body");this.$oElement=b;a.initImageButton();d(window).trigger("resize")},unload:function(){var a=Atoshonetwork.$;this.$oImage.removeAttr("atosho_id");this.$oImage.removeAttr("atosho_sf");this.$oImage.removeAttr("atosho_load");this.$oElement.remove()},initImageButton:function(){var j=this;var c=Atoshonetwork.$;var b=0;var d=0;var e=j.$oImage;var a=0;var h=-1;j.$oImage.parents().each(function(){var k=c(this).css("z-index");if(!isNaN(parseFloat(k))&&isFinite(k)&&h<parseInt(k)){h=parseInt(k)}});if(h<0){h=this.defaultConfiguration.config["z-index"]}var g=c("<div/>",{id:"atoshoImageOverlay","class":"basket-image-small atosho-init-layer atoshonetwork",style:"display:block;"}).css({position:"absolute","z-index":h}).append('<div id="basket-icon" class="atoshonetwork basket-icon" style="height: 80%;width: 80%;background-color: '+Atoshonetwork.getConfig("Source").customization.storefrontButtonColor+';border-radius: 50%;margin: 10% 0 0 10%;opacity: 1;"/>');g.appendTo(j.$oElement);j.$oIcon=g;Atoshonetwork.Event.listen("atosho.shop.onClose",function(){j.$oIcon.css({"z-index":h})});this.$oImage.mouseenter(function(){window.clearTimeout(j.timeoutID);j.displayPreview()});this.$oImage.mouseleave(function(){j.timeoutID=window.setTimeout(function(){j.hidePreview()},300)});var f=c("<div/>",{id:"atoshoImageTextOverlay","class":"image-text-overlay atoshonetwork",style:"display:block;"}).css({position:"absolute","z-index":h,"background-color":Atoshonetwork.getConfig("Source").customization.backgroundColor}).insertAfter(g);j.$oTextOverlay=f;Atoshonetwork.Event.listen("atosho.shop.onClose",function(){j.$oTextOverlay.css({"z-index":h})});if(j.$oImage.css("float")=="left"||j.$oImage.css("float")=="right"){d=j.$oImage.height()}f.css({height:g.height()});f.on("mouseenter",function(){window.clearTimeout(j.timeoutID);j.openShop(false)});g.on("mouseenter",function(){window.clearTimeout(j.timeoutID);j.openShop(false)});f.on("mouseleave",function(){j.timeoutID=window.setTimeout(function(){if(j.oShop!=null&&j.oShop.isPreviewOpen()){j.oShop.closeShop()}},200)});g.on("mouseleave",function(){j.timeoutID=window.setTimeout(function(){if(j.oShop!=null&&j.oShop.isPreviewOpen()){j.oShop.closeShop()}},200)});f.append('<span class="image-text atoshonetwork">'+j.oHubData.alias+"</span>");f.append('<div style="position: absolute;right: 10px;bottom: 0px;"><span id="extraStoreText" style="font-size: 10px;color: #b1b1b1;margin-right: 10px;display: inline-block;height: 12px;">'+Atoshonetwork.getConfig("Source").customization.advertisingText+'</span><div class="text-arrow atoshonetwork" style="background-color: '+Atoshonetwork.getConfig("Source").customization.storefrontButtonColor+';"><span>'+Atoshonetwork.getConfig("Source").translations.DETAILS_BUTTON+"</span></div></div>");this.$oElement.mouseenter(function(){window.clearTimeout(j.timeoutID);j.displayPreview()}).mouseleave(function(){j.timeoutID=window.setTimeout(function(){j.hidePreview()},150)}).click(function(k){if(typeof k.stopPropagation!=="undefined"){k.stopPropagation();k.preventDefault()}else{if(window.event){window.event.cancelBubble=true}}j.openShop(true)});c(window).resize(function(){j.positionOverlay()});c(window).scroll(function(){j.positionOverlay();if(Atoshonetwork.Common.isScrolledIntoView(g)){window.setTimeout(function(){g.addClass("orange")},200);if(!j.hasExpanded){j.hasExpanded=true;window.setTimeout(function(){j.displayPreview()},500);j.timeoutID=window.setTimeout(function(){j.hidePreview()},2500)}}else{g.removeClass("orange");j.hasExpanded=false}});c(window).trigger("scroll")},destroy:function(){this.unload()},positionOverlay:function(){var c=Atoshonetwork.$;var a=this;var b=c("img[atosho_id="+a.$oElement.attr("id")+"]");if(b.length){var d=b.offset();if(isNaN(a.defaultConfiguration.config["horizontal-position"])){switch(a.defaultConfiguration.config["horizontal-position"]){case"left":iconMarginLeft=b.offset().left;imageTextMarginLeft=1+d.left+a.$oIcon.width();break;case"right":iconMarginLeft=d.left+b.width()-a.$oIcon.width();imageTextMarginLeft=b.offset().left;break}}if(isNaN(a.defaultConfiguration.config["vertical-position"])){switch(a.defaultConfiguration.config["vertical-position"]){case"bottom":iconMarginTop=d.top+b.height()-a.$oIcon.height();break;case"top":iconMarginTop=d.top;break}}a.$oIcon.offset({top:iconMarginTop,left:iconMarginLeft});a.$oTextOverlay.offset({left:imageTextMarginLeft,top:iconMarginTop})}},displayPreview:function(){var d=Atoshonetwork.$;var b=this;var c=d("div#atoshoImageOverlay",b.$oElement);var a=d("div#atoshoImageTextOverlay",b.$oElement);a.animate({width:b.$oImage.width()-c.width()-1},200);c.addClass("active");c.css({"background-color":Atoshonetwork.getConfig("Source").customization.backgroundColor})},hidePreview:function(){var c=this;var e=Atoshonetwork.$;var d=e("div#atoshoImageOverlay",c.$oElement);var a=e("div#atoshoImageTextOverlay",c.$oElement);var b=e("div.atosho-shop-container[atosho_id="+c.$oElement.attr("id")+"]");if(this.oShop==null||!this.oShop.isOpen()){a.animate({width:0},200);d.removeClass("active");d.css({"background-color":"transparent"})}},openShop:function(c){var b=this;var d=Atoshonetwork.$;if(c==null){c=true}var e=b.$oImage.offset().left;if(Atoshonetwork._arrsConfig.shopContainerSelector!=null&&Atoshonetwork._arrsConfig.shopContainerSelector!=""){e=d(Atoshonetwork._arrsConfig.shopContainerSelector).offset().left}Atoshonetwork.Event.fire("atosho.editorial.hub.image.storefront.onClick");if(this.oShop==null){this.oShop=new Atoshonetwork.Shop(this);this.oShop.onClose(function(){b.hidePreview()})}var a=0;if(d("body").css("position")=="relative"){a=d("body").offset().top}b.$oIcon.css({"z-index":"421"});b.$oTextOverlay.css({"z-index":"421"});this.oShop.openPreviewHub(b.$oImage.offset().top-a+b.$oImage.height(),e,b.iHubId,null,b.oMainHubData.zone.id,true);if(c){this.oShop.removePreviewCover(true)}}};Atoshonetwork.Hub.Basket=function(){Atoshonetwork.SuperClass.call(this);var a=Atoshonetwork.$;this.$oContainer=a('<div class="atoshoHubBasketContainer"></div>').css({height:"40px",position:"relative",cursor:"pointer",width:"40px","margin-left":"auto",overflow:"hidden"});this.oBasketData=Atoshonetwork.Cache.get("basketData");this.init()};Atoshonetwork.Hub.Basket.prototype=Atoshonetwork.$.extend(true,Object.create(Atoshonetwork.SuperClass.prototype),{init:function(){var c=this;var f=Atoshonetwork.$;var e=f('<div class="atoshoHubBasketPriceSection"></div>').attr({id:"priceSection"}).css({height:"100%",position:"absolute",left:"40px",right:"0px","text-align":"center",color:"white"});var d=f("<div></div>").css({"line-height":"40px","font-weight":"bold","text-align":"center"});e.append(d);var b=f("<div></div>").attr({id:"iconSection"}).addClass("AtoshoHubBasketImageIcon").css({width:"40px",height:"100%",position:"relative",display:"inline-block","float":"left"});var a='<div class="atoshoHubBasketBadge" id="badge" style="display:none;height: 14px;min-width: 12px;position: absolute;top: 0px;right: 3px;top:3px;z-index: 100;border-radius: 11px;text-align: center;line-height: 1em;padding: 2px 2px 0 2px;font-size: 10px;font-weight: bold;"/>';b.append(a);this.$oContainer.append(b).append(e);this.$oContainer.click(function(){c.fire("onClick")});Atoshonetwork.Event.listen("atosho.shop.basket.onChange",function(){c.oBasketData=Atoshonetwork.Cache.get("basketData");c.populate()});if(this.oBasketData==null){Atoshonetwork.Getter.Json().get(Atoshonetwork._arrsConfig.url+"/neweditorialshop/basket/guid/"+Atoshonetwork._guid,{},function(h,g,j){c.handleBasketData(h,g,j,function(){c.populate()})})}else{c.populate()}},onClick:function(a){this.listen("onClick",a)},populate:function(){var b=Atoshonetwork.$;var a=b("div#priceSection",this.$oContainer);if(this.oBasketData==null||this.oBasketData.totalquantity==0){this.$oContainer.animate({width:"40px"},150);b("div#badge",this.$oContainer).fadeOut()}else{b("div",a).html(this.oBasketData.totalpriceincshippingincvat.formatToCurrency());this.$oContainer.animate({width:"100%"},150);b("div#badge",this.$oContainer).html(this.oBasketData.totalquantity).fadeIn()}},handleBasketData:function(b,a,d,c){switch(b){case"success":this.oBasketData=a;Atoshonetwork.Cache.set("basketData",a);c();break;case"error":Atoshonetwork.Cache.set("basketData",null);c();break;case"complete":break;case"beforesend":break}},render:function(){return this.$oContainer},renderTo:function(a){a.html(this.$oContainer)},destroy:function(){this.$oContainer.remove()}});Atoshonetwork.Editorial.ShoppingAssistant=function(){Atoshonetwork.SuperClass.call(this);this.hasExpanded=false;this.closeDelay=null;this.basketData=null;this.basketModule=null;this.initialOpening=true;this.productCount=0;this.pluginNames=["ProductsOnPage","PopularPages","Lastviewed","Footer"];this.plugins={};this.openState="partial";this.accordian=null;this.preventStop=false;this.$oBasket=null;this.oZone=Atoshonetwork.getZone("Editorial.ShoppingAssistant");this.init();Atoshonetwork.Editorial.ShoppingAssistant._basket=this};Atoshonetwork.Editorial.ShoppingAssistant._basket=null;Atoshonetwork.Editorial.ShoppingAssistant.onMouseEnter=function(a){Atoshonetwork.Event.listen("Atoshonetwork.basketwidget.onMouseEnter",a)};Atoshonetwork.Editorial.ShoppingAssistant.onFirstMouseEnter=function(a){Atoshonetwork.Event.listen("Atoshonetwork.basketwidget.onFirstMouseEnter",a)};Atoshonetwork.Editorial.ShoppingAssistant.onOpenButtonClick=function(a){Atoshonetwork.Event.listen("Atoshonetwork.basketwidget.basketmodule.onOpenButtonClick",a)};Atoshonetwork.Editorial.ShoppingAssistant.prototype=Atoshonetwork.$.extend(true,Object.create(Atoshonetwork.SuperClass.prototype),{init:function(){var a=this;Atoshonetwork.Event.listen("atosho.shop.onOpen",function(){a.slideIn(true,0,true)});Atoshonetwork.Event.listen("atosho.shop.onClose",function(){a.updateWidget();a.slideIn(false,0,false)});Atoshonetwork.Event.listen("atosho.hub.onClose",function(){a.updateWidget();a.slideIn(false,0,false)});Atoshonetwork.Event.listen("Atoshonetwork.AtoshoBasketWidget.Close",function(c,b){a.slideIn(false,b,false)});Atoshonetwork.Event.listen("Atoshonetwork.AtoshoBasketWidget.Trigger.State",function(c,b){switch(b){case"partial":a.slideIn(false,0);break;case"hidden":a.slideIn(true,0);break;case"full":a.slideOutFull();break}});a.onRender(function(){window.setTimeout(function(){if(a.openState=="partial"){a.slideIn(false,0,false)}},2500);if(a.plugins.Lastviewed&&a.plugins.Lastviewed.isVisible()){a.accordian.setSectionDisplay("Lastviewed",2);if(a.plugins.Email&&a.plugins.Email.isVisible()){a.accordian.setSectionDisplay("Email",1)}}else{if(a.plugins.Lastviewed){a.accordian.setSectionDisplay("Lastviewed",0)}if(a.plugins.Email&&a.plugins.Email.isVisible()){a.accordian.setSectionDisplay("Email",2)}}if(!a.plugins.ProductsOnPage||!a.plugins.ProductsOnPage.isVisible()){if(a.plugins.PopularPages&&a.plugins.PopularPages.isVisible()){a.accordian.setSectionDisplay("PopularPages",2)}if(a.plugins.ProductsOnPage){a.accordian.setSectionDisplay("ProductsOnPage",0)}}else{if(a.plugins.ProductsOnPage){a.accordian.setSectionDisplay("ProductsOnPage",2)}}})},handleBasketData:function(c,b,e){var a=this;var d=Atoshonetwork.$;switch(c){case"success":this.basketData=b;Atoshonetwork.Cache.set("basketData",b);d("span#atoshoNumberOfItems",a.$oBasket).html(a.basketData!=null?a.basketData.totalquantity:0);d("span#atoshoTotalPrice",a.$oBasket).html(a.basketData.totalpriceincshippingincvat.formatToCurrency());a.updateCountBadge();break;case"error":Atoshonetwork.Cache.set("basketData",null);a.updateCountBadge();break;case"complete":break;case"beforesend":break}},render:function(){var d=Atoshonetwork.$;var a=this;var e=(0).formatToCurrency();this.$oBasket=d("<div id='AtoshoBasketWidget' class='atoshoBasketWidget' style='text-align: left;line-height:1em;font-family: helvetica;z-index: 4294967295;width: 212px;position: fixed;top: 45px;right: 0px;background-color: #a8a9b8;border: solid 4px #a8a9b8;border-right: solid 0px #a8a9b8;'></div>");var g='<div id="AtoshoBasketHead" style="position:relative;">';g+='<div id="AtoshoProductCountBadge" style="display:none;height: 14px;min-width: 12px;position: absolute;top: 0px;left: 30px;z-index: 100;background-color: #307ac4;border-radius: 11px;border: solid 1px white;color: white;text-align: center;line-height: 1em;padding: 2px 2px 0 2px;font-size: 10px;font-weight: bold;"/>';g+='<div id="AtoshoBasketHeadInfo"  style="overflow: hidden;height: 46px;border-radius: 2px 0px 0px 2px; background-color: '+Atoshonetwork.getConfig("Source").customization.backgroundColor+';"><div class="atosho-buttonimage atoshonetwork" style="border-radius: 2px;position:relative;height: 46px;width: 46px;background-color: '+Atoshonetwork.getConfig("Source").customization.backgroundColor+';"><div id="basket-icon" class="atoshonetwork basket-icon" style="height: 34px;width: 34px;background-color: '+Atoshonetwork.getConfig("Source").customization.storefrontButtonColor+';border-radius: 50%;margin: 10% 0 0 10%;opacity: 1;"/></div>';g+='<div class="atoshoShoppingAssistantLogo"></div>';g+='<div style="width: 100%;color: white;overflow: hidden;text-overflow: ellipsis;font-size: 14px;height: 14px;line-height: 1em;white-space: nowrap;"><span class="atoshoBody" style="float:left;padding-left:12px;font-weight:bold;">'+Atoshonetwork.oTranslation.get("editorial_shop","BASKET")+'</span><span class="atoshoBody" style="float: right;padding-right: 10px;font-weight: normal;"><span id="atoshoNumberOfItems">0</span> '+Atoshonetwork.oTranslation.get("editorial_shop","SA_ITEMS")+"</span></div>";g+='<div style="width: 100%;color: white;overflow: hidden;text-overflow: ellipsis;font-size: 12px;height: 14px;line-height: 1em;white-space: nowrap;padding-top: 8px;font-weight: normal;font-size:12px;"><span style="float:left;padding-left:10px;" class="atoshoBody">'+Atoshonetwork.oTranslation.get("editorial_shop","TOTAL")+':</span><span id="atoshoTotalPrice" style="float:right;padding-right: 10px;" class="atoshoBody">'+e+"</span></div>";g+="<div style='text-align:center;margin:4px;'>";g+="<a id='basketModuleOpen' href='#' class='atoshoBasketWidgetButton atoshoBody' style='color:white;background-color:"+Atoshonetwork.getConfig("Source").customization.storefrontButtonColor+";'>"+Atoshonetwork.oTranslation.get("editorial_shop","SHOW_BASKET");g+="<span class='atoshoBasketOpenButton'></span>";g+="</a>";g+="</div>";g+="</div>";g+="</div>";this.$oBasket.append(g);d("a#basketModuleOpen",this.$oBasket).click(function(){Atoshonetwork.Shop.renderBasketTo();Atoshonetwork.Event.fire("Atoshonetwork.basketwidget.basketmodule.onOpenButtonClick");return false});var c=new Atoshonetwork.Accordian();a.accordian=c;this.$oBasket.append(c.init());for(var b=0;b<a.pluginNames.length;b++){var f=new Atoshonetwork.Editorial.ShoppingAssistant[a.pluginNames[b]](a.oZone);a.plugins[a.pluginNames[b]]=f;if(a.pluginNames[b]=="Footer"){this.$oBasket.append(f.render())}else{c.addSection(a.pluginNames[b],f.getTitle(),f.render(),(a.pluginNames[b]=="ProductsOnPage"?"block":"none"))}}a.slideOutFull();a.$oBasket.mouseenter(function(){if(!a.preventStop){a.slideOut();Atoshonetwork.Event.fire("Atoshonetwork.basketwidget.onMouseEnter");Atoshonetwork.Event.fireOnce("Atoshonetwork.basketwidget.onFirstMouseEnter")}}).mouseleave(function(){if(!a.preventStop){a.slideIn(false,600,false)}});Atoshonetwork.Getter.Json().get(Atoshonetwork._arrsConfig.url+"/neweditorialshop/basket/guid/"+Atoshonetwork._guid,{},function(j,h,k){a.handleBasketData(j,h,k)});a.fire("onRendered",[]);Atoshonetwork.Event.fire("atosho.basketwidget.lastviewedmodule.onRendered",[]);return this.$oBasket},renderTo:function(a){a.html(this.render())},onRender:function(a){this.listen("onRendered",a)},slideOutFull:function(){var c=Atoshonetwork.$;var b=this;var a=c("div#AtoshoBasketHeadInfo",b.$oBasket);if(b.openState!="full"){b.openState="full";b.$oBasket.queue("atoshoQueue",function(d){b.$oBasket.animate({right:"0px"},{duration:300,complete:d})});if(b.basketData!=null&&b.basketData.totalquantity>0){b.$oBasket.queue("atoshoQueue",function(d){a.animate({height:"118px"},{duration:300,complete:d})})}else{b.$oBasket.queue("atoshoQueue",function(d){a.animate({height:"65px"},{duration:300,complete:d})})}if(!b.initialOpening){b.openModules(0)}else{b.openState="partial";b.initialOpening=false}}},openModules:function(e){var f=Atoshonetwork.$;var d=this;if(e<d.pluginNames.length-1){var g=d.plugins[d.pluginNames[e]];var b=f("#"+g.name+"_holder",d.$oBasket);var a=b.css("max-height");if((a=="0px"||b.attr("style").indexOf("block")==-1)&&g.isVisible()){b.css({"max-height":"500px"});b.css({display:"block"});f("div.atoshoModuleContent",b).css({display:"none"});var c=f("div.atoshoModuleContent",b).height();c+=50;b.css({display:"none"});f("div.atoshoModuleContent",b).css({display:"block"});b.css({"max-height":"0px"});d.$oBasket.queue("atoshoQueue",function(h){b.css({display:"block"});b.animate({"max-height":c},200,function(){b.css({"max-height":"500px"});h()})})}e=e+1;d.openModules(e)}else{d.$oBasket.queue("atoshoQueue",function(h){f("div#atoshoOpenHelp",d.$oBasket).css({display:"block"});f("div#atoshoOpenHelp",d.$oBasket).animate({"max-height":"50px"},{duration:200,complete:h})});d.$oBasket.dequeue("atoshoQueue");return}},closeModules:function(d,e){var g=Atoshonetwork.$;var c=this;var b=g("div#AtoshoBasketHeadInfo",c.$oBasket);if(c.pluginNames.length==0){return}if(d==-1){c.$oBasket.queue("atoshoCloseQueue",function(h){g("div#AtoshoBasketHeadInfo",c.$oBasket).animate({height:"44px"},100,function(){c.$oBasket.animate({right:e},200)});h()});c.$oBasket.dequeue("atoshoCloseQueue");return}if(d==-2){c.$oBasket.queue("atoshoCloseQueue",function(h){g("div#atoshoOpenHelp",c.$oBasket).animate({"max-height":"0px"},100,function(){g("div#atoshoOpenHelp",c.$oBasket).css({display:"none"});h()})});d=c.pluginNames.length-2;c.closeModules(d,e)}else{var f=c.pluginNames[d];var a=g("div#"+c.plugins[f].name+"_holder",c.$oBasket);if(c.plugins[f].name=="ProductsOnPage"&&a.height()>60){d=d-1;c.closeModules(d,e);return}c.$oBasket.queue("atoshoCloseQueue",function(h){a.css("max-height",a.css("height"));a.animate({"max-height":"0px"},100,function(){a.css({display:"none"});h()})});d=d-1;c.closeModules(d,e)}},slideIn:function(d,b,e){var f=Atoshonetwork.$;var a=this;var c="-167px";a.closeDelay=window.setTimeout(function(){a.preventStop=e;window.setTimeout(function(){a.preventStop=false},2000);a.$oBasket.stop("atoshoQueue",true,true);a.$oBasket.clearQueue("atoshoQueue");if(d){a.openState="hidden";c="-216px"}else{a.openState="partial"}a.$oBasket.queue("atoshoCloseQueue",function(g){f("div.atoshoIsCollapsible",a.$oBasket).css({overflow:"hidden"});g()});a.closeModules(-2,c)},b)},slideOut:function(){var b=Atoshonetwork.$;var a=this;a.$oBasket.stop("atoshoCloseQueue",true,true);a.$oBasket.clearQueue("atoshoCloseQueue");window.clearTimeout(a.closeDelay);a.slideOutFull()},updateCountBadge:function(){var b=Atoshonetwork.$;var a=this;if(a.basketData!=null&&a.basketData.totalquantity>0){b("div#AtoshoProductCountBadge",a.$oBasket).text(a.basketData.totalquantity).css({display:"block"})}else{b("div#AtoshoProductCountBadge",a.$oBasket).css({display:"none"})}},updateWidget:function(){var e=Atoshonetwork.$;var a=this;a.basketData=Atoshonetwork.Cache.get("basketData");a.updateCountBadge();var f=((a.basketData!=null)?a.basketData.totalpriceincshippingincvat:0);var c=((a.basketData!=null)?a.basketData.totalquantity:0);e("span#atoshoTotalPrice",a.$oBasket).html(f.formatToCurrency());e("span#atoshoNumberOfItems",a.$oBasket).text(c);for(var b=0;b<a.pluginNames.length;b++){var d=a.pluginNames[b];if(a.plugins[d].modified()){a.accordian.updateSection(a.plugins[d].name,a.plugins[d].render())}}Atoshonetwork.Event.fire("atosho.basketwidget.onRendered",[])},destroy:function(){this.$oBasket.remove();delete this}});Atoshonetwork.Editorial.ShoppingAssistant.Basket=function(a){Atoshonetwork.SuperClass.call(this);this.name="basket";this.visible=true;this.basketData=null;this.options={};this.updated=false;this.oZone=a;this.containingElement=null;this.customization=Atoshonetwork.getConfig("Source").customization;this.currency=Atoshonetwork.getConfig("Source").currency;this.init()};Atoshonetwork.Editorial.ShoppingAssistant.Basket.onOpenButtonClick=function(a){Atoshonetwork.Event.listen("Atoshonetwork.basketwidget.basketmodule.onOpenButtonClick",a)};Atoshonetwork.Editorial.ShoppingAssistant.Basket.prototype=Atoshonetwork.$.extend(true,Object.create(Atoshonetwork.SuperClass.prototype),{init:function(){var a=this;a.loadData();Atoshonetwork.Event.listen("atosho.shop.basket.onChange",function(){a.updated=true})},loadData:function(){this.basketData=Atoshonetwork.getData("basketData");this.setVisibility("atosho.learnModule.onSetVisibility",(this.basketData!=null&&this.basketData.totalquantity>0))},render:function(a){var b;this.containingElement=a;if(this.visible){b="<div><div style='max-height:172px;overflow-y:auto;'>";for(merchantId in this.basketData.merchants){for(prodId in this.basketData.merchants[merchantId].products){b+="<div style='height:38px;background-color:"+this.customization.backgroundColor+";border-bottom:1px solid rgb(168, 169, 184);margin:2px 8px 2px 9px;'>";b+="<div style='margin-top:3px;margin-right:8px;height:30px;width:30px;float:left;background:white;background-size:contain;background-position:center;background-repeat:no-repeat;background-image:url("+this.basketData.merchants[merchantId].products[prodId].image+");'></div>";b+="<div style='font-weight:bold;font-style:normal;padding-top:5px;color:white;overflow:hidden;text-overflow:ellipsis;font-size:12px;height:12px;line-height:1em;white-space:nowrap;'>"+this.basketData.merchants[merchantId].products[prodId].name+"</div>";b+="<div style='padding-top:2px;color:white;overflow:hidden;text-overflow:ellipsis;font-size:12px;height:12px;line-height:1em;white-space:nowrap;'>"+this.basketData.currencyiso+" "+this.basketData.merchants[merchantId].products[prodId].totalpriceincvat.formatMoney(this.currency.format.substr(5,1),this.currency.format.substr(1,1))+"</div>";b+="</div>"}}b+="</div><div style='text-align:center;margin:4px;'>";b+="<a id='basketModuleOpen' href='#' class='atoshoBasketWidgetButton' style='color:white;background-color:"+this.customization.storefrontButtonColor+";'>"+Atoshonetwork.oTranslation.get("editorial_shop","SHOW_BASKET");b+="<span class='atoshoBasketOpenButton'></span>";b+="</a>";b+="</div>";b+="</div>"}a.append(b);$("a#basketModuleOpen",a).click(function(){Atoshonetwork.ProductPage.renderBasketTo();Atoshonetwork.Event.fire("Atoshonetwork.basketwidget.basketmodule.onOpenButtonClick");return false});this.bind()},update:function(){if(this.updated){this.basketData=Atoshonetwork.getData("basketData");this.setVisibility("atosho.learnModule.onSetVisibility",(this.basketData!=null&&this.basketData.totalquantity>0));this.containingElement.empty();this.render(this.containingElement)}this.updated=false},isEmpty:function(){for(var a in this.basketData){if(this.basketData.hasOwnProperty(a)){return false}}return true},productCount:function(){var a=0;if(this.basketData!=null&&!this.isEmpty()){for(merchantId in this.basketData.merchants){for(prodId in this.basketData.merchants[merchantId].products){a++}}}return a},setVisibility:function(b,a){this.visible=a;Atoshonetwork.fireEvent(b,[!a])},onSetVisibility:function(a){Atoshonetwork.Event.listen("atosho.basketModule.onSetVisibility",a)},onRendered:function(a){this.listen("onRendered",a)},modified:function(){return this.updated},isVisible:function(){return this.visible}});Atoshonetwork.Editorial.ShoppingAssistant.Footer=function(){Atoshonetwork.SuperClass.call(this);this.name="Footer";this.visible=true;this.options={};this.customization=Atoshonetwork.getConfig("Source").customization;this.currency=Atoshonetwork.getConfig("Source").currency;this.$footer=null};Atoshonetwork.Editorial.ShoppingAssistant.Footer.prototype=Atoshonetwork.$.extend(true,Object.create(Atoshonetwork.SuperClass.prototype),{render:function(){var a=Atoshonetwork.$;var b="";if(this.visible){b="<div id='atoshoOpenHelp' class='atoshoBasketModuleGradient' style='max-height:500px;overflow:hidden;margin-top: 2px;display:none;height:50px;width:100%;background-color:"+this.customization.backgroundColor+";border-radius: 2px 0px 0px 2px;'>";b+="<div style='height:100%;display: table;text-align: left;width: 167px;font-weight: bold;font-style: normal;font-size: 14px;color: #fff;float: left;'><div class='atoshoHead' style='padding-left: 12px;display: table-cell;vertical-align: middle;'>"+Atoshonetwork.oTranslation.get("editorial_shop","BUY_IN_ARTICLES")+"</div></div>";b+="<div style='width: 45px;float: right;display: table-cell;vertical-align: middle;'><div style='margin-top: 5px;' class='atoshoBasketFooterLogo'></div></div>";b+="</div>"}this.$footer=a(b);return this.$footer},bind:function(){var b=Atoshonetwork.$;var a=this;this.$footer.click(function(){a.openHelpOverlay();Atoshonetwork.Event.fire("Atoshonetwork.basketwidget.learnmodule.onOpenButtonClick");return false})},openHelpOverlay:function(){var a=Atoshonetwork.$;if(a("#atoshoHelp").length<1){var b='<div id="atoshoHelp" style="z-index: 10001;height:0px;display:none;width:172px;background-color: '+Atoshonetwork.getConfig("Source").customization.backgroundColor+';border: solid 4px #a8a9b8;border-right: solid 0px #a8a9b8;position: fixed;right: 0px;">';b+='<div id="AtoshoHelpClose"/>';b+='<div id="AtoshoHelpTitle" style="color: white;padding: 18px;font-size: 18px;">'+Atoshonetwork.oTranslation.get("editorial_shop","YOU_CAN_SHOP",{channelpartnername:Atoshonetwork.getConfig("Source").name})+"</div>";b+='<div id="AtoshoHelpContent" style="height:342px;width:620px;background-color: #efefef;overflow:hidden;margin-left: 16px;">';b+='<div id="HelpPageHolder" style="width:1240px;height:100%;">';b+='<div id="AtoshoHelpPage1" style="height:100%;width:620px;display:inline-block;"><div class="atoshoHelpImage1"></div><div style="width:50%;display:inline-block;vertical-align: top;margin-top: 100px;color: #323232;font-size: 14px;font-weight: bold;">'+Atoshonetwork.oTranslation.get("editorial_shop","HELP_PAGE_1")+"</div></div>";b+='<div id="AtoshoHelpPage2" style="height:100%;width:620px;display:inline-block;"><div class="atoshoHelpImage2"></div><div style="width:50%;display:inline-block;vertical-align: top;margin-top: 100px;color: #323232;font-size: 14px;font-weight: bold;">'+Atoshonetwork.oTranslation.get("editorial_shop","HELP_PAGE_2")+"</div></div>";b+="</div>";b+='<div style="height: 35px;width: 80px;position: absolute;right: 140px;bottom: 50px;"><div class="pagingButton active" value="1">1</div><div class="pagingButton" style="margin-left:5px;" value="2">2</div></div>';b+="</div>";b+='<div id="AtoshoHelpFoot" style="display: block;height: 28px;overflow: hidden;bottom: 0px;position: absolute;width: 100%;">';b+='<div style="height:28px;background-color:#a8a9b8;color:white;"><div class="atoshoLogo" style="display: inline-block;float: right;margin: 4px 4px 0px 4px;"></div><span style="display: inline-block;float: right;padding: 6px 10px 0px 0px;">Powered by</span></div>';b+="</div></div>";b+='<div id="atoshoHelpBorderTran" style="z-index: 99999;height: 4px;border-bottom: white dotted 1px;width: 172px;position: fixed;margin-top: -1px;background: '+Atoshonetwork.getConfig("Source").customization.backgroundColor+';"/>';Atoshonetwork.fireEvent("Atoshonetwork.AtoshoBasketWidget.PreventClose",[]);a("#AtoshoBasketHead").after(b);Atoshonetwork.$("#atoshoHelp").css({display:"block",height:"450px",width:"652px",right:"-652px"});Atoshonetwork.$("#atoshoHelp").animate({right:"0px"},400);Atoshonetwork.$("#atoshoHelp").mouseenter(function(){event.stopPropagation();window.event.cancelBubble=true});Atoshonetwork.$("#atoshoHelp").mouseleave(function(){event.stopPropagation();window.event.cancelBubble=true});a("#AtoshoHelpContent .pagingButton").click(function(){a("#AtoshoHelpContent .pagingButton").removeClass("active");a(this).addClass("active");if(a(this).attr("value")==1){a("#atoshoHelp #HelpPageHolder").animate({"margin-left":"0px"})}else{a("#atoshoHelp #HelpPageHolder").animate({"margin-left":"-652px"})}return false});a("#AtoshoHelpClose").click(function(){Atoshonetwork.$("#atoshoHelp").animate({right:"-652px"},400,function(){Atoshonetwork.$("#atoshoHelp").remove();Atoshonetwork.$("#atoshoHelpBorderTran").remove();Atoshonetwork.fireEvent("Atoshonetwork.AtoshoBasketWidget.EnableClose",[]);Atoshonetwork.fireEvent("Atoshonetwork.AtoshoBasketWidget.Close",[750])})})}},modified:function(){return false},isVisible:function(){return true}});Atoshonetwork.Editorial.ShoppingAssistant.Email=function(){Atoshonetwork.SuperClass.call(this);this.name="Email";this.visible=true;this.options={};this.customization=Atoshonetwork.getConfig("Source").customization;this.currency=Atoshonetwork.getConfig("Source").currency;this.$footer=null};Atoshonetwork.Editorial.ShoppingAssistant.Email.onSubmit=function(a){Atoshonetwork.Event.listen("Atoshonetwork.basketwidget.emailmodule.onSubmit",a)};Atoshonetwork.Editorial.ShoppingAssistant.Email.prototype=Atoshonetwork.$.extend(true,Object.create(Atoshonetwork.SuperClass.prototype),{render:function(){var b="";var a=Atoshonetwork.$;if(this.visible){b="<div id='atoshoEmailModule' style='padding: 0px 12px 10px 12px;font-size: 12px;line-height: 14px;font-family: helvetica;'>";b+="<div>"+Atoshonetwork.oTranslation.get("editorial_shop","EMAIL_MODULE_TEXT")+"</div>";b+="<div id='atoshoEnterEmail' style='height: 27px;background-color: white;border-radius: 2px;margin-top: 10px;'>";b+="<input type='text' id='atosho_email' placeholder='E-mail' name='atosho_email' style='width: 145px;float: left;margin-top: 2px;height: 23px;line-height: 23px;font-size: 12px;margin-left: 5px;border: none;background-color: white;background: white;box-shadow: none;padding: 0px;border-radius: 0px;outline: none;outline-offset: 0px;font-family: helvetica !important;'></input>";b+="<div id='submitAtoshoEmail' style='width: 30px;height: 21px;background-color: "+this.customization.storefrontButtonColor+";border-radius: 2px;float: right;margin: 3px;font-weight: bold;color: white;cursor: pointer;'>";b+="<span style='margin: 4px 5px 2px 6px;display: block;'>OK</span>";b+="</div>";b+="</div>";b+="</div>"}this.$footer=a(b);this.bind();return this.$footer},bind:function(){var b=Atoshonetwork.$;var a=this;b("div#submitAtoshoEmail",a.$footer).click(function(){var c=b("div#atosho_email").val();Atoshonetwork.Event.fire("Atoshonetwork.basketwidget.emailmodule.onSubmit",[c]);b(a.$footer).empty();b(a.$footer).html("<div>"+Atoshonetwork.oTranslation.get("editorial_shop","EMAIL_MODULE_THANKYOU")+"</div>")})},getTitle:function(){return Atoshonetwork.oTranslation.get("editorial_shop","EMAIL_MODULE_TITLE")},modified:function(){return false},onModified:function(a){this.listen("onModified",a)},isVisible:function(){return this.visible}});Atoshonetwork.Editorial.ShoppingAssistant.Lastviewed=function(a){Atoshonetwork.SuperClass.call(this);this.name="Lastviewed";this.visible=true;this.lastviewedids=[];this.options={};this.lastIndex=0;this.oZone=a;this.customization=Atoshonetwork.getConfig("Source").customization;this.currency=Atoshonetwork.getConfig("Source").currency;this.containingElement=null;this.updated=false;this.$lastViewed=null;this.init()};Atoshonetwork.Editorial.ShoppingAssistant.Lastviewed.onProductClick=function(a){Atoshonetwork.Event.listen("Atoshonetwork.basketwidget.lastviewedmodule.onProductClick",a)},Atoshonetwork.Editorial.ShoppingAssistant.Lastviewed.prototype=Atoshonetwork.$.extend(true,Object.create(Atoshonetwork.SuperClass.prototype),{init:function(){var a=this;var b=Atoshonetwork.$;var c="";if((c=Atoshonetwork.Common.getCookie("atoshonetwork_lsp"))!=""){a.lastviewedids=c.split("|");if(a.lastviewedids[0]!=parseInt(a.lastviewedids[0])){a.lastviewedids=[]}}Atoshonetwork.Event.listen("atosho.shop.onLastSeenProductsChanged",function(){if((c=Atoshonetwork.Common.getCookie("atoshonetwork_lsp"))!=""){a.lastviewedids=c.split("|");if(a.lastviewedids[0]!=parseInt(a.lastviewedids[0])){a.lastviewedids=[]}}a.updated=true})},getTitle:function(){return Atoshonetwork.oTranslation.get("editorial_shop","LAST_SEEN")},loadData:function(c){var a=this;var b=a.lastIndex;if(a.lastIndex+c<=a.lastviewedids.length){a.lastIndex=b+c}else{a.lastIndex=a.lastviewedids.length}Atoshonetwork.Getter.loadArray(a.lastviewedids,"InStockProduct",function(){},function(d,e,f){switch(d){case"success":a.renderProduct(e,f);break;case"error":break;case"complete":break;case"beforesend":break}},a.lastIndex)},renderProduct:function(c,e){var d=Atoshonetwork.$;var a=this;var b=e.getFirstImageURL(80);d("#lastseenProd_"+c,a.$lastViewed).removeClass("atoshoLoadingThumbnail");d("#lastseenProd_"+c,a.$lastViewed).css({"background-image":"url("+b+")"});if(parseInt(e.stock.stockcount)==0){d("#lastseenCover_"+c,a.$lastViewed).css({display:"table"})}},render:function(){var f="",c,d;var a=this;var e=Atoshonetwork.$;if(a.visible&&a.lastviewedids.length>0){f+="<div style='margin-bottom:10px;'>";f+="<div class='lastViewedHolder' style='max-height:125px;width:1000px;overflow-y: hidden;'>";f+="<span class='atoshoSlideButton prevButton' style='position:absolute;color:#fff;line-height:124px;left:0;z-index:10000;display:none;'><a href='#' class='atoshoPrev' style='padding:10px 10px;background-color:#a8a9b8;vertical-align:middle;line-height: 124px;'></a></span>";f+="<span class='lastViewedColumn' style='text-align:center;height:100%;float:left;width:900px;margin-left:0;'>";d=a.productCount();var b=0;for(c=0;c<a.lastviewedids.length;c++){if(c==0){f+="<div id='block0' style='max-height: 124px;width:184px;display:inline;position:relative;float:left;margin:0 14px;'>"}if(c==6){f+="</div>";f+="<div id='block1' style='max-height: 124px;width:184px;display:inline;position:relative;float:left;margin-right:14px;'>"}else{if(c>10&&(c+3)%10==0){f+="</div>";f+="<div id='block"+(Math.floor((c+3)/10))+"' style='max-height: 124px;width:184px;display:inline;position:relative;float:left;margin-right:14px;'>"}}if(b<2){if(b==0){f+="<div style='margin-bottom:2px;height:60px;position: relative;'>"}f+="<span id='lastseenProd_"+a.lastviewedids[c]+"' class='atoshoLoadingThumbnail lastSeenProduct' prodId='"+a.lastviewedids[c]+"' style='float:left;display:inline-block;height:60px;width:60px;margin-right:2px;background-color:white;background-size:contain;background-position:center;background-repeat:no-repeat;'></span>";f+='<span id="lastseenCover_'+a.lastviewedids[c]+'" class="lastSeenOutOfStock"><span style="display: table-cell;vertical-align: middle;line-height: 1em;">'+Atoshonetwork.oTranslation.get("editorial_shop","OUT_OF_STOCK")+"</span></span>";b++;if(c==d-1){f+="</div>";b=0}}else{f+="<span id='lastseenProd_"+a.lastviewedids[c]+"' class='atoshoLoadingThumbnail lastSeenProduct' prodId='"+a.lastviewedids[c]+"' style='float:right;display:inline-block;height:60px;width:60px;background-color:white;background-size:contain;background-position:center;background-repeat:no-repeat;'></span>";f+='<span id="lastseenCover_'+a.lastviewedids[c]+'" class="lastSeenOutOfStock" style="right:0px;"><span style="display: table-cell;vertical-align: middle;line-height: 1em;">'+Atoshonetwork.oTranslation.get("editorial_shop","OUT_OF_STOCK")+"</span></span>";f+="</div>";b=0}}f+="</div>";f+="</span>";f+="<span class='atoshoSlideButton nextButton' style='position:absolute;color:#fff;line-height:124px;left:177px;z-index10000;display:none;'><a href='#' class='atoshoNext' style='margin-left:15px;padding:10px 10px;background-color:#a8a9b8;vertical-align:middle;line-height: 124px;'></a></span>";f+="</div>";f+="</div>"}a.$lastViewed=e(f);a.loadData(7);a.bind();a.onRendered(a.displayArrows());Atoshonetwork.Event.fire("Atoshonetwork.LastviewedModule.Visible",(this.lastviewedids.length>0));return a.$lastViewed},productCount:function(){return this.lastviewedids.length},setVisibility:function(b,a){this.visible=a;Atoshonetwork.fireEvent(b,[!a])},onSetVisibility:function(a){Atoshonetwork.Event.listen("Atoshonetwork.lastviewedModule.onSetVisibility",a)},bind:function(){var b=Atoshonetwork.$;var a=this;b("span.atoshoSlideButton.nextButton",a.$lastViewed).click(function(c){b(this).css("z-index",10000);a.loadData(8);var d=parseInt(b("span.lastViewedColumn",a.$lastViewed).css("margin-left"));b("span.lastViewedColumn",a.$lastViewed).animate({"margin-left":d-198},300,"",function(){b("span.atoshoSlideButton.prevButton",a.$lastViewed).show();if(Math.abs(d/198)+1>=b(".lastViewedColumn",a.$lastViewed).children().length-1){b("span.atoshoSlideButton.nextButton",a.$lastViewed).hide()}});c.preventDefault()});b("span.atoshoSlideButton.prevButton",a.$lastViewed).click(function(c){b(this).css("z-index",10000);var d=parseInt(b("span.lastViewedColumn",a.$lastViewed).css("margin-left"));b("span.lastViewedColumn",a.$lastViewed).animate({"margin-left":d+198},300,"",function(){b("span.atoshoSlideButton.nextButton",a.$lastViewed).show();if(Math.abs(d/198)<=1){b("span.atoshoSlideButton.prevButton",a.$lastViewed).hide()}});c.preventDefault()});b("span.lastSeenProduct",a.$lastViewed).click(function(){var c=b(this).attr("prodId");Atoshonetwork.Event.fire("Atoshonetwork.basketwidget.lastviewedmodule.onProductClick",[c]);Atoshonetwork.Shop.renderTo(c,null,a.oZone)})},onRendered:function(a){this.listen("onRendered",a)},displayArrows:function(){var c=Atoshonetwork.$;var a=this;if(c("span.lastViewedColumn",a.$lastViewed).children().length>1){var b=parseInt(c("span.lastViewedColumn",a.$lastViewed).css("margin-left"));if(Math.abs(b/198)<c("span.lastViewedColumn",a.$lastViewed).children().length-1){c("span.atoshoSlideButton.nextButton",a.$lastViewed).show()}if(Math.abs(b/198)>0){c("span.atoshoSlideButton.prevButton",a.$lastViewed).show()}}},modified:function(){var b=Atoshonetwork.$;var a=this;if(a.updated){if((sCookie=Atoshonetwork.Common.getCookie("atoshonetwork_lsp"))!=""){a.lastviewedids=sCookie.split("|");if(a.lastviewedids[0]!=parseInt(a.lastviewedids[0])){a.lastviewedids=[]}}a.lastIndex=0}return a.updated},onModified:function(a){this.listen("onModified",a)},isVisible:function(){if(this.lastviewedids.length>0){return true}return false}});Atoshonetwork.Editorial.ShoppingAssistant.ProductsOnPage=function(a){this.name="ProductsOnPage";this.visible=true;this.productids={};this.options={};this.lastIndex=0;this.oZone=a;this.customization=Atoshonetwork.getConfig("Source").customization;this.currency=Atoshonetwork.getConfig("Source").currency;this.containingElement=null;this.$productsOnPage=null};Atoshonetwork.Editorial.ShoppingAssistant.ProductsOnPage.onProductClick=function(a){Atoshonetwork.Event.listen("Atoshonetwork.basketwidget.productsonpagemodule.onProductClick",a)};Atoshonetwork.Editorial.ShoppingAssistant.ProductsOnPage.prototype=Atoshonetwork.$.extend(true,Object.create(Atoshonetwork.SuperClass.prototype),{getTitle:function(){return Atoshonetwork.oTranslation.get("editorial_shop","BUY_IN_ARTICLE")},renderProduct:function(h,d,g){if(h=="success"&&g.stock.stockcount!=0&&!this.productids[d]){this.productids[d]=d;var a=this;var f=Atoshonetwork.$;var c="border-top: solid 1px #a8a9b8;";var b=g.getFirstImageURL(80);var e=f("<div class='atoshoOnPageProduct' style='"+c+"' prodId='"+g.sheet.id+"'><div style='background-color: white;background-image:url("+b+");background-size: contain;background-position: center;background-repeat: no-repeat;height:25px;width:25px;float:left;margin-top: 2px;'/><div class='atoshoBody' style='font-size: 12px;line-height: 12px;margin: 8px 5px 0px 7px;width: 132px;overflow: hidden;text-overflow: ellipsis;white-space: nowrap;float: left;'>"+g.sheet.attributes.Title.value+"</div></div>");e.click(function(){var j=f(this).attr("prodId");Atoshonetwork.Event.fire("Atoshonetwork.basketwidget.productsonpagemodule.onProductClick",[j]);Atoshonetwork.Shop.renderTo(j,null,a.oZone)});f("div#atoshoSAProductContainer",a.$productsOnPage).append(e)}},render:function(){var a=this;var c=Atoshonetwork.$;var e="<div style='width: 100%;margin-bottom: 10px;'>";e+="<div id='atoshoSAProductContainer' style='text-align:left;max-height:135px;overflow-y: auto;'>";e+="</div>";e+="</div>";this.$productsOnPage=c(e);if(Atoshonetwork.Editorial){var d=Atoshonetwork.Editorial.getOnPageProduct();for(var b=0;b<d.length;b++){Atoshonetwork.Getter.InStockProduct(d[b],function(g,f,h){a.renderProduct(g,f,h)})}}Atoshonetwork.Event.listen("atosho.onPageProductAdded",function(g,f){Atoshonetwork.Getter.InStockProduct(f,function(j,h,k){a.renderProduct(j,h,k)})});return this.$productsOnPage},renderTo:function(a){a.html(this.render())},onModified:function(a){this.listen("onModified",a)},modified:function(){return false},isVisible:function(){if(Atoshonetwork.Editorial.getOnPageProduct().length>0){return true}return false}});Atoshonetwork.Editorial.ShoppingAssistant.PopularPages=function(){Atoshonetwork.SuperClass.call(this);this.name="PopularPages";this.visible=true;this.lastviewedids=[];this.options={};this.lastIndex=0;this.$popularPages=null;this.customization=Atoshonetwork.getConfig("Source").customization;this.init()};Atoshonetwork.Editorial.ShoppingAssistant.PopularPages.onLinkClicked=function(a){Atoshonetwork.Event.listen("Atoshonetwork.AtoshoBasketWidget.onLinkClicked",a)};Atoshonetwork.Editorial.ShoppingAssistant.PopularPages.prototype=Atoshonetwork.$.extend(true,Object.create(Atoshonetwork.SuperClass.prototype),{init:function(){var a=this;var b=Atoshonetwork.$;if(Atoshonetwork.getConfig("Source").customization.links!=null&&Atoshonetwork.getConfig("Source").customization.links.length){this.visible=true}else{this.visible=false}},getTitle:function(){return Atoshonetwork.oTranslation.get("editorial_shop","POPULAR_ARTICLES")},render:function(){var a=this;var c=Atoshonetwork.$;var d="";if(this.visible){d="<div style='width: 100%;margin-bottom: 10px;'>";d+="<div style='text-align:left;display:table-cell;vertical-align:middle;'>";for(var b=0;b<Atoshonetwork.getConfig("Source").customization.links.length;b++){d+="<div class='atoshoPopularLinksHolder' link='"+Atoshonetwork.getConfig("Source").customization.links[b].url+"'><span class='atoshoPopularLinksArrow'/><a class='atoshoPopularLinks'>"+Atoshonetwork.getConfig("Source").customization.links[b].text+"</a></div>"}d+="</div>";d+="</div>"}this.$popularPages=c(d);c("div.atoshoPopularLinksHolder",a.$popularPages).click(function(){c(this).addClass("atoshoActive");Atoshonetwork.Event.fire("Atoshonetwork.AtoshoBasketWidget.onLinkClicked",[c(this).attr("link")]);return false});return this.$popularPages},renderTo:function(a){a.html(this.render())},modified:function(){return false},onModified:function(a){this.listen("onModified",a)},isVisible:function(){return this.visible}});Atoshonetwork.Editorial.Dock=function(a,b){Atoshonetwork.Editorial.DOMStorefront.call(this,a,b);this.defaultConfiguration={config:{"z-index":"10000",mixpanel:0,"horizontal-position":"left","vertical-position":"bottom","button-text":""}};Atoshonetwork.$.extend(true,this.defaultConfiguration,b);this.$previewItem=null;this.timeoutID=null;this.$oPreview=null;this.hasExpanded=false;this.oShop=null;this.$oThumbnailContainer=null;this.activeTimeout=null;this.init();this.binder()};Atoshonetwork.Editorial.Dock.prototype=Atoshonetwork.$.extend(true,Object.create(Atoshonetwork.Editorial.DOMStorefront.prototype),{init:function(){var a=this;var b=Atoshonetwork.$;a.$oElement=b("<atoshonetwork>",{id:a.iID});a.$oElement.css({width:"100%",display:"block",clear:"both",position:"relative"}).css(a.oCSS);a.$oElement.on("click",function(d){d.stopPropagation();d.preventDefault()});a.$oElement.insertAfter(a.$oContainer);a.initImageButton();var c=0;if(a.$oElement.css("zIndex")){c=a.$oElement.css("zIndex")}Atoshonetwork.Event.listen("atosho.shop.onClose",function(){a.$oElement.css({"z-index":c})})},initImageButton:function(){var p=this;var h=Atoshonetwork.$;var f=0;var l=0;var e=0;var k=h('<div id="atosho-image-container" class="atoshoDockContainer"></div>').css({cursor:"pointer",width:p.$oElement.width()});p.$oElement.append(k);var o=h("<div/>",{id:"atoshoImageOverlay","class":"atoshoDockIconHolder atosho-init-layer atoshonetwork",style:"display:block;"}).css({position:"relative","float":"left"}).append('<div class="atoshoDockBackground" style="display:block;background-color:'+Atoshonetwork.getConfig("Source").customization.backgroundColor+';"></div><div id="basket-icon" aid="'+k.attr("id")+'" class="atoshonetwork basket-icon" style="position: absolute;height: 80%;width: 80%;background-color: '+Atoshonetwork.getConfig("Source").customization.storefrontButtonColor+';border-radius: 50%;margin: 10% 0 0 10%;opacity: 1;"/>');o.appendTo(k);var n=h("<div/>",{id:"atoshoImageTextOverlay","class":"atoshoDockTextOverlay atoshonetwork",style:"display:block;"}).css({position:"relative","float":"left"});n.css({"margin-left":"1px"}).insertAfter(o);n.css({height:o.height(),width:p.$oElement.width()-o.width()-1});n.append('<div class="atoshonetwork atoshoDockBackground" style="display:block;background-color:'+Atoshonetwork.getConfig("Source").customization.backgroundColor+';"></div>');n.append('<span class="atoshoDockText atoshonetwork atoshoBody"></span>');n.append('<div style="height:15px;position: absolute;right: 10px;bottom: 0px;"><span id="extraStoreText" style="font-size: 10px;color: #b1b1b1;margin-right: 10px;display: inline-block;height: 12px;line-height: 1em;">'+Atoshonetwork.getConfig("Source").customization.advertisingText+"</span></div>");p.$oExpandedThumbnailContainer=h('<div style="display:none;" class="atoshoDockExpandedThumbnailHolder"></div>');n.append(p.$oExpandedThumbnailContainer);var c=h('<div class="atoshoDockThumbnailRow"></div>');p.$oExpandedThumbnailContainer.append(c);var m=p.defaultConfiguration.config.products;var b=m.length;var g=false;var a=0;var d=0;var j=Math.floor(n.width()/48)-2;if(j>0){Atoshonetwork.Getter.loadArray(this.defaultConfiguration.config.products,"InStockProduct",function(q){if(!q.length){p.$oElement.remove()}else{p.resizeOnApproach(h("div.atoshoDockThumbnail",p.$oThumbnailContainer),{});var r=p.defaultConfiguration.config["button-text"];r=r.replace("%WEBSITENAME%",Atoshonetwork.getConfig("Source").name);r=r.replace("%PRODUCTNAME%",q[0].sheet.name);h("span.atoshoDockText",n).html(r)}},function(u,r,t){if(u=="success"){if(d<j){d++;var v=h('<div class="atoshoDockThumbnail" style="background-image:url('+t.getFirstImageURL(500)+');"></div>');var q=h('<div class="atoshoDockToolTip" style="display:none;"><div class="atoshoToolTipTitle">'+t.sheet.name+'</div><div class="atoshoToolTipPrice">'+t.getPrice()+'</div><div class="atoshoToolTipOriginalPrice">'+t.getOriginalPrice()+'</div><div class="atoshoToolTipArrow"></div></div>');v.append(q);c.append(v);var w=null;v.hover(function(){p.iCurrentProductId=r;w=setTimeout(function(){p.openShop(false)},150)},function(){clearTimeout(w)});v.on("click",function(x){x.stopPropagation();x.preventDefault();p.openShop(true)});k.css({display:"block"})}if(a==b-1){p.fire("allProductsLoaded")}a++}})}if(Atoshonetwork.Common.isScrolledIntoView(o)){p.displayPreview();p.timeoutID=window.setTimeout(function(){p.hidePreview()},2500)}k.on("mouseenter",function(){p.setActive(true);clearTimeout(p.timeoutID)});k.on("mouseleave",function(){p.setActive(false)})},binder:function(){var c=Atoshonetwork.$;var a=this;var b=c("div#atoshoImageOverlay",a.$oElement);Atoshonetwork.$(window).scroll(function(){if(Atoshonetwork.Common.isScrolledIntoView(b)){if(!a.hasExpanded){a.hasExpanded=true;window.setTimeout(function(){a.displayPreview()},500);a.timeoutID=window.setTimeout(function(){a.hidePreview()},2500)}}else{b.removeClass("orange");a.hasExpanded=false}})},displayPreview:function(){var d=Atoshonetwork.$;var c=this;var b=d("div.atoshoDockExpandedThumbnailHolder",c.$oElement);var a=d("span.atoshoDockText",c.$oElement);b.fadeIn();a.fadeOut()},hidePreview:function(){var e=Atoshonetwork.$;var c=this;var b=e("div.atoshoDockExpandedThumbnailHolder",c.$oElement);var a=e("span.atoshoDockText",c.$oElement);var d=e("div#atoshoImageOverlay",c.$oElement);clearTimeout(c.timeoutID);d.addClass("active");if((this.oShop==null||!this.oShop.isOpen())){b.fadeOut();a.fadeIn()}},setActive:function(a){var f=Atoshonetwork.$;var d=this;var c=f("div.atoshoDockExpandedThumbnailHolder",d.$oElement);var b=f("span.atoshoDockText",d.$oElement);var e=f("div#atoshoImageOverlay",d.$oElement);if(a){clearTimeout(d.activeTimeout);c.fadeIn();b.fadeOut()}else{d.activeTimeout=setTimeout(function(){if(d.oShop!=null&&d.oShop.isPreviewOpen()){d.oShop.closeShop()}if(d.oShop==null||(d.oShop!=null&&!d.oShop.isOpen())){c.fadeOut();b.fadeIn()}},500)}},openShop:function(c){var b=this;var d=Atoshonetwork.$;var e=b.$oElement.offset().left;if(this.oShop==null){this.oShop=new Atoshonetwork.Shop(this);this.oShop.onClose(function(){b.setActive(false)})}var a=0;if(d("body").css("position")=="relative"){a=d("body").offset().top}this.oShop.openOneToOneGrid(b.$oElement.offset().top-a+b.$oElement.height(),e,b.iCurrentProductId,this.defaultConfiguration.id,b.defaultConfiguration.config.products,true);b.$oElement.css({"z-index":"421"});if(c){Atoshonetwork.Event.fire("atosho.editorial.storefront.onClick",[b.iCurrentProductId,b.defaultConfiguration]);d.get(Atoshonetwork._arrsConfig.url+"/shop/openimpression/productid/"+b.iCurrentProductId+"/zoneid/"+b.defaultConfiguration.id);this.oShop.removePreviewCover(true,function(){})}},resizeOnApproach:function(m,e){var n=this;var f=Atoshonetwork.$;var d={elementDefault:44,elementClosest:88,triggerDistance:96,setWidthAndHeight:true};if(e){f.extend(d,e)}var a=d.setWidthAndHeight;var b=m;var k=d.elementDefault;var h=d.elementClosest;var c=d.triggerDistance;var l=h-k;var j=l/c;var g=false;f(document).ready(function(){b.each(function(){this.style.width=k+"px";if(a){this.style.height=k+"px"}})});f(document).mousemove(function(q){var p=q.pageX;var o=q.pageY;b.each(function(){var v=f(this).offset();var t=f(this).width();var u=n.distToSqEdge(t,v.left+(t/2),v.top+(t/2),p,o);if(u<c){if(u<0){u=0}g=true;var r=k+(l-(u*j));f(this).css({height:r+"px",width:r+"px","margin-top":(-1*(r-k-4))+"px"});if(r==h){f("div.atoshoDockToolTip",f(this)).css({display:"block"})}else{f("div.atoshoDockToolTip",f(this)).css({display:"none"})}}else{f("div.atoshoDockToolTip",f(this)).css({display:"none"});f(this).css({height:k+"px",width:k+"px","margin-top":"4px"})}})})},distToSqEdge:function(f,b,h,d,c){var e=Math.sqrt((b-d)*(b-d)+(h-c)*(h-c));vx=d-b;vy=c-h;var a=0;var g=0;if(vx>vy){if(vx>-vy){a=1}else{g=1}}else{if(vx>-vy){g=-1}else{a=-1}}vlength=Math.sqrt((vx*vx)+(vy*vy));vux=vx/vlength;vuy=vy/vlength;cosA=vux*a+vuy*g;centreToSqEdge=Math.abs((0.5*f)/cosA);mouseToSquareEdge=vlength-centreToSqEdge;return mouseToSquareEdge}});if(!Atoshonetwork.Editorial.Hub){Atoshonetwork.Editorial.Hub={}}Atoshonetwork.Editorial.Hub.ImageDock=function(b,a){Atoshonetwork.SuperClass.call(this);this.defaultConfiguration={config:{"z-index":"10000",mixpanel:0,"horizontal-position":"left","vertical-position":"bottom","button-text":""}};Atoshonetwork.$.extend(true,this.defaultConfiguration,a);this.$oImage=b;if(this.$oImage.attr("atosho_id")==undefined){this.$oImage.attr("atosho_id","img_"+Math.floor(Math.random()*10000000000))}this.$oElement=null;this.$oContainer=null;this.$previewItem=null;this.timeoutID=null;this.$oPreview=null;this.iCurrentProductId=null;this.hasExpanded=false;this.oShop=null;this.$oThumbnailContainer=null;this.oMainHubData=a;this.iHubId=a.hubid;this.arroProducts=[];this.arriProduct=[];this.arroCollections=[];var c=this;Atoshonetwork.Getter.Hub(this.iHubId,function(e,d,f){if(e=="success"){Atoshonetwork.loadTranslation(function(){c.oHub=f;var g=Atoshonetwork.$.map(c.oHub.collections,function(j,h){return[j]});Atoshonetwork.Getter.loadArray(g,"Collection",function(j,h){if(j.length){c.init();c.binder()}},function(k,j,h){if(k=="success"){c.arroCollections.push(h);c.arriProduct=Atoshonetwork.Common.shuffleArray(c.arriProduct.concat(h.products))}})})}});this.activeTimeout=null};Atoshonetwork.Editorial.Hub.ImageDock.prototype=Atoshonetwork.$.extend(true,Object.create(Atoshonetwork.SuperClass.prototype),{init:function(){var a=this;var d=Atoshonetwork.$;var c=a.$oImage;var b=d("<atoshonetwork>",{id:c.attr("atosho_id")});if(a.$oImage.css("float")=="right"){b.css({"float":"right"})}b.appendTo("body");a.$oElement=b;a.initImageDock();var e=0;if(a.$oElement.css("zIndex")){e=a.$oElement.css("zIndex")}Atoshonetwork.Event.listen("atosho.shop.onClose",function(){a.$oElement.css({"z-index":e})})},destroy:function(){var a=Atoshonetwork.$;this.$oImage.removeAttr("atosho_load");this.$oElement.remove();delete this},initImageDock:function(){var r=this;var h=Atoshonetwork.$;var f=0;var l=0;var m=r.$oImage;var e=0;var q=-1;r.$oImage.parents().each(function(){var t=h(this).css("z-index");if(!isNaN(parseFloat(t))&&isFinite(t)&&q<parseInt(t)){q=parseInt(t)}});if(q<0){q=this.defaultConfiguration.config["z-index"]}var k=h('<div id="atosho-image-container" class="atoshoImageDockContainer"></div>').css({position:"absolute","z-index":q,cursor:"pointer",width:r.$oImage.width(),display:"none"});r.$oElement.append(k);r.$oContainer=k;Atoshonetwork.Event.listen("atosho.shop.onClose",function(){r.$oContainer.css({"z-index":q})});var p=h("<div/>",{id:"atoshoImageOverlay","class":"atoshoImageDockIconHolder atosho-init-layer atoshonetwork",style:"display:block;"}).css({position:"relative","z-index":q,"float":"left"}).append('<div class="atoshoImageDockBackground" style="display:none;background-color:'+Atoshonetwork.getConfig("Source").customization.backgroundColor+';"></div><div id="basket-icon" aid="'+m.attr("atosho_id")+'" class="atoshonetwork basket-icon" style="position: absolute;height: 80%;width: 80%;background-color: '+Atoshonetwork.getConfig("Source").customization.storefrontButtonColor+';border-radius: 50%;margin: 10% 0 0 10%;opacity: 1;"/>');p.appendTo(k);var o=h("<div/>",{id:"atoshoImageTextOverlay","class":"atoshoImageDockTextOverlay atoshonetwork",style:"display:block;"}).css({position:"relative","z-index":q,"float":"left"});if(r.defaultConfiguration.config["horizontal-position"]=="left"){o.css({"margin-left":"1px"}).insertAfter(p)}else{o.css({"margin-right":"1px"}).insertBefore(p)}if(r.$oImage.css("float")=="left"||r.$oImage.css("float")=="right"){l=r.$oImage.height()}o.css({height:p.height(),width:r.$oImage.width()-p.width()-1});o.append('<div class="atoshonetwork atoshoImageDockBackground" style="display:none;background-color:'+Atoshonetwork.getConfig("Source").customization.backgroundColor+';"></div>');o.append('<span class="atoshoImageDockText atoshonetwork atoshoBody"></span>');o.append('<div style="height:15px;position: absolute;right: 10px;bottom: 0px;"><span id="extraStoreText" style="font-size: 10px;color: #b1b1b1;margin-right: 10px;display: inline-block;height: 12px;line-height: 1em;">'+Atoshonetwork.getConfig("Source").customization.advertisingText+"</span></div>");r.$oExpandedThumbnailContainer=h('<div style="display:none;" class="atoshoImageDockExpandedThumbnailHolder"></div>');o.append(r.$oExpandedThumbnailContainer);var c=h('<div class="atoshoImageDockThumbnailRow"></div>');r.$oExpandedThumbnailContainer.append(c);var n=r.arriProduct;var b=n.length;var g=false;var a=0;var d=0;var j=Math.floor(o.width()/48)-2;if(j>0){Atoshonetwork.Getter.loadArray(r.arriProduct,"InStockProduct",function(u){if(!u.length){r.$oElement.remove()}else{r.resizeOnApproach(h("div.atoshoImageDockThumbnail",r.$oThumbnailContainer),{});var v=r.defaultConfiguration.config["button-text"];if(v==null||v.trim()==""){v=r.oHub.alias}v=v.replace("%WEBSITENAME%",Atoshonetwork.getConfig("Source").name);v=v.replace("%PRODUCTNAME%",u[0].sheet.name);v=v.replace("%COLLECTION_0%",r.arroCollections[0].alias);var t=Atoshonetwork.Common.shuffleArray(r.arroCollections);v=v.replace("%COLLECTION_X%",t[0].alias);h("span.atoshoImageDockText",o).html(v)}},function(w,u,v){if(w=="success"){if(d<j){Atoshonetwork.Editorial.addOnPageProduct(u);d++;var x=h('<div class="atoshoImageDockThumbnail" style="background-image:url('+v.getFirstImageURL(500)+');"></div>');var t=h('<div class="atoshoImageDockToolTip" style="display:none;"><div class="atoshoToolTipTitle">'+v.sheet.name+'</div><div class="atoshoToolTipPrice">'+v.getPrice()+'</div><div class="atoshoToolTipOriginalPrice">'+v.getOriginalPrice()+'</div><div class="atoshoToolTipArrow"></div></div>');x.append(t);c.append(x);var y=null;x.hover(function(){r.iCurrentProductId=u;y=setTimeout(function(){r.openShop(false)},150)},function(){clearTimeout(y)});x.on("click",function(){r.openShop(true)});k.css({display:"block"})}if(a==b-1){r.fire("allProductsLoaded")}a++}})}h(window).resize(function(){r.positionOverlay()});Atoshonetwork.onImageLoaded(function(){r.positionOverlay()});if(Atoshonetwork.Common.isScrolledIntoView(p)){r.displayPreview();r.timeoutID=window.setTimeout(function(){r.hidePreview()},2500)}r.$oImage.on("mouseenter",function(){r.setActive(true)});r.$oImage.on("mouseleave",function(){r.setActive(false)});k.on("mouseenter",function(){r.setActive(true);clearTimeout(r.timeoutID)});k.on("mouseleave",function(){r.setActive(false)});c.on("mouseenter",function(){h("div.atoshoImageDockBackground",p).fadeIn();h("div.atoshoImageDockBackground",r.$oElement).fadeIn()});r.positionOverlay()},positionOverlay:function(){var b=this;var f=Atoshonetwork.$;var e=b.$oImage;var h=e.offset();var d=f("div#atoshoImageOverlay",b.$oElement);var c=0;var g=0;if(isNaN(b.defaultConfiguration.config["horizontal-position"])){switch(b.defaultConfiguration.config["horizontal-position"]){case"left":c=h.left;break;case"right":c=h.left+e.width()-d.width();break}}var a=0;if(f("body").css("position")=="relative"){a=f("body").offset().top}if(isNaN(b.defaultConfiguration.config["vertical-position"])){switch(b.defaultConfiguration.config["vertical-position"]){case"bottom":g=h.top-a+e.height()-d.height();break;case"top":g=h.top-a;break}}f("div#atosho-image-container",b.$oElement).css({top:g,left:c});f("div#atoshoImageTextOverlay",b.$oElement).css({width:b.$oImage.width()-d.width()-1});f("div#atosho-image-container",b.$oElement).css({width:b.$oImage.width()})},binder:function(){var c=Atoshonetwork.$;var a=this;var b=c("div#atoshoImageOverlay",a.$oElement);Atoshonetwork.$(window).scroll(function(){if(Atoshonetwork.Common.isScrolledIntoView(b)){a.positionOverlay();if(!a.hasExpanded){a.hasExpanded=true;window.setTimeout(function(){a.displayPreview()},500);a.timeoutID=window.setTimeout(function(){a.hidePreview()},2500)}}else{b.removeClass("orange");a.hasExpanded=false}})},displayPreview:function(){var f=Atoshonetwork.$;var d=this;var c=f("div.atoshoImageDockExpandedThumbnailHolder",d.$oElement);var a=f("span.atoshoImageDockText",d.$oElement);var b=f("div.atoshoImageDockBackground",d.$oElement);var e=f("div#atoshoImageOverlay",d.$oElement);c.fadeIn();a.fadeOut()},hidePreview:function(){var f=Atoshonetwork.$;var d=this;var c=f("div.atoshoImageDockExpandedThumbnailHolder",d.$oElement);var a=f("span.atoshoImageDockText",d.$oElement);var b=f("div.atoshoImageDockBackground",d.$oElement);var e=f("div#atoshoImageOverlay",d.$oElement);clearTimeout(d.timeoutID);e.addClass("active");if((this.oShop==null||!this.oShop.isOpen())&&b.css("display")!="block"){c.fadeOut();a.fadeIn()}},setActive:function(a){var g=Atoshonetwork.$;var e=this;var d=g("div.atoshoImageDockExpandedThumbnailHolder",e.$oElement);var b=g("span.atoshoImageDockText",e.$oElement);var c=g("div.atoshoImageDockBackground",e.$oElement);var f=g("div#atoshoImageOverlay",e.$oElement);if(a){clearTimeout(e.activeTimeout);d.fadeIn();b.fadeOut()}else{e.activeTimeout=setTimeout(function(){if(e.oShop!=null&&e.oShop.isPreviewOpen()){e.oShop.closeShop()}if(e.oShop==null||(e.oShop!=null&&!e.oShop.isOpen())){d.fadeOut();b.fadeIn();c.fadeOut();g("div.atoshoImageDockBackground",f).fadeOut()}},500)}},openShop:function(c){var b=this;var d=Atoshonetwork.$;var e=b.$oImage.offset().left;if(this.oShop==null){this.oShop=new Atoshonetwork.Shop(this);this.oShop.onClose(function(){b.setActive(false)})}var a=0;if(d("body").css("position")=="relative"){a=d("body").offset().top}b.oShop.openPreviewHub(b.$oImage.offset().top-a+b.$oImage.height(),e,b.iHubId,b.iCurrentProductId,b.oMainHubData.zone.id,c);b.$oContainer.css({"z-index":"421"});if(c){d.get(Atoshonetwork._arrsConfig.url+"/shop/openimpression/productid/"+b.iCurrentProductId+"/zoneid/"+b.defaultConfiguration.id);Atoshonetwork.Event.fire("atosho.editorial.storefront.onClick",[b.iCurrentProductId,b.defaultConfiguration]);this.oShop.removePreviewCover(true,function(){})}},resizeOnApproach:function(m,e){var n=this;var f=Atoshonetwork.$;var d={elementDefault:44,elementClosest:88,triggerDistance:96,setWidthAndHeight:true};if(e){f.extend(d,e)}var a=d.setWidthAndHeight;var b=m;var k=d.elementDefault;var h=d.elementClosest;var c=d.triggerDistance;var l=h-k;var j=l/c;var g=false;f(document).ready(function(){b.each(function(){this.style.width=k+"px";if(a){this.style.height=k+"px"}})});f(document).mousemove(function(q){var p=q.pageX;var o=q.pageY;b.each(function(){var v=f(this).offset();var t=f(this).width();var u=n.distToSqEdge(t,v.left+(t/2),v.top+(t/2),p,o);if(u<c){if(u<0){u=0}g=true;var r=k+(l-(u*j));f(this).css({height:r+"px",width:r+"px","margin-top":(-1*(r-k-4))+"px"});if(r==h){f("div.atoshoImageDockToolTip",f(this)).css({display:"block"})}else{f("div.atoshoImageDockToolTip",f(this)).css({display:"none"})}}else{f("div.atoshoImageDockToolTip",f(this)).css({display:"none"});f(this).css({height:k+"px",width:k+"px","margin-top":"4px"})}})})},distToSqEdge:function(f,b,h,d,c){var e=Math.sqrt((b-d)*(b-d)+(h-c)*(h-c));vx=d-b;vy=c-h;var a=0;var g=0;if(vx>vy){if(vx>-vy){a=1}else{g=1}}else{if(vx>-vy){g=-1}else{a=-1}}vlength=Math.sqrt((vx*vx)+(vy*vy));vux=vx/vlength;vuy=vy/vlength;cosA=vux*a+vuy*g;centreToSqEdge=Math.abs((0.5*f)/cosA);mouseToSquareEdge=vlength-centreToSqEdge;return mouseToSquareEdge}});if(!Atoshonetwork.Editorial.Hub){Atoshonetwork.Editorial.Hub={}}Atoshonetwork.Editorial.Hub.Dock=function(b,a){Atoshonetwork.Editorial.DOMStorefront.call(this,b,a);this.defaultConfiguration={config:{"z-index":"10000",mixpanel:0,"horizontal-position":"left","vertical-position":"bottom","button-text":""}};Atoshonetwork.$.extend(true,this.defaultConfiguration,a);this.$previewItem=null;this.timeoutID=null;this.$oPreview=null;this.hasExpanded=false;this.oShop=null;this.$oThumbnailContainer=null;this.activeTimeout=null;this.oMainHubData=a;this.iHubId=a.hubid;this.arroProducts=[];this.arriProduct=[];this.arroCollections=[];var c=this;Atoshonetwork.Getter.Hub(this.iHubId,function(e,d,f){if(e=="success"){Atoshonetwork.loadTranslation(function(){c.oHub=f;var g=Atoshonetwork.$.map(c.oHub.collections,function(j,h){return[j]});Atoshonetwork.Getter.loadArray(g,"Collection",function(j,h){if(j.length){c.init();c.binder()}},function(k,j,h){if(k=="success"){c.arroCollections.push(h);c.arriProduct=Atoshonetwork.Common.shuffleArray(c.arriProduct.concat(h.products))}})})}})};Atoshonetwork.Editorial.Hub.Dock.prototype=Atoshonetwork.$.extend(true,Object.create(Atoshonetwork.Editorial.DOMStorefront.prototype),{init:function(){var a=this;var b=Atoshonetwork.$;a.$oElement=b("<atoshonetwork>",{id:a.iID});a.$oElement.css({width:"100%",display:"block",clear:"both"}).css(a.oCSS);a.$oElement.on("click",function(c){c.stopPropagation();c.preventDefault()});a.$oElement.insertAfter(a.$oContainer);a.initImageButton()},initImageButton:function(){var p=this;var h=Atoshonetwork.$;var f=0;var l=0;var e=0;var k=h('<div id="atosho-image-container" class="atoshoDockContainer"></div>').css({cursor:"pointer",width:p.$oElement.width()});p.$oElement.append(k);var o=h("<div/>",{id:"atoshoImageOverlay","class":"atoshoDockIconHolder atosho-init-layer atoshonetwork",style:"display:block;"}).css({position:"relative","float":"left"}).append('<div class="atoshoDockBackground" style="display:block;background-color:'+Atoshonetwork.getConfig("Source").customization.backgroundColor+';"></div><div id="basket-icon" aid="'+k.attr("id")+'" class="atoshonetwork basket-icon" style="position: absolute;height: 80%;width: 80%;background-color: '+Atoshonetwork.getConfig("Source").customization.storefrontButtonColor+';border-radius: 50%;margin: 10% 0 0 10%;opacity: 1;"/>');o.appendTo(k);var n=h("<div/>",{id:"atoshoImageTextOverlay","class":"atoshoDockTextOverlay atoshonetwork",style:"display:block;"}).css({position:"relative","float":"left"});n.css({"margin-left":"1px"}).insertAfter(o);n.css({height:o.height(),width:p.$oElement.width()-o.width()-1});n.append('<div class="atoshonetwork atoshoDockBackground" style="display:block;background-color:'+Atoshonetwork.getConfig("Source").customization.backgroundColor+';"></div>');n.append('<span class="atoshoDockText atoshonetwork atoshoBody"></span>');n.append('<div style="height:15px;position: absolute;right: 10px;bottom: 0px;"><span id="extraStoreText" style="font-size: 10px;color: #b1b1b1;margin-right: 10px;display: inline-block;height: 12px;line-height: 1em;">'+Atoshonetwork.getConfig("Source").customization.advertisingText+"</span></div>");p.$oExpandedThumbnailContainer=h('<div style="display:none;" class="atoshoDockExpandedThumbnailHolder"></div>');n.append(p.$oExpandedThumbnailContainer);var c=h('<div class="atoshoDockThumbnailRow"></div>');p.$oExpandedThumbnailContainer.append(c);var m=p.arriProduct;var b=m.length;var g=false;var a=0;var d=0;var j=Math.floor(n.width()/48)-2;if(j>0){Atoshonetwork.Getter.loadArray(this.arriProduct,"Product",function(r){if(!r.length){p.$oElement.remove()}else{p.resizeOnApproach(h("div.atoshoDockThumbnail",p.$oThumbnailContainer),{});var t=p.defaultConfiguration.config["button-text"];if(t==null||t.trim()==""){t=p.oHub.alias}t=t.replace("%WEBSITENAME%",Atoshonetwork.getConfig("Source").name);t=t.replace("%PRODUCTNAME%",r[0].sheet.name);t=t.replace("%COLLECTION_0%",p.arroCollections[0].alias);var q=Atoshonetwork.Common.shuffleArray(p.arroCollections);t=t.replace("%COLLECTION_X%",q[0].alias);h("span.atoshoDockText",n).html(t)}},function(u,r,t){if(u=="success"){if(d<j){d++;var v=h('<div class="atoshoDockThumbnail" style="background-image:url('+t.getFirstImageURL(500)+');"></div>');var q=h('<div class="atoshoDockToolTip" style="display:none;"><div class="atoshoToolTipTitle">'+t.sheet.name+'</div><div class="atoshoToolTipPrice">'+t.getPrice()+'</div><div class="atoshoToolTipOriginalPrice">'+t.getOriginalPrice()+'</div><div class="atoshoToolTipArrow"></div></div>');v.append(q);c.append(v);var w=null;v.hover(function(){p.iCurrentProductId=r;w=setTimeout(function(){p.openShop(false)},150)},function(){clearTimeout(w)});v.on("click",function(x){x.stopPropagation();x.preventDefault();p.openShop(true)});k.css({display:"block"})}if(a==b-1){p.fire("allProductsLoaded")}a++}})}if(Atoshonetwork.Common.isScrolledIntoView(o)){p.displayPreview();p.timeoutID=window.setTimeout(function(){p.hidePreview()},2500)}k.on("mouseenter",function(){p.setActive(true);clearTimeout(p.timeoutID)});k.on("mouseleave",function(){p.setActive(false)})},binder:function(){var c=Atoshonetwork.$;var a=this;var b=c("div#atoshoImageOverlay",a.$oElement);Atoshonetwork.$(window).scroll(function(){if(Atoshonetwork.Common.isScrolledIntoView(b)){if(!a.hasExpanded){a.hasExpanded=true;window.setTimeout(function(){a.displayPreview()},500);a.timeoutID=window.setTimeout(function(){a.hidePreview()},2500)}}else{b.removeClass("orange");a.hasExpanded=false}})},displayPreview:function(){var d=Atoshonetwork.$;var c=this;var b=d("div.atoshoDockExpandedThumbnailHolder",c.$oElement);var a=d("span.atoshoDockText",c.$oElement);b.fadeIn();a.fadeOut()},hidePreview:function(){var e=Atoshonetwork.$;var c=this;var b=e("div.atoshoDockExpandedThumbnailHolder",c.$oElement);var a=e("span.atoshoDockText",c.$oElement);var d=e("div#atoshoImageOverlay",c.$oElement);clearTimeout(c.timeoutID);d.addClass("active");if((this.oShop==null||!this.oShop.isOpen())){b.fadeOut();a.fadeIn()}},setActive:function(a){var f=Atoshonetwork.$;var d=this;var c=f("div.atoshoDockExpandedThumbnailHolder",d.$oElement);var b=f("span.atoshoDockText",d.$oElement);var e=f("div#atoshoImageOverlay",d.$oElement);if(a){clearTimeout(d.activeTimeout);c.fadeIn();b.fadeOut()}else{d.activeTimeout=setTimeout(function(){if(d.oShop!=null&&d.oShop.isPreviewOpen()){d.oShop.closeShop()}if(d.oShop==null||(d.oShop!=null&&!d.oShop.isOpen())){c.fadeOut();b.fadeIn()}},500)}},openShop:function(c){var b=this;var d=Atoshonetwork.$;var e=b.$oElement.offset().left;if(this.oShop==null){this.oShop=new Atoshonetwork.Shop(this);this.oShop.onClose(function(){b.setActive(false)})}var a=0;if(d("body").css("position")=="relative"){a=d("body").offset().top}b.oShop.openPreviewHub(b.$oElement.offset().top-a+b.$oElement.height(),e,b.iHubId,b.iCurrentProductId,b.oMainHubData.zone.id,c);if(c){Atoshonetwork.Event.fire("atosho.editorial.storefront.onClick",[b.iCurrentProductId,b.defaultConfiguration]);d.get(Atoshonetwork._arrsConfig.url+"/shop/openimpression/productid/"+b.iCurrentProductId+"/zoneid/"+b.defaultConfiguration.id);this.oShop.removePreviewCover(true,function(){})}},resizeOnApproach:function(m,e){var n=this;var f=Atoshonetwork.$;var d={elementDefault:44,elementClosest:88,triggerDistance:96,setWidthAndHeight:true};if(e){f.extend(d,e)}var a=d.setWidthAndHeight;var b=m;var k=d.elementDefault;var h=d.elementClosest;var c=d.triggerDistance;var l=h-k;var j=l/c;var g=false;f(document).ready(function(){b.each(function(){this.style.width=k+"px";if(a){this.style.height=k+"px"}})});f(document).mousemove(function(q){var p=q.pageX;var o=q.pageY;b.each(function(){var v=f(this).offset();var t=f(this).width();var u=n.distToSqEdge(t,v.left+(t/2),v.top+(t/2),p,o);if(u<c){if(u<0){u=0}g=true;var r=k+(l-(u*j));f(this).css({height:r+"px",width:r+"px","margin-top":(-1*(r-k-4))+"px"});if(r==h){f("div.atoshoDockToolTip",f(this)).css({display:"block"})}else{f("div.atoshoDockToolTip",f(this)).css({display:"none"})}}else{f("div.atoshoDockToolTip",f(this)).css({display:"none"});f(this).css({height:k+"px",width:k+"px","margin-top":"4px"})}})})},distToSqEdge:function(f,b,h,d,c){var e=Math.sqrt((b-d)*(b-d)+(h-c)*(h-c));vx=d-b;vy=c-h;var a=0;var g=0;if(vx>vy){if(vx>-vy){a=1}else{g=1}}else{if(vx>-vy){g=-1}else{a=-1}}vlength=Math.sqrt((vx*vx)+(vy*vy));vux=vx/vlength;vuy=vy/vlength;cosA=vux*a+vuy*g;centreToSqEdge=Math.abs((0.5*f)/cosA);mouseToSquareEdge=vlength-centreToSqEdge;return mouseToSquareEdge}});if(!Atoshonetwork.Editorial.Hub){Atoshonetwork.Editorial.Hub={}}Atoshonetwork.Editorial.Mosaic=function(a,c){Atoshonetwork.Editorial.DOMStorefront.call(this,a,c);var b=this;this.defaultConfiguration={config:{"z-index":"10000",mixpanel:0,container:{padding:2},cell:{margin:1,width:70,height:70},formats:{small:{"max-items":2,col:6,row:2},medium:{"max-items":5,col:6,row:3},large:{"max-items":8,col:8,row:3},"x-large":{"max-items":11,col:9,row:3}}}};Atoshonetwork.$.extend(true,this.defaultConfiguration,c);this.formatBehavior=[[],[[3,0,2,2]],[[3,0,2,2],[2,0,1,1]],[[3,0,3,3],[2,0,1,1],[1,2,1,1]],[[3,0,3,3],[2,0,1,1],[1,2,1,1],[1,0,1,1]],[[3,0,3,3],[0,2,1,1],[2,2,1,1],[1,0,1,1],[2,0,1,1]],[[2,0,1,1],[0,2,1,1],[1,2,1,1],[2,2,1,1],[3,0,3,3],[6,0,2,2]],[[1,0,1,1],[2,0,1,1],[0,2,1,1],[1,2,1,1],[2,2,1,1],[5,0,3,3],[3,0,2,2]],[[1,0,1,1],[2,0,1,1],[0,2,1,1],[1,2,1,1],[2,2,1,1],[5,0,3,3],[3,0,2,2],[3,2,1,1]],[[1,0,1,1],[2,0,1,1],[0,2,1,1],[1,2,1,1],[3,0,3,3],[6,0,2,2],[8,0,1,1],[6,2,1,1],[7,2,1,1]],[[1,0,1,1],[2,0,1,1],[0,2,1,1],[1,2,1,1],[2,2,1,1],[3,0,3,3],[6,0,2,2],[8,0,1,1],[8,1,1,1],[7,2,1,1]],[[1,0,1,1],[2,0,1,1],[0,2,1,1],[1,2,1,1],[2,2,1,1],[5,0,3,3],[3,0,2,2],[8,0,1,1],[8,1,1,1],[3,2,1,1],[8,2,1,1]]];this.formatSpecialBehavior=[[],[[0,0,1,1,"icon"],[5,1,1,1,"show_all"],[0,1,3,1,"title"]],[[0,0,1,1,"icon"],[5,1,1,1,"show_all"],[0,1,3,1,"title"]],[[0,0,1,1,"icon"],[2,2,1,1,"show_all"],[0,1,3,1,"title"]],[[0,0,1,1,"icon"],[2,2,1,1,"show_all"],[0,1,3,1,"title"]],[[0,0,1,1,"icon"],[1,2,1,1,"show_all"],[0,1,3,1,"title"]],[[0,0,1,1,"icon"],[7,2,1,1,"show_all"],[0,1,3,1,"title"]],[[0,0,1,1,"icon"],[4,2,1,1,"show_all"],[0,1,3,1,"title"]],[[0,0,1,1,"icon"],[4,2,1,1,"show_all"],[0,1,3,1,"title"]],[[0,0,1,1,"icon"],[2,2,1,1,"show_all"],[0,1,3,1,"title"]],[[0,0,1,1,"icon"],[6,2,1,1,"show_all"],[0,1,3,1,"title"]],[[0,0,1,1,"icon"],[4,2,1,1,"show_all"],[0,1,3,1,"title"]]];this.oSelectedFormat=null;this.oHub=null;this.oShop=null;this.buttonText=null;this.iParentWidth=a.parent().width();this.arroProducts=[];this.arriProduct=[];Atoshonetwork.loadTranslation(function(){b.arriProduct=Atoshonetwork.Common.shuffleArray(b.arriProduct.concat(b.defaultConfiguration.config.products));b.init()})};Atoshonetwork.Editorial.Mosaic.onAllProductLoaded=function(a){Atoshonetwork.Event.listen("atosho.editorial.hub.onAllProductLoaded",a)};Atoshonetwork.Editorial.Mosaic.prototype=Atoshonetwork.$.extend(true,Object.create(Atoshonetwork.Editorial.DOMStorefront.prototype),{init:function(){var m=this;var e=Atoshonetwork.$;var g=m.$oPlaceHolder;var h=e("<atoshonetwork>",{id:g.attr("atosho_id"),"class":"atoshonetwork",style:"display: inline-block;"}).css({position:"relative",padding:this.defaultConfiguration.config.container.padding+"px","margin-top":"5px","margin-bottom":"5px"}).css(m.oCSS);h.insertAfter(g);this.$oElement=h;var f=this.defaultConfiguration.config.formats;var d=this.defaultConfiguration.config.cell;var b={};var c=0;for(var l in f){if(f.hasOwnProperty(l)){var a=f[l];if(this.iParentWidth>(a.col*d.width+this.defaultConfiguration.config.container.padding*2)){b[a["max-items"]]=a;if(a["max-items"]>c){c=a["max-items"]}}}}var j=null;this.loadProducts(c,function(n){for(var o in b){if(b.hasOwnProperty(o)){if(parseInt(o)==n){j=b[o];break}else{if(parseInt(o)>n&&(j==null||j["max-items"]>b[o]["max-items"])){j=b[o]}}}}m.initGrid(j,n)});h.on("mouseleave",function(){window.setTimeout(function(){if(m.oShop!=null&&m.oShop.isPreviewOpen()){m.oShop.closeShop()}},200)});var k=0;if(m.$oElement.css("zIndex")){k=m.$oElement.css("zIndex")}Atoshonetwork.Event.listen("atosho.shop.onClose",function(){m.$oElement.css({"z-index":k})})},loadProducts:function(c,b){var a=this;Atoshonetwork.Getter.loadArray(a.arriProduct.slice(0,c),"InStockProduct",function(d){a.arroProducts=d;if(a.arroProducts.length<c&&a.arriProduct.length>c){Atoshonetwork.Getter.loadArray(a.arriProduct.slice(c,c+3),"InStockProduct",function(e){a.arroProducts=a.arroProducts.concat(e).slice(0,c);Atoshonetwork.Event.fire("atosho.editorial.hub.onAllProductLoaded",[a.arroProducts.length]);b&&b(a.arroProducts.length)})}else{Atoshonetwork.Event.fire("atosho.editorial.hub.onAllProductLoaded",[a.arroProducts.length]);b&&b(a.arroProducts.length)}})},initGrid:function(j,h){var e=Atoshonetwork.$;var m=this;var d=this.defaultConfiguration.config.cell;var f=(((d.height-(2*d.margin))/2));var b=j.col*d.width;var a=j.row*d.height;this.$oElement.css({"background-color":"rgb(168, 169, 184)","border-color":"rgb(168, 169, 184)",cursor:"pointer"}).width(b).height(a);var c=this.formatBehavior[h];for(i=0;i<c.length;i++){this.addToGrid(c[i][0],c[i][1],c[i][2],c[i][3],this.generateProductIcon(this.arroProducts[i],c[i][2]*c[i][3]))}var g=this.formatSpecialBehavior[h];for(i=0;i<g.length;i++){switch(g[i][4]){case"icon":var l=e("<div/>").css({width:"100%",height:"100%","background-color":Atoshonetwork.getConfig("Source").customization.backgroundColor,overflow:"auto"}).append('<div id="basket-icon" class="atoshonetwork basket-icon" style="height: 70%;width: 70%;background-color: '+Atoshonetwork.getConfig("Source").customization.storefrontButtonColor+';border-radius: 50%;margin: 15%;opacity: 1;"/>');break;case"show_all":var l=e("<div/>").css({height:(f*2)+"px","text-align":"center",width:"100%","font-weight":"bold","font-style":"normal","font-size":"10px",color:"#fff","line-height":f+"px","background-color":Atoshonetwork.getConfig("Source").customization.backgroundColor,"float":"left"}).append('<div style="font-size: 10px;padding-left: 12px;display: table-cell;vertical-align: middle;">'+Atoshonetwork.oTranslation.get("editorial_shop","SHOW_ALL")+"</div>");var k=e("<div>").css({width:"100%",height:f+"px","vertical-align":"bottom",position:"absolute",bottom:"0px","line-height":f+"px","text-align":"center","font-weight":"bold",color:"#252525","font-size":"10px"}).addClass("atoshoTransparentWhiteBack").html(e("<div>").addClass("atosho-hub-image-arrow-white").css({display:"inline-block","margin-top":(f/2-3)+"px"}));l.append(k);break;case"title":m.buttonText=m.defaultConfiguration.config["button-text"];m.buttonText=m.buttonText.replace("%WEBSITENAME%",Atoshonetwork.getConfig("Source").name);var l=e("<div/>").css({height:"100%",display:"table","text-align":"left",width:"100%","font-style":"normal","font-size":"14px",color:"#fff","background-color":Atoshonetwork.getConfig("Source").customization.backgroundColor,"float":"left"}).append('<div style="padding: 0px 12px;display: table-cell;vertical-align: middle;line-height: 1em;">'+m.buttonText+"</div>");l.append('<span id="extraStoreText" style="font-size: 10px;color: #b1b1b1;margin-right: 5px;display: inline-block;height: 12px;position: absolute;right: 0;bottom: 0;">'+Atoshonetwork.getConfig("Source").customization.advertisingText+"</span>");break;default:var l=e("<div/>").css({"background-color":Atoshonetwork.getConfig("Source").customization.backgroundColor}).append(g[i][4]);break}l.click(function(){m.openShop()});this.addToGrid(g[i][0],g[i][1],g[i][2],g[i][3],l)}},openShop:function(a){var b=this;var c=Atoshonetwork.$;var d=b.$oPlaceHolder.offset().left;if(Atoshonetwork._arrsConfig.shopContainerSelector!=null&&Atoshonetwork._arrsConfig.shopContainerSelector!=""){d=c(Atoshonetwork._arrsConfig.shopContainerSelector).offset().left}Atoshonetwork.Event.fire("atosho.editorial.hub.mosaic.storefront.onClick");Atoshonetwork.Event.fire("atosho.editorial.storefront.onClick",[a,{type:"Editorial.Mosaic",id:b.defaultConfiguration.id,name:b.defaultConfiguration.name,config:{"button-text":b.buttonText}}]);if(this.oShop==null){this.oShop=new Atoshonetwork.Shop(b)}b.$oElement.css({"z-index":"421"});this.oShop.openOneToOneGrid(b.$oElement.offset().top+b.$oElement.outerHeight(),d,a,b.defaultConfiguration.id,b.defaultConfiguration.config.products,true);this.oShop.removePreviewCover(true)},generateProductIcon:function(k,t){var j=this;var d=Atoshonetwork.$;var f=500;switch(t){case 1:f=80;break;case 4:f=120;break;default:f=500;break}var h=this.getFirstImage(k,f);var o=d("<div>").css({"background-color":"white","background-size":"contain","background-position":"center","background-repeat":"no-repeat","background-image":"url('"+h+"')",height:"100%",width:"100%"});var q=this.defaultConfiguration.config.cell;var m=k.getPrice();var n=(((q.height-(2*q.margin))/2));var l=d("<div>").css({width:"100%",height:"68px","vertical-align":"bottom",position:"absolute",bottom:"-29px","text-align":"center","font-weight":"bold",color:"#252525","font-size":"10px"}).addClass("atoshoTransparentWhiteBack");var g=d("<div>").css({height:"31px","padding-top":"8px","font-size":"10px"});var a=d("<div>").css({"line-height":"12px","font-size":"10px",color:"#252525"}).html(m);g.append(a);var b=k.getSavedPercentage();if(b>8){var r=Atoshonetwork.oTranslation.get("editorial_shop","SAVE",{discount:b+"%"});var c=Atoshonetwork.getConfig("Currency");if(c.id==6){r=Atoshonetwork.oTranslation.get("editorial_shop","SAVE",{discount:k.getSavedAmount()})}var e=d("<div>").css({"line-height":"12px","font-size":"10px",color:"#ca4747"}).html(r);g.append(e)}l.append(g);var p=d("<div>").css({"line-height":"28px","margin-right":"5px","margin-left":"5px","border-top":"1px solid rgb(168, 169, 184)","font-size":"10px",color:"#252525"}).html(Atoshonetwork.getConfig("Source").translations.DETAILS_BUTTON).append(d("<div>").addClass("atosho-hub-image-arrow-grey").css({display:"inline-block","margin-left":"5px"}));l.append(p);o.append(l);o.bind("click",function(){j.openShop(k.sheet.id)}).bind("mouseenter",function(){l.animate({bottom:"0px"},100)}).bind("mouseleave",function(){l.animate({bottom:"-29px"},100)});o.hover(function(){d.data(this,"timer",setTimeout(function(){var u=j.$oPlaceHolder.offset().left;if(Atoshonetwork._arrsConfig.shopContainerSelector!=null&&Atoshonetwork._arrsConfig.shopContainerSelector!=""){u=d(Atoshonetwork._arrsConfig.shopContainerSelector).offset().left}if(j.oShop==null){j.oShop=new Atoshonetwork.Shop(j)}j.oShop.openOneToOneGrid(j.$oElement.offset().top+j.$oElement.outerHeight(),u,k.sheet.id,j.defaultConfiguration.id,j.defaultConfiguration.config.products,true)},250))},function(){clearTimeout(d.data(this,"timer"))});return o},addToGrid:function(c,f,a,g,b){var d=this.defaultConfiguration.config.cell;var e=Atoshonetwork.$;var h=e("<div>",{id:"atosho-grid-cell"}).css({margin:d.margin+"px",overflow:"hidden",position:"absolute","line-height":"1em",left:this.defaultConfiguration.config.container.padding+d.width*c,top:this.defaultConfiguration.config.container.padding+d.height*f,width:d.width*a-(2*d.margin),height:d.height*g-(2*d.margin)}).html(b).appendTo(this.$oElement)},getFirstImage:function(a,b){for(sIndex in a.sheet.images){if((a.sheet.images[sIndex].url!==null&&a.sheet.images[sIndex].url!=="")||(a.sheet.images[sIndex].type!==null&&a.sheet.images[sIndex].type!=="")){return a.sheet.images[sIndex].url+b+"x"+b+"_trim."+a.sheet.images[sIndex].type}}},destroy:function(){var a=Atoshonetwork.$;this.$oElement.remove();delete this}});if(!Atoshonetwork.Editorial.Hub){Atoshonetwork.Editorial.Hub={}}Atoshonetwork.Editorial.Hub.ExpandedMosaic=function(b,a){Atoshonetwork.Editorial.DOMStorefront.call(this,b,a);var c=this;this.defaultConfiguration={config:{"z-index":"10000",mixpanel:0,container:{padding:2},cell:{margin:1,width:70,height:70},twoRows:(a.config&&a.config.rows&&a.config.rows==2)?true:false}};this.format={6:{2:{layout:[[0,0,1,1,"icon"],[5,1,1,1,"show_all"],[0,1,3,1,"title"],[3,0,2,2],[5,0,1,1],[2,0,1,1],[1,0,1,1]],minItems:1,maxItems:4},3:{layout:[[0,0,1,1,"icon"],[5,2,1,1,"show_all"],[0,1,3,1,"title"],[3,0,2,2],[5,0,1,1],[0,2,1,1],[3,2,1,1],[2,0,1,1],[1,0,1,1],[4,2,1,1],[1,2,1,1],[5,1,1,1],[2,2,1,1]],minItems:3,maxItems:10}},8:{2:{layout:[[0,0,1,1,"icon"],[7,1,1,1,"show_all"],[0,1,3,1,"title"],[4,0,2,2],[7,0,1,1],[3,1,1,1],[2,0,1,1],[6,0,1,1],[1,0,1,1],[6,1,1,1],[3,0,1,1]],minItems:1,maxItems:8},3:{layout:[[0,0,1,1,"icon"],[7,2,1,1,"show_all"],[0,1,3,1,"title"],[2,0,1,1],[0,2,1,1],[3,1,2,2],[5,2,1,1],[6,0,2,2],[4,0,1,1],[1,2,1,1],[5,0,1,1],[1,0,1,1],[6,2,1,1],[2,2,1,1],[5,1,1,1],[3,0,1,1]],minItems:5,maxItems:13}},11:{2:{layout:[[0,0,1,1,"icon"],[10,1,1,1,"show_all"],[0,1,3,1,"title"],[4,0,2,2],[7,0,1,1],[8,0,2,2],[1,0,1,1],[3,1,1,1],[6,1,1,1],[3,0,1,1],[10,0,1,1],[7,1,1,1],[2,0,1,1],[6,0,1,1]],minItems:1,maxItems:11},3:{layout:[[0,0,1,1,"icon"],[10,2,1,1,"show_all"],[0,1,3,1,"title"],[5,0,3,3],[3,0,2,2],[9,0,2,2],[1,0,1,1],[2,2,1,1],[8,0,1,1],[4,2,1,1],[0,2,1,1],[9,2,1,1],[2,0,1,1],[8,2,1,1],[1,2,1,1],[8,1,1,1],[3,2,1,1]],minItems:6,maxItems:14}},14:{2:{layout:[[0,0,1,1,"icon"],[13,1,1,1,"show_all"],[0,1,3,1,"title"],[8,0,2,2],[3,0,2,2],[11,0,2,2],[7,1,1,1],[5,0,2,2],[10,0,1,1],[1,0,1,1],[13,0,1,1],[10,1,1,1],[2,0,1,1],[7,0,1,1]],minItems:1,maxItems:11},3:{layout:[[0,0,1,1,"icon"],[13,2,1,1,"show_all"],[0,1,3,1,"title"],[5,0,3,3],[3,0,2,2],[9,1,2,2],[1,0,1,1],[2,2,1,1],[8,0,1,1],[11,0,2,2],[13,0,1,1],[12,2,1,1],[10,0,1,1],[4,2,1,1],[8,2,1,1],[0,2,1,1],[13,1,1,1],[2,0,1,1],[1,2,1,1],[11,2,1,1],[9,0,1,1],[8,1,1,1],[3,2,1,1]],minItems:7,maxItems:20}}};this.oSelectedFormat=null;this.oMainHubData=a;this.iHubId=a.hubid;this.oHub=null;this.oShop=null;this.iParentWidth=b.parent().width();this.arroProducts=[];this.arriProduct=[];this.arroCollections=[];this.buttonText="";this.iNumCols=this.getNumCols();this.iNumRows=0;this.iCellWidth=null;Atoshonetwork.Getter.Hub(this.iHubId,function(e,d,f){if(e=="success"){Atoshonetwork.loadTranslation(function(){c.oHub=f;var g=Atoshonetwork.$.map(c.oHub.collections,function(j,h){return[j]});Atoshonetwork.Getter.loadArray(g,"Collection",function(j,h){if(j.length){c.init()}},function(k,j,h){if(k=="success"){c.arroCollections.push(h);c.arriProduct=Atoshonetwork.Common.shuffleArray(c.arriProduct.concat(h.products))}})})}})};Atoshonetwork.Editorial.Hub.ExpandedMosaic.onAllProductLoaded=function(a){Atoshonetwork.Event.listen("atosho.editorial.hub.onAllProductLoaded",a)};Atoshonetwork.Editorial.Hub.ExpandedMosaic.prototype=Atoshonetwork.$.extend(true,Object.create(Atoshonetwork.Editorial.DOMStorefront.prototype),{init:function(){var a=this;var d=Atoshonetwork.$;var c=a.$oPlaceHolder;a.$oElement=d("<atoshonetwork>",{id:c.attr("atosho_id"),"class":"atoshonetwork",style:"display: inline-block;"}).css({position:"relative","margin-top":"5px","margin-bottom":"5px","box-sizing":"border-box",border:"solid 3px #b3b3b3"}).css(a.oCSS);a.$oElement.insertAfter(c);var b=this.defaultConfiguration.config.cell;var f=0;a.iNumRows=3;if(a.defaultConfiguration.config.twoRows){a.iNumRows=2}f=a.format[a.iNumCols][a.iNumRows]["maxItems"];this.loadProducts(f,function(g){if(a.iNumRows==3&&g<a.format[a.iNumCols][a.iNumRows]["minItems"]){a.iNumRows=2}a.initGrid(g)});a.$oElement.on("mouseleave",function(){window.setTimeout(function(){if(a.oShop!=null&&a.oShop.isPreviewOpen()){a.oShop.closeShop()}},200)});var e=0;if(a.$oElement.css("zIndex")){e=a.$oElement.css("zIndex")}Atoshonetwork.Event.listen("atosho.shop.onClose",function(){a.$oElement.css({"z-index":e})})},loadProducts:function(c,b){var a=this;Atoshonetwork.Getter.loadArray(a.arriProduct.slice(0,c),"InStockProduct",function(d){a.arroProducts=d;if(a.arroProducts.length<c&&a.arriProduct.length>c){Atoshonetwork.Getter.loadArray(a.arriProduct.slice(c,c+3),"InStockProduct",function(e){a.arroProducts=a.arroProducts.concat(e).slice(0,c);Atoshonetwork.Event.fire("atosho.editorial.hub.onAllProductLoaded",[a.arroProducts.length]);b&&b(a.arroProducts.length)})}else{Atoshonetwork.Event.fire("atosho.editorial.hub.onAllProductLoaded",[a.arroProducts.length]);b&&b(a.arroProducts.length)}})},initGrid:function(h){var e=Atoshonetwork.$;var m=this;var c=this.defaultConfiguration.config.cell;var g=(((c.height-(2*c.margin))/2));this.$oElement.css({"background-color":"#cecece",cursor:"pointer",width:"100%"});var a=m.format[m.iNumCols][m.iNumRows]["layout"];m.iCellWidth=100/m.iNumCols;for(var d=0;d<m.iNumCols*m.iNumRows;d++){this.$oElement.append(e('<div class="atoshonetwork atoshoEmptyHubCell" style="width:'+m.iCellWidth+"%;padding-bottom:"+m.iCellWidth+'%;"></div>'))}for(var f=0;f<m.arroProducts.length+3;f++){if(f<3){switch(a[f][4]){case"icon":var l=e("<div/>").css({width:"100%",height:"100%","background-color":Atoshonetwork.getConfig("Source").customization.backgroundColor,overflow:"auto"}).append('<div id="basket-icon" class="atoshonetwork basket-icon" style="height: 69%;width: 69%;background-color: '+Atoshonetwork.getConfig("Source").customization.storefrontButtonColor+';border-radius: 50%;margin: 15%;opacity: 1;"/>');break;case"show_all":var l=e("<div/>").css({height:"100%","text-align":"center",width:"100%","font-weight":"bold","font-style":"normal","font-size":"10px",color:"#fff","line-height":g+"px","background-color":Atoshonetwork.getConfig("Source").customization.backgroundColor,"float":"left"}).append('<div style="font-size: 10px;text-align:center;vertical-align: middle;">'+Atoshonetwork.oTranslation.get("editorial_shop","SHOW_ALL")+"</div>");var k=e("<div>").css({width:"100%",height:g+"px","vertical-align":"bottom",position:"absolute",bottom:"0px","line-height":g+"px","text-align":"center","font-weight":"bold",color:"#252525","font-size":"10px"}).addClass("atoshoTransparentWhiteBack").html(e("<div>").addClass("atosho-hub-image-arrow-white").css({display:"inline-block","margin-top":(g/2-3)+"px"}));l.append(k);break;case"title":m.buttonText=this.oHub.alias;m.buttonText=m.buttonText.replace("%COLLECTION_0%",m.arroCollections[0].alias);var b=Atoshonetwork.Common.shuffleArray(m.arroCollections);m.buttonText=m.buttonText.replace("%COLLECTION_X%",b[0].alias);var l=e("<div/>").css({height:"100%",display:"table","text-align":"left",width:"100%","font-style":"normal","font-size":"14px",color:"#fff","background-color":Atoshonetwork.getConfig("Source").customization.backgroundColor,"float":"left"}).append('<div style="padding: 0px 12px;display: table-cell;vertical-align: middle;line-height: 1em;">'+m.buttonText+"</div>");l.append('<span id="extraStoreText" style="font-size: 10px;color: #b1b1b1;margin-right: 5px;display: inline-block;height: 12px;position: absolute;right: 0;bottom: 0;">'+Atoshonetwork.getConfig("Source").customization.advertisingText+"</span>");break;default:var l=e("<div/>").css({"background-color":Atoshonetwork.getConfig("Source").customization.backgroundColor}).append(a[f][4]);break}this.addToGrid(a[f][0],a[f][1],a[f][2],a[f][3],l);l.click(function(){m.openShop()})}else{this.addToGrid(a[f][0],a[f][1],a[f][2],a[f][3],this.generateProductIcon(this.arroProducts[f-3],a[f][2]*(m.iCellWidth/100)*m.$oElement.width()))}}},openShop:function(a){var b=this;var c=Atoshonetwork.$;var d=b.$oPlaceHolder.offset().left;if(Atoshonetwork._arrsConfig.shopContainerSelector!=null&&Atoshonetwork._arrsConfig.shopContainerSelector!=""){d=c(Atoshonetwork._arrsConfig.shopContainerSelector).offset().left}Atoshonetwork.Event.fire("atosho.Editorial.Hub.ExpandedMosaic.storefront.onClick");Atoshonetwork.Event.fire("atosho.editorial.storefront.onClick",[a,{type:"Editorial.Mosaic",id:b.oMainHubData.zone.id,name:b.oMainHubData.zone.name,config:{"button-text":b.oHub.alias}}]);if(this.oShop==null){this.oShop=new Atoshonetwork.Shop(b)}b.$oElement.css({"z-index":"421"});this.oShop.openPreviewHub(b.$oElement.offset().top+b.$oElement.outerHeight(),d,b.iHubId,a,b.oMainHubData.zone.id,true);this.oShop.removePreviewCover(true)},generateProductIcon:function(l,u){var k=this;var d=Atoshonetwork.$;var g=500;if(u<81){g=80}else{if(u<120){g=120}else{if(u>120){g=500}}}var j=this.getFirstImage(l,g);var p=d("<div>").css({"background-color":"white","background-size":"contain","background-position":"center","background-repeat":"no-repeat","background-image":"url('"+j+"')",height:"100%",width:"100%"});var r=this.defaultConfiguration.config.cell;var f=Atoshonetwork.getConfig("Source").currency.format;var n=(Atoshonetwork.getConfig("Currency").rates[l.price.currency.id]*l.price.price.current).formatMoney(f.substr(5,1),f.substr(1,1));var o=(((r.height-(2*r.margin))/2));var m=d("<div>").css({width:"100%",height:"68px","vertical-align":"bottom",position:"absolute",bottom:"-30px","text-align":"center","font-weight":"bold",color:"#252525","font-size":"10px"}).addClass("atoshoTransparentWhiteBack");var h=d("<div>").css({height:"31px","padding-top":"8px","font-size":"10px"});var a=d("<div>").css({"line-height":"12px","font-size":"10px",color:"#252525"}).html(Atoshonetwork.getConfig("Currency").iso+" "+n);h.append(a);var b=l.getSavedPercentage();if(b>8){var t=Atoshonetwork.oTranslation.get("editorial_shop","SAVE",{discount:b+"%"});var c=Atoshonetwork.getConfig("Currency");if(c.id==6){t=Atoshonetwork.oTranslation.get("editorial_shop","SAVE",{discount:l.getSavedAmount()})}var e=d("<div>").css({"line-height":"12px","font-size":"10px",color:"#ca4747"}).html(t);h.append(e)}m.append(h);var q=d("<div>").css({"line-height":"28px","margin-right":"5px","margin-left":"5px","border-top":"1px solid rgb(168, 169, 184)","font-size":"10px",color:"#252525"}).html(Atoshonetwork.getConfig("Source").translations.DETAILS_BUTTON).append(d("<div>").addClass("atosho-hub-image-arrow-grey").css({display:"inline-block","margin-left":"5px"}));m.append(q);p.append(m);p.bind("click",function(){k.openShop(l.sheet.id)}).bind("mouseenter",function(){m.animate({bottom:"0px"},100)}).bind("mouseleave",function(){m.animate({bottom:"-30px"},100)});p.hover(function(){d.data(this,"timer",setTimeout(function(){var v=k.$oPlaceHolder.offset().left;if(Atoshonetwork._arrsConfig.shopContainerSelector!=null&&Atoshonetwork._arrsConfig.shopContainerSelector!=""){v=d(Atoshonetwork._arrsConfig.shopContainerSelector).offset().left}if(k.oShop==null){k.oShop=new Atoshonetwork.Shop(k)}k.oShop.openPreviewHub(k.$oElement.offset().top+k.$oElement.outerHeight(),v,k.iHubId,l.sheet.id,k.oMainHubData.zone.id,true)},250))},function(){clearTimeout(d.data(this,"timer"))});return p},addToGrid:function(k,f,g,h,e){var b=this.defaultConfiguration.config.cell;var c=Atoshonetwork.$;var j=this;var a=c("<div>",{id:"atosho-grid-cell"}).css({overflow:"hidden",position:"absolute","line-height":"1em",left:j.iCellWidth*k+"%",top:(1/j.iNumRows)*f*100+"%",width:j.iCellWidth*g+"%","padding-bottom":j.iCellWidth*h+"%"}).appendTo(this.$oElement);var d=c('<div class="atoshonetwork atosho-grid-cell-content" style="position: absolute;top: 2px;left: 1px;bottom: 1px;right: 1px;"></div>').html(e);a.append(d)},getFirstImage:function(a,b){for(sIndex in a.sheet.images){if((a.sheet.images[sIndex].url!==null&&a.sheet.images[sIndex].url!=="")||(a.sheet.images[sIndex].type!==null&&a.sheet.images[sIndex].type!=="")){return a.sheet.images[sIndex].url+b+"x"+b+"_trim."+a.sheet.images[sIndex].type}}},getNumCols:function(){var a=this;var c=Atoshonetwork.$;var b=a.$oPlaceHolder.parent().width();if(b<328){return 0}else{if(b<527){return 6}else{if(b<725){return 8}else{if(b<919){return 11}else{return 14}}}}}});