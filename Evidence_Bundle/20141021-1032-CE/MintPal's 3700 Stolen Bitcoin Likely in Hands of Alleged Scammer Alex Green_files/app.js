(function(){var root=this,previousUnderscore=root._,ArrayProto=Array.prototype,ObjProto=Object.prototype,FuncProto=Function.prototype,push=ArrayProto.push,slice=ArrayProto.slice,concat=ArrayProto.concat,toString=ObjProto.toString,hasOwnProperty=ObjProto.hasOwnProperty,nativeIsArray=Array.isArray,nativeKeys=Object.keys,nativeBind=FuncProto.bind,_=function(obj){return obj instanceof _?obj:this instanceof _?void(this._wrapped=obj):new _(obj)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=_),exports._=_):root._=_,_.VERSION="1.7.0";var createCallback=function(func,context,argCount){if(void 0===context)return func;switch(null==argCount?3:argCount){case 1:return function(value){return func.call(context,value)};case 2:return function(value,other){return func.call(context,value,other)};case 3:return function(value,index,collection){return func.call(context,value,index,collection)};case 4:return function(accumulator,value,index,collection){return func.call(context,accumulator,value,index,collection)}}return function(){return func.apply(context,arguments)}};_.iteratee=function(value,context,argCount){return null==value?_.identity:_.isFunction(value)?createCallback(value,context,argCount):_.isObject(value)?_.matches(value):_.property(value)},_.each=_.forEach=function(obj,iteratee,context){if(null==obj)return obj;iteratee=createCallback(iteratee,context);var i,length=obj.length;if(length===+length)for(i=0;length>i;i++)iteratee(obj[i],i,obj);else{var keys=_.keys(obj);for(i=0,length=keys.length;length>i;i++)iteratee(obj[keys[i]],keys[i],obj)}return obj},_.map=_.collect=function(obj,iteratee,context){if(null==obj)return[];iteratee=_.iteratee(iteratee,context);for(var currentKey,keys=obj.length!==+obj.length&&_.keys(obj),length=(keys||obj).length,results=Array(length),index=0;length>index;index++)currentKey=keys?keys[index]:index,results[index]=iteratee(obj[currentKey],currentKey,obj);return results};var reduceError="Reduce of empty array with no initial value";_.reduce=_.foldl=_.inject=function(obj,iteratee,memo,context){null==obj&&(obj=[]),iteratee=createCallback(iteratee,context,4);var currentKey,keys=obj.length!==+obj.length&&_.keys(obj),length=(keys||obj).length,index=0;if(arguments.length<3){if(!length)throw new TypeError(reduceError);memo=obj[keys?keys[index++]:index++]}for(;length>index;index++)currentKey=keys?keys[index]:index,memo=iteratee(memo,obj[currentKey],currentKey,obj);return memo},_.reduceRight=_.foldr=function(obj,iteratee,memo,context){null==obj&&(obj=[]),iteratee=createCallback(iteratee,context,4);var currentKey,keys=obj.length!==+obj.length&&_.keys(obj),index=(keys||obj).length;if(arguments.length<3){if(!index)throw new TypeError(reduceError);memo=obj[keys?keys[--index]:--index]}for(;index--;)currentKey=keys?keys[index]:index,memo=iteratee(memo,obj[currentKey],currentKey,obj);return memo},_.find=_.detect=function(obj,predicate,context){var result;return predicate=_.iteratee(predicate,context),_.some(obj,function(value,index,list){return predicate(value,index,list)?(result=value,!0):void 0}),result},_.filter=_.select=function(obj,predicate,context){var results=[];return null==obj?results:(predicate=_.iteratee(predicate,context),_.each(obj,function(value,index,list){predicate(value,index,list)&&results.push(value)}),results)},_.reject=function(obj,predicate,context){return _.filter(obj,_.negate(_.iteratee(predicate)),context)},_.every=_.all=function(obj,predicate,context){if(null==obj)return!0;predicate=_.iteratee(predicate,context);var index,currentKey,keys=obj.length!==+obj.length&&_.keys(obj),length=(keys||obj).length;for(index=0;length>index;index++)if(currentKey=keys?keys[index]:index,!predicate(obj[currentKey],currentKey,obj))return!1;return!0},_.some=_.any=function(obj,predicate,context){if(null==obj)return!1;predicate=_.iteratee(predicate,context);var index,currentKey,keys=obj.length!==+obj.length&&_.keys(obj),length=(keys||obj).length;for(index=0;length>index;index++)if(currentKey=keys?keys[index]:index,predicate(obj[currentKey],currentKey,obj))return!0;return!1},_.contains=_.include=function(obj,target){return null==obj?!1:(obj.length!==+obj.length&&(obj=_.values(obj)),_.indexOf(obj,target)>=0)},_.invoke=function(obj,method){var args=slice.call(arguments,2),isFunc=_.isFunction(method);return _.map(obj,function(value){return(isFunc?method:value[method]).apply(value,args)})},_.pluck=function(obj,key){return _.map(obj,_.property(key))},_.where=function(obj,attrs){return _.filter(obj,_.matches(attrs))},_.findWhere=function(obj,attrs){return _.find(obj,_.matches(attrs))},_.max=function(obj,iteratee,context){var value,computed,result=-1/0,lastComputed=-1/0;if(null==iteratee&&null!=obj){obj=obj.length===+obj.length?obj:_.values(obj);for(var i=0,length=obj.length;length>i;i++)value=obj[i],value>result&&(result=value)}else iteratee=_.iteratee(iteratee,context),_.each(obj,function(value,index,list){computed=iteratee(value,index,list),(computed>lastComputed||computed===-1/0&&result===-1/0)&&(result=value,lastComputed=computed)});return result},_.min=function(obj,iteratee,context){var value,computed,result=1/0,lastComputed=1/0;if(null==iteratee&&null!=obj){obj=obj.length===+obj.length?obj:_.values(obj);for(var i=0,length=obj.length;length>i;i++)value=obj[i],result>value&&(result=value)}else iteratee=_.iteratee(iteratee,context),_.each(obj,function(value,index,list){computed=iteratee(value,index,list),(lastComputed>computed||1/0===computed&&1/0===result)&&(result=value,lastComputed=computed)});return result},_.shuffle=function(obj){for(var rand,set=obj&&obj.length===+obj.length?obj:_.values(obj),length=set.length,shuffled=Array(length),index=0;length>index;index++)rand=_.random(0,index),rand!==index&&(shuffled[index]=shuffled[rand]),shuffled[rand]=set[index];return shuffled},_.sample=function(obj,n,guard){return null==n||guard?(obj.length!==+obj.length&&(obj=_.values(obj)),obj[_.random(obj.length-1)]):_.shuffle(obj).slice(0,Math.max(0,n))},_.sortBy=function(obj,iteratee,context){return iteratee=_.iteratee(iteratee,context),_.pluck(_.map(obj,function(value,index,list){return{value:value,index:index,criteria:iteratee(value,index,list)}}).sort(function(left,right){var a=left.criteria,b=right.criteria;if(a!==b){if(a>b||void 0===a)return 1;if(b>a||void 0===b)return-1}return left.index-right.index}),"value")};var group=function(behavior){return function(obj,iteratee,context){var result={};return iteratee=_.iteratee(iteratee,context),_.each(obj,function(value,index){var key=iteratee(value,index,obj);behavior(result,value,key)}),result}};_.groupBy=group(function(result,value,key){_.has(result,key)?result[key].push(value):result[key]=[value]}),_.indexBy=group(function(result,value,key){result[key]=value}),_.countBy=group(function(result,value,key){_.has(result,key)?result[key]++:result[key]=1}),_.sortedIndex=function(array,obj,iteratee,context){iteratee=_.iteratee(iteratee,context,1);for(var value=iteratee(obj),low=0,high=array.length;high>low;){var mid=low+high>>>1;iteratee(array[mid])<value?low=mid+1:high=mid}return low},_.toArray=function(obj){return obj?_.isArray(obj)?slice.call(obj):obj.length===+obj.length?_.map(obj,_.identity):_.values(obj):[]},_.size=function(obj){return null==obj?0:obj.length===+obj.length?obj.length:_.keys(obj).length},_.partition=function(obj,predicate,context){predicate=_.iteratee(predicate,context);var pass=[],fail=[];return _.each(obj,function(value,key,obj){(predicate(value,key,obj)?pass:fail).push(value)}),[pass,fail]},_.first=_.head=_.take=function(array,n,guard){return null==array?void 0:null==n||guard?array[0]:0>n?[]:slice.call(array,0,n)},_.initial=function(array,n,guard){return slice.call(array,0,Math.max(0,array.length-(null==n||guard?1:n)))},_.last=function(array,n,guard){return null==array?void 0:null==n||guard?array[array.length-1]:slice.call(array,Math.max(array.length-n,0))},_.rest=_.tail=_.drop=function(array,n,guard){return slice.call(array,null==n||guard?1:n)},_.compact=function(array){return _.filter(array,_.identity)};var flatten=function(input,shallow,strict,output){if(shallow&&_.every(input,_.isArray))return concat.apply(output,input);for(var i=0,length=input.length;length>i;i++){var value=input[i];_.isArray(value)||_.isArguments(value)?shallow?push.apply(output,value):flatten(value,shallow,strict,output):strict||output.push(value)}return output};_.flatten=function(array,shallow){return flatten(array,shallow,!1,[])},_.without=function(array){return _.difference(array,slice.call(arguments,1))},_.uniq=_.unique=function(array,isSorted,iteratee,context){if(null==array)return[];_.isBoolean(isSorted)||(context=iteratee,iteratee=isSorted,isSorted=!1),null!=iteratee&&(iteratee=_.iteratee(iteratee,context));for(var result=[],seen=[],i=0,length=array.length;length>i;i++){var value=array[i];if(isSorted)i&&seen===value||result.push(value),seen=value;else if(iteratee){var computed=iteratee(value,i,array);_.indexOf(seen,computed)<0&&(seen.push(computed),result.push(value))}else _.indexOf(result,value)<0&&result.push(value)}return result},_.union=function(){return _.uniq(flatten(arguments,!0,!0,[]))},_.intersection=function(array){if(null==array)return[];for(var result=[],argsLength=arguments.length,i=0,length=array.length;length>i;i++){var item=array[i];if(!_.contains(result,item)){for(var j=1;argsLength>j&&_.contains(arguments[j],item);j++);j===argsLength&&result.push(item)}}return result},_.difference=function(array){var rest=flatten(slice.call(arguments,1),!0,!0,[]);return _.filter(array,function(value){return!_.contains(rest,value)})},_.zip=function(array){if(null==array)return[];for(var length=_.max(arguments,"length").length,results=Array(length),i=0;length>i;i++)results[i]=_.pluck(arguments,i);return results},_.object=function(list,values){if(null==list)return{};for(var result={},i=0,length=list.length;length>i;i++)values?result[list[i]]=values[i]:result[list[i][0]]=list[i][1];return result},_.indexOf=function(array,item,isSorted){if(null==array)return-1;var i=0,length=array.length;if(isSorted){if("number"!=typeof isSorted)return i=_.sortedIndex(array,item),array[i]===item?i:-1;i=0>isSorted?Math.max(0,length+isSorted):isSorted}for(;length>i;i++)if(array[i]===item)return i;return-1},_.lastIndexOf=function(array,item,from){if(null==array)return-1;var idx=array.length;for("number"==typeof from&&(idx=0>from?idx+from+1:Math.min(idx,from+1));--idx>=0;)if(array[idx]===item)return idx;return-1},_.range=function(start,stop,step){arguments.length<=1&&(stop=start||0,start=0),step=step||1;for(var length=Math.max(Math.ceil((stop-start)/step),0),range=Array(length),idx=0;length>idx;idx++,start+=step)range[idx]=start;return range};var Ctor=function(){};_.bind=function(func,context){var args,bound;if(nativeBind&&func.bind===nativeBind)return nativeBind.apply(func,slice.call(arguments,1));if(!_.isFunction(func))throw new TypeError("Bind must be called on a function");return args=slice.call(arguments,2),bound=function(){if(!(this instanceof bound))return func.apply(context,args.concat(slice.call(arguments)));Ctor.prototype=func.prototype;var self=new Ctor;Ctor.prototype=null;var result=func.apply(self,args.concat(slice.call(arguments)));return _.isObject(result)?result:self}},_.partial=function(func){var boundArgs=slice.call(arguments,1);return function(){for(var position=0,args=boundArgs.slice(),i=0,length=args.length;length>i;i++)args[i]===_&&(args[i]=arguments[position++]);for(;position<arguments.length;)args.push(arguments[position++]);return func.apply(this,args)}},_.bindAll=function(obj){var i,key,length=arguments.length;if(1>=length)throw new Error("bindAll must be passed function names");for(i=1;length>i;i++)key=arguments[i],obj[key]=_.bind(obj[key],obj);return obj},_.memoize=function(func,hasher){var memoize=function(key){var cache=memoize.cache,address=hasher?hasher.apply(this,arguments):key;return _.has(cache,address)||(cache[address]=func.apply(this,arguments)),cache[address]};return memoize.cache={},memoize},_.delay=function(func,wait){var args=slice.call(arguments,2);return setTimeout(function(){return func.apply(null,args)},wait)},_.defer=function(func){return _.delay.apply(_,[func,1].concat(slice.call(arguments,1)))},_.throttle=function(func,wait,options){var context,args,result,timeout=null,previous=0;options||(options={});var later=function(){previous=options.leading===!1?0:_.now(),timeout=null,result=func.apply(context,args),timeout||(context=args=null)};return function(){var now=_.now();previous||options.leading!==!1||(previous=now);var remaining=wait-(now-previous);return context=this,args=arguments,0>=remaining||remaining>wait?(clearTimeout(timeout),timeout=null,previous=now,result=func.apply(context,args),timeout||(context=args=null)):timeout||options.trailing===!1||(timeout=setTimeout(later,remaining)),result}},_.debounce=function(func,wait,immediate){var timeout,args,context,timestamp,result,later=function(){var last=_.now()-timestamp;wait>last&&last>0?timeout=setTimeout(later,wait-last):(timeout=null,immediate||(result=func.apply(context,args),timeout||(context=args=null)))};return function(){context=this,args=arguments,timestamp=_.now();var callNow=immediate&&!timeout;return timeout||(timeout=setTimeout(later,wait)),callNow&&(result=func.apply(context,args),context=args=null),result}},_.wrap=function(func,wrapper){return _.partial(wrapper,func)},_.negate=function(predicate){return function(){return!predicate.apply(this,arguments)}},_.compose=function(){var args=arguments,start=args.length-1;return function(){for(var i=start,result=args[start].apply(this,arguments);i--;)result=args[i].call(this,result);return result}},_.after=function(times,func){return function(){return--times<1?func.apply(this,arguments):void 0}},_.before=function(times,func){var memo;return function(){return--times>0?memo=func.apply(this,arguments):func=null,memo}},_.once=_.partial(_.before,2),_.keys=function(obj){if(!_.isObject(obj))return[];if(nativeKeys)return nativeKeys(obj);var keys=[];for(var key in obj)_.has(obj,key)&&keys.push(key);return keys},_.values=function(obj){for(var keys=_.keys(obj),length=keys.length,values=Array(length),i=0;length>i;i++)values[i]=obj[keys[i]];return values},_.pairs=function(obj){for(var keys=_.keys(obj),length=keys.length,pairs=Array(length),i=0;length>i;i++)pairs[i]=[keys[i],obj[keys[i]]];return pairs},_.invert=function(obj){for(var result={},keys=_.keys(obj),i=0,length=keys.length;length>i;i++)result[obj[keys[i]]]=keys[i];return result},_.functions=_.methods=function(obj){var names=[];for(var key in obj)_.isFunction(obj[key])&&names.push(key);return names.sort()},_.extend=function(obj){if(!_.isObject(obj))return obj;for(var source,prop,i=1,length=arguments.length;length>i;i++){source=arguments[i];for(prop in source)hasOwnProperty.call(source,prop)&&(obj[prop]=source[prop])}return obj},_.pick=function(obj,iteratee,context){var key,result={};if(null==obj)return result;if(_.isFunction(iteratee)){iteratee=createCallback(iteratee,context);for(key in obj){var value=obj[key];iteratee(value,key,obj)&&(result[key]=value)}}else{var keys=concat.apply([],slice.call(arguments,1));obj=new Object(obj);for(var i=0,length=keys.length;length>i;i++)key=keys[i],key in obj&&(result[key]=obj[key])}return result},_.omit=function(obj,iteratee,context){if(_.isFunction(iteratee))iteratee=_.negate(iteratee);else{var keys=_.map(concat.apply([],slice.call(arguments,1)),String);iteratee=function(value,key){return!_.contains(keys,key)}}return _.pick(obj,iteratee,context)},_.defaults=function(obj){if(!_.isObject(obj))return obj;for(var i=1,length=arguments.length;length>i;i++){var source=arguments[i];for(var prop in source)void 0===obj[prop]&&(obj[prop]=source[prop])}return obj},_.clone=function(obj){return _.isObject(obj)?_.isArray(obj)?obj.slice():_.extend({},obj):obj},_.tap=function(obj,interceptor){return interceptor(obj),obj};var eq=function(a,b,aStack,bStack){if(a===b)return 0!==a||1/a===1/b;if(null==a||null==b)return a===b;a instanceof _&&(a=a._wrapped),b instanceof _&&(b=b._wrapped);var className=toString.call(a);if(className!==toString.call(b))return!1;switch(className){case"[object RegExp]":case"[object String]":return""+a==""+b;case"[object Number]":return+a!==+a?+b!==+b:0===+a?1/+a===1/b:+a===+b;case"[object Date]":case"[object Boolean]":return+a===+b}if("object"!=typeof a||"object"!=typeof b)return!1;for(var length=aStack.length;length--;)if(aStack[length]===a)return bStack[length]===b;var aCtor=a.constructor,bCtor=b.constructor;if(aCtor!==bCtor&&"constructor"in a&&"constructor"in b&&!(_.isFunction(aCtor)&&aCtor instanceof aCtor&&_.isFunction(bCtor)&&bCtor instanceof bCtor))return!1;aStack.push(a),bStack.push(b);var size,result;if("[object Array]"===className){if(size=a.length,result=size===b.length)for(;size--&&(result=eq(a[size],b[size],aStack,bStack)););}else{var key,keys=_.keys(a);if(size=keys.length,result=_.keys(b).length===size)for(;size--&&(key=keys[size],result=_.has(b,key)&&eq(a[key],b[key],aStack,bStack)););}return aStack.pop(),bStack.pop(),result};_.isEqual=function(a,b){return eq(a,b,[],[])},_.isEmpty=function(obj){if(null==obj)return!0;if(_.isArray(obj)||_.isString(obj)||_.isArguments(obj))return 0===obj.length;for(var key in obj)if(_.has(obj,key))return!1;return!0},_.isElement=function(obj){return!(!obj||1!==obj.nodeType)},_.isArray=nativeIsArray||function(obj){return"[object Array]"===toString.call(obj)},_.isObject=function(obj){var type=typeof obj;return"function"===type||"object"===type&&!!obj},_.each(["Arguments","Function","String","Number","Date","RegExp"],function(name){_["is"+name]=function(obj){return toString.call(obj)==="[object "+name+"]"}}),_.isArguments(arguments)||(_.isArguments=function(obj){return _.has(obj,"callee")}),"function"!=typeof/./&&(_.isFunction=function(obj){return"function"==typeof obj||!1}),_.isFinite=function(obj){return isFinite(obj)&&!isNaN(parseFloat(obj))},_.isNaN=function(obj){return _.isNumber(obj)&&obj!==+obj},_.isBoolean=function(obj){return obj===!0||obj===!1||"[object Boolean]"===toString.call(obj)},_.isNull=function(obj){return null===obj},_.isUndefined=function(obj){return void 0===obj},_.has=function(obj,key){return null!=obj&&hasOwnProperty.call(obj,key)},_.noConflict=function(){return root._=previousUnderscore,this},_.identity=function(value){return value},_.constant=function(value){return function(){return value}},_.noop=function(){},_.property=function(key){return function(obj){return obj[key]}},_.matches=function(attrs){var pairs=_.pairs(attrs),length=pairs.length;return function(obj){if(null==obj)return!length;obj=new Object(obj);for(var i=0;length>i;i++){var pair=pairs[i],key=pair[0];if(pair[1]!==obj[key]||!(key in obj))return!1}return!0}},_.times=function(n,iteratee,context){var accum=Array(Math.max(0,n));iteratee=createCallback(iteratee,context,1);for(var i=0;n>i;i++)accum[i]=iteratee(i);return accum},_.random=function(min,max){return null==max&&(max=min,min=0),min+Math.floor(Math.random()*(max-min+1))},_.now=Date.now||function(){return(new Date).getTime()};var escapeMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},unescapeMap=_.invert(escapeMap),createEscaper=function(map){var escaper=function(match){return map[match]},source="(?:"+_.keys(map).join("|")+")",testRegexp=RegExp(source),replaceRegexp=RegExp(source,"g");return function(string){return string=null==string?"":""+string,testRegexp.test(string)?string.replace(replaceRegexp,escaper):string}};_.escape=createEscaper(escapeMap),_.unescape=createEscaper(unescapeMap),_.result=function(object,property){if(null==object)return void 0;var value=object[property];return _.isFunction(value)?object[property]():value};var idCounter=0;_.uniqueId=function(prefix){var id=++idCounter+"";return prefix?prefix+id:id},_.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var noMatch=/(.)^/,escapes={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},escaper=/\\|'|\r|\n|\u2028|\u2029/g,escapeChar=function(match){return"\\"+escapes[match]};_.template=function(text,settings,oldSettings){!settings&&oldSettings&&(settings=oldSettings),settings=_.defaults({},settings,_.templateSettings);var matcher=RegExp([(settings.escape||noMatch).source,(settings.interpolate||noMatch).source,(settings.evaluate||noMatch).source].join("|")+"|$","g"),index=0,source="__p+='";text.replace(matcher,function(match,escape,interpolate,evaluate,offset){return source+=text.slice(index,offset).replace(escaper,escapeChar),index=offset+match.length,escape?source+="'+\n((__t=("+escape+"))==null?'':_.escape(__t))+\n'":interpolate?source+="'+\n((__t=("+interpolate+"))==null?'':__t)+\n'":evaluate&&(source+="';\n"+evaluate+"\n__p+='"),match}),source+="';\n",settings.variable||(source="with(obj||{}){\n"+source+"}\n"),source="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+source+"return __p;\n";try{var render=new Function(settings.variable||"obj","_",source)}catch(e){throw e.source=source,e}var template=function(data){return render.call(this,data,_)},argument=settings.variable||"obj";return template.source="function("+argument+"){\n"+source+"}",template},_.chain=function(obj){var instance=_(obj);return instance._chain=!0,instance};var result=function(obj){return this._chain?_(obj).chain():obj};_.mixin=function(obj){_.each(_.functions(obj),function(name){var func=_[name]=obj[name];_.prototype[name]=function(){var args=[this._wrapped];return push.apply(args,arguments),result.call(this,func.apply(_,args))}})},_.mixin(_),_.each(["pop","push","reverse","shift","sort","splice","unshift"],function(name){var method=ArrayProto[name];_.prototype[name]=function(){var obj=this._wrapped;return method.apply(obj,arguments),"shift"!==name&&"splice"!==name||0!==obj.length||delete obj[0],result.call(this,obj)}}),_.each(["concat","join","slice"],function(name){var method=ArrayProto[name];_.prototype[name]=function(){return result.call(this,method.apply(this._wrapped,arguments))}}),_.prototype.value=function(){return this._wrapped},"function"==typeof define&&define.amd&&define("underscore",[],function(){return _})}).call(this),function(window,undefined){function isArraylike(obj){var length=obj.length,type=jQuery.type(obj);return jQuery.isWindow(obj)?!1:1===obj.nodeType&&length?!0:"array"===type||"function"!==type&&(0===length||"number"==typeof length&&length>0&&length-1 in obj)}function createOptions(options){var object=optionsCache[options]={};return jQuery.each(options.match(core_rnotwhite)||[],function(_,flag){object[flag]=!0}),object}function internalData(elem,name,data,pvt){if(jQuery.acceptData(elem)){var ret,thisCache,internalKey=jQuery.expando,isNode=elem.nodeType,cache=isNode?jQuery.cache:elem,id=isNode?elem[internalKey]:elem[internalKey]&&internalKey;if(id&&cache[id]&&(pvt||cache[id].data)||data!==undefined||"string"!=typeof name)return id||(id=isNode?elem[internalKey]=core_deletedIds.pop()||jQuery.guid++:internalKey),cache[id]||(cache[id]=isNode?{}:{toJSON:jQuery.noop}),("object"==typeof name||"function"==typeof name)&&(pvt?cache[id]=jQuery.extend(cache[id],name):cache[id].data=jQuery.extend(cache[id].data,name)),thisCache=cache[id],pvt||(thisCache.data||(thisCache.data={}),thisCache=thisCache.data),data!==undefined&&(thisCache[jQuery.camelCase(name)]=data),"string"==typeof name?(ret=thisCache[name],null==ret&&(ret=thisCache[jQuery.camelCase(name)])):ret=thisCache,ret}}function internalRemoveData(elem,name,pvt){if(jQuery.acceptData(elem)){var thisCache,i,isNode=elem.nodeType,cache=isNode?jQuery.cache:elem,id=isNode?elem[jQuery.expando]:jQuery.expando;if(cache[id]){if(name&&(thisCache=pvt?cache[id]:cache[id].data)){jQuery.isArray(name)?name=name.concat(jQuery.map(name,jQuery.camelCase)):name in thisCache?name=[name]:(name=jQuery.camelCase(name),name=name in thisCache?[name]:name.split(" ")),i=name.length;for(;i--;)delete thisCache[name[i]];if(pvt?!isEmptyDataObject(thisCache):!jQuery.isEmptyObject(thisCache))return}(pvt||(delete cache[id].data,isEmptyDataObject(cache[id])))&&(isNode?jQuery.cleanData([elem],!0):jQuery.support.deleteExpando||cache!=cache.window?delete cache[id]:cache[id]=null)}}}function dataAttr(elem,key,data){if(data===undefined&&1===elem.nodeType){var name="data-"+key.replace(rmultiDash,"-$1").toLowerCase();if(data=elem.getAttribute(name),"string"==typeof data){try{data="true"===data?!0:"false"===data?!1:"null"===data?null:+data+""===data?+data:rbrace.test(data)?jQuery.parseJSON(data):data}catch(e){}jQuery.data(elem,key,data)}else data=undefined}return data}function isEmptyDataObject(obj){var name;for(name in obj)if(("data"!==name||!jQuery.isEmptyObject(obj[name]))&&"toJSON"!==name)return!1;return!0}function returnTrue(){return!0}function returnFalse(){return!1}function safeActiveElement(){try{return document.activeElement}catch(err){}}function sibling(cur,dir){do cur=cur[dir];while(cur&&1!==cur.nodeType);return cur}function winnow(elements,qualifier,not){if(jQuery.isFunction(qualifier))return jQuery.grep(elements,function(elem,i){return!!qualifier.call(elem,i,elem)!==not});if(qualifier.nodeType)return jQuery.grep(elements,function(elem){return elem===qualifier!==not});if("string"==typeof qualifier){if(isSimple.test(qualifier))return jQuery.filter(qualifier,elements,not);qualifier=jQuery.filter(qualifier,elements)}return jQuery.grep(elements,function(elem){return jQuery.inArray(elem,qualifier)>=0!==not})}function createSafeFragment(document){var list=nodeNames.split("|"),safeFrag=document.createDocumentFragment();if(safeFrag.createElement)for(;list.length;)safeFrag.createElement(list.pop());return safeFrag}function manipulationTarget(elem,content){return jQuery.nodeName(elem,"table")&&jQuery.nodeName(1===content.nodeType?content:content.firstChild,"tr")?elem.getElementsByTagName("tbody")[0]||elem.appendChild(elem.ownerDocument.createElement("tbody")):elem}function disableScript(elem){return elem.type=(null!==jQuery.find.attr(elem,"type"))+"/"+elem.type,elem}function restoreScript(elem){var match=rscriptTypeMasked.exec(elem.type);return match?elem.type=match[1]:elem.removeAttribute("type"),elem}function setGlobalEval(elems,refElements){for(var elem,i=0;null!=(elem=elems[i]);i++)jQuery._data(elem,"globalEval",!refElements||jQuery._data(refElements[i],"globalEval"))}function cloneCopyEvent(src,dest){if(1===dest.nodeType&&jQuery.hasData(src)){var type,i,l,oldData=jQuery._data(src),curData=jQuery._data(dest,oldData),events=oldData.events;if(events){delete curData.handle,curData.events={};for(type in events)for(i=0,l=events[type].length;l>i;i++)jQuery.event.add(dest,type,events[type][i])}curData.data&&(curData.data=jQuery.extend({},curData.data))}}function fixCloneNodeIssues(src,dest){var nodeName,e,data;if(1===dest.nodeType){if(nodeName=dest.nodeName.toLowerCase(),!jQuery.support.noCloneEvent&&dest[jQuery.expando]){data=jQuery._data(dest);for(e in data.events)jQuery.removeEvent(dest,e,data.handle);dest.removeAttribute(jQuery.expando)}"script"===nodeName&&dest.text!==src.text?(disableScript(dest).text=src.text,restoreScript(dest)):"object"===nodeName?(dest.parentNode&&(dest.outerHTML=src.outerHTML),jQuery.support.html5Clone&&src.innerHTML&&!jQuery.trim(dest.innerHTML)&&(dest.innerHTML=src.innerHTML)):"input"===nodeName&&manipulation_rcheckableType.test(src.type)?(dest.defaultChecked=dest.checked=src.checked,dest.value!==src.value&&(dest.value=src.value)):"option"===nodeName?dest.defaultSelected=dest.selected=src.defaultSelected:("input"===nodeName||"textarea"===nodeName)&&(dest.defaultValue=src.defaultValue)}}function getAll(context,tag){var elems,elem,i=0,found=typeof context.getElementsByTagName!==core_strundefined?context.getElementsByTagName(tag||"*"):typeof context.querySelectorAll!==core_strundefined?context.querySelectorAll(tag||"*"):undefined;if(!found)for(found=[],elems=context.childNodes||context;null!=(elem=elems[i]);i++)!tag||jQuery.nodeName(elem,tag)?found.push(elem):jQuery.merge(found,getAll(elem,tag));return tag===undefined||tag&&jQuery.nodeName(context,tag)?jQuery.merge([context],found):found}function fixDefaultChecked(elem){manipulation_rcheckableType.test(elem.type)&&(elem.defaultChecked=elem.checked)}function vendorPropName(style,name){if(name in style)return name;for(var capName=name.charAt(0).toUpperCase()+name.slice(1),origName=name,i=cssPrefixes.length;i--;)if(name=cssPrefixes[i]+capName,name in style)return name;return origName}function isHidden(elem,el){return elem=el||elem,"none"===jQuery.css(elem,"display")||!jQuery.contains(elem.ownerDocument,elem)}function showHide(elements,show){for(var display,elem,hidden,values=[],index=0,length=elements.length;length>index;index++)elem=elements[index],elem.style&&(values[index]=jQuery._data(elem,"olddisplay"),display=elem.style.display,show?(values[index]||"none"!==display||(elem.style.display=""),""===elem.style.display&&isHidden(elem)&&(values[index]=jQuery._data(elem,"olddisplay",css_defaultDisplay(elem.nodeName)))):values[index]||(hidden=isHidden(elem),(display&&"none"!==display||!hidden)&&jQuery._data(elem,"olddisplay",hidden?display:jQuery.css(elem,"display"))));for(index=0;length>index;index++)elem=elements[index],elem.style&&(show&&"none"!==elem.style.display&&""!==elem.style.display||(elem.style.display=show?values[index]||"":"none"));return elements}function setPositiveNumber(elem,value,subtract){var matches=rnumsplit.exec(value);return matches?Math.max(0,matches[1]-(subtract||0))+(matches[2]||"px"):value}function augmentWidthOrHeight(elem,name,extra,isBorderBox,styles){for(var i=extra===(isBorderBox?"border":"content")?4:"width"===name?1:0,val=0;4>i;i+=2)"margin"===extra&&(val+=jQuery.css(elem,extra+cssExpand[i],!0,styles)),isBorderBox?("content"===extra&&(val-=jQuery.css(elem,"padding"+cssExpand[i],!0,styles)),"margin"!==extra&&(val-=jQuery.css(elem,"border"+cssExpand[i]+"Width",!0,styles))):(val+=jQuery.css(elem,"padding"+cssExpand[i],!0,styles),"padding"!==extra&&(val+=jQuery.css(elem,"border"+cssExpand[i]+"Width",!0,styles)));return val}function getWidthOrHeight(elem,name,extra){var valueIsBorderBox=!0,val="width"===name?elem.offsetWidth:elem.offsetHeight,styles=getStyles(elem),isBorderBox=jQuery.support.boxSizing&&"border-box"===jQuery.css(elem,"boxSizing",!1,styles);if(0>=val||null==val){if(val=curCSS(elem,name,styles),(0>val||null==val)&&(val=elem.style[name]),rnumnonpx.test(val))return val;valueIsBorderBox=isBorderBox&&(jQuery.support.boxSizingReliable||val===elem.style[name]),val=parseFloat(val)||0}return val+augmentWidthOrHeight(elem,name,extra||(isBorderBox?"border":"content"),valueIsBorderBox,styles)+"px"}function css_defaultDisplay(nodeName){var doc=document,display=elemdisplay[nodeName];return display||(display=actualDisplay(nodeName,doc),"none"!==display&&display||(iframe=(iframe||jQuery("<iframe frameborder='0' width='0' height='0'/>").css("cssText","display:block !important")).appendTo(doc.documentElement),doc=(iframe[0].contentWindow||iframe[0].contentDocument).document,doc.write("<!doctype html><html><body>"),doc.close(),display=actualDisplay(nodeName,doc),iframe.detach()),elemdisplay[nodeName]=display),display}function actualDisplay(name,doc){var elem=jQuery(doc.createElement(name)).appendTo(doc.body),display=jQuery.css(elem[0],"display");return elem.remove(),display}function buildParams(prefix,obj,traditional,add){var name;if(jQuery.isArray(obj))jQuery.each(obj,function(i,v){traditional||rbracket.test(prefix)?add(prefix,v):buildParams(prefix+"["+("object"==typeof v?i:"")+"]",v,traditional,add)});else if(traditional||"object"!==jQuery.type(obj))add(prefix,obj);else for(name in obj)buildParams(prefix+"["+name+"]",obj[name],traditional,add)}function addToPrefiltersOrTransports(structure){return function(dataTypeExpression,func){"string"!=typeof dataTypeExpression&&(func=dataTypeExpression,dataTypeExpression="*");var dataType,i=0,dataTypes=dataTypeExpression.toLowerCase().match(core_rnotwhite)||[];if(jQuery.isFunction(func))for(;dataType=dataTypes[i++];)"+"===dataType[0]?(dataType=dataType.slice(1)||"*",(structure[dataType]=structure[dataType]||[]).unshift(func)):(structure[dataType]=structure[dataType]||[]).push(func)
}}function inspectPrefiltersOrTransports(structure,options,originalOptions,jqXHR){function inspect(dataType){var selected;return inspected[dataType]=!0,jQuery.each(structure[dataType]||[],function(_,prefilterOrFactory){var dataTypeOrTransport=prefilterOrFactory(options,originalOptions,jqXHR);return"string"!=typeof dataTypeOrTransport||seekingTransport||inspected[dataTypeOrTransport]?seekingTransport?!(selected=dataTypeOrTransport):void 0:(options.dataTypes.unshift(dataTypeOrTransport),inspect(dataTypeOrTransport),!1)}),selected}var inspected={},seekingTransport=structure===transports;return inspect(options.dataTypes[0])||!inspected["*"]&&inspect("*")}function ajaxExtend(target,src){var deep,key,flatOptions=jQuery.ajaxSettings.flatOptions||{};for(key in src)src[key]!==undefined&&((flatOptions[key]?target:deep||(deep={}))[key]=src[key]);return deep&&jQuery.extend(!0,target,deep),target}function ajaxHandleResponses(s,jqXHR,responses){for(var firstDataType,ct,finalDataType,type,contents=s.contents,dataTypes=s.dataTypes;"*"===dataTypes[0];)dataTypes.shift(),ct===undefined&&(ct=s.mimeType||jqXHR.getResponseHeader("Content-Type"));if(ct)for(type in contents)if(contents[type]&&contents[type].test(ct)){dataTypes.unshift(type);break}if(dataTypes[0]in responses)finalDataType=dataTypes[0];else{for(type in responses){if(!dataTypes[0]||s.converters[type+" "+dataTypes[0]]){finalDataType=type;break}firstDataType||(firstDataType=type)}finalDataType=finalDataType||firstDataType}return finalDataType?(finalDataType!==dataTypes[0]&&dataTypes.unshift(finalDataType),responses[finalDataType]):void 0}function ajaxConvert(s,response,jqXHR,isSuccess){var conv2,current,conv,tmp,prev,converters={},dataTypes=s.dataTypes.slice();if(dataTypes[1])for(conv in s.converters)converters[conv.toLowerCase()]=s.converters[conv];for(current=dataTypes.shift();current;)if(s.responseFields[current]&&(jqXHR[s.responseFields[current]]=response),!prev&&isSuccess&&s.dataFilter&&(response=s.dataFilter(response,s.dataType)),prev=current,current=dataTypes.shift())if("*"===current)current=prev;else if("*"!==prev&&prev!==current){if(conv=converters[prev+" "+current]||converters["* "+current],!conv)for(conv2 in converters)if(tmp=conv2.split(" "),tmp[1]===current&&(conv=converters[prev+" "+tmp[0]]||converters["* "+tmp[0]])){conv===!0?conv=converters[conv2]:converters[conv2]!==!0&&(current=tmp[0],dataTypes.unshift(tmp[1]));break}if(conv!==!0)if(conv&&s["throws"])response=conv(response);else try{response=conv(response)}catch(e){return{state:"parsererror",error:conv?e:"No conversion from "+prev+" to "+current}}}return{state:"success",data:response}}function createStandardXHR(){try{return new window.XMLHttpRequest}catch(e){}}function createActiveXHR(){try{return new window.ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}function createFxNow(){return setTimeout(function(){fxNow=undefined}),fxNow=jQuery.now()}function createTween(value,prop,animation){for(var tween,collection=(tweeners[prop]||[]).concat(tweeners["*"]),index=0,length=collection.length;length>index;index++)if(tween=collection[index].call(animation,prop,value))return tween}function Animation(elem,properties,options){var result,stopped,index=0,length=animationPrefilters.length,deferred=jQuery.Deferred().always(function(){delete tick.elem}),tick=function(){if(stopped)return!1;for(var currentTime=fxNow||createFxNow(),remaining=Math.max(0,animation.startTime+animation.duration-currentTime),temp=remaining/animation.duration||0,percent=1-temp,index=0,length=animation.tweens.length;length>index;index++)animation.tweens[index].run(percent);return deferred.notifyWith(elem,[animation,percent,remaining]),1>percent&&length?remaining:(deferred.resolveWith(elem,[animation]),!1)},animation=deferred.promise({elem:elem,props:jQuery.extend({},properties),opts:jQuery.extend(!0,{specialEasing:{}},options),originalProperties:properties,originalOptions:options,startTime:fxNow||createFxNow(),duration:options.duration,tweens:[],createTween:function(prop,end){var tween=jQuery.Tween(elem,animation.opts,prop,end,animation.opts.specialEasing[prop]||animation.opts.easing);return animation.tweens.push(tween),tween},stop:function(gotoEnd){var index=0,length=gotoEnd?animation.tweens.length:0;if(stopped)return this;for(stopped=!0;length>index;index++)animation.tweens[index].run(1);return gotoEnd?deferred.resolveWith(elem,[animation,gotoEnd]):deferred.rejectWith(elem,[animation,gotoEnd]),this}}),props=animation.props;for(propFilter(props,animation.opts.specialEasing);length>index;index++)if(result=animationPrefilters[index].call(animation,elem,props,animation.opts))return result;return jQuery.map(props,createTween,animation),jQuery.isFunction(animation.opts.start)&&animation.opts.start.call(elem,animation),jQuery.fx.timer(jQuery.extend(tick,{elem:elem,anim:animation,queue:animation.opts.queue})),animation.progress(animation.opts.progress).done(animation.opts.done,animation.opts.complete).fail(animation.opts.fail).always(animation.opts.always)}function propFilter(props,specialEasing){var index,name,easing,value,hooks;for(index in props)if(name=jQuery.camelCase(index),easing=specialEasing[name],value=props[index],jQuery.isArray(value)&&(easing=value[1],value=props[index]=value[0]),index!==name&&(props[name]=value,delete props[index]),hooks=jQuery.cssHooks[name],hooks&&"expand"in hooks){value=hooks.expand(value),delete props[name];for(index in value)index in props||(props[index]=value[index],specialEasing[index]=easing)}else specialEasing[name]=easing}function defaultPrefilter(elem,props,opts){var prop,value,toggle,tween,hooks,oldfire,anim=this,orig={},style=elem.style,hidden=elem.nodeType&&isHidden(elem),dataShow=jQuery._data(elem,"fxshow");opts.queue||(hooks=jQuery._queueHooks(elem,"fx"),null==hooks.unqueued&&(hooks.unqueued=0,oldfire=hooks.empty.fire,hooks.empty.fire=function(){hooks.unqueued||oldfire()}),hooks.unqueued++,anim.always(function(){anim.always(function(){hooks.unqueued--,jQuery.queue(elem,"fx").length||hooks.empty.fire()})})),1===elem.nodeType&&("height"in props||"width"in props)&&(opts.overflow=[style.overflow,style.overflowX,style.overflowY],"inline"===jQuery.css(elem,"display")&&"none"===jQuery.css(elem,"float")&&(jQuery.support.inlineBlockNeedsLayout&&"inline"!==css_defaultDisplay(elem.nodeName)?style.zoom=1:style.display="inline-block")),opts.overflow&&(style.overflow="hidden",jQuery.support.shrinkWrapBlocks||anim.always(function(){style.overflow=opts.overflow[0],style.overflowX=opts.overflow[1],style.overflowY=opts.overflow[2]}));for(prop in props)if(value=props[prop],rfxtypes.exec(value)){if(delete props[prop],toggle=toggle||"toggle"===value,value===(hidden?"hide":"show"))continue;orig[prop]=dataShow&&dataShow[prop]||jQuery.style(elem,prop)}if(!jQuery.isEmptyObject(orig)){dataShow?"hidden"in dataShow&&(hidden=dataShow.hidden):dataShow=jQuery._data(elem,"fxshow",{}),toggle&&(dataShow.hidden=!hidden),hidden?jQuery(elem).show():anim.done(function(){jQuery(elem).hide()}),anim.done(function(){var prop;jQuery._removeData(elem,"fxshow");for(prop in orig)jQuery.style(elem,prop,orig[prop])});for(prop in orig)tween=createTween(hidden?dataShow[prop]:0,prop,anim),prop in dataShow||(dataShow[prop]=tween.start,hidden&&(tween.end=tween.start,tween.start="width"===prop||"height"===prop?1:0))}}function Tween(elem,options,prop,end,easing){return new Tween.prototype.init(elem,options,prop,end,easing)}function genFx(type,includeWidth){var which,attrs={height:type},i=0;for(includeWidth=includeWidth?1:0;4>i;i+=2-includeWidth)which=cssExpand[i],attrs["margin"+which]=attrs["padding"+which]=type;return includeWidth&&(attrs.opacity=attrs.width=type),attrs}function getWindow(elem){return jQuery.isWindow(elem)?elem:9===elem.nodeType?elem.defaultView||elem.parentWindow:!1}var readyList,rootjQuery,core_strundefined=typeof undefined,location=window.location,document=window.document,docElem=document.documentElement,_jQuery=window.jQuery,_$=window.$,class2type={},core_deletedIds=[],core_version="1.10.2",core_concat=core_deletedIds.concat,core_push=core_deletedIds.push,core_slice=core_deletedIds.slice,core_indexOf=core_deletedIds.indexOf,core_toString=class2type.toString,core_hasOwn=class2type.hasOwnProperty,core_trim=core_version.trim,jQuery=function(selector,context){return new jQuery.fn.init(selector,context,rootjQuery)},core_pnum=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,core_rnotwhite=/\S+/g,rtrim=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,rquickExpr=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,rsingleTag=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,rvalidchars=/^[\],:{}\s]*$/,rvalidbraces=/(?:^|:|,)(?:\s*\[)+/g,rvalidescape=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,rvalidtokens=/"[^"\\\r\n]*"|true|false|null|-?(?:\d+\.|)\d+(?:[eE][+-]?\d+|)/g,rmsPrefix=/^-ms-/,rdashAlpha=/-([\da-z])/gi,fcamelCase=function(all,letter){return letter.toUpperCase()},completed=function(event){(document.addEventListener||"load"===event.type||"complete"===document.readyState)&&(detach(),jQuery.ready())},detach=function(){document.addEventListener?(document.removeEventListener("DOMContentLoaded",completed,!1),window.removeEventListener("load",completed,!1)):(document.detachEvent("onreadystatechange",completed),window.detachEvent("onload",completed))};jQuery.fn=jQuery.prototype={jquery:core_version,constructor:jQuery,init:function(selector,context,rootjQuery){var match,elem;if(!selector)return this;if("string"==typeof selector){if(match="<"===selector.charAt(0)&&">"===selector.charAt(selector.length-1)&&selector.length>=3?[null,selector,null]:rquickExpr.exec(selector),!match||!match[1]&&context)return!context||context.jquery?(context||rootjQuery).find(selector):this.constructor(context).find(selector);if(match[1]){if(context=context instanceof jQuery?context[0]:context,jQuery.merge(this,jQuery.parseHTML(match[1],context&&context.nodeType?context.ownerDocument||context:document,!0)),rsingleTag.test(match[1])&&jQuery.isPlainObject(context))for(match in context)jQuery.isFunction(this[match])?this[match](context[match]):this.attr(match,context[match]);return this}if(elem=document.getElementById(match[2]),elem&&elem.parentNode){if(elem.id!==match[2])return rootjQuery.find(selector);this.length=1,this[0]=elem}return this.context=document,this.selector=selector,this}return selector.nodeType?(this.context=this[0]=selector,this.length=1,this):jQuery.isFunction(selector)?rootjQuery.ready(selector):(selector.selector!==undefined&&(this.selector=selector.selector,this.context=selector.context),jQuery.makeArray(selector,this))},selector:"",length:0,toArray:function(){return core_slice.call(this)},get:function(num){return null==num?this.toArray():0>num?this[this.length+num]:this[num]},pushStack:function(elems){var ret=jQuery.merge(this.constructor(),elems);return ret.prevObject=this,ret.context=this.context,ret},each:function(callback,args){return jQuery.each(this,callback,args)},ready:function(fn){return jQuery.ready.promise().done(fn),this},slice:function(){return this.pushStack(core_slice.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(i){var len=this.length,j=+i+(0>i?len:0);return this.pushStack(j>=0&&len>j?[this[j]]:[])},map:function(callback){return this.pushStack(jQuery.map(this,function(elem,i){return callback.call(elem,i,elem)}))},end:function(){return this.prevObject||this.constructor(null)},push:core_push,sort:[].sort,splice:[].splice},jQuery.fn.init.prototype=jQuery.fn,jQuery.extend=jQuery.fn.extend=function(){var src,copyIsArray,copy,name,options,clone,target=arguments[0]||{},i=1,length=arguments.length,deep=!1;for("boolean"==typeof target&&(deep=target,target=arguments[1]||{},i=2),"object"==typeof target||jQuery.isFunction(target)||(target={}),length===i&&(target=this,--i);length>i;i++)if(null!=(options=arguments[i]))for(name in options)src=target[name],copy=options[name],target!==copy&&(deep&&copy&&(jQuery.isPlainObject(copy)||(copyIsArray=jQuery.isArray(copy)))?(copyIsArray?(copyIsArray=!1,clone=src&&jQuery.isArray(src)?src:[]):clone=src&&jQuery.isPlainObject(src)?src:{},target[name]=jQuery.extend(deep,clone,copy)):copy!==undefined&&(target[name]=copy));return target},jQuery.extend({expando:"jQuery"+(core_version+Math.random()).replace(/\D/g,""),noConflict:function(deep){return window.$===jQuery&&(window.$=_$),deep&&window.jQuery===jQuery&&(window.jQuery=_jQuery),jQuery},isReady:!1,readyWait:1,holdReady:function(hold){hold?jQuery.readyWait++:jQuery.ready(!0)},ready:function(wait){if(wait===!0?!--jQuery.readyWait:!jQuery.isReady){if(!document.body)return setTimeout(jQuery.ready);jQuery.isReady=!0,wait!==!0&&--jQuery.readyWait>0||(readyList.resolveWith(document,[jQuery]),jQuery.fn.trigger&&jQuery(document).trigger("ready").off("ready"))}},isFunction:function(obj){return"function"===jQuery.type(obj)},isArray:Array.isArray||function(obj){return"array"===jQuery.type(obj)},isWindow:function(obj){return null!=obj&&obj==obj.window},isNumeric:function(obj){return!isNaN(parseFloat(obj))&&isFinite(obj)},type:function(obj){return null==obj?String(obj):"object"==typeof obj||"function"==typeof obj?class2type[core_toString.call(obj)]||"object":typeof obj},isPlainObject:function(obj){var key;if(!obj||"object"!==jQuery.type(obj)||obj.nodeType||jQuery.isWindow(obj))return!1;try{if(obj.constructor&&!core_hasOwn.call(obj,"constructor")&&!core_hasOwn.call(obj.constructor.prototype,"isPrototypeOf"))return!1}catch(e){return!1}if(jQuery.support.ownLast)for(key in obj)return core_hasOwn.call(obj,key);for(key in obj);return key===undefined||core_hasOwn.call(obj,key)},isEmptyObject:function(obj){var name;for(name in obj)return!1;return!0},error:function(msg){throw new Error(msg)},parseHTML:function(data,context,keepScripts){if(!data||"string"!=typeof data)return null;"boolean"==typeof context&&(keepScripts=context,context=!1),context=context||document;var parsed=rsingleTag.exec(data),scripts=!keepScripts&&[];return parsed?[context.createElement(parsed[1])]:(parsed=jQuery.buildFragment([data],context,scripts),scripts&&jQuery(scripts).remove(),jQuery.merge([],parsed.childNodes))},parseJSON:function(data){return window.JSON&&window.JSON.parse?window.JSON.parse(data):null===data?data:"string"==typeof data&&(data=jQuery.trim(data),data&&rvalidchars.test(data.replace(rvalidescape,"@").replace(rvalidtokens,"]").replace(rvalidbraces,"")))?new Function("return "+data)():void jQuery.error("Invalid JSON: "+data)},parseXML:function(data){var xml,tmp;if(!data||"string"!=typeof data)return null;try{window.DOMParser?(tmp=new DOMParser,xml=tmp.parseFromString(data,"text/xml")):(xml=new ActiveXObject("Microsoft.XMLDOM"),xml.async="false",xml.loadXML(data))}catch(e){xml=undefined}return xml&&xml.documentElement&&!xml.getElementsByTagName("parsererror").length||jQuery.error("Invalid XML: "+data),xml},noop:function(){},globalEval:function(data){data&&jQuery.trim(data)&&(window.execScript||function(data){window.eval.call(window,data)})(data)},camelCase:function(string){return string.replace(rmsPrefix,"ms-").replace(rdashAlpha,fcamelCase)},nodeName:function(elem,name){return elem.nodeName&&elem.nodeName.toLowerCase()===name.toLowerCase()},each:function(obj,callback,args){var value,i=0,length=obj.length,isArray=isArraylike(obj);if(args){if(isArray)for(;length>i&&(value=callback.apply(obj[i],args),value!==!1);i++);else for(i in obj)if(value=callback.apply(obj[i],args),value===!1)break}else if(isArray)for(;length>i&&(value=callback.call(obj[i],i,obj[i]),value!==!1);i++);else for(i in obj)if(value=callback.call(obj[i],i,obj[i]),value===!1)break;return obj},trim:core_trim&&!core_trim.call("﻿ ")?function(text){return null==text?"":core_trim.call(text)}:function(text){return null==text?"":(text+"").replace(rtrim,"")},makeArray:function(arr,results){var ret=results||[];return null!=arr&&(isArraylike(Object(arr))?jQuery.merge(ret,"string"==typeof arr?[arr]:arr):core_push.call(ret,arr)),ret},inArray:function(elem,arr,i){var len;if(arr){if(core_indexOf)return core_indexOf.call(arr,elem,i);for(len=arr.length,i=i?0>i?Math.max(0,len+i):i:0;len>i;i++)if(i in arr&&arr[i]===elem)return i}return-1},merge:function(first,second){var l=second.length,i=first.length,j=0;if("number"==typeof l)for(;l>j;j++)first[i++]=second[j];else for(;second[j]!==undefined;)first[i++]=second[j++];return first.length=i,first},grep:function(elems,callback,inv){var retVal,ret=[],i=0,length=elems.length;for(inv=!!inv;length>i;i++)retVal=!!callback(elems[i],i),inv!==retVal&&ret.push(elems[i]);return ret},map:function(elems,callback,arg){var value,i=0,length=elems.length,isArray=isArraylike(elems),ret=[];if(isArray)for(;length>i;i++)value=callback(elems[i],i,arg),null!=value&&(ret[ret.length]=value);else for(i in elems)value=callback(elems[i],i,arg),null!=value&&(ret[ret.length]=value);return core_concat.apply([],ret)},guid:1,proxy:function(fn,context){var args,proxy,tmp;return"string"==typeof context&&(tmp=fn[context],context=fn,fn=tmp),jQuery.isFunction(fn)?(args=core_slice.call(arguments,2),proxy=function(){return fn.apply(context||this,args.concat(core_slice.call(arguments)))},proxy.guid=fn.guid=fn.guid||jQuery.guid++,proxy):undefined},access:function(elems,fn,key,value,chainable,emptyGet,raw){var i=0,length=elems.length,bulk=null==key;if("object"===jQuery.type(key)){chainable=!0;for(i in key)jQuery.access(elems,fn,i,key[i],!0,emptyGet,raw)}else if(value!==undefined&&(chainable=!0,jQuery.isFunction(value)||(raw=!0),bulk&&(raw?(fn.call(elems,value),fn=null):(bulk=fn,fn=function(elem,key,value){return bulk.call(jQuery(elem),value)})),fn))for(;length>i;i++)fn(elems[i],key,raw?value:value.call(elems[i],i,fn(elems[i],key)));return chainable?elems:bulk?fn.call(elems):length?fn(elems[0],key):emptyGet},now:function(){return(new Date).getTime()},swap:function(elem,options,callback,args){var ret,name,old={};for(name in options)old[name]=elem.style[name],elem.style[name]=options[name];ret=callback.apply(elem,args||[]);for(name in options)elem.style[name]=old[name];return ret}}),jQuery.ready.promise=function(obj){if(!readyList)if(readyList=jQuery.Deferred(),"complete"===document.readyState)setTimeout(jQuery.ready);else if(document.addEventListener)document.addEventListener("DOMContentLoaded",completed,!1),window.addEventListener("load",completed,!1);else{document.attachEvent("onreadystatechange",completed),window.attachEvent("onload",completed);var top=!1;try{top=null==window.frameElement&&document.documentElement}catch(e){}top&&top.doScroll&&!function doScrollCheck(){if(!jQuery.isReady){try{top.doScroll("left")}catch(e){return setTimeout(doScrollCheck,50)}detach(),jQuery.ready()}}()}return readyList.promise(obj)},jQuery.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(i,name){class2type["[object "+name+"]"]=name.toLowerCase()}),rootjQuery=jQuery(document),function(window,undefined){function Sizzle(selector,context,results,seed){var match,elem,m,nodeType,i,groups,old,nid,newContext,newSelector;if((context?context.ownerDocument||context:preferredDoc)!==document&&setDocument(context),context=context||document,results=results||[],!selector||"string"!=typeof selector)return results;if(1!==(nodeType=context.nodeType)&&9!==nodeType)return[];if(documentIsHTML&&!seed){if(match=rquickExpr.exec(selector))if(m=match[1]){if(9===nodeType){if(elem=context.getElementById(m),!elem||!elem.parentNode)return results;if(elem.id===m)return results.push(elem),results}else if(context.ownerDocument&&(elem=context.ownerDocument.getElementById(m))&&contains(context,elem)&&elem.id===m)return results.push(elem),results}else{if(match[2])return push.apply(results,context.getElementsByTagName(selector)),results;if((m=match[3])&&support.getElementsByClassName&&context.getElementsByClassName)return push.apply(results,context.getElementsByClassName(m)),results}if(support.qsa&&(!rbuggyQSA||!rbuggyQSA.test(selector))){if(nid=old=expando,newContext=context,newSelector=9===nodeType&&selector,1===nodeType&&"object"!==context.nodeName.toLowerCase()){for(groups=tokenize(selector),(old=context.getAttribute("id"))?nid=old.replace(rescape,"\\$&"):context.setAttribute("id",nid),nid="[id='"+nid+"'] ",i=groups.length;i--;)groups[i]=nid+toSelector(groups[i]);newContext=rsibling.test(selector)&&context.parentNode||context,newSelector=groups.join(",")}if(newSelector)try{return push.apply(results,newContext.querySelectorAll(newSelector)),results}catch(qsaError){}finally{old||context.removeAttribute("id")}}}return select(selector.replace(rtrim,"$1"),context,results,seed)}function createCache(){function cache(key,value){return keys.push(key+=" ")>Expr.cacheLength&&delete cache[keys.shift()],cache[key]=value}var keys=[];return cache}function markFunction(fn){return fn[expando]=!0,fn}function assert(fn){var div=document.createElement("div");try{return!!fn(div)}catch(e){return!1}finally{div.parentNode&&div.parentNode.removeChild(div),div=null}}function addHandle(attrs,handler){for(var arr=attrs.split("|"),i=attrs.length;i--;)Expr.attrHandle[arr[i]]=handler}function siblingCheck(a,b){var cur=b&&a,diff=cur&&1===a.nodeType&&1===b.nodeType&&(~b.sourceIndex||MAX_NEGATIVE)-(~a.sourceIndex||MAX_NEGATIVE);if(diff)return diff;if(cur)for(;cur=cur.nextSibling;)if(cur===b)return-1;return a?1:-1}function createInputPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();return"input"===name&&elem.type===type}}function createButtonPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();return("input"===name||"button"===name)&&elem.type===type}}function createPositionalPseudo(fn){return markFunction(function(argument){return argument=+argument,markFunction(function(seed,matches){for(var j,matchIndexes=fn([],seed.length,argument),i=matchIndexes.length;i--;)seed[j=matchIndexes[i]]&&(seed[j]=!(matches[j]=seed[j]))})})}function setFilters(){}function tokenize(selector,parseOnly){var matched,match,tokens,type,soFar,groups,preFilters,cached=tokenCache[selector+" "];if(cached)return parseOnly?0:cached.slice(0);for(soFar=selector,groups=[],preFilters=Expr.preFilter;soFar;){(!matched||(match=rcomma.exec(soFar)))&&(match&&(soFar=soFar.slice(match[0].length)||soFar),groups.push(tokens=[])),matched=!1,(match=rcombinators.exec(soFar))&&(matched=match.shift(),tokens.push({value:matched,type:match[0].replace(rtrim," ")}),soFar=soFar.slice(matched.length));for(type in Expr.filter)!(match=matchExpr[type].exec(soFar))||preFilters[type]&&!(match=preFilters[type](match))||(matched=match.shift(),tokens.push({value:matched,type:type,matches:match}),soFar=soFar.slice(matched.length));if(!matched)break}return parseOnly?soFar.length:soFar?Sizzle.error(selector):tokenCache(selector,groups).slice(0)}function toSelector(tokens){for(var i=0,len=tokens.length,selector="";len>i;i++)selector+=tokens[i].value;return selector}function addCombinator(matcher,combinator,base){var dir=combinator.dir,checkNonElements=base&&"parentNode"===dir,doneName=done++;return combinator.first?function(elem,context,xml){for(;elem=elem[dir];)if(1===elem.nodeType||checkNonElements)return matcher(elem,context,xml)}:function(elem,context,xml){var data,cache,outerCache,dirkey=dirruns+" "+doneName;if(xml){for(;elem=elem[dir];)if((1===elem.nodeType||checkNonElements)&&matcher(elem,context,xml))return!0}else for(;elem=elem[dir];)if(1===elem.nodeType||checkNonElements)if(outerCache=elem[expando]||(elem[expando]={}),(cache=outerCache[dir])&&cache[0]===dirkey){if((data=cache[1])===!0||data===cachedruns)return data===!0}else if(cache=outerCache[dir]=[dirkey],cache[1]=matcher(elem,context,xml)||cachedruns,cache[1]===!0)return!0}}function elementMatcher(matchers){return matchers.length>1?function(elem,context,xml){for(var i=matchers.length;i--;)if(!matchers[i](elem,context,xml))return!1;return!0}:matchers[0]}function condense(unmatched,map,filter,context,xml){for(var elem,newUnmatched=[],i=0,len=unmatched.length,mapped=null!=map;len>i;i++)(elem=unmatched[i])&&(!filter||filter(elem,context,xml))&&(newUnmatched.push(elem),mapped&&map.push(i));return newUnmatched}function setMatcher(preFilter,selector,matcher,postFilter,postFinder,postSelector){return postFilter&&!postFilter[expando]&&(postFilter=setMatcher(postFilter)),postFinder&&!postFinder[expando]&&(postFinder=setMatcher(postFinder,postSelector)),markFunction(function(seed,results,context,xml){var temp,i,elem,preMap=[],postMap=[],preexisting=results.length,elems=seed||multipleContexts(selector||"*",context.nodeType?[context]:context,[]),matcherIn=!preFilter||!seed&&selector?elems:condense(elems,preMap,preFilter,context,xml),matcherOut=matcher?postFinder||(seed?preFilter:preexisting||postFilter)?[]:results:matcherIn;if(matcher&&matcher(matcherIn,matcherOut,context,xml),postFilter)for(temp=condense(matcherOut,postMap),postFilter(temp,[],context,xml),i=temp.length;i--;)(elem=temp[i])&&(matcherOut[postMap[i]]=!(matcherIn[postMap[i]]=elem));if(seed){if(postFinder||preFilter){if(postFinder){for(temp=[],i=matcherOut.length;i--;)(elem=matcherOut[i])&&temp.push(matcherIn[i]=elem);postFinder(null,matcherOut=[],temp,xml)}for(i=matcherOut.length;i--;)(elem=matcherOut[i])&&(temp=postFinder?indexOf.call(seed,elem):preMap[i])>-1&&(seed[temp]=!(results[temp]=elem))}}else matcherOut=condense(matcherOut===results?matcherOut.splice(preexisting,matcherOut.length):matcherOut),postFinder?postFinder(null,results,matcherOut,xml):push.apply(results,matcherOut)})}function matcherFromTokens(tokens){for(var checkContext,matcher,j,len=tokens.length,leadingRelative=Expr.relative[tokens[0].type],implicitRelative=leadingRelative||Expr.relative[" "],i=leadingRelative?1:0,matchContext=addCombinator(function(elem){return elem===checkContext},implicitRelative,!0),matchAnyContext=addCombinator(function(elem){return indexOf.call(checkContext,elem)>-1},implicitRelative,!0),matchers=[function(elem,context,xml){return!leadingRelative&&(xml||context!==outermostContext)||((checkContext=context).nodeType?matchContext(elem,context,xml):matchAnyContext(elem,context,xml))}];len>i;i++)if(matcher=Expr.relative[tokens[i].type])matchers=[addCombinator(elementMatcher(matchers),matcher)];else{if(matcher=Expr.filter[tokens[i].type].apply(null,tokens[i].matches),matcher[expando]){for(j=++i;len>j&&!Expr.relative[tokens[j].type];j++);return setMatcher(i>1&&elementMatcher(matchers),i>1&&toSelector(tokens.slice(0,i-1).concat({value:" "===tokens[i-2].type?"*":""})).replace(rtrim,"$1"),matcher,j>i&&matcherFromTokens(tokens.slice(i,j)),len>j&&matcherFromTokens(tokens=tokens.slice(j)),len>j&&toSelector(tokens))}matchers.push(matcher)}return elementMatcher(matchers)}function matcherFromGroupMatchers(elementMatchers,setMatchers){var matcherCachedRuns=0,bySet=setMatchers.length>0,byElement=elementMatchers.length>0,superMatcher=function(seed,context,xml,results,expandContext){var elem,j,matcher,setMatched=[],matchedCount=0,i="0",unmatched=seed&&[],outermost=null!=expandContext,contextBackup=outermostContext,elems=seed||byElement&&Expr.find.TAG("*",expandContext&&context.parentNode||context),dirrunsUnique=dirruns+=null==contextBackup?1:Math.random()||.1;for(outermost&&(outermostContext=context!==document&&context,cachedruns=matcherCachedRuns);null!=(elem=elems[i]);i++){if(byElement&&elem){for(j=0;matcher=elementMatchers[j++];)if(matcher(elem,context,xml)){results.push(elem);break}outermost&&(dirruns=dirrunsUnique,cachedruns=++matcherCachedRuns)}bySet&&((elem=!matcher&&elem)&&matchedCount--,seed&&unmatched.push(elem))}if(matchedCount+=i,bySet&&i!==matchedCount){for(j=0;matcher=setMatchers[j++];)matcher(unmatched,setMatched,context,xml);if(seed){if(matchedCount>0)for(;i--;)unmatched[i]||setMatched[i]||(setMatched[i]=pop.call(results));setMatched=condense(setMatched)}push.apply(results,setMatched),outermost&&!seed&&setMatched.length>0&&matchedCount+setMatchers.length>1&&Sizzle.uniqueSort(results)}return outermost&&(dirruns=dirrunsUnique,outermostContext=contextBackup),unmatched};return bySet?markFunction(superMatcher):superMatcher}function multipleContexts(selector,contexts,results){for(var i=0,len=contexts.length;len>i;i++)Sizzle(selector,contexts[i],results);return results}function select(selector,context,results,seed){var i,tokens,token,type,find,match=tokenize(selector);if(!seed&&1===match.length){if(tokens=match[0]=match[0].slice(0),tokens.length>2&&"ID"===(token=tokens[0]).type&&support.getById&&9===context.nodeType&&documentIsHTML&&Expr.relative[tokens[1].type]){if(context=(Expr.find.ID(token.matches[0].replace(runescape,funescape),context)||[])[0],!context)return results;selector=selector.slice(tokens.shift().value.length)}for(i=matchExpr.needsContext.test(selector)?0:tokens.length;i--&&(token=tokens[i],!Expr.relative[type=token.type]);)if((find=Expr.find[type])&&(seed=find(token.matches[0].replace(runescape,funescape),rsibling.test(tokens[0].type)&&context.parentNode||context))){if(tokens.splice(i,1),selector=seed.length&&toSelector(tokens),!selector)return push.apply(results,seed),results;break}}return compile(selector,match)(seed,context,!documentIsHTML,results,rsibling.test(selector)),results}var i,support,cachedruns,Expr,getText,isXML,compile,outermostContext,sortInput,setDocument,document,docElem,documentIsHTML,rbuggyQSA,rbuggyMatches,matches,contains,expando="sizzle"+-new Date,preferredDoc=window.document,dirruns=0,done=0,classCache=createCache(),tokenCache=createCache(),compilerCache=createCache(),hasDuplicate=!1,sortOrder=function(a,b){return a===b?(hasDuplicate=!0,0):0},strundefined=typeof undefined,MAX_NEGATIVE=1<<31,hasOwn={}.hasOwnProperty,arr=[],pop=arr.pop,push_native=arr.push,push=arr.push,slice=arr.slice,indexOf=arr.indexOf||function(elem){for(var i=0,len=this.length;len>i;i++)if(this[i]===elem)return i;return-1},booleans="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",whitespace="[\\x20\\t\\r\\n\\f]",characterEncoding="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",identifier=characterEncoding.replace("w","w#"),attributes="\\["+whitespace+"*("+characterEncoding+")"+whitespace+"*(?:([*^$|!~]?=)"+whitespace+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+identifier+")|)|)"+whitespace+"*\\]",pseudos=":("+characterEncoding+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+attributes.replace(3,8)+")*)|.*)\\)|)",rtrim=new RegExp("^"+whitespace+"+|((?:^|[^\\\\])(?:\\\\.)*)"+whitespace+"+$","g"),rcomma=new RegExp("^"+whitespace+"*,"+whitespace+"*"),rcombinators=new RegExp("^"+whitespace+"*([>+~]|"+whitespace+")"+whitespace+"*"),rsibling=new RegExp(whitespace+"*[+~]"),rattributeQuotes=new RegExp("="+whitespace+"*([^\\]'\"]*)"+whitespace+"*\\]","g"),rpseudo=new RegExp(pseudos),ridentifier=new RegExp("^"+identifier+"$"),matchExpr={ID:new RegExp("^#("+characterEncoding+")"),CLASS:new RegExp("^\\.("+characterEncoding+")"),TAG:new RegExp("^("+characterEncoding.replace("w","w*")+")"),ATTR:new RegExp("^"+attributes),PSEUDO:new RegExp("^"+pseudos),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+whitespace+"*(even|odd|(([+-]|)(\\d*)n|)"+whitespace+"*(?:([+-]|)"+whitespace+"*(\\d+)|))"+whitespace+"*\\)|)","i"),bool:new RegExp("^(?:"+booleans+")$","i"),needsContext:new RegExp("^"+whitespace+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+whitespace+"*((?:-\\d)?\\d*)"+whitespace+"*\\)|)(?=[^-]|$)","i")},rnative=/^[^{]+\{\s*\[native \w/,rquickExpr=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,rinputs=/^(?:input|select|textarea|button)$/i,rheader=/^h\d$/i,rescape=/'|\\/g,runescape=new RegExp("\\\\([\\da-f]{1,6}"+whitespace+"?|("+whitespace+")|.)","ig"),funescape=function(_,escaped,escapedWhitespace){var high="0x"+escaped-65536;return high!==high||escapedWhitespace?escaped:0>high?String.fromCharCode(high+65536):String.fromCharCode(high>>10|55296,1023&high|56320)};try{push.apply(arr=slice.call(preferredDoc.childNodes),preferredDoc.childNodes),arr[preferredDoc.childNodes.length].nodeType}catch(e){push={apply:arr.length?function(target,els){push_native.apply(target,slice.call(els))}:function(target,els){for(var j=target.length,i=0;target[j++]=els[i++];);target.length=j-1
}}}isXML=Sizzle.isXML=function(elem){var documentElement=elem&&(elem.ownerDocument||elem).documentElement;return documentElement?"HTML"!==documentElement.nodeName:!1},support=Sizzle.support={},setDocument=Sizzle.setDocument=function(node){var doc=node?node.ownerDocument||node:preferredDoc,parent=doc.defaultView;return doc!==document&&9===doc.nodeType&&doc.documentElement?(document=doc,docElem=doc.documentElement,documentIsHTML=!isXML(doc),parent&&parent.attachEvent&&parent!==parent.top&&parent.attachEvent("onbeforeunload",function(){setDocument()}),support.attributes=assert(function(div){return div.className="i",!div.getAttribute("className")}),support.getElementsByTagName=assert(function(div){return div.appendChild(doc.createComment("")),!div.getElementsByTagName("*").length}),support.getElementsByClassName=assert(function(div){return div.innerHTML="<div class='a'></div><div class='a i'></div>",div.firstChild.className="i",2===div.getElementsByClassName("i").length}),support.getById=assert(function(div){return docElem.appendChild(div).id=expando,!doc.getElementsByName||!doc.getElementsByName(expando).length}),support.getById?(Expr.find.ID=function(id,context){if(typeof context.getElementById!==strundefined&&documentIsHTML){var m=context.getElementById(id);return m&&m.parentNode?[m]:[]}},Expr.filter.ID=function(id){var attrId=id.replace(runescape,funescape);return function(elem){return elem.getAttribute("id")===attrId}}):(delete Expr.find.ID,Expr.filter.ID=function(id){var attrId=id.replace(runescape,funescape);return function(elem){var node=typeof elem.getAttributeNode!==strundefined&&elem.getAttributeNode("id");return node&&node.value===attrId}}),Expr.find.TAG=support.getElementsByTagName?function(tag,context){return typeof context.getElementsByTagName!==strundefined?context.getElementsByTagName(tag):void 0}:function(tag,context){var elem,tmp=[],i=0,results=context.getElementsByTagName(tag);if("*"===tag){for(;elem=results[i++];)1===elem.nodeType&&tmp.push(elem);return tmp}return results},Expr.find.CLASS=support.getElementsByClassName&&function(className,context){return typeof context.getElementsByClassName!==strundefined&&documentIsHTML?context.getElementsByClassName(className):void 0},rbuggyMatches=[],rbuggyQSA=[],(support.qsa=rnative.test(doc.querySelectorAll))&&(assert(function(div){div.innerHTML="<select><option selected=''></option></select>",div.querySelectorAll("[selected]").length||rbuggyQSA.push("\\["+whitespace+"*(?:value|"+booleans+")"),div.querySelectorAll(":checked").length||rbuggyQSA.push(":checked")}),assert(function(div){var input=doc.createElement("input");input.setAttribute("type","hidden"),div.appendChild(input).setAttribute("t",""),div.querySelectorAll("[t^='']").length&&rbuggyQSA.push("[*^$]="+whitespace+"*(?:''|\"\")"),div.querySelectorAll(":enabled").length||rbuggyQSA.push(":enabled",":disabled"),div.querySelectorAll("*,:x"),rbuggyQSA.push(",.*:")})),(support.matchesSelector=rnative.test(matches=docElem.webkitMatchesSelector||docElem.mozMatchesSelector||docElem.oMatchesSelector||docElem.msMatchesSelector))&&assert(function(div){support.disconnectedMatch=matches.call(div,"div"),matches.call(div,"[s!='']:x"),rbuggyMatches.push("!=",pseudos)}),rbuggyQSA=rbuggyQSA.length&&new RegExp(rbuggyQSA.join("|")),rbuggyMatches=rbuggyMatches.length&&new RegExp(rbuggyMatches.join("|")),contains=rnative.test(docElem.contains)||docElem.compareDocumentPosition?function(a,b){var adown=9===a.nodeType?a.documentElement:a,bup=b&&b.parentNode;return a===bup||!(!bup||1!==bup.nodeType||!(adown.contains?adown.contains(bup):a.compareDocumentPosition&&16&a.compareDocumentPosition(bup)))}:function(a,b){if(b)for(;b=b.parentNode;)if(b===a)return!0;return!1},sortOrder=docElem.compareDocumentPosition?function(a,b){if(a===b)return hasDuplicate=!0,0;var compare=b.compareDocumentPosition&&a.compareDocumentPosition&&a.compareDocumentPosition(b);return compare?1&compare||!support.sortDetached&&b.compareDocumentPosition(a)===compare?a===doc||contains(preferredDoc,a)?-1:b===doc||contains(preferredDoc,b)?1:sortInput?indexOf.call(sortInput,a)-indexOf.call(sortInput,b):0:4&compare?-1:1:a.compareDocumentPosition?-1:1}:function(a,b){var cur,i=0,aup=a.parentNode,bup=b.parentNode,ap=[a],bp=[b];if(a===b)return hasDuplicate=!0,0;if(!aup||!bup)return a===doc?-1:b===doc?1:aup?-1:bup?1:sortInput?indexOf.call(sortInput,a)-indexOf.call(sortInput,b):0;if(aup===bup)return siblingCheck(a,b);for(cur=a;cur=cur.parentNode;)ap.unshift(cur);for(cur=b;cur=cur.parentNode;)bp.unshift(cur);for(;ap[i]===bp[i];)i++;return i?siblingCheck(ap[i],bp[i]):ap[i]===preferredDoc?-1:bp[i]===preferredDoc?1:0},doc):document},Sizzle.matches=function(expr,elements){return Sizzle(expr,null,null,elements)},Sizzle.matchesSelector=function(elem,expr){if((elem.ownerDocument||elem)!==document&&setDocument(elem),expr=expr.replace(rattributeQuotes,"='$1']"),!(!support.matchesSelector||!documentIsHTML||rbuggyMatches&&rbuggyMatches.test(expr)||rbuggyQSA&&rbuggyQSA.test(expr)))try{var ret=matches.call(elem,expr);if(ret||support.disconnectedMatch||elem.document&&11!==elem.document.nodeType)return ret}catch(e){}return Sizzle(expr,document,null,[elem]).length>0},Sizzle.contains=function(context,elem){return(context.ownerDocument||context)!==document&&setDocument(context),contains(context,elem)},Sizzle.attr=function(elem,name){(elem.ownerDocument||elem)!==document&&setDocument(elem);var fn=Expr.attrHandle[name.toLowerCase()],val=fn&&hasOwn.call(Expr.attrHandle,name.toLowerCase())?fn(elem,name,!documentIsHTML):undefined;return val===undefined?support.attributes||!documentIsHTML?elem.getAttribute(name):(val=elem.getAttributeNode(name))&&val.specified?val.value:null:val},Sizzle.error=function(msg){throw new Error("Syntax error, unrecognized expression: "+msg)},Sizzle.uniqueSort=function(results){var elem,duplicates=[],j=0,i=0;if(hasDuplicate=!support.detectDuplicates,sortInput=!support.sortStable&&results.slice(0),results.sort(sortOrder),hasDuplicate){for(;elem=results[i++];)elem===results[i]&&(j=duplicates.push(i));for(;j--;)results.splice(duplicates[j],1)}return results},getText=Sizzle.getText=function(elem){var node,ret="",i=0,nodeType=elem.nodeType;if(nodeType){if(1===nodeType||9===nodeType||11===nodeType){if("string"==typeof elem.textContent)return elem.textContent;for(elem=elem.firstChild;elem;elem=elem.nextSibling)ret+=getText(elem)}else if(3===nodeType||4===nodeType)return elem.nodeValue}else for(;node=elem[i];i++)ret+=getText(node);return ret},Expr=Sizzle.selectors={cacheLength:50,createPseudo:markFunction,match:matchExpr,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(match){return match[1]=match[1].replace(runescape,funescape),match[3]=(match[4]||match[5]||"").replace(runescape,funescape),"~="===match[2]&&(match[3]=" "+match[3]+" "),match.slice(0,4)},CHILD:function(match){return match[1]=match[1].toLowerCase(),"nth"===match[1].slice(0,3)?(match[3]||Sizzle.error(match[0]),match[4]=+(match[4]?match[5]+(match[6]||1):2*("even"===match[3]||"odd"===match[3])),match[5]=+(match[7]+match[8]||"odd"===match[3])):match[3]&&Sizzle.error(match[0]),match},PSEUDO:function(match){var excess,unquoted=!match[5]&&match[2];return matchExpr.CHILD.test(match[0])?null:(match[3]&&match[4]!==undefined?match[2]=match[4]:unquoted&&rpseudo.test(unquoted)&&(excess=tokenize(unquoted,!0))&&(excess=unquoted.indexOf(")",unquoted.length-excess)-unquoted.length)&&(match[0]=match[0].slice(0,excess),match[2]=unquoted.slice(0,excess)),match.slice(0,3))}},filter:{TAG:function(nodeNameSelector){var nodeName=nodeNameSelector.replace(runescape,funescape).toLowerCase();return"*"===nodeNameSelector?function(){return!0}:function(elem){return elem.nodeName&&elem.nodeName.toLowerCase()===nodeName}},CLASS:function(className){var pattern=classCache[className+" "];return pattern||(pattern=new RegExp("(^|"+whitespace+")"+className+"("+whitespace+"|$)"))&&classCache(className,function(elem){return pattern.test("string"==typeof elem.className&&elem.className||typeof elem.getAttribute!==strundefined&&elem.getAttribute("class")||"")})},ATTR:function(name,operator,check){return function(elem){var result=Sizzle.attr(elem,name);return null==result?"!="===operator:operator?(result+="","="===operator?result===check:"!="===operator?result!==check:"^="===operator?check&&0===result.indexOf(check):"*="===operator?check&&result.indexOf(check)>-1:"$="===operator?check&&result.slice(-check.length)===check:"~="===operator?(" "+result+" ").indexOf(check)>-1:"|="===operator?result===check||result.slice(0,check.length+1)===check+"-":!1):!0}},CHILD:function(type,what,argument,first,last){var simple="nth"!==type.slice(0,3),forward="last"!==type.slice(-4),ofType="of-type"===what;return 1===first&&0===last?function(elem){return!!elem.parentNode}:function(elem,context,xml){var cache,outerCache,node,diff,nodeIndex,start,dir=simple!==forward?"nextSibling":"previousSibling",parent=elem.parentNode,name=ofType&&elem.nodeName.toLowerCase(),useCache=!xml&&!ofType;if(parent){if(simple){for(;dir;){for(node=elem;node=node[dir];)if(ofType?node.nodeName.toLowerCase()===name:1===node.nodeType)return!1;start=dir="only"===type&&!start&&"nextSibling"}return!0}if(start=[forward?parent.firstChild:parent.lastChild],forward&&useCache){for(outerCache=parent[expando]||(parent[expando]={}),cache=outerCache[type]||[],nodeIndex=cache[0]===dirruns&&cache[1],diff=cache[0]===dirruns&&cache[2],node=nodeIndex&&parent.childNodes[nodeIndex];node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop();)if(1===node.nodeType&&++diff&&node===elem){outerCache[type]=[dirruns,nodeIndex,diff];break}}else if(useCache&&(cache=(elem[expando]||(elem[expando]={}))[type])&&cache[0]===dirruns)diff=cache[1];else for(;(node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop())&&((ofType?node.nodeName.toLowerCase()!==name:1!==node.nodeType)||!++diff||(useCache&&((node[expando]||(node[expando]={}))[type]=[dirruns,diff]),node!==elem)););return diff-=last,diff===first||diff%first===0&&diff/first>=0}}},PSEUDO:function(pseudo,argument){var args,fn=Expr.pseudos[pseudo]||Expr.setFilters[pseudo.toLowerCase()]||Sizzle.error("unsupported pseudo: "+pseudo);return fn[expando]?fn(argument):fn.length>1?(args=[pseudo,pseudo,"",argument],Expr.setFilters.hasOwnProperty(pseudo.toLowerCase())?markFunction(function(seed,matches){for(var idx,matched=fn(seed,argument),i=matched.length;i--;)idx=indexOf.call(seed,matched[i]),seed[idx]=!(matches[idx]=matched[i])}):function(elem){return fn(elem,0,args)}):fn}},pseudos:{not:markFunction(function(selector){var input=[],results=[],matcher=compile(selector.replace(rtrim,"$1"));return matcher[expando]?markFunction(function(seed,matches,context,xml){for(var elem,unmatched=matcher(seed,null,xml,[]),i=seed.length;i--;)(elem=unmatched[i])&&(seed[i]=!(matches[i]=elem))}):function(elem,context,xml){return input[0]=elem,matcher(input,null,xml,results),!results.pop()}}),has:markFunction(function(selector){return function(elem){return Sizzle(selector,elem).length>0}}),contains:markFunction(function(text){return function(elem){return(elem.textContent||elem.innerText||getText(elem)).indexOf(text)>-1}}),lang:markFunction(function(lang){return ridentifier.test(lang||"")||Sizzle.error("unsupported lang: "+lang),lang=lang.replace(runescape,funescape).toLowerCase(),function(elem){var elemLang;do if(elemLang=documentIsHTML?elem.lang:elem.getAttribute("xml:lang")||elem.getAttribute("lang"))return elemLang=elemLang.toLowerCase(),elemLang===lang||0===elemLang.indexOf(lang+"-");while((elem=elem.parentNode)&&1===elem.nodeType);return!1}}),target:function(elem){var hash=window.location&&window.location.hash;return hash&&hash.slice(1)===elem.id},root:function(elem){return elem===docElem},focus:function(elem){return elem===document.activeElement&&(!document.hasFocus||document.hasFocus())&&!!(elem.type||elem.href||~elem.tabIndex)},enabled:function(elem){return elem.disabled===!1},disabled:function(elem){return elem.disabled===!0},checked:function(elem){var nodeName=elem.nodeName.toLowerCase();return"input"===nodeName&&!!elem.checked||"option"===nodeName&&!!elem.selected},selected:function(elem){return elem.parentNode&&elem.parentNode.selectedIndex,elem.selected===!0},empty:function(elem){for(elem=elem.firstChild;elem;elem=elem.nextSibling)if(elem.nodeName>"@"||3===elem.nodeType||4===elem.nodeType)return!1;return!0},parent:function(elem){return!Expr.pseudos.empty(elem)},header:function(elem){return rheader.test(elem.nodeName)},input:function(elem){return rinputs.test(elem.nodeName)},button:function(elem){var name=elem.nodeName.toLowerCase();return"input"===name&&"button"===elem.type||"button"===name},text:function(elem){var attr;return"input"===elem.nodeName.toLowerCase()&&"text"===elem.type&&(null==(attr=elem.getAttribute("type"))||attr.toLowerCase()===elem.type)},first:createPositionalPseudo(function(){return[0]}),last:createPositionalPseudo(function(matchIndexes,length){return[length-1]}),eq:createPositionalPseudo(function(matchIndexes,length,argument){return[0>argument?argument+length:argument]}),even:createPositionalPseudo(function(matchIndexes,length){for(var i=0;length>i;i+=2)matchIndexes.push(i);return matchIndexes}),odd:createPositionalPseudo(function(matchIndexes,length){for(var i=1;length>i;i+=2)matchIndexes.push(i);return matchIndexes}),lt:createPositionalPseudo(function(matchIndexes,length,argument){for(var i=0>argument?argument+length:argument;--i>=0;)matchIndexes.push(i);return matchIndexes}),gt:createPositionalPseudo(function(matchIndexes,length,argument){for(var i=0>argument?argument+length:argument;++i<length;)matchIndexes.push(i);return matchIndexes})}},Expr.pseudos.nth=Expr.pseudos.eq;for(i in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})Expr.pseudos[i]=createInputPseudo(i);for(i in{submit:!0,reset:!0})Expr.pseudos[i]=createButtonPseudo(i);setFilters.prototype=Expr.filters=Expr.pseudos,Expr.setFilters=new setFilters,compile=Sizzle.compile=function(selector,group){var i,setMatchers=[],elementMatchers=[],cached=compilerCache[selector+" "];if(!cached){for(group||(group=tokenize(selector)),i=group.length;i--;)cached=matcherFromTokens(group[i]),cached[expando]?setMatchers.push(cached):elementMatchers.push(cached);cached=compilerCache(selector,matcherFromGroupMatchers(elementMatchers,setMatchers))}return cached},support.sortStable=expando.split("").sort(sortOrder).join("")===expando,support.detectDuplicates=hasDuplicate,setDocument(),support.sortDetached=assert(function(div1){return 1&div1.compareDocumentPosition(document.createElement("div"))}),assert(function(div){return div.innerHTML="<a href='#'></a>","#"===div.firstChild.getAttribute("href")})||addHandle("type|href|height|width",function(elem,name,isXML){return isXML?void 0:elem.getAttribute(name,"type"===name.toLowerCase()?1:2)}),support.attributes&&assert(function(div){return div.innerHTML="<input/>",div.firstChild.setAttribute("value",""),""===div.firstChild.getAttribute("value")})||addHandle("value",function(elem,name,isXML){return isXML||"input"!==elem.nodeName.toLowerCase()?void 0:elem.defaultValue}),assert(function(div){return null==div.getAttribute("disabled")})||addHandle(booleans,function(elem,name,isXML){var val;return isXML?void 0:(val=elem.getAttributeNode(name))&&val.specified?val.value:elem[name]===!0?name.toLowerCase():null}),jQuery.find=Sizzle,jQuery.expr=Sizzle.selectors,jQuery.expr[":"]=jQuery.expr.pseudos,jQuery.unique=Sizzle.uniqueSort,jQuery.text=Sizzle.getText,jQuery.isXMLDoc=Sizzle.isXML,jQuery.contains=Sizzle.contains}(window);var optionsCache={};jQuery.Callbacks=function(options){options="string"==typeof options?optionsCache[options]||createOptions(options):jQuery.extend({},options);var firing,memory,fired,firingLength,firingIndex,firingStart,list=[],stack=!options.once&&[],fire=function(data){for(memory=options.memory&&data,fired=!0,firingIndex=firingStart||0,firingStart=0,firingLength=list.length,firing=!0;list&&firingLength>firingIndex;firingIndex++)if(list[firingIndex].apply(data[0],data[1])===!1&&options.stopOnFalse){memory=!1;break}firing=!1,list&&(stack?stack.length&&fire(stack.shift()):memory?list=[]:self.disable())},self={add:function(){if(list){var start=list.length;!function add(args){jQuery.each(args,function(_,arg){var type=jQuery.type(arg);"function"===type?options.unique&&self.has(arg)||list.push(arg):arg&&arg.length&&"string"!==type&&add(arg)})}(arguments),firing?firingLength=list.length:memory&&(firingStart=start,fire(memory))}return this},remove:function(){return list&&jQuery.each(arguments,function(_,arg){for(var index;(index=jQuery.inArray(arg,list,index))>-1;)list.splice(index,1),firing&&(firingLength>=index&&firingLength--,firingIndex>=index&&firingIndex--)}),this},has:function(fn){return fn?jQuery.inArray(fn,list)>-1:!(!list||!list.length)},empty:function(){return list=[],firingLength=0,this},disable:function(){return list=stack=memory=undefined,this},disabled:function(){return!list},lock:function(){return stack=undefined,memory||self.disable(),this},locked:function(){return!stack},fireWith:function(context,args){return!list||fired&&!stack||(args=args||[],args=[context,args.slice?args.slice():args],firing?stack.push(args):fire(args)),this},fire:function(){return self.fireWith(this,arguments),this},fired:function(){return!!fired}};return self},jQuery.extend({Deferred:function(func){var tuples=[["resolve","done",jQuery.Callbacks("once memory"),"resolved"],["reject","fail",jQuery.Callbacks("once memory"),"rejected"],["notify","progress",jQuery.Callbacks("memory")]],state="pending",promise={state:function(){return state},always:function(){return deferred.done(arguments).fail(arguments),this},then:function(){var fns=arguments;return jQuery.Deferred(function(newDefer){jQuery.each(tuples,function(i,tuple){var action=tuple[0],fn=jQuery.isFunction(fns[i])&&fns[i];deferred[tuple[1]](function(){var returned=fn&&fn.apply(this,arguments);returned&&jQuery.isFunction(returned.promise)?returned.promise().done(newDefer.resolve).fail(newDefer.reject).progress(newDefer.notify):newDefer[action+"With"](this===promise?newDefer.promise():this,fn?[returned]:arguments)})}),fns=null}).promise()},promise:function(obj){return null!=obj?jQuery.extend(obj,promise):promise}},deferred={};return promise.pipe=promise.then,jQuery.each(tuples,function(i,tuple){var list=tuple[2],stateString=tuple[3];promise[tuple[1]]=list.add,stateString&&list.add(function(){state=stateString},tuples[1^i][2].disable,tuples[2][2].lock),deferred[tuple[0]]=function(){return deferred[tuple[0]+"With"](this===deferred?promise:this,arguments),this},deferred[tuple[0]+"With"]=list.fireWith}),promise.promise(deferred),func&&func.call(deferred,deferred),deferred},when:function(subordinate){var progressValues,progressContexts,resolveContexts,i=0,resolveValues=core_slice.call(arguments),length=resolveValues.length,remaining=1!==length||subordinate&&jQuery.isFunction(subordinate.promise)?length:0,deferred=1===remaining?subordinate:jQuery.Deferred(),updateFunc=function(i,contexts,values){return function(value){contexts[i]=this,values[i]=arguments.length>1?core_slice.call(arguments):value,values===progressValues?deferred.notifyWith(contexts,values):--remaining||deferred.resolveWith(contexts,values)}};if(length>1)for(progressValues=new Array(length),progressContexts=new Array(length),resolveContexts=new Array(length);length>i;i++)resolveValues[i]&&jQuery.isFunction(resolveValues[i].promise)?resolveValues[i].promise().done(updateFunc(i,resolveContexts,resolveValues)).fail(deferred.reject).progress(updateFunc(i,progressContexts,progressValues)):--remaining;return remaining||deferred.resolveWith(resolveContexts,resolveValues),deferred.promise()}}),jQuery.support=function(support){var all,a,input,select,fragment,opt,eventName,isSupported,i,div=document.createElement("div");if(div.setAttribute("className","t"),div.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",all=div.getElementsByTagName("*")||[],a=div.getElementsByTagName("a")[0],!a||!a.style||!all.length)return support;select=document.createElement("select"),opt=select.appendChild(document.createElement("option")),input=div.getElementsByTagName("input")[0],a.style.cssText="top:1px;float:left;opacity:.5",support.getSetAttribute="t"!==div.className,support.leadingWhitespace=3===div.firstChild.nodeType,support.tbody=!div.getElementsByTagName("tbody").length,support.htmlSerialize=!!div.getElementsByTagName("link").length,support.style=/top/.test(a.getAttribute("style")),support.hrefNormalized="/a"===a.getAttribute("href"),support.opacity=/^0.5/.test(a.style.opacity),support.cssFloat=!!a.style.cssFloat,support.checkOn=!!input.value,support.optSelected=opt.selected,support.enctype=!!document.createElement("form").enctype,support.html5Clone="<:nav></:nav>"!==document.createElement("nav").cloneNode(!0).outerHTML,support.inlineBlockNeedsLayout=!1,support.shrinkWrapBlocks=!1,support.pixelPosition=!1,support.deleteExpando=!0,support.noCloneEvent=!0,support.reliableMarginRight=!0,support.boxSizingReliable=!0,input.checked=!0,support.noCloneChecked=input.cloneNode(!0).checked,select.disabled=!0,support.optDisabled=!opt.disabled;try{delete div.test}catch(e){support.deleteExpando=!1}input=document.createElement("input"),input.setAttribute("value",""),support.input=""===input.getAttribute("value"),input.value="t",input.setAttribute("type","radio"),support.radioValue="t"===input.value,input.setAttribute("checked","t"),input.setAttribute("name","t"),fragment=document.createDocumentFragment(),fragment.appendChild(input),support.appendChecked=input.checked,support.checkClone=fragment.cloneNode(!0).cloneNode(!0).lastChild.checked,div.attachEvent&&(div.attachEvent("onclick",function(){support.noCloneEvent=!1}),div.cloneNode(!0).click());for(i in{submit:!0,change:!0,focusin:!0})div.setAttribute(eventName="on"+i,"t"),support[i+"Bubbles"]=eventName in window||div.attributes[eventName].expando===!1;div.style.backgroundClip="content-box",div.cloneNode(!0).style.backgroundClip="",support.clearCloneStyle="content-box"===div.style.backgroundClip;for(i in jQuery(support))break;return support.ownLast="0"!==i,jQuery(function(){var container,marginDiv,tds,divReset="padding:0;margin:0;border:0;display:block;box-sizing:content-box;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;",body=document.getElementsByTagName("body")[0];body&&(container=document.createElement("div"),container.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",body.appendChild(container).appendChild(div),div.innerHTML="<table><tr><td></td><td>t</td></tr></table>",tds=div.getElementsByTagName("td"),tds[0].style.cssText="padding:0;margin:0;border:0;display:none",isSupported=0===tds[0].offsetHeight,tds[0].style.display="",tds[1].style.display="none",support.reliableHiddenOffsets=isSupported&&0===tds[0].offsetHeight,div.innerHTML="",div.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;",jQuery.swap(body,null!=body.style.zoom?{zoom:1}:{},function(){support.boxSizing=4===div.offsetWidth}),window.getComputedStyle&&(support.pixelPosition="1%"!==(window.getComputedStyle(div,null)||{}).top,support.boxSizingReliable="4px"===(window.getComputedStyle(div,null)||{width:"4px"}).width,marginDiv=div.appendChild(document.createElement("div")),marginDiv.style.cssText=div.style.cssText=divReset,marginDiv.style.marginRight=marginDiv.style.width="0",div.style.width="1px",support.reliableMarginRight=!parseFloat((window.getComputedStyle(marginDiv,null)||{}).marginRight)),typeof div.style.zoom!==core_strundefined&&(div.innerHTML="",div.style.cssText=divReset+"width:1px;padding:1px;display:inline;zoom:1",support.inlineBlockNeedsLayout=3===div.offsetWidth,div.style.display="block",div.innerHTML="<div></div>",div.firstChild.style.width="5px",support.shrinkWrapBlocks=3!==div.offsetWidth,support.inlineBlockNeedsLayout&&(body.style.zoom=1)),body.removeChild(container),container=div=tds=marginDiv=null)}),all=select=fragment=opt=a=input=null,support}({});var rbrace=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,rmultiDash=/([A-Z])/g;jQuery.extend({cache:{},noData:{applet:!0,embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(elem){return elem=elem.nodeType?jQuery.cache[elem[jQuery.expando]]:elem[jQuery.expando],!!elem&&!isEmptyDataObject(elem)},data:function(elem,name,data){return internalData(elem,name,data)},removeData:function(elem,name){return internalRemoveData(elem,name)},_data:function(elem,name,data){return internalData(elem,name,data,!0)},_removeData:function(elem,name){return internalRemoveData(elem,name,!0)},acceptData:function(elem){if(elem.nodeType&&1!==elem.nodeType&&9!==elem.nodeType)return!1;var noData=elem.nodeName&&jQuery.noData[elem.nodeName.toLowerCase()];return!noData||noData!==!0&&elem.getAttribute("classid")===noData}}),jQuery.fn.extend({data:function(key,value){var attrs,name,data=null,i=0,elem=this[0];if(key===undefined){if(this.length&&(data=jQuery.data(elem),1===elem.nodeType&&!jQuery._data(elem,"parsedAttrs"))){for(attrs=elem.attributes;i<attrs.length;i++)name=attrs[i].name,0===name.indexOf("data-")&&(name=jQuery.camelCase(name.slice(5)),dataAttr(elem,name,data[name]));jQuery._data(elem,"parsedAttrs",!0)}return data}return"object"==typeof key?this.each(function(){jQuery.data(this,key)}):arguments.length>1?this.each(function(){jQuery.data(this,key,value)}):elem?dataAttr(elem,key,jQuery.data(elem,key)):null},removeData:function(key){return this.each(function(){jQuery.removeData(this,key)})}}),jQuery.extend({queue:function(elem,type,data){var queue;return elem?(type=(type||"fx")+"queue",queue=jQuery._data(elem,type),data&&(!queue||jQuery.isArray(data)?queue=jQuery._data(elem,type,jQuery.makeArray(data)):queue.push(data)),queue||[]):void 0},dequeue:function(elem,type){type=type||"fx";var queue=jQuery.queue(elem,type),startLength=queue.length,fn=queue.shift(),hooks=jQuery._queueHooks(elem,type),next=function(){jQuery.dequeue(elem,type)};"inprogress"===fn&&(fn=queue.shift(),startLength--),fn&&("fx"===type&&queue.unshift("inprogress"),delete hooks.stop,fn.call(elem,next,hooks)),!startLength&&hooks&&hooks.empty.fire()},_queueHooks:function(elem,type){var key=type+"queueHooks";return jQuery._data(elem,key)||jQuery._data(elem,key,{empty:jQuery.Callbacks("once memory").add(function(){jQuery._removeData(elem,type+"queue"),jQuery._removeData(elem,key)})})}}),jQuery.fn.extend({queue:function(type,data){var setter=2;return"string"!=typeof type&&(data=type,type="fx",setter--),arguments.length<setter?jQuery.queue(this[0],type):data===undefined?this:this.each(function(){var queue=jQuery.queue(this,type,data);jQuery._queueHooks(this,type),"fx"===type&&"inprogress"!==queue[0]&&jQuery.dequeue(this,type)})},dequeue:function(type){return this.each(function(){jQuery.dequeue(this,type)})},delay:function(time,type){return time=jQuery.fx?jQuery.fx.speeds[time]||time:time,type=type||"fx",this.queue(type,function(next,hooks){var timeout=setTimeout(next,time);hooks.stop=function(){clearTimeout(timeout)}})},clearQueue:function(type){return this.queue(type||"fx",[])},promise:function(type,obj){var tmp,count=1,defer=jQuery.Deferred(),elements=this,i=this.length,resolve=function(){--count||defer.resolveWith(elements,[elements])};for("string"!=typeof type&&(obj=type,type=undefined),type=type||"fx";i--;)tmp=jQuery._data(elements[i],type+"queueHooks"),tmp&&tmp.empty&&(count++,tmp.empty.add(resolve));return resolve(),defer.promise(obj)}});var nodeHook,boolHook,rclass=/[\t\r\n\f]/g,rreturn=/\r/g,rfocusable=/^(?:input|select|textarea|button|object)$/i,rclickable=/^(?:a|area)$/i,ruseDefault=/^(?:checked|selected)$/i,getSetAttribute=jQuery.support.getSetAttribute,getSetInput=jQuery.support.input;jQuery.fn.extend({attr:function(name,value){return jQuery.access(this,jQuery.attr,name,value,arguments.length>1)},removeAttr:function(name){return this.each(function(){jQuery.removeAttr(this,name)})},prop:function(name,value){return jQuery.access(this,jQuery.prop,name,value,arguments.length>1)},removeProp:function(name){return name=jQuery.propFix[name]||name,this.each(function(){try{this[name]=undefined,delete this[name]}catch(e){}})},addClass:function(value){var classes,elem,cur,clazz,j,i=0,len=this.length,proceed="string"==typeof value&&value;if(jQuery.isFunction(value))return this.each(function(j){jQuery(this).addClass(value.call(this,j,this.className))});if(proceed)for(classes=(value||"").match(core_rnotwhite)||[];len>i;i++)if(elem=this[i],cur=1===elem.nodeType&&(elem.className?(" "+elem.className+" ").replace(rclass," "):" ")){for(j=0;clazz=classes[j++];)cur.indexOf(" "+clazz+" ")<0&&(cur+=clazz+" ");elem.className=jQuery.trim(cur)}return this},removeClass:function(value){var classes,elem,cur,clazz,j,i=0,len=this.length,proceed=0===arguments.length||"string"==typeof value&&value;if(jQuery.isFunction(value))return this.each(function(j){jQuery(this).removeClass(value.call(this,j,this.className))});if(proceed)for(classes=(value||"").match(core_rnotwhite)||[];len>i;i++)if(elem=this[i],cur=1===elem.nodeType&&(elem.className?(" "+elem.className+" ").replace(rclass," "):"")){for(j=0;clazz=classes[j++];)for(;cur.indexOf(" "+clazz+" ")>=0;)cur=cur.replace(" "+clazz+" "," ");elem.className=value?jQuery.trim(cur):""}return this},toggleClass:function(value,stateVal){var type=typeof value;return"boolean"==typeof stateVal&&"string"===type?stateVal?this.addClass(value):this.removeClass(value):this.each(jQuery.isFunction(value)?function(i){jQuery(this).toggleClass(value.call(this,i,this.className,stateVal),stateVal)}:function(){if("string"===type)for(var className,i=0,self=jQuery(this),classNames=value.match(core_rnotwhite)||[];className=classNames[i++];)self.hasClass(className)?self.removeClass(className):self.addClass(className);else(type===core_strundefined||"boolean"===type)&&(this.className&&jQuery._data(this,"__className__",this.className),this.className=this.className||value===!1?"":jQuery._data(this,"__className__")||"")})},hasClass:function(selector){for(var className=" "+selector+" ",i=0,l=this.length;l>i;i++)if(1===this[i].nodeType&&(" "+this[i].className+" ").replace(rclass," ").indexOf(className)>=0)return!0;return!1},val:function(value){var ret,hooks,isFunction,elem=this[0];{if(arguments.length)return isFunction=jQuery.isFunction(value),this.each(function(i){var val;1===this.nodeType&&(val=isFunction?value.call(this,i,jQuery(this).val()):value,null==val?val="":"number"==typeof val?val+="":jQuery.isArray(val)&&(val=jQuery.map(val,function(value){return null==value?"":value+""})),hooks=jQuery.valHooks[this.type]||jQuery.valHooks[this.nodeName.toLowerCase()],hooks&&"set"in hooks&&hooks.set(this,val,"value")!==undefined||(this.value=val))});if(elem)return hooks=jQuery.valHooks[elem.type]||jQuery.valHooks[elem.nodeName.toLowerCase()],hooks&&"get"in hooks&&(ret=hooks.get(elem,"value"))!==undefined?ret:(ret=elem.value,"string"==typeof ret?ret.replace(rreturn,""):null==ret?"":ret)}}}),jQuery.extend({valHooks:{option:{get:function(elem){var val=jQuery.find.attr(elem,"value");return null!=val?val:elem.text}},select:{get:function(elem){for(var value,option,options=elem.options,index=elem.selectedIndex,one="select-one"===elem.type||0>index,values=one?null:[],max=one?index+1:options.length,i=0>index?max:one?index:0;max>i;i++)if(option=options[i],!(!option.selected&&i!==index||(jQuery.support.optDisabled?option.disabled:null!==option.getAttribute("disabled"))||option.parentNode.disabled&&jQuery.nodeName(option.parentNode,"optgroup"))){if(value=jQuery(option).val(),one)return value;values.push(value)}return values},set:function(elem,value){for(var optionSet,option,options=elem.options,values=jQuery.makeArray(value),i=options.length;i--;)option=options[i],(option.selected=jQuery.inArray(jQuery(option).val(),values)>=0)&&(optionSet=!0);
return optionSet||(elem.selectedIndex=-1),values}}},attr:function(elem,name,value){var hooks,ret,nType=elem.nodeType;if(elem&&3!==nType&&8!==nType&&2!==nType)return typeof elem.getAttribute===core_strundefined?jQuery.prop(elem,name,value):(1===nType&&jQuery.isXMLDoc(elem)||(name=name.toLowerCase(),hooks=jQuery.attrHooks[name]||(jQuery.expr.match.bool.test(name)?boolHook:nodeHook)),value===undefined?hooks&&"get"in hooks&&null!==(ret=hooks.get(elem,name))?ret:(ret=jQuery.find.attr(elem,name),null==ret?undefined:ret):null!==value?hooks&&"set"in hooks&&(ret=hooks.set(elem,value,name))!==undefined?ret:(elem.setAttribute(name,value+""),value):void jQuery.removeAttr(elem,name))},removeAttr:function(elem,value){var name,propName,i=0,attrNames=value&&value.match(core_rnotwhite);if(attrNames&&1===elem.nodeType)for(;name=attrNames[i++];)propName=jQuery.propFix[name]||name,jQuery.expr.match.bool.test(name)?getSetInput&&getSetAttribute||!ruseDefault.test(name)?elem[propName]=!1:elem[jQuery.camelCase("default-"+name)]=elem[propName]=!1:jQuery.attr(elem,name,""),elem.removeAttribute(getSetAttribute?name:propName)},attrHooks:{type:{set:function(elem,value){if(!jQuery.support.radioValue&&"radio"===value&&jQuery.nodeName(elem,"input")){var val=elem.value;return elem.setAttribute("type",value),val&&(elem.value=val),value}}}},propFix:{"for":"htmlFor","class":"className"},prop:function(elem,name,value){var ret,hooks,notxml,nType=elem.nodeType;if(elem&&3!==nType&&8!==nType&&2!==nType)return notxml=1!==nType||!jQuery.isXMLDoc(elem),notxml&&(name=jQuery.propFix[name]||name,hooks=jQuery.propHooks[name]),value!==undefined?hooks&&"set"in hooks&&(ret=hooks.set(elem,value,name))!==undefined?ret:elem[name]=value:hooks&&"get"in hooks&&null!==(ret=hooks.get(elem,name))?ret:elem[name]},propHooks:{tabIndex:{get:function(elem){var tabindex=jQuery.find.attr(elem,"tabindex");return tabindex?parseInt(tabindex,10):rfocusable.test(elem.nodeName)||rclickable.test(elem.nodeName)&&elem.href?0:-1}}}}),boolHook={set:function(elem,value,name){return value===!1?jQuery.removeAttr(elem,name):getSetInput&&getSetAttribute||!ruseDefault.test(name)?elem.setAttribute(!getSetAttribute&&jQuery.propFix[name]||name,name):elem[jQuery.camelCase("default-"+name)]=elem[name]=!0,name}},jQuery.each(jQuery.expr.match.bool.source.match(/\w+/g),function(i,name){var getter=jQuery.expr.attrHandle[name]||jQuery.find.attr;jQuery.expr.attrHandle[name]=getSetInput&&getSetAttribute||!ruseDefault.test(name)?function(elem,name,isXML){var fn=jQuery.expr.attrHandle[name],ret=isXML?undefined:(jQuery.expr.attrHandle[name]=undefined)!=getter(elem,name,isXML)?name.toLowerCase():null;return jQuery.expr.attrHandle[name]=fn,ret}:function(elem,name,isXML){return isXML?undefined:elem[jQuery.camelCase("default-"+name)]?name.toLowerCase():null}}),getSetInput&&getSetAttribute||(jQuery.attrHooks.value={set:function(elem,value,name){return jQuery.nodeName(elem,"input")?void(elem.defaultValue=value):nodeHook&&nodeHook.set(elem,value,name)}}),getSetAttribute||(nodeHook={set:function(elem,value,name){var ret=elem.getAttributeNode(name);return ret||elem.setAttributeNode(ret=elem.ownerDocument.createAttribute(name)),ret.value=value+="","value"===name||value===elem.getAttribute(name)?value:undefined}},jQuery.expr.attrHandle.id=jQuery.expr.attrHandle.name=jQuery.expr.attrHandle.coords=function(elem,name,isXML){var ret;return isXML?undefined:(ret=elem.getAttributeNode(name))&&""!==ret.value?ret.value:null},jQuery.valHooks.button={get:function(elem,name){var ret=elem.getAttributeNode(name);return ret&&ret.specified?ret.value:undefined},set:nodeHook.set},jQuery.attrHooks.contenteditable={set:function(elem,value,name){nodeHook.set(elem,""===value?!1:value,name)}},jQuery.each(["width","height"],function(i,name){jQuery.attrHooks[name]={set:function(elem,value){return""===value?(elem.setAttribute(name,"auto"),value):void 0}}})),jQuery.support.hrefNormalized||jQuery.each(["href","src"],function(i,name){jQuery.propHooks[name]={get:function(elem){return elem.getAttribute(name,4)}}}),jQuery.support.style||(jQuery.attrHooks.style={get:function(elem){return elem.style.cssText||undefined},set:function(elem,value){return elem.style.cssText=value+""}}),jQuery.support.optSelected||(jQuery.propHooks.selected={get:function(elem){var parent=elem.parentNode;return parent&&(parent.selectedIndex,parent.parentNode&&parent.parentNode.selectedIndex),null}}),jQuery.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){jQuery.propFix[this.toLowerCase()]=this}),jQuery.support.enctype||(jQuery.propFix.enctype="encoding"),jQuery.each(["radio","checkbox"],function(){jQuery.valHooks[this]={set:function(elem,value){return jQuery.isArray(value)?elem.checked=jQuery.inArray(jQuery(elem).val(),value)>=0:void 0}},jQuery.support.checkOn||(jQuery.valHooks[this].get=function(elem){return null===elem.getAttribute("value")?"on":elem.value})});var rformElems=/^(?:input|select|textarea)$/i,rkeyEvent=/^key/,rmouseEvent=/^(?:mouse|contextmenu)|click/,rfocusMorph=/^(?:focusinfocus|focusoutblur)$/,rtypenamespace=/^([^.]*)(?:\.(.+)|)$/;jQuery.event={global:{},add:function(elem,types,handler,data,selector){var tmp,events,t,handleObjIn,special,eventHandle,handleObj,handlers,type,namespaces,origType,elemData=jQuery._data(elem);if(elemData){for(handler.handler&&(handleObjIn=handler,handler=handleObjIn.handler,selector=handleObjIn.selector),handler.guid||(handler.guid=jQuery.guid++),(events=elemData.events)||(events=elemData.events={}),(eventHandle=elemData.handle)||(eventHandle=elemData.handle=function(e){return typeof jQuery===core_strundefined||e&&jQuery.event.triggered===e.type?undefined:jQuery.event.dispatch.apply(eventHandle.elem,arguments)},eventHandle.elem=elem),types=(types||"").match(core_rnotwhite)||[""],t=types.length;t--;)tmp=rtypenamespace.exec(types[t])||[],type=origType=tmp[1],namespaces=(tmp[2]||"").split(".").sort(),type&&(special=jQuery.event.special[type]||{},type=(selector?special.delegateType:special.bindType)||type,special=jQuery.event.special[type]||{},handleObj=jQuery.extend({type:type,origType:origType,data:data,handler:handler,guid:handler.guid,selector:selector,needsContext:selector&&jQuery.expr.match.needsContext.test(selector),namespace:namespaces.join(".")},handleObjIn),(handlers=events[type])||(handlers=events[type]=[],handlers.delegateCount=0,special.setup&&special.setup.call(elem,data,namespaces,eventHandle)!==!1||(elem.addEventListener?elem.addEventListener(type,eventHandle,!1):elem.attachEvent&&elem.attachEvent("on"+type,eventHandle))),special.add&&(special.add.call(elem,handleObj),handleObj.handler.guid||(handleObj.handler.guid=handler.guid)),selector?handlers.splice(handlers.delegateCount++,0,handleObj):handlers.push(handleObj),jQuery.event.global[type]=!0);elem=null}},remove:function(elem,types,handler,selector,mappedTypes){var j,handleObj,tmp,origCount,t,events,special,handlers,type,namespaces,origType,elemData=jQuery.hasData(elem)&&jQuery._data(elem);if(elemData&&(events=elemData.events)){for(types=(types||"").match(core_rnotwhite)||[""],t=types.length;t--;)if(tmp=rtypenamespace.exec(types[t])||[],type=origType=tmp[1],namespaces=(tmp[2]||"").split(".").sort(),type){for(special=jQuery.event.special[type]||{},type=(selector?special.delegateType:special.bindType)||type,handlers=events[type]||[],tmp=tmp[2]&&new RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.|)")+"(\\.|$)"),origCount=j=handlers.length;j--;)handleObj=handlers[j],!mappedTypes&&origType!==handleObj.origType||handler&&handler.guid!==handleObj.guid||tmp&&!tmp.test(handleObj.namespace)||selector&&selector!==handleObj.selector&&("**"!==selector||!handleObj.selector)||(handlers.splice(j,1),handleObj.selector&&handlers.delegateCount--,special.remove&&special.remove.call(elem,handleObj));origCount&&!handlers.length&&(special.teardown&&special.teardown.call(elem,namespaces,elemData.handle)!==!1||jQuery.removeEvent(elem,type,elemData.handle),delete events[type])}else for(type in events)jQuery.event.remove(elem,type+types[t],handler,selector,!0);jQuery.isEmptyObject(events)&&(delete elemData.handle,jQuery._removeData(elem,"events"))}},trigger:function(event,data,elem,onlyHandlers){var handle,ontype,cur,bubbleType,special,tmp,i,eventPath=[elem||document],type=core_hasOwn.call(event,"type")?event.type:event,namespaces=core_hasOwn.call(event,"namespace")?event.namespace.split("."):[];if(cur=tmp=elem=elem||document,3!==elem.nodeType&&8!==elem.nodeType&&!rfocusMorph.test(type+jQuery.event.triggered)&&(type.indexOf(".")>=0&&(namespaces=type.split("."),type=namespaces.shift(),namespaces.sort()),ontype=type.indexOf(":")<0&&"on"+type,event=event[jQuery.expando]?event:new jQuery.Event(type,"object"==typeof event&&event),event.isTrigger=onlyHandlers?2:3,event.namespace=namespaces.join("."),event.namespace_re=event.namespace?new RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,event.result=undefined,event.target||(event.target=elem),data=null==data?[event]:jQuery.makeArray(data,[event]),special=jQuery.event.special[type]||{},onlyHandlers||!special.trigger||special.trigger.apply(elem,data)!==!1)){if(!onlyHandlers&&!special.noBubble&&!jQuery.isWindow(elem)){for(bubbleType=special.delegateType||type,rfocusMorph.test(bubbleType+type)||(cur=cur.parentNode);cur;cur=cur.parentNode)eventPath.push(cur),tmp=cur;tmp===(elem.ownerDocument||document)&&eventPath.push(tmp.defaultView||tmp.parentWindow||window)}for(i=0;(cur=eventPath[i++])&&!event.isPropagationStopped();)event.type=i>1?bubbleType:special.bindType||type,handle=(jQuery._data(cur,"events")||{})[event.type]&&jQuery._data(cur,"handle"),handle&&handle.apply(cur,data),handle=ontype&&cur[ontype],handle&&jQuery.acceptData(cur)&&handle.apply&&handle.apply(cur,data)===!1&&event.preventDefault();if(event.type=type,!onlyHandlers&&!event.isDefaultPrevented()&&(!special._default||special._default.apply(eventPath.pop(),data)===!1)&&jQuery.acceptData(elem)&&ontype&&elem[type]&&!jQuery.isWindow(elem)){tmp=elem[ontype],tmp&&(elem[ontype]=null),jQuery.event.triggered=type;try{elem[type]()}catch(e){}jQuery.event.triggered=undefined,tmp&&(elem[ontype]=tmp)}return event.result}},dispatch:function(event){event=jQuery.event.fix(event);var i,ret,handleObj,matched,j,handlerQueue=[],args=core_slice.call(arguments),handlers=(jQuery._data(this,"events")||{})[event.type]||[],special=jQuery.event.special[event.type]||{};if(args[0]=event,event.delegateTarget=this,!special.preDispatch||special.preDispatch.call(this,event)!==!1){for(handlerQueue=jQuery.event.handlers.call(this,event,handlers),i=0;(matched=handlerQueue[i++])&&!event.isPropagationStopped();)for(event.currentTarget=matched.elem,j=0;(handleObj=matched.handlers[j++])&&!event.isImmediatePropagationStopped();)(!event.namespace_re||event.namespace_re.test(handleObj.namespace))&&(event.handleObj=handleObj,event.data=handleObj.data,ret=((jQuery.event.special[handleObj.origType]||{}).handle||handleObj.handler).apply(matched.elem,args),ret!==undefined&&(event.result=ret)===!1&&(event.preventDefault(),event.stopPropagation()));return special.postDispatch&&special.postDispatch.call(this,event),event.result}},handlers:function(event,handlers){var sel,handleObj,matches,i,handlerQueue=[],delegateCount=handlers.delegateCount,cur=event.target;if(delegateCount&&cur.nodeType&&(!event.button||"click"!==event.type))for(;cur!=this;cur=cur.parentNode||this)if(1===cur.nodeType&&(cur.disabled!==!0||"click"!==event.type)){for(matches=[],i=0;delegateCount>i;i++)handleObj=handlers[i],sel=handleObj.selector+" ",matches[sel]===undefined&&(matches[sel]=handleObj.needsContext?jQuery(sel,this).index(cur)>=0:jQuery.find(sel,this,null,[cur]).length),matches[sel]&&matches.push(handleObj);matches.length&&handlerQueue.push({elem:cur,handlers:matches})}return delegateCount<handlers.length&&handlerQueue.push({elem:this,handlers:handlers.slice(delegateCount)}),handlerQueue},fix:function(event){if(event[jQuery.expando])return event;var i,prop,copy,type=event.type,originalEvent=event,fixHook=this.fixHooks[type];for(fixHook||(this.fixHooks[type]=fixHook=rmouseEvent.test(type)?this.mouseHooks:rkeyEvent.test(type)?this.keyHooks:{}),copy=fixHook.props?this.props.concat(fixHook.props):this.props,event=new jQuery.Event(originalEvent),i=copy.length;i--;)prop=copy[i],event[prop]=originalEvent[prop];return event.target||(event.target=originalEvent.srcElement||document),3===event.target.nodeType&&(event.target=event.target.parentNode),event.metaKey=!!event.metaKey,fixHook.filter?fixHook.filter(event,originalEvent):event},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(event,original){return null==event.which&&(event.which=null!=original.charCode?original.charCode:original.keyCode),event}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(event,original){var body,eventDoc,doc,button=original.button,fromElement=original.fromElement;return null==event.pageX&&null!=original.clientX&&(eventDoc=event.target.ownerDocument||document,doc=eventDoc.documentElement,body=eventDoc.body,event.pageX=original.clientX+(doc&&doc.scrollLeft||body&&body.scrollLeft||0)-(doc&&doc.clientLeft||body&&body.clientLeft||0),event.pageY=original.clientY+(doc&&doc.scrollTop||body&&body.scrollTop||0)-(doc&&doc.clientTop||body&&body.clientTop||0)),!event.relatedTarget&&fromElement&&(event.relatedTarget=fromElement===event.target?original.toElement:fromElement),event.which||button===undefined||(event.which=1&button?1:2&button?3:4&button?2:0),event}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==safeActiveElement()&&this.focus)try{return this.focus(),!1}catch(e){}},delegateType:"focusin"},blur:{trigger:function(){return this===safeActiveElement()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return jQuery.nodeName(this,"input")&&"checkbox"===this.type&&this.click?(this.click(),!1):void 0},_default:function(event){return jQuery.nodeName(event.target,"a")}},beforeunload:{postDispatch:function(event){event.result!==undefined&&(event.originalEvent.returnValue=event.result)}}},simulate:function(type,elem,event,bubble){var e=jQuery.extend(new jQuery.Event,event,{type:type,isSimulated:!0,originalEvent:{}});bubble?jQuery.event.trigger(e,null,elem):jQuery.event.dispatch.call(elem,e),e.isDefaultPrevented()&&event.preventDefault()}},jQuery.removeEvent=document.removeEventListener?function(elem,type,handle){elem.removeEventListener&&elem.removeEventListener(type,handle,!1)}:function(elem,type,handle){var name="on"+type;elem.detachEvent&&(typeof elem[name]===core_strundefined&&(elem[name]=null),elem.detachEvent(name,handle))},jQuery.Event=function(src,props){return this instanceof jQuery.Event?(src&&src.type?(this.originalEvent=src,this.type=src.type,this.isDefaultPrevented=src.defaultPrevented||src.returnValue===!1||src.getPreventDefault&&src.getPreventDefault()?returnTrue:returnFalse):this.type=src,props&&jQuery.extend(this,props),this.timeStamp=src&&src.timeStamp||jQuery.now(),void(this[jQuery.expando]=!0)):new jQuery.Event(src,props)},jQuery.Event.prototype={isDefaultPrevented:returnFalse,isPropagationStopped:returnFalse,isImmediatePropagationStopped:returnFalse,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=returnTrue,e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=returnTrue,e&&(e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=returnTrue,this.stopPropagation()}},jQuery.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(orig,fix){jQuery.event.special[orig]={delegateType:fix,bindType:fix,handle:function(event){var ret,target=this,related=event.relatedTarget,handleObj=event.handleObj;return(!related||related!==target&&!jQuery.contains(target,related))&&(event.type=handleObj.origType,ret=handleObj.handler.apply(this,arguments),event.type=fix),ret}}}),jQuery.support.submitBubbles||(jQuery.event.special.submit={setup:function(){return jQuery.nodeName(this,"form")?!1:void jQuery.event.add(this,"click._submit keypress._submit",function(e){var elem=e.target,form=jQuery.nodeName(elem,"input")||jQuery.nodeName(elem,"button")?elem.form:undefined;form&&!jQuery._data(form,"submitBubbles")&&(jQuery.event.add(form,"submit._submit",function(event){event._submit_bubble=!0}),jQuery._data(form,"submitBubbles",!0))})},postDispatch:function(event){event._submit_bubble&&(delete event._submit_bubble,this.parentNode&&!event.isTrigger&&jQuery.event.simulate("submit",this.parentNode,event,!0))},teardown:function(){return jQuery.nodeName(this,"form")?!1:void jQuery.event.remove(this,"._submit")}}),jQuery.support.changeBubbles||(jQuery.event.special.change={setup:function(){return rformElems.test(this.nodeName)?(("checkbox"===this.type||"radio"===this.type)&&(jQuery.event.add(this,"propertychange._change",function(event){"checked"===event.originalEvent.propertyName&&(this._just_changed=!0)}),jQuery.event.add(this,"click._change",function(event){this._just_changed&&!event.isTrigger&&(this._just_changed=!1),jQuery.event.simulate("change",this,event,!0)})),!1):void jQuery.event.add(this,"beforeactivate._change",function(e){var elem=e.target;rformElems.test(elem.nodeName)&&!jQuery._data(elem,"changeBubbles")&&(jQuery.event.add(elem,"change._change",function(event){!this.parentNode||event.isSimulated||event.isTrigger||jQuery.event.simulate("change",this.parentNode,event,!0)}),jQuery._data(elem,"changeBubbles",!0))})},handle:function(event){var elem=event.target;return this!==elem||event.isSimulated||event.isTrigger||"radio"!==elem.type&&"checkbox"!==elem.type?event.handleObj.handler.apply(this,arguments):void 0},teardown:function(){return jQuery.event.remove(this,"._change"),!rformElems.test(this.nodeName)}}),jQuery.support.focusinBubbles||jQuery.each({focus:"focusin",blur:"focusout"},function(orig,fix){var attaches=0,handler=function(event){jQuery.event.simulate(fix,event.target,jQuery.event.fix(event),!0)};jQuery.event.special[fix]={setup:function(){0===attaches++&&document.addEventListener(orig,handler,!0)},teardown:function(){0===--attaches&&document.removeEventListener(orig,handler,!0)}}}),jQuery.fn.extend({on:function(types,selector,data,fn,one){var type,origFn;if("object"==typeof types){"string"!=typeof selector&&(data=data||selector,selector=undefined);for(type in types)this.on(type,selector,data,types[type],one);return this}if(null==data&&null==fn?(fn=selector,data=selector=undefined):null==fn&&("string"==typeof selector?(fn=data,data=undefined):(fn=data,data=selector,selector=undefined)),fn===!1)fn=returnFalse;else if(!fn)return this;return 1===one&&(origFn=fn,fn=function(event){return jQuery().off(event),origFn.apply(this,arguments)},fn.guid=origFn.guid||(origFn.guid=jQuery.guid++)),this.each(function(){jQuery.event.add(this,types,fn,data,selector)})},one:function(types,selector,data,fn){return this.on(types,selector,data,fn,1)},off:function(types,selector,fn){var handleObj,type;if(types&&types.preventDefault&&types.handleObj)return handleObj=types.handleObj,jQuery(types.delegateTarget).off(handleObj.namespace?handleObj.origType+"."+handleObj.namespace:handleObj.origType,handleObj.selector,handleObj.handler),this;if("object"==typeof types){for(type in types)this.off(type,selector,types[type]);return this}return(selector===!1||"function"==typeof selector)&&(fn=selector,selector=undefined),fn===!1&&(fn=returnFalse),this.each(function(){jQuery.event.remove(this,types,fn,selector)})},trigger:function(type,data){return this.each(function(){jQuery.event.trigger(type,data,this)})},triggerHandler:function(type,data){var elem=this[0];return elem?jQuery.event.trigger(type,data,elem,!0):void 0}});var isSimple=/^.[^:#\[\.,]*$/,rparentsprev=/^(?:parents|prev(?:Until|All))/,rneedsContext=jQuery.expr.match.needsContext,guaranteedUnique={children:!0,contents:!0,next:!0,prev:!0};jQuery.fn.extend({find:function(selector){var i,ret=[],self=this,len=self.length;if("string"!=typeof selector)return this.pushStack(jQuery(selector).filter(function(){for(i=0;len>i;i++)if(jQuery.contains(self[i],this))return!0}));for(i=0;len>i;i++)jQuery.find(selector,self[i],ret);return ret=this.pushStack(len>1?jQuery.unique(ret):ret),ret.selector=this.selector?this.selector+" "+selector:selector,ret},has:function(target){var i,targets=jQuery(target,this),len=targets.length;return this.filter(function(){for(i=0;len>i;i++)if(jQuery.contains(this,targets[i]))return!0})},not:function(selector){return this.pushStack(winnow(this,selector||[],!0))},filter:function(selector){return this.pushStack(winnow(this,selector||[],!1))},is:function(selector){return!!winnow(this,"string"==typeof selector&&rneedsContext.test(selector)?jQuery(selector):selector||[],!1).length},closest:function(selectors,context){for(var cur,i=0,l=this.length,ret=[],pos=rneedsContext.test(selectors)||"string"!=typeof selectors?jQuery(selectors,context||this.context):0;l>i;i++)for(cur=this[i];cur&&cur!==context;cur=cur.parentNode)if(cur.nodeType<11&&(pos?pos.index(cur)>-1:1===cur.nodeType&&jQuery.find.matchesSelector(cur,selectors))){cur=ret.push(cur);break}return this.pushStack(ret.length>1?jQuery.unique(ret):ret)},index:function(elem){return elem?"string"==typeof elem?jQuery.inArray(this[0],jQuery(elem)):jQuery.inArray(elem.jquery?elem[0]:elem,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(selector,context){var set="string"==typeof selector?jQuery(selector,context):jQuery.makeArray(selector&&selector.nodeType?[selector]:selector),all=jQuery.merge(this.get(),set);return this.pushStack(jQuery.unique(all))},addBack:function(selector){return this.add(null==selector?this.prevObject:this.prevObject.filter(selector))}}),jQuery.each({parent:function(elem){var parent=elem.parentNode;return parent&&11!==parent.nodeType?parent:null},parents:function(elem){return jQuery.dir(elem,"parentNode")},parentsUntil:function(elem,i,until){return jQuery.dir(elem,"parentNode",until)},next:function(elem){return sibling(elem,"nextSibling")},prev:function(elem){return sibling(elem,"previousSibling")},nextAll:function(elem){return jQuery.dir(elem,"nextSibling")},prevAll:function(elem){return jQuery.dir(elem,"previousSibling")},nextUntil:function(elem,i,until){return jQuery.dir(elem,"nextSibling",until)},prevUntil:function(elem,i,until){return jQuery.dir(elem,"previousSibling",until)},siblings:function(elem){return jQuery.sibling((elem.parentNode||{}).firstChild,elem)},children:function(elem){return jQuery.sibling(elem.firstChild)},contents:function(elem){return jQuery.nodeName(elem,"iframe")?elem.contentDocument||elem.contentWindow.document:jQuery.merge([],elem.childNodes)}},function(name,fn){jQuery.fn[name]=function(until,selector){var ret=jQuery.map(this,fn,until);return"Until"!==name.slice(-5)&&(selector=until),selector&&"string"==typeof selector&&(ret=jQuery.filter(selector,ret)),this.length>1&&(guaranteedUnique[name]||(ret=jQuery.unique(ret)),rparentsprev.test(name)&&(ret=ret.reverse())),this.pushStack(ret)}}),jQuery.extend({filter:function(expr,elems,not){var elem=elems[0];return not&&(expr=":not("+expr+")"),1===elems.length&&1===elem.nodeType?jQuery.find.matchesSelector(elem,expr)?[elem]:[]:jQuery.find.matches(expr,jQuery.grep(elems,function(elem){return 1===elem.nodeType}))},dir:function(elem,dir,until){for(var matched=[],cur=elem[dir];cur&&9!==cur.nodeType&&(until===undefined||1!==cur.nodeType||!jQuery(cur).is(until));)1===cur.nodeType&&matched.push(cur),cur=cur[dir];return matched},sibling:function(n,elem){for(var r=[];n;n=n.nextSibling)1===n.nodeType&&n!==elem&&r.push(n);return r}});var nodeNames="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",rinlinejQuery=/ jQuery\d+="(?:null|\d+)"/g,rnoshimcache=new RegExp("<(?:"+nodeNames+")[\\s/>]","i"),rleadingWhitespace=/^\s+/,rxhtmlTag=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,rtagName=/<([\w:]+)/,rtbody=/<tbody/i,rhtml=/<|&#?\w+;/,rnoInnerhtml=/<(?:script|style|link)/i,manipulation_rcheckableType=/^(?:checkbox|radio)$/i,rchecked=/checked\s*(?:[^=]|=\s*.checked.)/i,rscriptType=/^$|\/(?:java|ecma)script/i,rscriptTypeMasked=/^true\/(.*)/,rcleanScript=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,wrapMap={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:jQuery.support.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},safeFragment=createSafeFragment(document),fragmentDiv=safeFragment.appendChild(document.createElement("div"));wrapMap.optgroup=wrapMap.option,wrapMap.tbody=wrapMap.tfoot=wrapMap.colgroup=wrapMap.caption=wrapMap.thead,wrapMap.th=wrapMap.td,jQuery.fn.extend({text:function(value){return jQuery.access(this,function(value){return value===undefined?jQuery.text(this):this.empty().append((this[0]&&this[0].ownerDocument||document).createTextNode(value))},null,value,arguments.length)},append:function(){return this.domManip(arguments,function(elem){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var target=manipulationTarget(this,elem);target.appendChild(elem)}})},prepend:function(){return this.domManip(arguments,function(elem){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var target=manipulationTarget(this,elem);target.insertBefore(elem,target.firstChild)}})},before:function(){return this.domManip(arguments,function(elem){this.parentNode&&this.parentNode.insertBefore(elem,this)})},after:function(){return this.domManip(arguments,function(elem){this.parentNode&&this.parentNode.insertBefore(elem,this.nextSibling)})},remove:function(selector,keepData){for(var elem,elems=selector?jQuery.filter(selector,this):this,i=0;null!=(elem=elems[i]);i++)keepData||1!==elem.nodeType||jQuery.cleanData(getAll(elem)),elem.parentNode&&(keepData&&jQuery.contains(elem.ownerDocument,elem)&&setGlobalEval(getAll(elem,"script")),elem.parentNode.removeChild(elem));return this},empty:function(){for(var elem,i=0;null!=(elem=this[i]);i++){for(1===elem.nodeType&&jQuery.cleanData(getAll(elem,!1));elem.firstChild;)elem.removeChild(elem.firstChild);elem.options&&jQuery.nodeName(elem,"select")&&(elem.options.length=0)}return this},clone:function(dataAndEvents,deepDataAndEvents){return dataAndEvents=null==dataAndEvents?!1:dataAndEvents,deepDataAndEvents=null==deepDataAndEvents?dataAndEvents:deepDataAndEvents,this.map(function(){return jQuery.clone(this,dataAndEvents,deepDataAndEvents)})},html:function(value){return jQuery.access(this,function(value){var elem=this[0]||{},i=0,l=this.length;if(value===undefined)return 1===elem.nodeType?elem.innerHTML.replace(rinlinejQuery,""):undefined;if(!("string"!=typeof value||rnoInnerhtml.test(value)||!jQuery.support.htmlSerialize&&rnoshimcache.test(value)||!jQuery.support.leadingWhitespace&&rleadingWhitespace.test(value)||wrapMap[(rtagName.exec(value)||["",""])[1].toLowerCase()])){value=value.replace(rxhtmlTag,"<$1></$2>");try{for(;l>i;i++)elem=this[i]||{},1===elem.nodeType&&(jQuery.cleanData(getAll(elem,!1)),elem.innerHTML=value);elem=0}catch(e){}}elem&&this.empty().append(value)},null,value,arguments.length)},replaceWith:function(){var args=jQuery.map(this,function(elem){return[elem.nextSibling,elem.parentNode]}),i=0;return this.domManip(arguments,function(elem){var next=args[i++],parent=args[i++];parent&&(next&&next.parentNode!==parent&&(next=this.nextSibling),jQuery(this).remove(),parent.insertBefore(elem,next))},!0),i?this:this.remove()},detach:function(selector){return this.remove(selector,!0)},domManip:function(args,callback,allowIntersection){args=core_concat.apply([],args);var first,node,hasScripts,scripts,doc,fragment,i=0,l=this.length,set=this,iNoClone=l-1,value=args[0],isFunction=jQuery.isFunction(value);if(isFunction||!(1>=l||"string"!=typeof value||jQuery.support.checkClone)&&rchecked.test(value))return this.each(function(index){var self=set.eq(index);isFunction&&(args[0]=value.call(this,index,self.html())),self.domManip(args,callback,allowIntersection)});if(l&&(fragment=jQuery.buildFragment(args,this[0].ownerDocument,!1,!allowIntersection&&this),first=fragment.firstChild,1===fragment.childNodes.length&&(fragment=first),first)){for(scripts=jQuery.map(getAll(fragment,"script"),disableScript),hasScripts=scripts.length;l>i;i++)node=fragment,i!==iNoClone&&(node=jQuery.clone(node,!0,!0),hasScripts&&jQuery.merge(scripts,getAll(node,"script"))),callback.call(this[i],node,i);if(hasScripts)for(doc=scripts[scripts.length-1].ownerDocument,jQuery.map(scripts,restoreScript),i=0;hasScripts>i;i++)node=scripts[i],rscriptType.test(node.type||"")&&!jQuery._data(node,"globalEval")&&jQuery.contains(doc,node)&&(node.src?jQuery._evalUrl(node.src):jQuery.globalEval((node.text||node.textContent||node.innerHTML||"").replace(rcleanScript,"")));fragment=first=null}return this}}),jQuery.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(name,original){jQuery.fn[name]=function(selector){for(var elems,i=0,ret=[],insert=jQuery(selector),last=insert.length-1;last>=i;i++)elems=i===last?this:this.clone(!0),jQuery(insert[i])[original](elems),core_push.apply(ret,elems.get());return this.pushStack(ret)}}),jQuery.extend({clone:function(elem,dataAndEvents,deepDataAndEvents){var destElements,node,clone,i,srcElements,inPage=jQuery.contains(elem.ownerDocument,elem);if(jQuery.support.html5Clone||jQuery.isXMLDoc(elem)||!rnoshimcache.test("<"+elem.nodeName+">")?clone=elem.cloneNode(!0):(fragmentDiv.innerHTML=elem.outerHTML,fragmentDiv.removeChild(clone=fragmentDiv.firstChild)),!(jQuery.support.noCloneEvent&&jQuery.support.noCloneChecked||1!==elem.nodeType&&11!==elem.nodeType||jQuery.isXMLDoc(elem)))for(destElements=getAll(clone),srcElements=getAll(elem),i=0;null!=(node=srcElements[i]);++i)destElements[i]&&fixCloneNodeIssues(node,destElements[i]);if(dataAndEvents)if(deepDataAndEvents)for(srcElements=srcElements||getAll(elem),destElements=destElements||getAll(clone),i=0;null!=(node=srcElements[i]);i++)cloneCopyEvent(node,destElements[i]);else cloneCopyEvent(elem,clone);return destElements=getAll(clone,"script"),destElements.length>0&&setGlobalEval(destElements,!inPage&&getAll(elem,"script")),destElements=srcElements=node=null,clone},buildFragment:function(elems,context,scripts,selection){for(var j,elem,contains,tmp,tag,tbody,wrap,l=elems.length,safe=createSafeFragment(context),nodes=[],i=0;l>i;i++)if(elem=elems[i],elem||0===elem)if("object"===jQuery.type(elem))jQuery.merge(nodes,elem.nodeType?[elem]:elem);else if(rhtml.test(elem)){for(tmp=tmp||safe.appendChild(context.createElement("div")),tag=(rtagName.exec(elem)||["",""])[1].toLowerCase(),wrap=wrapMap[tag]||wrapMap._default,tmp.innerHTML=wrap[1]+elem.replace(rxhtmlTag,"<$1></$2>")+wrap[2],j=wrap[0];j--;)tmp=tmp.lastChild;if(!jQuery.support.leadingWhitespace&&rleadingWhitespace.test(elem)&&nodes.push(context.createTextNode(rleadingWhitespace.exec(elem)[0])),!jQuery.support.tbody)for(elem="table"!==tag||rtbody.test(elem)?"<table>"!==wrap[1]||rtbody.test(elem)?0:tmp:tmp.firstChild,j=elem&&elem.childNodes.length;j--;)jQuery.nodeName(tbody=elem.childNodes[j],"tbody")&&!tbody.childNodes.length&&elem.removeChild(tbody);for(jQuery.merge(nodes,tmp.childNodes),tmp.textContent="";tmp.firstChild;)tmp.removeChild(tmp.firstChild);tmp=safe.lastChild}else nodes.push(context.createTextNode(elem));
for(tmp&&safe.removeChild(tmp),jQuery.support.appendChecked||jQuery.grep(getAll(nodes,"input"),fixDefaultChecked),i=0;elem=nodes[i++];)if((!selection||-1===jQuery.inArray(elem,selection))&&(contains=jQuery.contains(elem.ownerDocument,elem),tmp=getAll(safe.appendChild(elem),"script"),contains&&setGlobalEval(tmp),scripts))for(j=0;elem=tmp[j++];)rscriptType.test(elem.type||"")&&scripts.push(elem);return tmp=null,safe},cleanData:function(elems,acceptData){for(var elem,type,id,data,i=0,internalKey=jQuery.expando,cache=jQuery.cache,deleteExpando=jQuery.support.deleteExpando,special=jQuery.event.special;null!=(elem=elems[i]);i++)if((acceptData||jQuery.acceptData(elem))&&(id=elem[internalKey],data=id&&cache[id])){if(data.events)for(type in data.events)special[type]?jQuery.event.remove(elem,type):jQuery.removeEvent(elem,type,data.handle);cache[id]&&(delete cache[id],deleteExpando?delete elem[internalKey]:typeof elem.removeAttribute!==core_strundefined?elem.removeAttribute(internalKey):elem[internalKey]=null,core_deletedIds.push(id))}},_evalUrl:function(url){return jQuery.ajax({url:url,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})}}),jQuery.fn.extend({wrapAll:function(html){if(jQuery.isFunction(html))return this.each(function(i){jQuery(this).wrapAll(html.call(this,i))});if(this[0]){var wrap=jQuery(html,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&wrap.insertBefore(this[0]),wrap.map(function(){for(var elem=this;elem.firstChild&&1===elem.firstChild.nodeType;)elem=elem.firstChild;return elem}).append(this)}return this},wrapInner:function(html){return this.each(jQuery.isFunction(html)?function(i){jQuery(this).wrapInner(html.call(this,i))}:function(){var self=jQuery(this),contents=self.contents();contents.length?contents.wrapAll(html):self.append(html)})},wrap:function(html){var isFunction=jQuery.isFunction(html);return this.each(function(i){jQuery(this).wrapAll(isFunction?html.call(this,i):html)})},unwrap:function(){return this.parent().each(function(){jQuery.nodeName(this,"body")||jQuery(this).replaceWith(this.childNodes)}).end()}});var iframe,getStyles,curCSS,ralpha=/alpha\([^)]*\)/i,ropacity=/opacity\s*=\s*([^)]*)/,rposition=/^(top|right|bottom|left)$/,rdisplayswap=/^(none|table(?!-c[ea]).+)/,rmargin=/^margin/,rnumsplit=new RegExp("^("+core_pnum+")(.*)$","i"),rnumnonpx=new RegExp("^("+core_pnum+")(?!px)[a-z%]+$","i"),rrelNum=new RegExp("^([+-])=("+core_pnum+")","i"),elemdisplay={BODY:"block"},cssShow={position:"absolute",visibility:"hidden",display:"block"},cssNormalTransform={letterSpacing:0,fontWeight:400},cssExpand=["Top","Right","Bottom","Left"],cssPrefixes=["Webkit","O","Moz","ms"];jQuery.fn.extend({css:function(name,value){return jQuery.access(this,function(elem,name,value){var len,styles,map={},i=0;if(jQuery.isArray(name)){for(styles=getStyles(elem),len=name.length;len>i;i++)map[name[i]]=jQuery.css(elem,name[i],!1,styles);return map}return value!==undefined?jQuery.style(elem,name,value):jQuery.css(elem,name)},name,value,arguments.length>1)},show:function(){return showHide(this,!0)},hide:function(){return showHide(this)},toggle:function(state){return"boolean"==typeof state?state?this.show():this.hide():this.each(function(){isHidden(this)?jQuery(this).show():jQuery(this).hide()})}}),jQuery.extend({cssHooks:{opacity:{get:function(elem,computed){if(computed){var ret=curCSS(elem,"opacity");return""===ret?"1":ret}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":jQuery.support.cssFloat?"cssFloat":"styleFloat"},style:function(elem,name,value,extra){if(elem&&3!==elem.nodeType&&8!==elem.nodeType&&elem.style){var ret,type,hooks,origName=jQuery.camelCase(name),style=elem.style;if(name=jQuery.cssProps[origName]||(jQuery.cssProps[origName]=vendorPropName(style,origName)),hooks=jQuery.cssHooks[name]||jQuery.cssHooks[origName],value===undefined)return hooks&&"get"in hooks&&(ret=hooks.get(elem,!1,extra))!==undefined?ret:style[name];if(type=typeof value,"string"===type&&(ret=rrelNum.exec(value))&&(value=(ret[1]+1)*ret[2]+parseFloat(jQuery.css(elem,name)),type="number"),!(null==value||"number"===type&&isNaN(value)||("number"!==type||jQuery.cssNumber[origName]||(value+="px"),jQuery.support.clearCloneStyle||""!==value||0!==name.indexOf("background")||(style[name]="inherit"),hooks&&"set"in hooks&&(value=hooks.set(elem,value,extra))===undefined)))try{style[name]=value}catch(e){}}},css:function(elem,name,extra,styles){var num,val,hooks,origName=jQuery.camelCase(name);return name=jQuery.cssProps[origName]||(jQuery.cssProps[origName]=vendorPropName(elem.style,origName)),hooks=jQuery.cssHooks[name]||jQuery.cssHooks[origName],hooks&&"get"in hooks&&(val=hooks.get(elem,!0,extra)),val===undefined&&(val=curCSS(elem,name,styles)),"normal"===val&&name in cssNormalTransform&&(val=cssNormalTransform[name]),""===extra||extra?(num=parseFloat(val),extra===!0||jQuery.isNumeric(num)?num||0:val):val}}),window.getComputedStyle?(getStyles=function(elem){return window.getComputedStyle(elem,null)},curCSS=function(elem,name,_computed){var width,minWidth,maxWidth,computed=_computed||getStyles(elem),ret=computed?computed.getPropertyValue(name)||computed[name]:undefined,style=elem.style;return computed&&(""!==ret||jQuery.contains(elem.ownerDocument,elem)||(ret=jQuery.style(elem,name)),rnumnonpx.test(ret)&&rmargin.test(name)&&(width=style.width,minWidth=style.minWidth,maxWidth=style.maxWidth,style.minWidth=style.maxWidth=style.width=ret,ret=computed.width,style.width=width,style.minWidth=minWidth,style.maxWidth=maxWidth)),ret}):document.documentElement.currentStyle&&(getStyles=function(elem){return elem.currentStyle},curCSS=function(elem,name,_computed){var left,rs,rsLeft,computed=_computed||getStyles(elem),ret=computed?computed[name]:undefined,style=elem.style;return null==ret&&style&&style[name]&&(ret=style[name]),rnumnonpx.test(ret)&&!rposition.test(name)&&(left=style.left,rs=elem.runtimeStyle,rsLeft=rs&&rs.left,rsLeft&&(rs.left=elem.currentStyle.left),style.left="fontSize"===name?"1em":ret,ret=style.pixelLeft+"px",style.left=left,rsLeft&&(rs.left=rsLeft)),""===ret?"auto":ret}),jQuery.each(["height","width"],function(i,name){jQuery.cssHooks[name]={get:function(elem,computed,extra){return computed?0===elem.offsetWidth&&rdisplayswap.test(jQuery.css(elem,"display"))?jQuery.swap(elem,cssShow,function(){return getWidthOrHeight(elem,name,extra)}):getWidthOrHeight(elem,name,extra):void 0},set:function(elem,value,extra){var styles=extra&&getStyles(elem);return setPositiveNumber(elem,value,extra?augmentWidthOrHeight(elem,name,extra,jQuery.support.boxSizing&&"border-box"===jQuery.css(elem,"boxSizing",!1,styles),styles):0)}}}),jQuery.support.opacity||(jQuery.cssHooks.opacity={get:function(elem,computed){return ropacity.test((computed&&elem.currentStyle?elem.currentStyle.filter:elem.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":computed?"1":""},set:function(elem,value){var style=elem.style,currentStyle=elem.currentStyle,opacity=jQuery.isNumeric(value)?"alpha(opacity="+100*value+")":"",filter=currentStyle&&currentStyle.filter||style.filter||"";style.zoom=1,(value>=1||""===value)&&""===jQuery.trim(filter.replace(ralpha,""))&&style.removeAttribute&&(style.removeAttribute("filter"),""===value||currentStyle&&!currentStyle.filter)||(style.filter=ralpha.test(filter)?filter.replace(ralpha,opacity):filter+" "+opacity)}}),jQuery(function(){jQuery.support.reliableMarginRight||(jQuery.cssHooks.marginRight={get:function(elem,computed){return computed?jQuery.swap(elem,{display:"inline-block"},curCSS,[elem,"marginRight"]):void 0}}),!jQuery.support.pixelPosition&&jQuery.fn.position&&jQuery.each(["top","left"],function(i,prop){jQuery.cssHooks[prop]={get:function(elem,computed){return computed?(computed=curCSS(elem,prop),rnumnonpx.test(computed)?jQuery(elem).position()[prop]+"px":computed):void 0}}})}),jQuery.expr&&jQuery.expr.filters&&(jQuery.expr.filters.hidden=function(elem){return elem.offsetWidth<=0&&elem.offsetHeight<=0||!jQuery.support.reliableHiddenOffsets&&"none"===(elem.style&&elem.style.display||jQuery.css(elem,"display"))},jQuery.expr.filters.visible=function(elem){return!jQuery.expr.filters.hidden(elem)}),jQuery.each({margin:"",padding:"",border:"Width"},function(prefix,suffix){jQuery.cssHooks[prefix+suffix]={expand:function(value){for(var i=0,expanded={},parts="string"==typeof value?value.split(" "):[value];4>i;i++)expanded[prefix+cssExpand[i]+suffix]=parts[i]||parts[i-2]||parts[0];return expanded}},rmargin.test(prefix)||(jQuery.cssHooks[prefix+suffix].set=setPositiveNumber)});var r20=/%20/g,rbracket=/\[\]$/,rCRLF=/\r?\n/g,rsubmitterTypes=/^(?:submit|button|image|reset|file)$/i,rsubmittable=/^(?:input|select|textarea|keygen)/i;jQuery.fn.extend({serialize:function(){return jQuery.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var elements=jQuery.prop(this,"elements");return elements?jQuery.makeArray(elements):this}).filter(function(){var type=this.type;return this.name&&!jQuery(this).is(":disabled")&&rsubmittable.test(this.nodeName)&&!rsubmitterTypes.test(type)&&(this.checked||!manipulation_rcheckableType.test(type))}).map(function(i,elem){var val=jQuery(this).val();return null==val?null:jQuery.isArray(val)?jQuery.map(val,function(val){return{name:elem.name,value:val.replace(rCRLF,"\r\n")}}):{name:elem.name,value:val.replace(rCRLF,"\r\n")}}).get()}}),jQuery.param=function(a,traditional){var prefix,s=[],add=function(key,value){value=jQuery.isFunction(value)?value():null==value?"":value,s[s.length]=encodeURIComponent(key)+"="+encodeURIComponent(value)};if(traditional===undefined&&(traditional=jQuery.ajaxSettings&&jQuery.ajaxSettings.traditional),jQuery.isArray(a)||a.jquery&&!jQuery.isPlainObject(a))jQuery.each(a,function(){add(this.name,this.value)});else for(prefix in a)buildParams(prefix,a[prefix],traditional,add);return s.join("&").replace(r20,"+")},jQuery.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(i,name){jQuery.fn[name]=function(data,fn){return arguments.length>0?this.on(name,null,data,fn):this.trigger(name)}}),jQuery.fn.extend({hover:function(fnOver,fnOut){return this.mouseenter(fnOver).mouseleave(fnOut||fnOver)},bind:function(types,data,fn){return this.on(types,null,data,fn)},unbind:function(types,fn){return this.off(types,null,fn)},delegate:function(selector,types,data,fn){return this.on(types,selector,data,fn)},undelegate:function(selector,types,fn){return 1===arguments.length?this.off(selector,"**"):this.off(types,selector||"**",fn)}});var ajaxLocParts,ajaxLocation,ajax_nonce=jQuery.now(),ajax_rquery=/\?/,rhash=/#.*$/,rts=/([?&])_=[^&]*/,rheaders=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,rlocalProtocol=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,rnoContent=/^(?:GET|HEAD)$/,rprotocol=/^\/\//,rurl=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,_load=jQuery.fn.load,prefilters={},transports={},allTypes="*/".concat("*");try{ajaxLocation=location.href}catch(e){ajaxLocation=document.createElement("a"),ajaxLocation.href="",ajaxLocation=ajaxLocation.href}ajaxLocParts=rurl.exec(ajaxLocation.toLowerCase())||[],jQuery.fn.load=function(url,params,callback){if("string"!=typeof url&&_load)return _load.apply(this,arguments);var selector,response,type,self=this,off=url.indexOf(" ");return off>=0&&(selector=url.slice(off,url.length),url=url.slice(0,off)),jQuery.isFunction(params)?(callback=params,params=undefined):params&&"object"==typeof params&&(type="POST"),self.length>0&&jQuery.ajax({url:url,type:type,dataType:"html",data:params}).done(function(responseText){response=arguments,self.html(selector?jQuery("<div>").append(jQuery.parseHTML(responseText)).find(selector):responseText)}).complete(callback&&function(jqXHR,status){self.each(callback,response||[jqXHR.responseText,status,jqXHR])}),this},jQuery.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(i,type){jQuery.fn[type]=function(fn){return this.on(type,fn)}}),jQuery.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:ajaxLocation,type:"GET",isLocal:rlocalProtocol.test(ajaxLocParts[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":allTypes,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":jQuery.parseJSON,"text xml":jQuery.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(target,settings){return settings?ajaxExtend(ajaxExtend(target,jQuery.ajaxSettings),settings):ajaxExtend(jQuery.ajaxSettings,target)},ajaxPrefilter:addToPrefiltersOrTransports(prefilters),ajaxTransport:addToPrefiltersOrTransports(transports),ajax:function(url,options){function done(status,nativeStatusText,responses,headers){var isSuccess,success,error,response,modified,statusText=nativeStatusText;2!==state&&(state=2,timeoutTimer&&clearTimeout(timeoutTimer),transport=undefined,responseHeadersString=headers||"",jqXHR.readyState=status>0?4:0,isSuccess=status>=200&&300>status||304===status,responses&&(response=ajaxHandleResponses(s,jqXHR,responses)),response=ajaxConvert(s,response,jqXHR,isSuccess),isSuccess?(s.ifModified&&(modified=jqXHR.getResponseHeader("Last-Modified"),modified&&(jQuery.lastModified[cacheURL]=modified),modified=jqXHR.getResponseHeader("etag"),modified&&(jQuery.etag[cacheURL]=modified)),204===status||"HEAD"===s.type?statusText="nocontent":304===status?statusText="notmodified":(statusText=response.state,success=response.data,error=response.error,isSuccess=!error)):(error=statusText,(status||!statusText)&&(statusText="error",0>status&&(status=0))),jqXHR.status=status,jqXHR.statusText=(nativeStatusText||statusText)+"",isSuccess?deferred.resolveWith(callbackContext,[success,statusText,jqXHR]):deferred.rejectWith(callbackContext,[jqXHR,statusText,error]),jqXHR.statusCode(statusCode),statusCode=undefined,fireGlobals&&globalEventContext.trigger(isSuccess?"ajaxSuccess":"ajaxError",[jqXHR,s,isSuccess?success:error]),completeDeferred.fireWith(callbackContext,[jqXHR,statusText]),fireGlobals&&(globalEventContext.trigger("ajaxComplete",[jqXHR,s]),--jQuery.active||jQuery.event.trigger("ajaxStop")))}"object"==typeof url&&(options=url,url=undefined),options=options||{};var parts,i,cacheURL,responseHeadersString,timeoutTimer,fireGlobals,transport,responseHeaders,s=jQuery.ajaxSetup({},options),callbackContext=s.context||s,globalEventContext=s.context&&(callbackContext.nodeType||callbackContext.jquery)?jQuery(callbackContext):jQuery.event,deferred=jQuery.Deferred(),completeDeferred=jQuery.Callbacks("once memory"),statusCode=s.statusCode||{},requestHeaders={},requestHeadersNames={},state=0,strAbort="canceled",jqXHR={readyState:0,getResponseHeader:function(key){var match;if(2===state){if(!responseHeaders)for(responseHeaders={};match=rheaders.exec(responseHeadersString);)responseHeaders[match[1].toLowerCase()]=match[2];match=responseHeaders[key.toLowerCase()]}return null==match?null:match},getAllResponseHeaders:function(){return 2===state?responseHeadersString:null},setRequestHeader:function(name,value){var lname=name.toLowerCase();return state||(name=requestHeadersNames[lname]=requestHeadersNames[lname]||name,requestHeaders[name]=value),this},overrideMimeType:function(type){return state||(s.mimeType=type),this},statusCode:function(map){var code;if(map)if(2>state)for(code in map)statusCode[code]=[statusCode[code],map[code]];else jqXHR.always(map[jqXHR.status]);return this},abort:function(statusText){var finalText=statusText||strAbort;return transport&&transport.abort(finalText),done(0,finalText),this}};if(deferred.promise(jqXHR).complete=completeDeferred.add,jqXHR.success=jqXHR.done,jqXHR.error=jqXHR.fail,s.url=((url||s.url||ajaxLocation)+"").replace(rhash,"").replace(rprotocol,ajaxLocParts[1]+"//"),s.type=options.method||options.type||s.method||s.type,s.dataTypes=jQuery.trim(s.dataType||"*").toLowerCase().match(core_rnotwhite)||[""],null==s.crossDomain&&(parts=rurl.exec(s.url.toLowerCase()),s.crossDomain=!(!parts||parts[1]===ajaxLocParts[1]&&parts[2]===ajaxLocParts[2]&&(parts[3]||("http:"===parts[1]?"80":"443"))===(ajaxLocParts[3]||("http:"===ajaxLocParts[1]?"80":"443")))),s.data&&s.processData&&"string"!=typeof s.data&&(s.data=jQuery.param(s.data,s.traditional)),inspectPrefiltersOrTransports(prefilters,s,options,jqXHR),2===state)return jqXHR;fireGlobals=s.global,fireGlobals&&0===jQuery.active++&&jQuery.event.trigger("ajaxStart"),s.type=s.type.toUpperCase(),s.hasContent=!rnoContent.test(s.type),cacheURL=s.url,s.hasContent||(s.data&&(cacheURL=s.url+=(ajax_rquery.test(cacheURL)?"&":"?")+s.data,delete s.data),s.cache===!1&&(s.url=rts.test(cacheURL)?cacheURL.replace(rts,"$1_="+ajax_nonce++):cacheURL+(ajax_rquery.test(cacheURL)?"&":"?")+"_="+ajax_nonce++)),s.ifModified&&(jQuery.lastModified[cacheURL]&&jqXHR.setRequestHeader("If-Modified-Since",jQuery.lastModified[cacheURL]),jQuery.etag[cacheURL]&&jqXHR.setRequestHeader("If-None-Match",jQuery.etag[cacheURL])),(s.data&&s.hasContent&&s.contentType!==!1||options.contentType)&&jqXHR.setRequestHeader("Content-Type",s.contentType),jqXHR.setRequestHeader("Accept",s.dataTypes[0]&&s.accepts[s.dataTypes[0]]?s.accepts[s.dataTypes[0]]+("*"!==s.dataTypes[0]?", "+allTypes+"; q=0.01":""):s.accepts["*"]);for(i in s.headers)jqXHR.setRequestHeader(i,s.headers[i]);if(s.beforeSend&&(s.beforeSend.call(callbackContext,jqXHR,s)===!1||2===state))return jqXHR.abort();strAbort="abort";for(i in{success:1,error:1,complete:1})jqXHR[i](s[i]);if(transport=inspectPrefiltersOrTransports(transports,s,options,jqXHR)){jqXHR.readyState=1,fireGlobals&&globalEventContext.trigger("ajaxSend",[jqXHR,s]),s.async&&s.timeout>0&&(timeoutTimer=setTimeout(function(){jqXHR.abort("timeout")},s.timeout));try{state=1,transport.send(requestHeaders,done)}catch(e){if(!(2>state))throw e;done(-1,e)}}else done(-1,"No Transport");return jqXHR},getJSON:function(url,data,callback){return jQuery.get(url,data,callback,"json")},getScript:function(url,callback){return jQuery.get(url,undefined,callback,"script")}}),jQuery.each(["get","post"],function(i,method){jQuery[method]=function(url,data,callback,type){return jQuery.isFunction(data)&&(type=type||callback,callback=data,data=undefined),jQuery.ajax({url:url,type:method,dataType:type,data:data,success:callback})}}),jQuery.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(text){return jQuery.globalEval(text),text}}}),jQuery.ajaxPrefilter("script",function(s){s.cache===undefined&&(s.cache=!1),s.crossDomain&&(s.type="GET",s.global=!1)}),jQuery.ajaxTransport("script",function(s){if(s.crossDomain){var script,head=document.head||jQuery("head")[0]||document.documentElement;return{send:function(_,callback){script=document.createElement("script"),script.async=!0,s.scriptCharset&&(script.charset=s.scriptCharset),script.src=s.url,script.onload=script.onreadystatechange=function(_,isAbort){(isAbort||!script.readyState||/loaded|complete/.test(script.readyState))&&(script.onload=script.onreadystatechange=null,script.parentNode&&script.parentNode.removeChild(script),script=null,isAbort||callback(200,"success"))},head.insertBefore(script,head.firstChild)},abort:function(){script&&script.onload(undefined,!0)}}}});var oldCallbacks=[],rjsonp=/(=)\?(?=&|$)|\?\?/;jQuery.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var callback=oldCallbacks.pop()||jQuery.expando+"_"+ajax_nonce++;return this[callback]=!0,callback}}),jQuery.ajaxPrefilter("json jsonp",function(s,originalSettings,jqXHR){var callbackName,overwritten,responseContainer,jsonProp=s.jsonp!==!1&&(rjsonp.test(s.url)?"url":"string"==typeof s.data&&!(s.contentType||"").indexOf("application/x-www-form-urlencoded")&&rjsonp.test(s.data)&&"data");return jsonProp||"jsonp"===s.dataTypes[0]?(callbackName=s.jsonpCallback=jQuery.isFunction(s.jsonpCallback)?s.jsonpCallback():s.jsonpCallback,jsonProp?s[jsonProp]=s[jsonProp].replace(rjsonp,"$1"+callbackName):s.jsonp!==!1&&(s.url+=(ajax_rquery.test(s.url)?"&":"?")+s.jsonp+"="+callbackName),s.converters["script json"]=function(){return responseContainer||jQuery.error(callbackName+" was not called"),responseContainer[0]},s.dataTypes[0]="json",overwritten=window[callbackName],window[callbackName]=function(){responseContainer=arguments},jqXHR.always(function(){window[callbackName]=overwritten,s[callbackName]&&(s.jsonpCallback=originalSettings.jsonpCallback,oldCallbacks.push(callbackName)),responseContainer&&jQuery.isFunction(overwritten)&&overwritten(responseContainer[0]),responseContainer=overwritten=undefined}),"script"):void 0});var xhrCallbacks,xhrSupported,xhrId=0,xhrOnUnloadAbort=window.ActiveXObject&&function(){var key;for(key in xhrCallbacks)xhrCallbacks[key](undefined,!0)};jQuery.ajaxSettings.xhr=window.ActiveXObject?function(){return!this.isLocal&&createStandardXHR()||createActiveXHR()}:createStandardXHR,xhrSupported=jQuery.ajaxSettings.xhr(),jQuery.support.cors=!!xhrSupported&&"withCredentials"in xhrSupported,xhrSupported=jQuery.support.ajax=!!xhrSupported,xhrSupported&&jQuery.ajaxTransport(function(s){if(!s.crossDomain||jQuery.support.cors){var callback;return{send:function(headers,complete){var handle,i,xhr=s.xhr();if(s.username?xhr.open(s.type,s.url,s.async,s.username,s.password):xhr.open(s.type,s.url,s.async),s.xhrFields)for(i in s.xhrFields)xhr[i]=s.xhrFields[i];s.mimeType&&xhr.overrideMimeType&&xhr.overrideMimeType(s.mimeType),s.crossDomain||headers["X-Requested-With"]||(headers["X-Requested-With"]="XMLHttpRequest");try{for(i in headers)xhr.setRequestHeader(i,headers[i])}catch(err){}xhr.send(s.hasContent&&s.data||null),callback=function(_,isAbort){var status,responseHeaders,statusText,responses;try{if(callback&&(isAbort||4===xhr.readyState))if(callback=undefined,handle&&(xhr.onreadystatechange=jQuery.noop,xhrOnUnloadAbort&&delete xhrCallbacks[handle]),isAbort)4!==xhr.readyState&&xhr.abort();else{responses={},status=xhr.status,responseHeaders=xhr.getAllResponseHeaders(),"string"==typeof xhr.responseText&&(responses.text=xhr.responseText);try{statusText=xhr.statusText}catch(e){statusText=""}status||!s.isLocal||s.crossDomain?1223===status&&(status=204):status=responses.text?200:404}}catch(firefoxAccessException){isAbort||complete(-1,firefoxAccessException)}responses&&complete(status,statusText,responses,responseHeaders)},s.async?4===xhr.readyState?setTimeout(callback):(handle=++xhrId,xhrOnUnloadAbort&&(xhrCallbacks||(xhrCallbacks={},jQuery(window).unload(xhrOnUnloadAbort)),xhrCallbacks[handle]=callback),xhr.onreadystatechange=callback):callback()},abort:function(){callback&&callback(undefined,!0)}}}});var fxNow,timerId,rfxtypes=/^(?:toggle|show|hide)$/,rfxnum=new RegExp("^(?:([+-])=|)("+core_pnum+")([a-z%]*)$","i"),rrun=/queueHooks$/,animationPrefilters=[defaultPrefilter],tweeners={"*":[function(prop,value){var tween=this.createTween(prop,value),target=tween.cur(),parts=rfxnum.exec(value),unit=parts&&parts[3]||(jQuery.cssNumber[prop]?"":"px"),start=(jQuery.cssNumber[prop]||"px"!==unit&&+target)&&rfxnum.exec(jQuery.css(tween.elem,prop)),scale=1,maxIterations=20;if(start&&start[3]!==unit){unit=unit||start[3],parts=parts||[],start=+target||1;do scale=scale||".5",start/=scale,jQuery.style(tween.elem,prop,start+unit);while(scale!==(scale=tween.cur()/target)&&1!==scale&&--maxIterations)}return parts&&(start=tween.start=+start||+target||0,tween.unit=unit,tween.end=parts[1]?start+(parts[1]+1)*parts[2]:+parts[2]),tween}]};jQuery.Animation=jQuery.extend(Animation,{tweener:function(props,callback){jQuery.isFunction(props)?(callback=props,props=["*"]):props=props.split(" ");for(var prop,index=0,length=props.length;length>index;index++)prop=props[index],tweeners[prop]=tweeners[prop]||[],tweeners[prop].unshift(callback)},prefilter:function(callback,prepend){prepend?animationPrefilters.unshift(callback):animationPrefilters.push(callback)}}),jQuery.Tween=Tween,Tween.prototype={constructor:Tween,init:function(elem,options,prop,end,easing,unit){this.elem=elem,this.prop=prop,this.easing=easing||"swing",this.options=options,this.start=this.now=this.cur(),this.end=end,this.unit=unit||(jQuery.cssNumber[prop]?"":"px")},cur:function(){var hooks=Tween.propHooks[this.prop];return hooks&&hooks.get?hooks.get(this):Tween.propHooks._default.get(this)},run:function(percent){var eased,hooks=Tween.propHooks[this.prop];return this.pos=eased=this.options.duration?jQuery.easing[this.easing](percent,this.options.duration*percent,0,1,this.options.duration):percent,this.now=(this.end-this.start)*eased+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),hooks&&hooks.set?hooks.set(this):Tween.propHooks._default.set(this),this}},Tween.prototype.init.prototype=Tween.prototype,Tween.propHooks={_default:{get:function(tween){var result;return null==tween.elem[tween.prop]||tween.elem.style&&null!=tween.elem.style[tween.prop]?(result=jQuery.css(tween.elem,tween.prop,""),result&&"auto"!==result?result:0):tween.elem[tween.prop]},set:function(tween){jQuery.fx.step[tween.prop]?jQuery.fx.step[tween.prop](tween):tween.elem.style&&(null!=tween.elem.style[jQuery.cssProps[tween.prop]]||jQuery.cssHooks[tween.prop])?jQuery.style(tween.elem,tween.prop,tween.now+tween.unit):tween.elem[tween.prop]=tween.now}}},Tween.propHooks.scrollTop=Tween.propHooks.scrollLeft={set:function(tween){tween.elem.nodeType&&tween.elem.parentNode&&(tween.elem[tween.prop]=tween.now)}},jQuery.each(["toggle","show","hide"],function(i,name){var cssFn=jQuery.fn[name];jQuery.fn[name]=function(speed,easing,callback){return null==speed||"boolean"==typeof speed?cssFn.apply(this,arguments):this.animate(genFx(name,!0),speed,easing,callback)}}),jQuery.fn.extend({fadeTo:function(speed,to,easing,callback){return this.filter(isHidden).css("opacity",0).show().end().animate({opacity:to},speed,easing,callback)},animate:function(prop,speed,easing,callback){var empty=jQuery.isEmptyObject(prop),optall=jQuery.speed(speed,easing,callback),doAnimation=function(){var anim=Animation(this,jQuery.extend({},prop),optall);(empty||jQuery._data(this,"finish"))&&anim.stop(!0)};return doAnimation.finish=doAnimation,empty||optall.queue===!1?this.each(doAnimation):this.queue(optall.queue,doAnimation)},stop:function(type,clearQueue,gotoEnd){var stopQueue=function(hooks){var stop=hooks.stop;delete hooks.stop,stop(gotoEnd)};return"string"!=typeof type&&(gotoEnd=clearQueue,clearQueue=type,type=undefined),clearQueue&&type!==!1&&this.queue(type||"fx",[]),this.each(function(){var dequeue=!0,index=null!=type&&type+"queueHooks",timers=jQuery.timers,data=jQuery._data(this);if(index)data[index]&&data[index].stop&&stopQueue(data[index]);else for(index in data)data[index]&&data[index].stop&&rrun.test(index)&&stopQueue(data[index]);for(index=timers.length;index--;)timers[index].elem!==this||null!=type&&timers[index].queue!==type||(timers[index].anim.stop(gotoEnd),dequeue=!1,timers.splice(index,1));(dequeue||!gotoEnd)&&jQuery.dequeue(this,type)})},finish:function(type){return type!==!1&&(type=type||"fx"),this.each(function(){var index,data=jQuery._data(this),queue=data[type+"queue"],hooks=data[type+"queueHooks"],timers=jQuery.timers,length=queue?queue.length:0;for(data.finish=!0,jQuery.queue(this,type,[]),hooks&&hooks.stop&&hooks.stop.call(this,!0),index=timers.length;index--;)timers[index].elem===this&&timers[index].queue===type&&(timers[index].anim.stop(!0),timers.splice(index,1));for(index=0;length>index;index++)queue[index]&&queue[index].finish&&queue[index].finish.call(this);delete data.finish})}}),jQuery.each({slideDown:genFx("show"),slideUp:genFx("hide"),slideToggle:genFx("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(name,props){jQuery.fn[name]=function(speed,easing,callback){return this.animate(props,speed,easing,callback)}}),jQuery.speed=function(speed,easing,fn){var opt=speed&&"object"==typeof speed?jQuery.extend({},speed):{complete:fn||!fn&&easing||jQuery.isFunction(speed)&&speed,duration:speed,easing:fn&&easing||easing&&!jQuery.isFunction(easing)&&easing};return opt.duration=jQuery.fx.off?0:"number"==typeof opt.duration?opt.duration:opt.duration in jQuery.fx.speeds?jQuery.fx.speeds[opt.duration]:jQuery.fx.speeds._default,(null==opt.queue||opt.queue===!0)&&(opt.queue="fx"),opt.old=opt.complete,opt.complete=function(){jQuery.isFunction(opt.old)&&opt.old.call(this),opt.queue&&jQuery.dequeue(this,opt.queue)},opt},jQuery.easing={linear:function(p){return p},swing:function(p){return.5-Math.cos(p*Math.PI)/2}},jQuery.timers=[],jQuery.fx=Tween.prototype.init,jQuery.fx.tick=function(){var timer,timers=jQuery.timers,i=0;for(fxNow=jQuery.now();i<timers.length;i++)timer=timers[i],timer()||timers[i]!==timer||timers.splice(i--,1);timers.length||jQuery.fx.stop(),fxNow=undefined},jQuery.fx.timer=function(timer){timer()&&jQuery.timers.push(timer)&&jQuery.fx.start()},jQuery.fx.interval=13,jQuery.fx.start=function(){timerId||(timerId=setInterval(jQuery.fx.tick,jQuery.fx.interval))},jQuery.fx.stop=function(){clearInterval(timerId),timerId=null},jQuery.fx.speeds={slow:600,fast:200,_default:400},jQuery.fx.step={},jQuery.expr&&jQuery.expr.filters&&(jQuery.expr.filters.animated=function(elem){return jQuery.grep(jQuery.timers,function(fn){return elem===fn.elem}).length}),jQuery.fn.offset=function(options){if(arguments.length)return options===undefined?this:this.each(function(i){jQuery.offset.setOffset(this,options,i)});var docElem,win,box={top:0,left:0},elem=this[0],doc=elem&&elem.ownerDocument;if(doc)return docElem=doc.documentElement,jQuery.contains(docElem,elem)?(typeof elem.getBoundingClientRect!==core_strundefined&&(box=elem.getBoundingClientRect()),win=getWindow(doc),{top:box.top+(win.pageYOffset||docElem.scrollTop)-(docElem.clientTop||0),left:box.left+(win.pageXOffset||docElem.scrollLeft)-(docElem.clientLeft||0)}):box},jQuery.offset={setOffset:function(elem,options,i){var position=jQuery.css(elem,"position");"static"===position&&(elem.style.position="relative");var curTop,curLeft,curElem=jQuery(elem),curOffset=curElem.offset(),curCSSTop=jQuery.css(elem,"top"),curCSSLeft=jQuery.css(elem,"left"),calculatePosition=("absolute"===position||"fixed"===position)&&jQuery.inArray("auto",[curCSSTop,curCSSLeft])>-1,props={},curPosition={};calculatePosition?(curPosition=curElem.position(),curTop=curPosition.top,curLeft=curPosition.left):(curTop=parseFloat(curCSSTop)||0,curLeft=parseFloat(curCSSLeft)||0),jQuery.isFunction(options)&&(options=options.call(elem,i,curOffset)),null!=options.top&&(props.top=options.top-curOffset.top+curTop),null!=options.left&&(props.left=options.left-curOffset.left+curLeft),"using"in options?options.using.call(elem,props):curElem.css(props)}},jQuery.fn.extend({position:function(){if(this[0]){var offsetParent,offset,parentOffset={top:0,left:0},elem=this[0];return"fixed"===jQuery.css(elem,"position")?offset=elem.getBoundingClientRect():(offsetParent=this.offsetParent(),offset=this.offset(),jQuery.nodeName(offsetParent[0],"html")||(parentOffset=offsetParent.offset()),parentOffset.top+=jQuery.css(offsetParent[0],"borderTopWidth",!0),parentOffset.left+=jQuery.css(offsetParent[0],"borderLeftWidth",!0)),{top:offset.top-parentOffset.top-jQuery.css(elem,"marginTop",!0),left:offset.left-parentOffset.left-jQuery.css(elem,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var offsetParent=this.offsetParent||docElem;offsetParent&&!jQuery.nodeName(offsetParent,"html")&&"static"===jQuery.css(offsetParent,"position");)offsetParent=offsetParent.offsetParent;return offsetParent||docElem})}}),jQuery.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(method,prop){var top=/Y/.test(prop);
jQuery.fn[method]=function(val){return jQuery.access(this,function(elem,method,val){var win=getWindow(elem);return val===undefined?win?prop in win?win[prop]:win.document.documentElement[method]:elem[method]:void(win?win.scrollTo(top?jQuery(win).scrollLeft():val,top?val:jQuery(win).scrollTop()):elem[method]=val)},method,val,arguments.length,null)}}),jQuery.each({Height:"height",Width:"width"},function(name,type){jQuery.each({padding:"inner"+name,content:type,"":"outer"+name},function(defaultExtra,funcName){jQuery.fn[funcName]=function(margin,value){var chainable=arguments.length&&(defaultExtra||"boolean"!=typeof margin),extra=defaultExtra||(margin===!0||value===!0?"margin":"border");return jQuery.access(this,function(elem,type,value){var doc;return jQuery.isWindow(elem)?elem.document.documentElement["client"+name]:9===elem.nodeType?(doc=elem.documentElement,Math.max(elem.body["scroll"+name],doc["scroll"+name],elem.body["offset"+name],doc["offset"+name],doc["client"+name])):value===undefined?jQuery.css(elem,type,extra):jQuery.style(elem,type,value,extra)},type,chainable?margin:undefined,chainable,null)}})}),jQuery.fn.size=function(){return this.length},jQuery.fn.andSelf=jQuery.fn.addBack,"object"==typeof module&&module&&"object"==typeof module.exports?module.exports=jQuery:(window.jQuery=window.$=jQuery,"function"==typeof define&&define.amd&&define("jquery",[],function(){return jQuery}))}(window),define("home/utils/layoutUtils",["underscore","jquery"],function(_,$){!function(){var getScrollBarWidth=function(){var inner=$("<p>").css({width:"100%",height:"200px"})[0],$outer=$("<div>").css({position:"absolute",top:"0px",left:"0px",visibility:"hidden",width:"200px",height:"150px",overflow:"hidden"}).append(inner).appendTo($("body")),w1=inner.offsetWidth;$outer.css({overflow:"scroll"});var w2=inner.offsetWidth;return w1===w2&&(w2=$outer[0].clientWidth),$outer.remove(),w1-w2},insertCss=function(code){var style=$("<style>").attr("type","text/css")[0];style.styleSheet?style.styleSheet.cssText=code:style.innerHTML=code,$("head").append(style)},scrollbarWidth=getScrollBarWidth(),rules="@media only screen and (min-width: 480px) { body.scroll-fix { margin-right: "+scrollbarWidth+"px; } body.scroll-fix .compensation { margin-right: "+scrollbarWidth+"px; } }";$(function(){insertCss(rules)})}();var isScrollbarVisible=function(){var container=$("#container-page")[0];return container&&container.scrollHeight>container.clientHeight&&!$("body").hasClass("fixed")},LayoutUtils=function(){this.fixBackground=function(){this.docTop=$(document).scrollTop(),$("body").addClass("fixed").addClass("scroll-fix")},this.unfixBackground=function(){$("body").removeClass("fixed").toggleClass("scroll-fix",!isScrollbarVisible()),$(document).scrollTop(this.docTop)},this.scrollShownChanged=function(){$("body").toggleClass("scroll-fix",!isScrollbarVisible())},this.isElementInViewport=function($el){var rect=$el[0].getBoundingClientRect();return rect.top>=0&&rect.left>=0&&rect.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&rect.right<=(window.innerWidth||document.documentElement.clientWidth)},this.getScreenWidth=function(){return this.screenWidth=this.screenWidth||window.screen.width,this.screenWidth}};return function(){var instance=new LayoutUtils;return instance}()}),define("home/apps/dashboard/layoutUtils",["home/utils/layoutUtils"],function(layoutUtilsNew){return layoutUtilsNew}),window.Modernizr=function(window,document,undefined){function setCss(str){mStyle.cssText=str}function is(obj,type){return typeof obj===type}var inputElem,featureName,hasOwnProp,version="2.8.3",Modernizr={},enableClasses=!0,docElement=document.documentElement,mod="modernizr",modElem=document.createElement(mod),mStyle=modElem.style,prefixes=({}.toString," -webkit- -moz- -o- -ms- ".split(" ")),tests={},classes=[],slice=classes.slice,injectElementWithStyles=function(rule,callback,nodes,testnames){var style,ret,node,docOverflow,div=document.createElement("div"),body=document.body,fakeBody=body||document.createElement("body");if(parseInt(nodes,10))for(;nodes--;)node=document.createElement("div"),node.id=testnames?testnames[nodes]:mod+(nodes+1),div.appendChild(node);return style=["&#173;",'<style id="s',mod,'">',rule,"</style>"].join(""),div.id=mod,(body?div:fakeBody).innerHTML+=style,fakeBody.appendChild(div),body||(fakeBody.style.background="",fakeBody.style.overflow="hidden",docOverflow=docElement.style.overflow,docElement.style.overflow="hidden",docElement.appendChild(fakeBody)),ret=callback(div,rule),body?div.parentNode.removeChild(div):(fakeBody.parentNode.removeChild(fakeBody),docElement.style.overflow=docOverflow),!!ret},_hasOwnProperty={}.hasOwnProperty;hasOwnProp=is(_hasOwnProperty,"undefined")||is(_hasOwnProperty.call,"undefined")?function(object,property){return property in object&&is(object.constructor.prototype[property],"undefined")}:function(object,property){return _hasOwnProperty.call(object,property)},Function.prototype.bind||(Function.prototype.bind=function(that){var target=this;if("function"!=typeof target)throw new TypeError;var args=slice.call(arguments,1),bound=function(){if(this instanceof bound){var F=function(){};F.prototype=target.prototype;var self=new F,result=target.apply(self,args.concat(slice.call(arguments)));return Object(result)===result?result:self}return target.apply(that,args.concat(slice.call(arguments)))};return bound}),tests.touch=function(){var bool;return"ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch?bool=!0:injectElementWithStyles(["@media (",prefixes.join("touch-enabled),("),mod,")","{#modernizr{top:9px;position:absolute}}"].join(""),function(node){bool=9===node.offsetTop}),bool},tests.history=function(){return!(!window.history||!history.pushState)},tests.localstorage=function(){try{return localStorage.setItem(mod,mod),localStorage.removeItem(mod),!0}catch(e){return!1}},tests.sessionstorage=function(){try{return sessionStorage.setItem(mod,mod),sessionStorage.removeItem(mod),!0}catch(e){return!1}};for(var feature in tests)hasOwnProp(tests,feature)&&(featureName=feature.toLowerCase(),Modernizr[featureName]=tests[feature](),classes.push((Modernizr[featureName]?"":"no-")+featureName));return Modernizr.addTest=function(feature,test){if("object"==typeof feature)for(var key in feature)hasOwnProp(feature,key)&&Modernizr.addTest(key,feature[key]);else{if(feature=feature.toLowerCase(),Modernizr[feature]!==undefined)return Modernizr;test="function"==typeof test?test():test,"undefined"!=typeof enableClasses&&enableClasses&&(docElement.className+=" "+(test?"":"no-")+feature),Modernizr[feature]=test}return Modernizr},setCss(""),modElem=inputElem=null,function(window,document){function addStyleSheet(ownerDocument,cssText){var p=ownerDocument.createElement("p"),parent=ownerDocument.getElementsByTagName("head")[0]||ownerDocument.documentElement;return p.innerHTML="x<style>"+cssText+"</style>",parent.insertBefore(p.lastChild,parent.firstChild)}function getElements(){var elements=html5.elements;return"string"==typeof elements?elements.split(" "):elements}function getExpandoData(ownerDocument){var data=expandoData[ownerDocument[expando]];return data||(data={},expanID++,ownerDocument[expando]=expanID,expandoData[expanID]=data),data}function createElement(nodeName,ownerDocument,data){if(ownerDocument||(ownerDocument=document),supportsUnknownElements)return ownerDocument.createElement(nodeName);data||(data=getExpandoData(ownerDocument));var node;return node=data.cache[nodeName]?data.cache[nodeName].cloneNode():saveClones.test(nodeName)?(data.cache[nodeName]=data.createElem(nodeName)).cloneNode():data.createElem(nodeName),!node.canHaveChildren||reSkip.test(nodeName)||node.tagUrn?node:data.frag.appendChild(node)}function createDocumentFragment(ownerDocument,data){if(ownerDocument||(ownerDocument=document),supportsUnknownElements)return ownerDocument.createDocumentFragment();data=data||getExpandoData(ownerDocument);for(var clone=data.frag.cloneNode(),i=0,elems=getElements(),l=elems.length;l>i;i++)clone.createElement(elems[i]);return clone}function shivMethods(ownerDocument,data){data.cache||(data.cache={},data.createElem=ownerDocument.createElement,data.createFrag=ownerDocument.createDocumentFragment,data.frag=data.createFrag()),ownerDocument.createElement=function(nodeName){return html5.shivMethods?createElement(nodeName,ownerDocument,data):data.createElem(nodeName)},ownerDocument.createDocumentFragment=Function("h,f","return function(){var n=f.cloneNode(),c=n.createElement;h.shivMethods&&("+getElements().join().replace(/[\w\-]+/g,function(nodeName){return data.createElem(nodeName),data.frag.createElement(nodeName),'c("'+nodeName+'")'})+");return n}")(html5,data.frag)}function shivDocument(ownerDocument){ownerDocument||(ownerDocument=document);var data=getExpandoData(ownerDocument);return!html5.shivCSS||supportsHtml5Styles||data.hasCSS||(data.hasCSS=!!addStyleSheet(ownerDocument,"article,aside,dialog,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}mark{background:#FF0;color:#000}template{display:none}")),supportsUnknownElements||shivMethods(ownerDocument,data),ownerDocument}var supportsHtml5Styles,supportsUnknownElements,version="3.7.0",options=window.html5||{},reSkip=/^<|^(?:button|map|select|textarea|object|iframe|option|optgroup)$/i,saveClones=/^(?:a|b|code|div|fieldset|h1|h2|h3|h4|h5|h6|i|label|li|ol|p|q|span|strong|style|table|tbody|td|th|tr|ul)$/i,expando="_html5shiv",expanID=0,expandoData={};!function(){try{var a=document.createElement("a");a.innerHTML="<xyz></xyz>",supportsHtml5Styles="hidden"in a,supportsUnknownElements=1==a.childNodes.length||function(){document.createElement("a");var frag=document.createDocumentFragment();return"undefined"==typeof frag.cloneNode||"undefined"==typeof frag.createDocumentFragment||"undefined"==typeof frag.createElement}()}catch(e){supportsHtml5Styles=!0,supportsUnknownElements=!0}}();var html5={elements:options.elements||"abbr article aside audio bdi canvas data datalist details dialog figcaption figure footer header hgroup main mark meter nav output progress section summary template time video",version:version,shivCSS:options.shivCSS!==!1,supportsUnknownElements:supportsUnknownElements,shivMethods:options.shivMethods!==!1,type:"default",shivDocument:shivDocument,createElement:createElement,createDocumentFragment:createDocumentFragment};window.html5=html5,shivDocument(document)}(this,document),Modernizr._version=version,Modernizr._prefixes=prefixes,Modernizr.testStyles=injectElementWithStyles,docElement.className=docElement.className.replace(/(^|\s)no-js(\s|$)/,"$1$2")+(enableClasses?" js "+classes.join(" "):""),Modernizr}(this,this.document),function(a,b,c){function d(a){return"[object Function]"==o.call(a)}function e(a){return"string"==typeof a}function f(){}function g(a){return!a||"loaded"==a||"complete"==a||"uninitialized"==a}function h(){var a=p.shift();q=1,a?a.t?m(function(){("c"==a.t?B.injectCss:B.injectJs)(a.s,0,a.a,a.x,a.e,1)},0):(a(),h()):q=0}function i(a,c,d,e,f,i,j){function k(b){if(!o&&g(l.readyState)&&(u.r=o=1,!q&&h(),l.onload=l.onreadystatechange=null,b)){"img"!=a&&m(function(){t.removeChild(l)},50);for(var d in y[c])y[c].hasOwnProperty(d)&&y[c][d].onload()}}var j=j||B.errorTimeout,l=b.createElement(a),o=0,r=0,u={t:d,s:c,e:f,a:i,x:j};1===y[c]&&(r=1,y[c]=[]),"object"==a?l.data=c:(l.src=c,l.type=a),l.width=l.height="0",l.onerror=l.onload=l.onreadystatechange=function(){k.call(this,r)},p.splice(e,0,u),"img"!=a&&(r||2===y[c]?(t.insertBefore(l,s?null:n),m(k,j)):y[c].push(l))}function j(a,b,c,d,f){return q=0,b=b||"j",e(a)?i("c"==b?v:u,a,b,this.i++,c,d,f):(p.splice(this.i++,0,a),1==p.length&&h()),this}function k(){var a=B;return a.loader={load:j,i:0},a}var A,B,l=b.documentElement,m=a.setTimeout,n=b.getElementsByTagName("script")[0],o={}.toString,p=[],q=0,r="MozAppearance"in l.style,s=r&&!!b.createRange().compareNode,t=s?l:n.parentNode,l=a.opera&&"[object Opera]"==o.call(a.opera),l=!!b.attachEvent&&!l,u=r?"object":l?"script":"img",v=l?"script":u,w=Array.isArray||function(a){return"[object Array]"==o.call(a)},x=[],y={},z={timeout:function(a,b){return b.length&&(a.timeout=b[0]),a}};B=function(a){function b(a){var e,f,g,a=a.split("!"),b=x.length,c=a.pop(),d=a.length,c={url:c,origUrl:c,prefixes:a};for(f=0;d>f;f++)g=a[f].split("="),(e=z[g.shift()])&&(c=e(c,g));for(f=0;b>f;f++)c=x[f](c);return c}function g(a,e,f,g,h){var i=b(a),j=i.autoCallback;i.url.split(".").pop().split("?").shift(),i.bypass||(e&&(e=d(e)?e:e[a]||e[g]||e[a.split("/").pop().split("?")[0]]),i.instead?i.instead(a,e,f,g,h):(y[i.url]?i.noexec=!0:y[i.url]=1,f.load(i.url,i.forceCSS||!i.forceJS&&"css"==i.url.split(".").pop().split("?").shift()?"c":c,i.noexec,i.attrs,i.timeout),(d(e)||d(j))&&f.load(function(){k(),e&&e(i.origUrl,h,g),j&&j(i.origUrl,h,g),y[i.url]=2})))}function h(a,b){function c(a,c){if(a){if(e(a))c||(j=function(){var a=[].slice.call(arguments);k.apply(this,a),l()}),g(a,j,b,0,h);else if(Object(a)===a)for(n in m=function(){var c,b=0;for(c in a)a.hasOwnProperty(c)&&b++;return b}(),a)a.hasOwnProperty(n)&&(!c&&!--m&&(d(j)?j=function(){var a=[].slice.call(arguments);k.apply(this,a),l()}:j[n]=function(a){return function(){var b=[].slice.call(arguments);a&&a.apply(this,b),l()}}(k[n])),g(a[n],j,b,n,h))}else!c&&l()}var m,n,h=!!a.test,i=a.load||a.both,j=a.callback||f,k=j,l=a.complete||f;c(h?a.yep:a.nope,!!i),i&&c(i)}var i,j,l=this.yepnope.loader;if(e(a))g(a,0,l,0);else if(w(a))for(i=0;i<a.length;i++)j=a[i],e(j)?g(j,0,l,0):w(j)?B(j):Object(j)===j&&h(j,l);else Object(a)===a&&h(a,l)},B.addPrefix=function(a,b){z[a]=b},B.addFilter=function(a){x.push(a)},B.errorTimeout=1e4,null==b.readyState&&b.addEventListener&&(b.readyState="loading",b.addEventListener("DOMContentLoaded",A=function(){b.removeEventListener("DOMContentLoaded",A,0),b.readyState="complete"},0)),a.yepnope=k(),a.yepnope.executeStack=h,a.yepnope.injectJs=function(a,c,d,e,i,j){var l,o,k=b.createElement("script"),e=e||B.errorTimeout;k.src=a;for(o in d)k.setAttribute(o,d[o]);c=j?h:c||f,k.onreadystatechange=k.onload=function(){!l&&g(k.readyState)&&(l=1,c(),k.onload=k.onreadystatechange=null)},m(function(){l||(l=1,c(1))},e),i?k.onload():n.parentNode.insertBefore(k,n)},a.yepnope.injectCss=function(a,c,d,e,g,i){var j,e=b.createElement("link"),c=i?h:c||f;e.href=a,e.rel="stylesheet",e.type="text/css";for(j in d)e.setAttribute(j,d[j]);g||(n.parentNode.insertBefore(e,n),m(c,0))}}(this,document),Modernizr.load=function(){yepnope.apply(window,[].slice.call(arguments,0))},Modernizr.addTest("contenteditable","contentEditable"in document.documentElement),define("modernizr",function(global){return function(){var ret;return ret||global.Modernizr}}(this)),function(root,factory){if("function"==typeof define&&define.amd)define("backbone",["underscore","jquery","exports"],function(_,$,exports){root.Backbone=factory(root,exports,_,$)});else if("undefined"!=typeof exports){var _=require("underscore");factory(root,exports,_)}else root.Backbone=factory(root,{},root._,root.jQuery||root.Zepto||root.ender||root.$)}(this,function(root,Backbone,_,$){{var previousBackbone=root.Backbone,array=[],slice=(array.push,array.slice);array.splice}Backbone.VERSION="1.1.2",Backbone.$=$,Backbone.noConflict=function(){return root.Backbone=previousBackbone,this},Backbone.emulateHTTP=!1,Backbone.emulateJSON=!1;var Events=Backbone.Events={on:function(name,callback,context){if(!eventsApi(this,"on",name,[callback,context])||!callback)return this;this._events||(this._events={});var events=this._events[name]||(this._events[name]=[]);return events.push({callback:callback,context:context,ctx:context||this}),this},once:function(name,callback,context){if(!eventsApi(this,"once",name,[callback,context])||!callback)return this;var self=this,once=_.once(function(){self.off(name,once),callback.apply(this,arguments)});return once._callback=callback,this.on(name,once,context)},off:function(name,callback,context){var retain,ev,events,names,i,l,j,k;if(!this._events||!eventsApi(this,"off",name,[callback,context]))return this;if(!name&&!callback&&!context)return this._events=void 0,this;for(names=name?[name]:_.keys(this._events),i=0,l=names.length;l>i;i++)if(name=names[i],events=this._events[name]){if(this._events[name]=retain=[],callback||context)for(j=0,k=events.length;k>j;j++)ev=events[j],(callback&&callback!==ev.callback&&callback!==ev.callback._callback||context&&context!==ev.context)&&retain.push(ev);retain.length||delete this._events[name]}return this},trigger:function(name){if(!this._events)return this;var args=slice.call(arguments,1);if(!eventsApi(this,"trigger",name,args))return this;var events=this._events[name],allEvents=this._events.all;return events&&triggerEvents(events,args),allEvents&&triggerEvents(allEvents,arguments),this},stopListening:function(obj,name,callback){var listeningTo=this._listeningTo;if(!listeningTo)return this;var remove=!name&&!callback;callback||"object"!=typeof name||(callback=this),obj&&((listeningTo={})[obj._listenId]=obj);for(var id in listeningTo)obj=listeningTo[id],obj.off(name,callback,this),(remove||_.isEmpty(obj._events))&&delete this._listeningTo[id];return this}},eventSplitter=/\s+/,eventsApi=function(obj,action,name,rest){if(!name)return!0;if("object"==typeof name){for(var key in name)obj[action].apply(obj,[key,name[key]].concat(rest));return!1}if(eventSplitter.test(name)){for(var names=name.split(eventSplitter),i=0,l=names.length;l>i;i++)obj[action].apply(obj,[names[i]].concat(rest));return!1}return!0},triggerEvents=function(events,args){var ev,i=-1,l=events.length,a1=args[0],a2=args[1],a3=args[2];switch(args.length){case 0:for(;++i<l;)(ev=events[i]).callback.call(ev.ctx);return;case 1:for(;++i<l;)(ev=events[i]).callback.call(ev.ctx,a1);return;case 2:for(;++i<l;)(ev=events[i]).callback.call(ev.ctx,a1,a2);return;case 3:for(;++i<l;)(ev=events[i]).callback.call(ev.ctx,a1,a2,a3);return;default:for(;++i<l;)(ev=events[i]).callback.apply(ev.ctx,args);return}},listenMethods={listenTo:"on",listenToOnce:"once"};_.each(listenMethods,function(implementation,method){Events[method]=function(obj,name,callback){var listeningTo=this._listeningTo||(this._listeningTo={}),id=obj._listenId||(obj._listenId=_.uniqueId("l"));return listeningTo[id]=obj,callback||"object"!=typeof name||(callback=this),obj[implementation](name,callback,this),this}}),Events.bind=Events.on,Events.unbind=Events.off,_.extend(Backbone,Events);var Model=Backbone.Model=function(attributes,options){var attrs=attributes||{};options||(options={}),this.cid=_.uniqueId("c"),this.attributes={},options.collection&&(this.collection=options.collection),options.parse&&(attrs=this.parse(attrs,options)||{}),attrs=_.defaults({},attrs,_.result(this,"defaults")),this.set(attrs,options),this.changed={},this.initialize.apply(this,arguments)};_.extend(Model.prototype,Events,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(){return _.clone(this.attributes)},sync:function(){return Backbone.sync.apply(this,arguments)},get:function(attr){return this.attributes[attr]},escape:function(attr){return _.escape(this.get(attr))},has:function(attr){return null!=this.get(attr)},set:function(key,val,options){var attr,attrs,unset,changes,silent,changing,prev,current;if(null==key)return this;if("object"==typeof key?(attrs=key,options=val):(attrs={})[key]=val,options||(options={}),!this._validate(attrs,options))return!1;unset=options.unset,silent=options.silent,changes=[],changing=this._changing,this._changing=!0,changing||(this._previousAttributes=_.clone(this.attributes),this.changed={}),current=this.attributes,prev=this._previousAttributes,this.idAttribute in attrs&&(this.id=attrs[this.idAttribute]);for(attr in attrs)val=attrs[attr],_.isEqual(current[attr],val)||changes.push(attr),_.isEqual(prev[attr],val)?delete this.changed[attr]:this.changed[attr]=val,unset?delete current[attr]:current[attr]=val;if(!silent){changes.length&&(this._pending=options);for(var i=0,l=changes.length;l>i;i++)this.trigger("change:"+changes[i],this,current[changes[i]],options)}if(changing)return this;if(!silent)for(;this._pending;)options=this._pending,this._pending=!1,this.trigger("change",this,options);return this._pending=!1,this._changing=!1,this},unset:function(attr,options){return this.set(attr,void 0,_.extend({},options,{unset:!0}))},clear:function(options){var attrs={};for(var key in this.attributes)attrs[key]=void 0;return this.set(attrs,_.extend({},options,{unset:!0}))},hasChanged:function(attr){return null==attr?!_.isEmpty(this.changed):_.has(this.changed,attr)},changedAttributes:function(diff){if(!diff)return this.hasChanged()?_.clone(this.changed):!1;var val,changed=!1,old=this._changing?this._previousAttributes:this.attributes;for(var attr in diff)_.isEqual(old[attr],val=diff[attr])||((changed||(changed={}))[attr]=val);return changed},previous:function(attr){return null!=attr&&this._previousAttributes?this._previousAttributes[attr]:null},previousAttributes:function(){return _.clone(this._previousAttributes)},fetch:function(options){options=options?_.clone(options):{},void 0===options.parse&&(options.parse=!0);var model=this,success=options.success;return options.success=function(resp){return model.set(model.parse(resp,options),options)?(success&&success(model,resp,options),void model.trigger("sync",model,resp,options)):!1},wrapError(this,options),this.sync("read",this,options)},save:function(key,val,options){var attrs,method,xhr,attributes=this.attributes;if(null==key||"object"==typeof key?(attrs=key,options=val):(attrs={})[key]=val,options=_.extend({validate:!0},options),attrs&&!options.wait){if(!this.set(attrs,options))return!1}else if(!this._validate(attrs,options))return!1;attrs&&options.wait&&(this.attributes=_.extend({},attributes,attrs)),void 0===options.parse&&(options.parse=!0);var model=this,success=options.success;return options.success=function(resp){model.attributes=attributes;var serverAttrs=model.parse(resp,options);return options.wait&&(serverAttrs=_.extend(attrs||{},serverAttrs)),_.isObject(serverAttrs)&&!model.set(serverAttrs,options)?!1:(success&&success(model,resp,options),void model.trigger("sync",model,resp,options))},wrapError(this,options),method=this.isNew()?"create":options.patch?"patch":"update","patch"===method&&(options.attrs=attrs),xhr=this.sync(method,this,options),attrs&&options.wait&&(this.attributes=attributes),xhr},destroy:function(options){options=options?_.clone(options):{};var model=this,success=options.success,destroy=function(){model.trigger("destroy",model,model.collection,options)};if(options.success=function(resp){(options.wait||model.isNew())&&destroy(),success&&success(model,resp,options),model.isNew()||model.trigger("sync",model,resp,options)},this.isNew())return options.success(),!1;wrapError(this,options);var xhr=this.sync("delete",this,options);return options.wait||destroy(),xhr},url:function(){var base=_.result(this,"urlRoot")||_.result(this.collection,"url")||urlError();return this.isNew()?base:base.replace(/([^\/])$/,"$1/")+encodeURIComponent(this.id)},parse:function(resp){return resp},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(options){return this._validate({},_.extend(options||{},{validate:!0}))},_validate:function(attrs,options){if(!options.validate||!this.validate)return!0;attrs=_.extend({},this.attributes,attrs);var error=this.validationError=this.validate(attrs,options)||null;return error?(this.trigger("invalid",this,error,_.extend(options,{validationError:error})),!1):!0}});var modelMethods=["keys","values","pairs","invert","pick","omit"];_.each(modelMethods,function(method){Model.prototype[method]=function(){var args=slice.call(arguments);return args.unshift(this.attributes),_[method].apply(_,args)}});var Collection=Backbone.Collection=function(models,options){options||(options={}),options.model&&(this.model=options.model),void 0!==options.comparator&&(this.comparator=options.comparator),this._reset(),this.initialize.apply(this,arguments),models&&this.reset(models,_.extend({silent:!0},options))},setOptions={add:!0,remove:!0,merge:!0},addOptions={add:!0,remove:!1};_.extend(Collection.prototype,Events,{model:Model,initialize:function(){},toJSON:function(options){return this.map(function(model){return model.toJSON(options)})},sync:function(){return Backbone.sync.apply(this,arguments)},add:function(models,options){return this.set(models,_.extend({merge:!1},options,addOptions))},remove:function(models,options){var singular=!_.isArray(models);models=singular?[models]:_.clone(models),options||(options={});var i,l,index,model;for(i=0,l=models.length;l>i;i++)model=models[i]=this.get(models[i]),model&&(delete this._byId[model.id],delete this._byId[model.cid],index=this.indexOf(model),this.models.splice(index,1),this.length--,options.silent||(options.index=index,model.trigger("remove",model,this,options)),this._removeReference(model,options));return singular?models[0]:models},set:function(models,options){options=_.defaults({},options,setOptions),options.parse&&(models=this.parse(models,options));var singular=!_.isArray(models);models=singular?models?[models]:[]:_.clone(models);var i,l,id,model,attrs,existing,sort,at=options.at,targetModel=this.model,sortable=this.comparator&&null==at&&options.sort!==!1,sortAttr=_.isString(this.comparator)?this.comparator:null,toAdd=[],toRemove=[],modelMap={},add=options.add,merge=options.merge,remove=options.remove,order=!sortable&&add&&remove?[]:!1;for(i=0,l=models.length;l>i;i++){if(attrs=models[i]||{},id=attrs instanceof Model?model=attrs:attrs[targetModel.prototype.idAttribute||"id"],existing=this.get(id))remove&&(modelMap[existing.cid]=!0),merge&&(attrs=attrs===model?model.attributes:attrs,options.parse&&(attrs=existing.parse(attrs,options)),existing.set(attrs,options),sortable&&!sort&&existing.hasChanged(sortAttr)&&(sort=!0)),models[i]=existing;else if(add){if(model=models[i]=this._prepareModel(attrs,options),!model)continue;toAdd.push(model),this._addReference(model,options)}model=existing||model,!order||!model.isNew()&&modelMap[model.id]||order.push(model),modelMap[model.id]=!0}if(remove){for(i=0,l=this.length;l>i;++i)modelMap[(model=this.models[i]).cid]||toRemove.push(model);toRemove.length&&this.remove(toRemove,options)}if(toAdd.length||order&&order.length)if(sortable&&(sort=!0),this.length+=toAdd.length,null!=at)for(i=0,l=toAdd.length;l>i;i++)this.models.splice(at+i,0,toAdd[i]);else{order&&(this.models.length=0);var orderedModels=order||toAdd;for(i=0,l=orderedModels.length;l>i;i++)this.models.push(orderedModels[i])}if(sort&&this.sort({silent:!0}),!options.silent){for(i=0,l=toAdd.length;l>i;i++)(model=toAdd[i]).trigger("add",model,this,options);(sort||order&&order.length)&&this.trigger("sort",this,options)}return singular?models[0]:models},reset:function(models,options){options||(options={});for(var i=0,l=this.models.length;l>i;i++)this._removeReference(this.models[i],options);return options.previousModels=this.models,this._reset(),models=this.add(models,_.extend({silent:!0},options)),options.silent||this.trigger("reset",this,options),models},push:function(model,options){return this.add(model,_.extend({at:this.length},options))},pop:function(options){var model=this.at(this.length-1);return this.remove(model,options),model},unshift:function(model,options){return this.add(model,_.extend({at:0},options))},shift:function(options){var model=this.at(0);return this.remove(model,options),model},slice:function(){return slice.apply(this.models,arguments)},get:function(obj){return null==obj?void 0:this._byId[obj]||this._byId[obj.id]||this._byId[obj.cid]},at:function(index){return this.models[index]},where:function(attrs,first){return _.isEmpty(attrs)?first?void 0:[]:this[first?"find":"filter"](function(model){for(var key in attrs)if(attrs[key]!==model.get(key))return!1;return!0})},findWhere:function(attrs){return this.where(attrs,!0)},sort:function(options){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return options||(options={}),_.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(_.bind(this.comparator,this)),options.silent||this.trigger("sort",this,options),this},pluck:function(attr){return _.invoke(this.models,"get",attr)},fetch:function(options){options=options?_.clone(options):{},void 0===options.parse&&(options.parse=!0);var success=options.success,collection=this;return options.success=function(resp){var method=options.reset?"reset":"set";collection[method](resp,options),success&&success(collection,resp,options),collection.trigger("sync",collection,resp,options)},wrapError(this,options),this.sync("read",this,options)},create:function(model,options){if(options=options?_.clone(options):{},!(model=this._prepareModel(model,options)))return!1;options.wait||this.add(model,options);var collection=this,success=options.success;return options.success=function(model,resp){options.wait&&collection.add(model,options),success&&success(model,resp,options)},model.save(null,options),model},parse:function(resp){return resp},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(attrs,options){if(attrs instanceof Model)return attrs;options=options?_.clone(options):{},options.collection=this;var model=new this.model(attrs,options);return model.validationError?(this.trigger("invalid",this,model.validationError,options),!1):model},_addReference:function(model){this._byId[model.cid]=model,null!=model.id&&(this._byId[model.id]=model),model.collection||(model.collection=this),model.on("all",this._onModelEvent,this)},_removeReference:function(model){this===model.collection&&delete model.collection,model.off("all",this._onModelEvent,this)},_onModelEvent:function(event,model,collection,options){("add"!==event&&"remove"!==event||collection===this)&&("destroy"===event&&this.remove(model,options),model&&event==="change:"+model.idAttribute&&(delete this._byId[model.previous(model.idAttribute)],null!=model.id&&(this._byId[model.id]=model)),this.trigger.apply(this,arguments))}});var methods=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain","sample"];_.each(methods,function(method){Collection.prototype[method]=function(){var args=slice.call(arguments);return args.unshift(this.models),_[method].apply(_,args)}});var attributeMethods=["groupBy","countBy","sortBy","indexBy"];_.each(attributeMethods,function(method){Collection.prototype[method]=function(value,context){var iterator=_.isFunction(value)?value:function(model){return model.get(value)};return _[method](this.models,iterator,context)}});var View=Backbone.View=function(options){this.cid=_.uniqueId("view"),options||(options={}),_.extend(this,_.pick(options,viewOptions)),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},delegateEventSplitter=/^(\S+)\s*(.*)$/,viewOptions=["model","collection","el","id","attributes","className","tagName","events"];_.extend(View.prototype,Events,{tagName:"div",$:function(selector){return this.$el.find(selector)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(element,delegate){return this.$el&&this.undelegateEvents(),this.$el=element instanceof Backbone.$?element:Backbone.$(element),this.el=this.$el[0],delegate!==!1&&this.delegateEvents(),this},delegateEvents:function(events){if(!events&&!(events=_.result(this,"events")))return this;this.undelegateEvents();for(var key in events){var method=events[key];if(_.isFunction(method)||(method=this[events[key]]),method){var match=key.match(delegateEventSplitter),eventName=match[1],selector=match[2];
method=_.bind(method,this),eventName+=".delegateEvents"+this.cid,""===selector?this.$el.on(eventName,method):this.$el.on(eventName,selector,method)}}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_ensureElement:function(){if(this.el)this.setElement(_.result(this,"el"),!1);else{var attrs=_.extend({},_.result(this,"attributes"));this.id&&(attrs.id=_.result(this,"id")),this.className&&(attrs["class"]=_.result(this,"className"));var $el=Backbone.$("<"+_.result(this,"tagName")+">").attr(attrs);this.setElement($el,!1)}}}),Backbone.sync=function(method,model,options){var type=methodMap[method];_.defaults(options||(options={}),{emulateHTTP:Backbone.emulateHTTP,emulateJSON:Backbone.emulateJSON});var params={type:type,dataType:"json"};if(options.url||(params.url=_.result(model,"url")||urlError()),null!=options.data||!model||"create"!==method&&"update"!==method&&"patch"!==method||(params.contentType="application/json",params.data=JSON.stringify(options.attrs||model.toJSON(options))),options.emulateJSON&&(params.contentType="application/x-www-form-urlencoded",params.data=params.data?{model:params.data}:{}),options.emulateHTTP&&("PUT"===type||"DELETE"===type||"PATCH"===type)){params.type="POST",options.emulateJSON&&(params.data._method=type);var beforeSend=options.beforeSend;options.beforeSend=function(xhr){return xhr.setRequestHeader("X-HTTP-Method-Override",type),beforeSend?beforeSend.apply(this,arguments):void 0}}"GET"===params.type||options.emulateJSON||(params.processData=!1),"PATCH"===params.type&&noXhrPatch&&(params.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var xhr=options.xhr=Backbone.ajax(_.extend(params,options));return model.trigger("request",model,xhr,options),xhr};var noXhrPatch=!("undefined"==typeof window||!window.ActiveXObject||window.XMLHttpRequest&&(new XMLHttpRequest).dispatchEvent),methodMap={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};Backbone.ajax=function(){return Backbone.$.ajax.apply(Backbone.$,arguments)};var Router=Backbone.Router=function(options){options||(options={}),options.routes&&(this.routes=options.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},optionalParam=/\((.*?)\)/g,namedParam=/(\(\?)?:\w+/g,splatParam=/\*\w+/g,escapeRegExp=/[\-{}\[\]+?.,\\\^$|#\s]/g;_.extend(Router.prototype,Events,{initialize:function(){},route:function(route,name,callback){_.isRegExp(route)||(route=this._routeToRegExp(route)),_.isFunction(name)&&(callback=name,name=""),callback||(callback=this[name]);var router=this;return Backbone.history.route(route,function(fragment){var args=router._extractParameters(route,fragment);router.execute(callback,args),router.trigger.apply(router,["route:"+name].concat(args)),router.trigger("route",name,args),Backbone.history.trigger("route",router,name,args)}),this},execute:function(callback,args){callback&&callback.apply(this,args)},navigate:function(fragment,options){return Backbone.history.navigate(fragment,options),this},_bindRoutes:function(){if(this.routes){this.routes=_.result(this,"routes");for(var route,routes=_.keys(this.routes);null!=(route=routes.pop());)this.route(route,this.routes[route])}},_routeToRegExp:function(route){return route=route.replace(escapeRegExp,"\\$&").replace(optionalParam,"(?:$1)?").replace(namedParam,function(match,optional){return optional?match:"([^/?]+)"}).replace(splatParam,"([^?]*?)"),new RegExp("^"+route+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(route,fragment){var params=route.exec(fragment).slice(1);return _.map(params,function(param,i){return i===params.length-1?param||null:param?decodeURIComponent(param):null})}});var History=Backbone.History=function(){this.handlers=[],_.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},routeStripper=/^[#\/]|\s+$/g,rootStripper=/^\/+|\/+$/g,isExplorer=/msie [\w.]+/,trailingSlash=/\/$/,pathStripper=/#.*$/;History.started=!1,_.extend(History.prototype,Events,{interval:50,atRoot:function(){return this.location.pathname.replace(/[^\/]$/,"$&/")===this.root},getHash:function(window){var match=(window||this).location.href.match(/#(.*)$/);return match?match[1]:""},getFragment:function(fragment,forcePushState){if(null==fragment)if(this._hasPushState||!this._wantsHashChange||forcePushState){fragment=decodeURI(this.location.pathname+this.location.search);var root=this.root.replace(trailingSlash,"");fragment.indexOf(root)||(fragment=fragment.slice(root.length))}else fragment=this.getHash();return fragment.replace(routeStripper,"")},start:function(options){if(History.started)throw new Error("Backbone.history has already been started");History.started=!0,this.options=_.extend({root:"/"},this.options,options),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var fragment=this.getFragment(),docMode=document.documentMode,oldIE=isExplorer.exec(navigator.userAgent.toLowerCase())&&(!docMode||7>=docMode);if(this.root=("/"+this.root+"/").replace(rootStripper,"/"),oldIE&&this._wantsHashChange){var frame=Backbone.$('<iframe src="javascript:0" tabindex="-1">');this.iframe=frame.hide().appendTo("body")[0].contentWindow,this.navigate(fragment)}this._hasPushState?Backbone.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!oldIE?Backbone.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=fragment;var loc=this.location;if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot())return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+"#"+this.fragment),!0;this._hasPushState&&this.atRoot()&&loc.hash&&(this.fragment=this.getHash().replace(routeStripper,""),this.history.replaceState({},document.title,this.root+this.fragment))}return this.options.silent?void 0:this.loadUrl()},stop:function(){Backbone.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),History.started=!1},route:function(route,callback){this.handlers.unshift({route:route,callback:callback})},checkUrl:function(){var current=this.getFragment();return current===this.fragment&&this.iframe&&(current=this.getFragment(this.getHash(this.iframe))),current===this.fragment?!1:(this.iframe&&this.navigate(current),void this.loadUrl())},loadUrl:function(fragment){return fragment=this.fragment=this.getFragment(fragment),_.any(this.handlers,function(handler){return handler.route.test(fragment)?(handler.callback(fragment),!0):void 0})},navigate:function(fragment,options){if(!History.started)return!1;options&&options!==!0||(options={trigger:!!options});var url=this.root+(fragment=this.getFragment(fragment||""));if(fragment=fragment.replace(pathStripper,""),this.fragment!==fragment){if(this.fragment=fragment,""===fragment&&"/"!==url&&(url=url.slice(0,-1)),this._hasPushState)this.history[options.replace?"replaceState":"pushState"]({},document.title,url);else{if(!this._wantsHashChange)return this.location.assign(url);this._updateHash(this.location,fragment,options.replace),this.iframe&&fragment!==this.getFragment(this.getHash(this.iframe))&&(options.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,fragment,options.replace))}return options.trigger?this.loadUrl(fragment):void 0}},_updateHash:function(location,fragment,replace){if(replace){var href=location.href.replace(/(javascript:|#).*$/,"");location.replace(href+"#"+fragment)}else location.hash="#"+fragment}}),Backbone.history=new History;var extend=function(protoProps,staticProps){var child,parent=this;child=protoProps&&_.has(protoProps,"constructor")?protoProps.constructor:function(){return parent.apply(this,arguments)},_.extend(child,parent,staticProps);var Surrogate=function(){this.constructor=child};return Surrogate.prototype=parent.prototype,child.prototype=new Surrogate,protoProps&&_.extend(child.prototype,protoProps),child.__super__=parent.prototype,child};Model.extend=Collection.extend=Router.extend=View.extend=History.extend=extend;var urlError=function(){throw new Error('A "url" property or function must be specified')},wrapError=function(model,options){var error=options.error;options.error=function(resp){error&&error(model,resp,options),model.trigger("error",model,resp,options)}};return Backbone}),function(root,factory){if("function"==typeof define&&define.amd)define("backbone.wreqr",["backbone","underscore"],function(Backbone,_){return factory(Backbone,_)});else if("undefined"!=typeof exports){var Backbone=require("backbone"),_=require("underscore");module.exports=factory(Backbone,_)}else factory(root.Backbone,root._)}(this,function(Backbone,_){var previousWreqr=Backbone.Wreqr,Wreqr=Backbone.Wreqr={};return Backbone.Wreqr.VERSION="1.3.1",Backbone.Wreqr.noConflict=function(){return Backbone.Wreqr=previousWreqr,this},Wreqr.Handlers=function(Backbone,_){var Handlers=function(options){this.options=options,this._wreqrHandlers={},_.isFunction(this.initialize)&&this.initialize(options)};return Handlers.extend=Backbone.Model.extend,_.extend(Handlers.prototype,Backbone.Events,{setHandlers:function(handlers){_.each(handlers,function(handler,name){var context=null;_.isObject(handler)&&!_.isFunction(handler)&&(context=handler.context,handler=handler.callback),this.setHandler(name,handler,context)},this)},setHandler:function(name,handler,context){var config={callback:handler,context:context};this._wreqrHandlers[name]=config,this.trigger("handler:add",name,handler,context)},hasHandler:function(name){return!!this._wreqrHandlers[name]},getHandler:function(name){var config=this._wreqrHandlers[name];if(config)return function(){var args=Array.prototype.slice.apply(arguments);return config.callback.apply(config.context,args)}},removeHandler:function(name){delete this._wreqrHandlers[name]},removeAllHandlers:function(){this._wreqrHandlers={}}}),Handlers}(Backbone,_),Wreqr.CommandStorage=function(){var CommandStorage=function(options){this.options=options,this._commands={},_.isFunction(this.initialize)&&this.initialize(options)};return _.extend(CommandStorage.prototype,Backbone.Events,{getCommands:function(commandName){var commands=this._commands[commandName];return commands||(commands={command:commandName,instances:[]},this._commands[commandName]=commands),commands},addCommand:function(commandName,args){var command=this.getCommands(commandName);command.instances.push(args)},clearCommands:function(commandName){var command=this.getCommands(commandName);command.instances=[]}}),CommandStorage}(),Wreqr.Commands=function(Wreqr){return Wreqr.Handlers.extend({storageType:Wreqr.CommandStorage,constructor:function(options){this.options=options||{},this._initializeStorage(this.options),this.on("handler:add",this._executeCommands,this);var args=Array.prototype.slice.call(arguments);Wreqr.Handlers.prototype.constructor.apply(this,args)},execute:function(name,args){name=arguments[0],args=Array.prototype.slice.call(arguments,1),this.hasHandler(name)?this.getHandler(name).apply(this,args):this.storage.addCommand(name,args)},_executeCommands:function(name,handler,context){var command=this.storage.getCommands(name);_.each(command.instances,function(args){handler.apply(context,args)}),this.storage.clearCommands(name)},_initializeStorage:function(options){var storage,StorageType=options.storageType||this.storageType;storage=_.isFunction(StorageType)?new StorageType:StorageType,this.storage=storage}})}(Wreqr),Wreqr.RequestResponse=function(Wreqr){return Wreqr.Handlers.extend({request:function(){var name=arguments[0],args=Array.prototype.slice.call(arguments,1);return this.hasHandler(name)?this.getHandler(name).apply(this,args):void 0}})}(Wreqr),Wreqr.EventAggregator=function(Backbone,_){var EA=function(){};return EA.extend=Backbone.Model.extend,_.extend(EA.prototype,Backbone.Events),EA}(Backbone,_),Wreqr.Channel=function(){var Channel=function(channelName){this.vent=new Backbone.Wreqr.EventAggregator,this.reqres=new Backbone.Wreqr.RequestResponse,this.commands=new Backbone.Wreqr.Commands,this.channelName=channelName};return _.extend(Channel.prototype,{reset:function(){return this.vent.off(),this.vent.stopListening(),this.reqres.removeAllHandlers(),this.commands.removeAllHandlers(),this},connectEvents:function(hash,context){return this._connect("vent",hash,context),this},connectCommands:function(hash,context){return this._connect("commands",hash,context),this},connectRequests:function(hash,context){return this._connect("reqres",hash,context),this},_connect:function(type,hash,context){if(hash){context=context||this;var method="vent"===type?"on":"setHandler";_.each(hash,function(fn,eventName){this[type][method](eventName,_.bind(fn,context))},this)}}}),Channel}(Wreqr),Wreqr.radio=function(Wreqr){var Radio=function(){this._channels={},this.vent={},this.commands={},this.reqres={},this._proxyMethods()};_.extend(Radio.prototype,{channel:function(channelName){if(!channelName)throw new Error("Channel must receive a name");return this._getChannel(channelName)},_getChannel:function(channelName){var channel=this._channels[channelName];return channel||(channel=new Wreqr.Channel(channelName),this._channels[channelName]=channel),channel},_proxyMethods:function(){_.each(["vent","commands","reqres"],function(system){_.each(messageSystems[system],function(method){this[system][method]=proxyMethod(this,system,method)},this)},this)}});var messageSystems={vent:["on","off","trigger","once","stopListening","listenTo","listenToOnce"],commands:["execute","setHandler","setHandlers","removeHandler","removeAllHandlers"],reqres:["request","setHandler","setHandlers","removeHandler","removeAllHandlers"]},proxyMethod=function(radio,system,method){return function(channelName){var messageSystem=radio._getChannel(channelName)[system],args=Array.prototype.slice.call(arguments,1);return messageSystem[method].apply(messageSystem,args)}};return new Radio}(Wreqr),Backbone.Wreqr}),function(root,factory){if("function"==typeof define&&define.amd)define("backbone.babysitter",["backbone","underscore"],function(Backbone,_){return factory(Backbone,_)});else if("undefined"!=typeof exports){var Backbone=require("backbone"),_=require("underscore");module.exports=factory(Backbone,_)}else factory(root.Backbone,root._)}(this,function(Backbone,_){var previousChildViewContainer=Backbone.ChildViewContainer;return Backbone.ChildViewContainer=function(Backbone,_){var Container=function(views){this._views={},this._indexByModel={},this._indexByCustom={},this._updateLength(),_.each(views,this.add,this)};_.extend(Container.prototype,{add:function(view,customIndex){var viewCid=view.cid;return this._views[viewCid]=view,view.model&&(this._indexByModel[view.model.cid]=viewCid),customIndex&&(this._indexByCustom[customIndex]=viewCid),this._updateLength(),this},findByModel:function(model){return this.findByModelCid(model.cid)},findByModelCid:function(modelCid){var viewCid=this._indexByModel[modelCid];return this.findByCid(viewCid)},findByCustom:function(index){var viewCid=this._indexByCustom[index];return this.findByCid(viewCid)},findByIndex:function(index){return _.values(this._views)[index]},findByCid:function(cid){return this._views[cid]},remove:function(view){var viewCid=view.cid;return view.model&&delete this._indexByModel[view.model.cid],_.any(this._indexByCustom,function(cid,key){return cid===viewCid?(delete this._indexByCustom[key],!0):void 0},this),delete this._views[viewCid],this._updateLength(),this},call:function(method){this.apply(method,_.tail(arguments))},apply:function(method,args){_.each(this._views,function(view){_.isFunction(view[method])&&view[method].apply(view,args||[])})},_updateLength:function(){this.length=_.size(this._views)}});var methods=["forEach","each","map","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","toArray","first","initial","rest","last","without","isEmpty","pluck"];return _.each(methods,function(method){Container.prototype[method]=function(){var views=_.values(this._views),args=[views].concat(_.toArray(arguments));return _[method].apply(_,args)}}),Container}(Backbone,_),Backbone.ChildViewContainer.VERSION="0.1.5",Backbone.ChildViewContainer.noConflict=function(){return Backbone.ChildViewContainer=previousChildViewContainer,this},Backbone.ChildViewContainer}),function(root,factory){if("object"==typeof exports){var underscore=require("underscore"),backbone=require("backbone"),wreqr=require("backbone.wreqr"),babysitter=require("backbone.babysitter");module.exports=factory(underscore,backbone,wreqr,babysitter)}else"function"==typeof define&&define.amd&&define("backbone-marionette",["underscore","backbone","backbone.wreqr","backbone.babysitter"],factory)}(this,function(_,Backbone){!function(global,Backbone,_){function throwError(message,name){var error=new Error(message);throw error.name=name||"Error",error}var Marionette={};Backbone.Marionette=Marionette,Marionette.$=Backbone.$;var slice=Array.prototype.slice;return Marionette.extend=Backbone.Model.extend,Marionette.getOption=function(target,optionName){if(target&&optionName){var value;return value=target.options&&optionName in target.options&&void 0!==target.options[optionName]?target.options[optionName]:target[optionName]}},Marionette.normalizeMethods=function(hash){var method,normalizedHash={};return _.each(hash,function(fn,name){method=fn,_.isFunction(method)||(method=this[method]),method&&(normalizedHash[name]=method)},this),normalizedHash},Marionette.normalizeUIKeys=function(hash,ui){return"undefined"!=typeof hash?(_.each(_.keys(hash),function(v){var pattern=/@ui.[a-zA-Z_$0-9]*/g;v.match(pattern)&&(hash[v.replace(pattern,function(r){return ui[r.slice(4)]})]=hash[v],delete hash[v])}),hash):void 0},Marionette.triggerMethod=function(){function getEventName(match,prefix,eventName){return eventName.toUpperCase()}var splitter=/(^|:)(\w)/gi,triggerMethod=function(event){var methodName="on"+event.replace(splitter,getEventName),method=this[methodName];return _.isFunction(this.trigger)&&this.trigger.apply(this,arguments),_.isFunction(method)?method.apply(this,_.tail(arguments)):void 0};return triggerMethod}(),Marionette.MonitorDOMRefresh=function(documentElement){function handleShow(view){view._isShown=!0,triggerDOMRefresh(view)}function handleRender(view){view._isRendered=!0,triggerDOMRefresh(view)}function triggerDOMRefresh(view){view._isShown&&view._isRendered&&isInDOM(view)&&_.isFunction(view.triggerMethod)&&view.triggerMethod("dom:refresh")}function isInDOM(view){return documentElement.contains(view.el)}return function(view){view.listenTo(view,"show",function(){handleShow(view)}),view.listenTo(view,"render",function(){handleRender(view)})}}(document.documentElement),function(Marionette){function bindFromStrings(target,entity,evt,methods){var methodNames=methods.split(/\s+/);_.each(methodNames,function(methodName){var method=target[methodName];method||throwError("Method '"+methodName+"' was configured as an event handler, but does not exist."),target.listenTo(entity,evt,method)})}function bindToFunction(target,entity,evt,method){target.listenTo(entity,evt,method)}function unbindFromStrings(target,entity,evt,methods){var methodNames=methods.split(/\s+/);_.each(methodNames,function(methodName){var method=target[methodName];target.stopListening(entity,evt,method)})}function unbindToFunction(target,entity,evt,method){target.stopListening(entity,evt,method)}function iterateEvents(target,entity,bindings,functionCallback,stringCallback){entity&&bindings&&(_.isFunction(bindings)&&(bindings=bindings.call(target)),_.each(bindings,function(methods,evt){_.isFunction(methods)?functionCallback(target,entity,evt,methods):stringCallback(target,entity,evt,methods)}))}Marionette.bindEntityEvents=function(target,entity,bindings){iterateEvents(target,entity,bindings,bindToFunction,bindFromStrings)},Marionette.unbindEntityEvents=function(target,entity,bindings){iterateEvents(target,entity,bindings,unbindToFunction,unbindFromStrings)}}(Marionette),Marionette.Callbacks=function(){this._deferred=Marionette.$.Deferred(),this._callbacks=[]},_.extend(Marionette.Callbacks.prototype,{add:function(callback,contextOverride){this._callbacks.push({cb:callback,ctx:contextOverride}),this._deferred.done(function(context,options){contextOverride&&(context=contextOverride),callback.call(context,options)})},run:function(options,context){this._deferred.resolve(context,options)},reset:function(){var callbacks=this._callbacks;this._deferred=Marionette.$.Deferred(),this._callbacks=[],_.each(callbacks,function(cb){this.add(cb.cb,cb.ctx)},this)}}),Marionette.Controller=function(options){this.triggerMethod=Marionette.triggerMethod,this.options=options||{},_.isFunction(this.initialize)&&this.initialize(this.options)},Marionette.Controller.extend=Marionette.extend,_.extend(Marionette.Controller.prototype,Backbone.Events,{close:function(){this.stopListening();var args=Array.prototype.slice.call(arguments);this.triggerMethod.apply(this,["close"].concat(args)),this.unbind()}}),Marionette.Region=function(options){if(this.options=options||{},this.el=Marionette.getOption(this,"el"),this.el||throwError("An 'el' must be specified for a region.","NoElError"),this.initialize){var args=Array.prototype.slice.apply(arguments);this.initialize.apply(this,args)}},_.extend(Marionette.Region,{buildRegion:function(regionConfig,defaultRegionType){var regionIsString=_.isString(regionConfig),regionSelectorIsString=_.isString(regionConfig.selector),regionTypeIsUndefined=_.isUndefined(regionConfig.regionType),regionIsType=_.isFunction(regionConfig);regionIsType||regionIsString||regionSelectorIsString||throwError("Region must be specified as a Region type, a selector string or an object with selector property");var selector,RegionType;regionIsString&&(selector=regionConfig),regionConfig.selector&&(selector=regionConfig.selector,delete regionConfig.selector),regionIsType&&(RegionType=regionConfig),!regionIsType&&regionTypeIsUndefined&&(RegionType=defaultRegionType),regionConfig.regionType&&(RegionType=regionConfig.regionType,delete regionConfig.regionType),(regionIsString||regionIsType)&&(regionConfig={}),regionConfig.el=selector;var region=new RegionType(regionConfig);return regionConfig.parentEl&&(region.getEl=function(selector){var parentEl=regionConfig.parentEl;return _.isFunction(parentEl)&&(parentEl=parentEl()),parentEl.find(selector)}),region}}),_.extend(Marionette.Region.prototype,Backbone.Events,{show:function(view){this.ensureEl();var isViewClosed=view.isClosed||_.isUndefined(view.$el),isDifferentView=view!==this.currentView;isDifferentView&&this.close(),view.render(),Marionette.triggerMethod.call(this,"before:show",view),Marionette.triggerMethod.call(view,"before:show"),(isDifferentView||isViewClosed)&&this.open(view),this.currentView=view,Marionette.triggerMethod.call(this,"show",view),Marionette.triggerMethod.call(view,"show")},ensureEl:function(){this.$el&&0!==this.$el.length||(this.$el=this.getEl(this.el))},getEl:function(selector){return Marionette.$(selector)},open:function(view){this.$el.empty().append(view.el)},close:function(){var view=this.currentView;view&&!view.isClosed&&(view.close?view.close():view.remove&&view.remove(),Marionette.triggerMethod.call(this,"close",view),delete this.currentView)},attachView:function(view){this.currentView=view},reset:function(){this.close(),delete this.$el}}),Marionette.Region.extend=Marionette.extend,Marionette.RegionManager=function(Marionette){var RegionManager=Marionette.Controller.extend({constructor:function(options){this._regions={},Marionette.Controller.prototype.constructor.call(this,options)},addRegions:function(regionDefinitions,defaults){var regions={};return _.each(regionDefinitions,function(definition,name){_.isString(definition)&&(definition={selector:definition}),definition.selector&&(definition=_.defaults({},definition,defaults));var region=this.addRegion(name,definition);regions[name]=region},this),regions},addRegion:function(name,definition){var region,isObject=_.isObject(definition),isString=_.isString(definition),hasSelector=!!definition.selector;return region=isString||isObject&&hasSelector?Marionette.Region.buildRegion(definition,Marionette.Region):_.isFunction(definition)?Marionette.Region.buildRegion(definition,Marionette.Region):definition,this._store(name,region),this.triggerMethod("region:add",name,region),region},get:function(name){return this._regions[name]},removeRegion:function(name){var region=this._regions[name];this._remove(name,region)},removeRegions:function(){_.each(this._regions,function(region,name){this._remove(name,region)},this)},closeRegions:function(){_.each(this._regions,function(region){region.close()},this)},close:function(){this.removeRegions(),Marionette.Controller.prototype.close.apply(this,arguments)},_store:function(name,region){this._regions[name]=region,this._setLength()},_remove:function(name,region){region.close(),delete this._regions[name],this._setLength(),this.triggerMethod("region:remove",name,region)},_setLength:function(){this.length=_.size(this._regions)}}),methods=["forEach","each","map","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","toArray","first","initial","rest","last","without","isEmpty","pluck"];return _.each(methods,function(method){RegionManager.prototype[method]=function(){var regions=_.values(this._regions),args=[regions].concat(_.toArray(arguments));return _[method].apply(_,args)}}),RegionManager}(Marionette),Marionette.TemplateCache=function(templateId){this.templateId=templateId},_.extend(Marionette.TemplateCache,{templateCaches:{},get:function(templateId){var cachedTemplate=this.templateCaches[templateId];return cachedTemplate||(cachedTemplate=new Marionette.TemplateCache(templateId),this.templateCaches[templateId]=cachedTemplate),cachedTemplate.load()},clear:function(){var i,args=slice.call(arguments),length=args.length;if(length>0)for(i=0;length>i;i++)delete this.templateCaches[args[i]];else this.templateCaches={}}}),_.extend(Marionette.TemplateCache.prototype,{load:function(){if(this.compiledTemplate)return this.compiledTemplate;var template=this.loadTemplate(this.templateId);return this.compiledTemplate=this.compileTemplate(template),this.compiledTemplate},loadTemplate:function(templateId){var template=Marionette.$(templateId).html();return template&&0!==template.length||throwError("Could not find template: '"+templateId+"'","NoTemplateError"),template},compileTemplate:function(rawTemplate){return _.template(rawTemplate)}}),Marionette.Renderer={render:function(template,data){template||throwError("Cannot render the template since it's false, null or undefined.","TemplateNotFoundError");var templateFunc;return(templateFunc="function"==typeof template?template:Marionette.TemplateCache.get(template))(data)}},Marionette.View=Backbone.View.extend({constructor:function(options){_.bindAll(this,"render"),_.isObject(this.behaviors)&&new Marionette.Behaviors(this),this.options=_.extend({},_.result(this,"options"),_.isFunction(options)?options.call(this):options),this.events=this.normalizeUIKeys(_.result(this,"events")),Backbone.View.prototype.constructor.apply(this,arguments),Marionette.MonitorDOMRefresh(this),this.listenTo(this,"show",this.onShowCalled)},triggerMethod:Marionette.triggerMethod,normalizeMethods:Marionette.normalizeMethods,getTemplate:function(){return Marionette.getOption(this,"template")},mixinTemplateHelpers:function(target){target=target||{};var templateHelpers=Marionette.getOption(this,"templateHelpers");return _.isFunction(templateHelpers)&&(templateHelpers=templateHelpers.call(this)),_.extend(target,templateHelpers)},normalizeUIKeys:function(hash){var ui=_.result(this,"ui");return Marionette.normalizeUIKeys(hash,ui)},configureTriggers:function(){if(this.triggers){var triggerEvents={},triggers=this.normalizeUIKeys(_.result(this,"triggers"));return _.each(triggers,function(value,key){var hasOptions=_.isObject(value),eventName=hasOptions?value.event:value;triggerEvents[key]=function(e){if(e){var prevent=e.preventDefault,stop=e.stopPropagation,shouldPrevent=hasOptions?value.preventDefault:prevent,shouldStop=hasOptions?value.stopPropagation:stop;shouldPrevent&&prevent&&prevent.apply(e),shouldStop&&stop&&stop.apply(e)}var args={view:this,model:this.model,collection:this.collection};this.triggerMethod(eventName,args)}},this),triggerEvents}},delegateEvents:function(events){this._delegateDOMEvents(events),Marionette.bindEntityEvents(this,this.model,Marionette.getOption(this,"modelEvents")),Marionette.bindEntityEvents(this,this.collection,Marionette.getOption(this,"collectionEvents"))},_delegateDOMEvents:function(events){events=events||this.events,_.isFunction(events)&&(events=events.call(this));var combinedEvents={},behaviorEvents=_.result(this,"behaviorEvents")||{},triggers=this.configureTriggers();_.extend(combinedEvents,behaviorEvents,events,triggers),Backbone.View.prototype.delegateEvents.call(this,combinedEvents)},undelegateEvents:function(){var args=Array.prototype.slice.call(arguments);Backbone.View.prototype.undelegateEvents.apply(this,args),Marionette.unbindEntityEvents(this,this.model,Marionette.getOption(this,"modelEvents")),Marionette.unbindEntityEvents(this,this.collection,Marionette.getOption(this,"collectionEvents"))},onShowCalled:function(){},close:function(){if(!this.isClosed){var args=Array.prototype.slice.call(arguments),shouldClose=this.triggerMethod.apply(this,["before:close"].concat(args));shouldClose!==!1&&(this.isClosed=!0,this.triggerMethod.apply(this,["close"].concat(args)),this.unbindUIElements(),this.remove())}},bindUIElements:function(){if(this.ui){this._uiBindings||(this._uiBindings=this.ui);var bindings=_.result(this,"_uiBindings");this.ui={},_.each(_.keys(bindings),function(key){var selector=bindings[key];this.ui[key]=this.$(selector)},this)}},unbindUIElements:function(){this.ui&&this._uiBindings&&(_.each(this.ui,function($el,name){delete this.ui[name]},this),this.ui=this._uiBindings,delete this._uiBindings)}}),Marionette.ItemView=Marionette.View.extend({constructor:function(){Marionette.View.prototype.constructor.apply(this,arguments)},serializeData:function(){var data={};return this.model?data=this.model.toJSON():this.collection&&(data={items:this.collection.toJSON()}),data},render:function(){this.isClosed=!1,this.triggerMethod("before:render",this),this.triggerMethod("item:before:render",this);var data=this.serializeData();data=this.mixinTemplateHelpers(data);var template=this.getTemplate(),html=Marionette.Renderer.render(template,data);return this.$el.html(html),this.bindUIElements(),this.triggerMethod("render",this),this.triggerMethod("item:rendered",this),this},close:function(){this.isClosed||(this.triggerMethod("item:before:close"),Marionette.View.prototype.close.apply(this,arguments),this.triggerMethod("item:closed"))}}),Marionette.CollectionView=Marionette.View.extend({itemViewEventPrefix:"itemview",constructor:function(){this._initChildViewStorage(),Marionette.View.prototype.constructor.apply(this,arguments),this._initialEvents(),this.initRenderBuffer()},initRenderBuffer:function(){this.elBuffer=document.createDocumentFragment(),this._bufferedChildren=[]},startBuffering:function(){this.initRenderBuffer(),this.isBuffering=!0},endBuffering:function(){this.isBuffering=!1,this.appendBuffer(this,this.elBuffer),this._triggerShowBufferedChildren(),this.initRenderBuffer()},_triggerShowBufferedChildren:function(){this._isShown&&(_.each(this._bufferedChildren,function(child){Marionette.triggerMethod.call(child,"show")}),this._bufferedChildren=[])},_initialEvents:function(){this.collection&&(this.listenTo(this.collection,"add",this.addChildView),this.listenTo(this.collection,"remove",this.removeItemView),this.listenTo(this.collection,"reset",this.render))
},addChildView:function(item){this.closeEmptyView();var ItemView=this.getItemView(item),index=this.collection.indexOf(item);this.addItemView(item,ItemView,index)},onShowCalled:function(){this.children.each(function(child){Marionette.triggerMethod.call(child,"show")})},triggerBeforeRender:function(){this.triggerMethod("before:render",this),this.triggerMethod("collection:before:render",this)},triggerRendered:function(){this.triggerMethod("render",this),this.triggerMethod("collection:rendered",this)},render:function(){return this.isClosed=!1,this.triggerBeforeRender(),this._renderChildren(),this.triggerRendered(),this},_renderChildren:function(){this.startBuffering(),this.closeEmptyView(),this.closeChildren(),this.isEmpty(this.collection)?this.showEmptyView():this.showCollection(),this.endBuffering()},showCollection:function(){var ItemView;this.collection.each(function(item,index){ItemView=this.getItemView(item),this.addItemView(item,ItemView,index)},this)},showEmptyView:function(){var EmptyView=this.getEmptyView();if(EmptyView&&!this._showingEmptyView){this._showingEmptyView=!0;var model=new Backbone.Model;this.addItemView(model,EmptyView,0)}},closeEmptyView:function(){this._showingEmptyView&&(this.closeChildren(),delete this._showingEmptyView)},getEmptyView:function(){return Marionette.getOption(this,"emptyView")},getItemView:function(){var itemView=Marionette.getOption(this,"itemView");return itemView||throwError("An `itemView` must be specified","NoItemViewError"),itemView},addItemView:function(item,ItemView,index){var itemViewOptions=Marionette.getOption(this,"itemViewOptions");_.isFunction(itemViewOptions)&&(itemViewOptions=itemViewOptions.call(this,item,index));var view=this.buildItemView(item,ItemView,itemViewOptions);return this.addChildViewEventForwarding(view),this.triggerMethod("before:item:added",view),this.children.add(view),this.renderItemView(view,index),this._isShown&&!this.isBuffering&&Marionette.triggerMethod.call(view,"show"),this.triggerMethod("after:item:added",view),view},addChildViewEventForwarding:function(view){var prefix=Marionette.getOption(this,"itemViewEventPrefix");this.listenTo(view,"all",function(){var args=slice.call(arguments),rootEvent=args[0],itemEvents=this.normalizeMethods(this.getItemEvents());args[0]=prefix+":"+rootEvent,args.splice(1,0,view),"undefined"!=typeof itemEvents&&_.isFunction(itemEvents[rootEvent])&&itemEvents[rootEvent].apply(this,args),Marionette.triggerMethod.apply(this,args)},this)},getItemEvents:function(){return _.isFunction(this.itemEvents)?this.itemEvents.call(this):this.itemEvents},renderItemView:function(view,index){view.render(),this.appendHtml(this,view,index)},buildItemView:function(item,ItemViewType,itemViewOptions){var options=_.extend({model:item},itemViewOptions);return new ItemViewType(options)},removeItemView:function(item){var view=this.children.findByModel(item);this.removeChildView(view),this.checkEmpty()},removeChildView:function(view){view&&(this.stopListening(view),view.close?view.close():view.remove&&view.remove(),this.children.remove(view)),this.triggerMethod("item:removed",view)},isEmpty:function(){return!this.collection||0===this.collection.length},checkEmpty:function(){this.isEmpty(this.collection)&&this.showEmptyView()},appendBuffer:function(collectionView,buffer){collectionView.$el.append(buffer)},appendHtml:function(collectionView,itemView){collectionView.isBuffering?(collectionView.elBuffer.appendChild(itemView.el),collectionView._bufferedChildren.push(itemView)):collectionView.$el.append(itemView.el)},_initChildViewStorage:function(){this.children=new Backbone.ChildViewContainer},close:function(){this.isClosed||(this.triggerMethod("collection:before:close"),this.closeChildren(),this.triggerMethod("collection:closed"),Marionette.View.prototype.close.apply(this,arguments))},closeChildren:function(){this.children.each(function(child){this.removeChildView(child)},this),this.checkEmpty()}}),Marionette.CompositeView=Marionette.CollectionView.extend({constructor:function(){Marionette.CollectionView.prototype.constructor.apply(this,arguments)},_initialEvents:function(){this.once("render",function(){this.collection&&(this.listenTo(this.collection,"add",this.addChildView),this.listenTo(this.collection,"remove",this.removeItemView),this.listenTo(this.collection,"reset",this._renderChildren))})},getItemView:function(){var itemView=Marionette.getOption(this,"itemView")||this.constructor;return itemView||throwError("An `itemView` must be specified","NoItemViewError"),itemView},serializeData:function(){var data={};return this.model&&(data=this.model.toJSON()),data},render:function(){this.isRendered=!0,this.isClosed=!1,this.resetItemViewContainer(),this.triggerBeforeRender();var html=this.renderModel();return this.$el.html(html),this.bindUIElements(),this.triggerMethod("composite:model:rendered"),this._renderChildren(),this.triggerMethod("composite:rendered"),this.triggerRendered(),this},_renderChildren:function(){this.isRendered&&(this.triggerMethod("composite:collection:before:render"),Marionette.CollectionView.prototype._renderChildren.call(this),this.triggerMethod("composite:collection:rendered"))},renderModel:function(){var data={};data=this.serializeData(),data=this.mixinTemplateHelpers(data);var template=this.getTemplate();return Marionette.Renderer.render(template,data)},appendBuffer:function(compositeView,buffer){var $container=this.getItemViewContainer(compositeView);$container.append(buffer)},appendHtml:function(compositeView,itemView){if(compositeView.isBuffering)compositeView.elBuffer.appendChild(itemView.el),compositeView._bufferedChildren.push(itemView);else{var $container=this.getItemViewContainer(compositeView);$container.append(itemView.el)}},getItemViewContainer:function(containerView){if("$itemViewContainer"in containerView)return containerView.$itemViewContainer;var container,itemViewContainer=Marionette.getOption(containerView,"itemViewContainer");if(itemViewContainer){var selector=_.isFunction(itemViewContainer)?itemViewContainer.call(this):itemViewContainer;container=containerView.$(selector),container.length<=0&&throwError("The specified `itemViewContainer` was not found: "+containerView.itemViewContainer,"ItemViewContainerMissingError")}else container=containerView.$el;return containerView.$itemViewContainer=container,container},resetItemViewContainer:function(){this.$itemViewContainer&&delete this.$itemViewContainer}}),Marionette.Layout=Marionette.ItemView.extend({regionType:Marionette.Region,constructor:function(options){options=options||{},this._firstRender=!0,this._initializeRegions(options),Marionette.ItemView.prototype.constructor.call(this,options)},render:function(){return this.isClosed&&this._initializeRegions(),this._firstRender?this._firstRender=!1:this.isClosed||this._reInitializeRegions(),Marionette.ItemView.prototype.render.apply(this,arguments)},close:function(){this.isClosed||(this.regionManager.close(),Marionette.ItemView.prototype.close.apply(this,arguments))},addRegion:function(name,definition){var regions={};return regions[name]=definition,this._buildRegions(regions)[name]},addRegions:function(regions){return this.regions=_.extend({},this.regions,regions),this._buildRegions(regions)},removeRegion:function(name){return delete this.regions[name],this.regionManager.removeRegion(name)},_buildRegions:function(regions){var that=this,defaults={regionType:Marionette.getOption(this,"regionType"),parentEl:function(){return that.$el}};return this.regionManager.addRegions(regions,defaults)},_initializeRegions:function(options){var regions;this._initRegionManager(),regions=_.isFunction(this.regions)?this.regions(options):this.regions||{},this.addRegions(regions)},_reInitializeRegions:function(){this.regionManager.closeRegions(),this.regionManager.each(function(region){region.reset()})},_initRegionManager:function(){this.regionManager=new Marionette.RegionManager,this.listenTo(this.regionManager,"region:add",function(name,region){this[name]=region,this.trigger("region:add",name,region)}),this.listenTo(this.regionManager,"region:remove",function(name,region){delete this[name],this.trigger("region:remove",name,region)})}}),Marionette.Behavior=function(_,Backbone){function Behavior(options,view){this.view=view,this.defaults=_.result(this,"defaults")||{},this.options=_.extend({},this.defaults,options),this.$=function(){return this.view.$.apply(this.view,arguments)},this.initialize.apply(this,arguments)}return _.extend(Behavior.prototype,{initialize:function(){},triggerMethod:Marionette.triggerMethod}),_.extend(Behavior,{extend:Backbone.View.extend}),Behavior}(_,Backbone),Marionette.Behaviors=function(Marionette,_){function Behaviors(view){this.behaviors=Behaviors.parseBehaviors(view,view.behaviors),Behaviors.wrap(view,this.behaviors,["bindUIElements","unbindUIElements","delegateEvents","undelegateEvents","onShow","onClose","behaviorEvents","triggerMethod","setElement"])}var methods={setElement:function(setElement,behaviors){setElement.apply(this,_.tail(arguments,2)),_.each(behaviors,function(b){b.$el=this.$el},this)},onShow:function(onShow,behaviors){var args=_.tail(arguments,2);_.each(behaviors,function(b){Marionette.triggerMethod.apply(b,["show"].concat(args))}),_.isFunction(onShow)&&onShow.apply(this,args)},onClose:function(onClose,behaviors){var args=_.tail(arguments,2);_.each(behaviors,function(b){Marionette.triggerMethod.apply(b,["close"].concat(args))}),_.isFunction(onClose)&&onClose.apply(this,args)},bindUIElements:function(bindUIElements,behaviors){bindUIElements.apply(this),_.invoke(behaviors,bindUIElements)},unbindUIElements:function(unbindUIElements,behaviors){unbindUIElements.apply(this),_.invoke(behaviors,unbindUIElements)},triggerMethod:function(triggerMethod,behaviors){var args=_.tail(arguments,2);triggerMethod.apply(this,args),_.each(behaviors,function(b){triggerMethod.apply(b,args)})},delegateEvents:function(delegateEvents,behaviors){var args=_.tail(arguments,2);delegateEvents.apply(this,args),_.each(behaviors,function(b){Marionette.bindEntityEvents(this,this.model,Marionette.getOption(b,"modelEvents")),Marionette.bindEntityEvents(this,this.collection,Marionette.getOption(b,"collectionEvents"))},this)},undelegateEvents:function(undelegateEvents,behaviors){var args=_.tail(arguments,2);undelegateEvents.apply(this,args),_.each(behaviors,function(b){Marionette.unbindEntityEvents(this,this.model,Marionette.getOption(b,"modelEvents")),Marionette.unbindEntityEvents(this,this.collection,Marionette.getOption(b,"collectionEvents"))},this)},behaviorEvents:function(behaviorEvents,behaviors){var _behaviorsEvents={},viewUI=_.result(this,"ui");return _.each(behaviors,function(b,i){var _events={},behaviorEvents=_.result(b,"events")||{},behaviorUI=_.result(b,"ui"),ui=_.extend({},viewUI,behaviorUI);behaviorEvents=Marionette.normalizeUIKeys(behaviorEvents,ui),_.each(_.keys(behaviorEvents),function(key){var whitespace=new Array(i+2).join(" "),eventKey=key+whitespace,handler=_.isFunction(behaviorEvents[key])?behaviorEvents[key]:b[behaviorEvents[key]];_events[eventKey]=_.bind(handler,b)}),_behaviorsEvents=_.extend(_behaviorsEvents,_events)}),_behaviorsEvents}};return _.extend(Behaviors,{behaviorsLookup:function(){throw new Error("You must define where your behaviors are stored. See https://github.com/marionettejs/backbone.marionette/blob/master/docs/marionette.behaviors.md#behaviorslookup")},getBehaviorClass:function(options,key){return options.behaviorClass?options.behaviorClass:_.isFunction(Behaviors.behaviorsLookup)?Behaviors.behaviorsLookup.apply(this,arguments)[key]:Behaviors.behaviorsLookup[key]},parseBehaviors:function(view,behaviors){return _.map(behaviors,function(options,key){var BehaviorClass=Behaviors.getBehaviorClass(options,key);return new BehaviorClass(options,view)})},wrap:function(view,behaviors,methodNames){_.each(methodNames,function(methodName){view[methodName]=_.partial(methods[methodName],view[methodName],behaviors)})}}),Behaviors}(Marionette,_),Marionette.AppRouter=Backbone.Router.extend({constructor:function(options){Backbone.Router.prototype.constructor.apply(this,arguments),this.options=options||{};var appRoutes=Marionette.getOption(this,"appRoutes"),controller=this._getController();this.processAppRoutes(controller,appRoutes)},appRoute:function(route,methodName){var controller=this._getController();this._addAppRoute(controller,route,methodName)},processAppRoutes:function(controller,appRoutes){if(appRoutes){var routeNames=_.keys(appRoutes).reverse();_.each(routeNames,function(route){this._addAppRoute(controller,route,appRoutes[route])},this)}},_getController:function(){return Marionette.getOption(this,"controller")},_addAppRoute:function(controller,route,methodName){var method=controller[methodName];method||throwError("Method '"+methodName+"' was not found on the controller"),this.route(route,methodName,_.bind(method,controller))}}),Marionette.Application=function(options){this._initRegionManager(),this._initCallbacks=new Marionette.Callbacks,this.vent=new Backbone.Wreqr.EventAggregator,this.commands=new Backbone.Wreqr.Commands,this.reqres=new Backbone.Wreqr.RequestResponse,this.submodules={},_.extend(this,options),this.triggerMethod=Marionette.triggerMethod},_.extend(Marionette.Application.prototype,Backbone.Events,{execute:function(){this.commands.execute.apply(this.commands,arguments)},request:function(){return this.reqres.request.apply(this.reqres,arguments)},addInitializer:function(initializer){this._initCallbacks.add(initializer)},start:function(options){this.triggerMethod("initialize:before",options),this._initCallbacks.run(options,this),this.triggerMethod("initialize:after",options),this.triggerMethod("start",options)},addRegions:function(regions){return this._regionManager.addRegions(regions)},closeRegions:function(){this._regionManager.closeRegions()},removeRegion:function(region){this._regionManager.removeRegion(region)},getRegion:function(region){return this._regionManager.get(region)},module:function(moduleNames,moduleDefinition){var ModuleClass=Marionette.Module.getClass(moduleDefinition),args=slice.call(arguments);return args.unshift(this),ModuleClass.create.apply(ModuleClass,args)},_initRegionManager:function(){this._regionManager=new Marionette.RegionManager,this.listenTo(this._regionManager,"region:add",function(name,region){this[name]=region}),this.listenTo(this._regionManager,"region:remove",function(name){delete this[name]})}}),Marionette.Application.extend=Marionette.extend,Marionette.Module=function(moduleName,app,options){this.moduleName=moduleName,this.options=_.extend({},this.options,options),this.initialize=options.initialize||this.initialize,this.submodules={},this._setupInitializersAndFinalizers(),this.app=app,this.startWithParent=!0,this.triggerMethod=Marionette.triggerMethod,_.isFunction(this.initialize)&&this.initialize(this.options,moduleName,app)},Marionette.Module.extend=Marionette.extend,_.extend(Marionette.Module.prototype,Backbone.Events,{initialize:function(){},addInitializer:function(callback){this._initializerCallbacks.add(callback)},addFinalizer:function(callback){this._finalizerCallbacks.add(callback)},start:function(options){this._isInitialized||(_.each(this.submodules,function(mod){mod.startWithParent&&mod.start(options)}),this.triggerMethod("before:start",options),this._initializerCallbacks.run(options,this),this._isInitialized=!0,this.triggerMethod("start",options))},stop:function(){this._isInitialized&&(this._isInitialized=!1,Marionette.triggerMethod.call(this,"before:stop"),_.each(this.submodules,function(mod){mod.stop()}),this._finalizerCallbacks.run(void 0,this),this._initializerCallbacks.reset(),this._finalizerCallbacks.reset(),Marionette.triggerMethod.call(this,"stop"))},addDefinition:function(moduleDefinition,customArgs){this._runModuleDefinition(moduleDefinition,customArgs)},_runModuleDefinition:function(definition,customArgs){if(definition){var args=_.flatten([this,this.app,Backbone,Marionette,Marionette.$,_,customArgs]);definition.apply(this,args)}},_setupInitializersAndFinalizers:function(){this._initializerCallbacks=new Marionette.Callbacks,this._finalizerCallbacks=new Marionette.Callbacks}}),_.extend(Marionette.Module,{create:function(app,moduleNames,moduleDefinition){var module=app,customArgs=slice.call(arguments);customArgs.splice(0,3),moduleNames=moduleNames.split(".");var length=moduleNames.length,moduleDefinitions=[];return moduleDefinitions[length-1]=moduleDefinition,_.each(moduleNames,function(moduleName,i){var parentModule=module;module=this._getModule(parentModule,moduleName,app,moduleDefinition),this._addModuleDefinition(parentModule,module,moduleDefinitions[i],customArgs)},this),module},_getModule:function(parentModule,moduleName,app,def){var options=_.extend({},def),ModuleClass=this.getClass(def),module=parentModule[moduleName];return module||(module=new ModuleClass(moduleName,app,options),parentModule[moduleName]=module,parentModule.submodules[moduleName]=module),module},getClass:function(moduleDefinition){var ModuleClass=Marionette.Module;return moduleDefinition?moduleDefinition.prototype instanceof ModuleClass?moduleDefinition:moduleDefinition.moduleClass||ModuleClass:ModuleClass},_addModuleDefinition:function(parentModule,module,def,args){var fn=this._getDefine(def),startWithParent=this._getStartWithParent(def,module);fn&&module.addDefinition(fn,args),this._addStartWithParent(parentModule,module,startWithParent)},_getStartWithParent:function(def,module){var swp;return _.isFunction(def)&&def.prototype instanceof Marionette.Module?(swp=module.constructor.prototype.startWithParent,_.isUndefined(swp)?!0:swp):_.isObject(def)?(swp=def.startWithParent,_.isUndefined(swp)?!0:swp):!0},_getDefine:function(def){return!_.isFunction(def)||def.prototype instanceof Marionette.Module?_.isObject(def)?def.define:null:def},_addStartWithParent:function(parentModule,module,startWithParent){module.startWithParent=module.startWithParent&&startWithParent,module.startWithParent&&!module.startWithParentIsConfigured&&(module.startWithParentIsConfigured=!0,parentModule.addInitializer(function(options){module.startWithParent&&module.start(options)}))}}),Marionette}(this,Backbone,_);return Backbone.Marionette});var Handlebars=function(){var __module4__=function(){function SafeString(string){this.string=string}var __exports__;return SafeString.prototype.toString=function(){return""+this.string},__exports__=SafeString}(),__module3__=function(__dependency1__){function escapeChar(chr){return escape[chr]||"&amp;"}function extend(obj,value){for(var key in value)Object.prototype.hasOwnProperty.call(value,key)&&(obj[key]=value[key])}function escapeExpression(string){return string instanceof SafeString?string.toString():string||0===string?(string=""+string,possible.test(string)?string.replace(badChars,escapeChar):string):""}function isEmpty(value){return value||0===value?isArray(value)&&0===value.length?!0:!1:!0}var __exports__={},SafeString=__dependency1__,escape={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},badChars=/[&<>"'`]/g,possible=/[&<>"'`]/;__exports__.extend=extend;var toString=Object.prototype.toString;__exports__.toString=toString;var isFunction=function(value){return"function"==typeof value};isFunction(/x/)&&(isFunction=function(value){return"function"==typeof value&&"[object Function]"===toString.call(value)});var isFunction;__exports__.isFunction=isFunction;var isArray=Array.isArray||function(value){return value&&"object"==typeof value?"[object Array]"===toString.call(value):!1};return __exports__.isArray=isArray,__exports__.escapeExpression=escapeExpression,__exports__.isEmpty=isEmpty,__exports__}(__module4__),__module5__=function(){function Exception(message,node){var line;node&&node.firstLine&&(line=node.firstLine,message+=" - "+line+":"+node.firstColumn);for(var tmp=Error.prototype.constructor.call(this,message),idx=0;idx<errorProps.length;idx++)this[errorProps[idx]]=tmp[errorProps[idx]];line&&(this.lineNumber=line,this.column=node.firstColumn)}var __exports__,errorProps=["description","fileName","lineNumber","message","name","number","stack"];return Exception.prototype=new Error,__exports__=Exception}(),__module2__=function(__dependency1__,__dependency2__){function HandlebarsEnvironment(helpers,partials){this.helpers=helpers||{},this.partials=partials||{},registerDefaultHelpers(this)}function registerDefaultHelpers(instance){instance.registerHelper("helperMissing",function(arg){if(2===arguments.length)return void 0;throw new Exception("Missing helper: '"+arg+"'")}),instance.registerHelper("blockHelperMissing",function(context,options){var inverse=options.inverse||function(){},fn=options.fn;return isFunction(context)&&(context=context.call(this)),context===!0?fn(this):context===!1||null==context?inverse(this):isArray(context)?context.length>0?instance.helpers.each(context,options):inverse(this):fn(context)}),instance.registerHelper("each",function(context,options){var data,fn=options.fn,inverse=options.inverse,i=0,ret="";if(isFunction(context)&&(context=context.call(this)),options.data&&(data=createFrame(options.data)),context&&"object"==typeof context)if(isArray(context))for(var j=context.length;j>i;i++)data&&(data.index=i,data.first=0===i,data.last=i===context.length-1),ret+=fn(context[i],{data:data});else for(var key in context)context.hasOwnProperty(key)&&(data&&(data.key=key,data.index=i,data.first=0===i),ret+=fn(context[key],{data:data}),i++);return 0===i&&(ret=inverse(this)),ret}),instance.registerHelper("if",function(conditional,options){return isFunction(conditional)&&(conditional=conditional.call(this)),!options.hash.includeZero&&!conditional||Utils.isEmpty(conditional)?options.inverse(this):options.fn(this)}),instance.registerHelper("unless",function(conditional,options){return instance.helpers["if"].call(this,conditional,{fn:options.inverse,inverse:options.fn,hash:options.hash})}),instance.registerHelper("with",function(context,options){return isFunction(context)&&(context=context.call(this)),Utils.isEmpty(context)?void 0:options.fn(context)}),instance.registerHelper("log",function(context,options){var level=options.data&&null!=options.data.level?parseInt(options.data.level,10):1;instance.log(level,context)})}function log(level,obj){logger.log(level,obj)}var __exports__={},Utils=__dependency1__,Exception=__dependency2__,VERSION="1.3.0";__exports__.VERSION=VERSION;var COMPILER_REVISION=4;__exports__.COMPILER_REVISION=COMPILER_REVISION;var REVISION_CHANGES={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:">= 1.0.0"};__exports__.REVISION_CHANGES=REVISION_CHANGES;var isArray=Utils.isArray,isFunction=Utils.isFunction,toString=Utils.toString,objectType="[object Object]";__exports__.HandlebarsEnvironment=HandlebarsEnvironment,HandlebarsEnvironment.prototype={constructor:HandlebarsEnvironment,logger:logger,log:log,registerHelper:function(name,fn,inverse){if(toString.call(name)===objectType){if(inverse||fn)throw new Exception("Arg not supported with multiple helpers");Utils.extend(this.helpers,name)}else inverse&&(fn.not=inverse),this.helpers[name]=fn},registerPartial:function(name,str){toString.call(name)===objectType?Utils.extend(this.partials,name):this.partials[name]=str}};var logger={methodMap:{0:"debug",1:"info",2:"warn",3:"error"},DEBUG:0,INFO:1,WARN:2,ERROR:3,level:3,log:function(level,obj){if(logger.level<=level){var method=logger.methodMap[level];"undefined"!=typeof console&&console[method]&&console[method].call(console,obj)}}};__exports__.logger=logger,__exports__.log=log;var createFrame=function(object){var obj={};return Utils.extend(obj,object),obj};return __exports__.createFrame=createFrame,__exports__}(__module3__,__module5__),__module6__=function(__dependency1__,__dependency2__,__dependency3__){function checkRevision(compilerInfo){var compilerRevision=compilerInfo&&compilerInfo[0]||1,currentRevision=COMPILER_REVISION;if(compilerRevision!==currentRevision){if(currentRevision>compilerRevision){var runtimeVersions=REVISION_CHANGES[currentRevision],compilerVersions=REVISION_CHANGES[compilerRevision];throw new Exception("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+runtimeVersions+") or downgrade your runtime to an older version ("+compilerVersions+").")}throw new Exception("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+compilerInfo[1]+").")}}function template(templateSpec,env){if(!env)throw new Exception("No environment passed to template");var invokePartialWrapper=function(partial,name,context,helpers,partials,data){var result=env.VM.invokePartial.apply(this,arguments);if(null!=result)return result;if(env.compile){var options={helpers:helpers,partials:partials,data:data};return partials[name]=env.compile(partial,{data:void 0!==data},env),partials[name](context,options)}throw new Exception("The partial "+name+" could not be compiled when running in runtime-only mode")},container={escapeExpression:Utils.escapeExpression,invokePartial:invokePartialWrapper,programs:[],program:function(i,fn,data){var programWrapper=this.programs[i];return data?programWrapper=program(i,fn,data):programWrapper||(programWrapper=this.programs[i]=program(i,fn)),programWrapper},merge:function(param,common){var ret=param||common;return param&&common&&param!==common&&(ret={},Utils.extend(ret,common),Utils.extend(ret,param)),ret},programWithDepth:env.VM.programWithDepth,noop:env.VM.noop,compilerInfo:null};return function(context,options){options=options||{};var helpers,partials,namespace=options.partial?options:env;options.partial||(helpers=options.helpers,partials=options.partials);var result=templateSpec.call(container,namespace,context,helpers,partials,options.data);return options.partial||env.VM.checkRevision(container.compilerInfo),result}}function programWithDepth(i,fn,data){var args=Array.prototype.slice.call(arguments,3),prog=function(context,options){return options=options||{},fn.apply(this,[context,options.data||data].concat(args))};return prog.program=i,prog.depth=args.length,prog}function program(i,fn,data){var prog=function(context,options){return options=options||{},fn(context,options.data||data)};return prog.program=i,prog.depth=0,prog}function invokePartial(partial,name,context,helpers,partials,data){var options={partial:!0,helpers:helpers,partials:partials,data:data};if(void 0===partial)throw new Exception("The partial "+name+" could not be found");return partial instanceof Function?partial(context,options):void 0}function noop(){return""}var __exports__={},Utils=__dependency1__,Exception=__dependency2__,COMPILER_REVISION=__dependency3__.COMPILER_REVISION,REVISION_CHANGES=__dependency3__.REVISION_CHANGES;return __exports__.checkRevision=checkRevision,__exports__.template=template,__exports__.programWithDepth=programWithDepth,__exports__.program=program,__exports__.invokePartial=invokePartial,__exports__.noop=noop,__exports__}(__module3__,__module5__,__module2__),__module1__=function(__dependency1__,__dependency2__,__dependency3__,__dependency4__,__dependency5__){var __exports__,base=__dependency1__,SafeString=__dependency2__,Exception=__dependency3__,Utils=__dependency4__,runtime=__dependency5__,create=function(){var hb=new base.HandlebarsEnvironment;return Utils.extend(hb,base),hb.SafeString=SafeString,hb.Exception=Exception,hb.Utils=Utils,hb.VM=runtime,hb.template=function(spec){return runtime.template(spec,hb)},hb},Handlebars=create();return Handlebars.create=create,__exports__=Handlebars}(__module2__,__module4__,__module5__,__module3__,__module6__),__module7__=function(__dependency1__){function LocationInfo(locInfo){locInfo=locInfo||{},this.firstLine=locInfo.first_line,this.firstColumn=locInfo.first_column,this.lastColumn=locInfo.last_column,this.lastLine=locInfo.last_line}var __exports__,Exception=__dependency1__,AST={ProgramNode:function(statements,inverseStrip,inverse,locInfo){var inverseLocationInfo,firstInverseNode;3===arguments.length?(locInfo=inverse,inverse=null):2===arguments.length&&(locInfo=inverseStrip,inverseStrip=null),LocationInfo.call(this,locInfo),this.type="program",this.statements=statements,this.strip={},inverse?(firstInverseNode=inverse[0],firstInverseNode?(inverseLocationInfo={first_line:firstInverseNode.firstLine,last_line:firstInverseNode.lastLine,last_column:firstInverseNode.lastColumn,first_column:firstInverseNode.firstColumn},this.inverse=new AST.ProgramNode(inverse,inverseStrip,inverseLocationInfo)):this.inverse=new AST.ProgramNode(inverse,inverseStrip),this.strip.right=inverseStrip.left):inverseStrip&&(this.strip.left=inverseStrip.right)},MustacheNode:function(rawParams,hash,open,strip,locInfo){if(LocationInfo.call(this,locInfo),this.type="mustache",this.strip=strip,null!=open&&open.charAt){var escapeFlag=open.charAt(3)||open.charAt(2);this.escaped="{"!==escapeFlag&&"&"!==escapeFlag}else this.escaped=!!open;this.sexpr=rawParams instanceof AST.SexprNode?rawParams:new AST.SexprNode(rawParams,hash),this.sexpr.isRoot=!0,this.id=this.sexpr.id,this.params=this.sexpr.params,this.hash=this.sexpr.hash,this.eligibleHelper=this.sexpr.eligibleHelper,this.isHelper=this.sexpr.isHelper},SexprNode:function(rawParams,hash,locInfo){LocationInfo.call(this,locInfo),this.type="sexpr",this.hash=hash;var id=this.id=rawParams[0],params=this.params=rawParams.slice(1),eligibleHelper=this.eligibleHelper=id.isSimple;this.isHelper=eligibleHelper&&(params.length||hash)},PartialNode:function(partialName,context,strip,locInfo){LocationInfo.call(this,locInfo),this.type="partial",this.partialName=partialName,this.context=context,this.strip=strip},BlockNode:function(mustache,program,inverse,close,locInfo){if(LocationInfo.call(this,locInfo),mustache.sexpr.id.original!==close.path.original)throw new Exception(mustache.sexpr.id.original+" doesn't match "+close.path.original,this);this.type="block",this.mustache=mustache,this.program=program,this.inverse=inverse,this.strip={left:mustache.strip.left,right:close.strip.right},(program||inverse).strip.left=mustache.strip.right,(inverse||program).strip.right=close.strip.left,inverse&&!program&&(this.isInverse=!0)},ContentNode:function(string,locInfo){LocationInfo.call(this,locInfo),this.type="content",this.string=string},HashNode:function(pairs,locInfo){LocationInfo.call(this,locInfo),this.type="hash",this.pairs=pairs},IdNode:function(parts,locInfo){LocationInfo.call(this,locInfo),this.type="ID";for(var original="",dig=[],depth=0,i=0,l=parts.length;l>i;i++){var part=parts[i].part;if(original+=(parts[i].separator||"")+part,".."===part||"."===part||"this"===part){if(dig.length>0)throw new Exception("Invalid path: "+original,this);".."===part?depth++:this.isScoped=!0}else dig.push(part)}this.original=original,this.parts=dig,this.string=dig.join("."),this.depth=depth,this.isSimple=1===parts.length&&!this.isScoped&&0===depth,this.stringModeValue=this.string},PartialNameNode:function(name,locInfo){LocationInfo.call(this,locInfo),this.type="PARTIAL_NAME",this.name=name.original},DataNode:function(id,locInfo){LocationInfo.call(this,locInfo),this.type="DATA",this.id=id},StringNode:function(string,locInfo){LocationInfo.call(this,locInfo),this.type="STRING",this.original=this.string=this.stringModeValue=string},IntegerNode:function(integer,locInfo){LocationInfo.call(this,locInfo),this.type="INTEGER",this.original=this.integer=integer,this.stringModeValue=Number(integer)},BooleanNode:function(bool,locInfo){LocationInfo.call(this,locInfo),this.type="BOOLEAN",this.bool=bool,this.stringModeValue="true"===bool},CommentNode:function(comment,locInfo){LocationInfo.call(this,locInfo),this.type="comment",this.comment=comment}};return __exports__=AST}(__module5__),__module9__=function(){var __exports__,handlebars=function(){function stripFlags(open,close){return{left:"~"===open.charAt(2),right:"~"===close.charAt(0)||"~"===close.charAt(1)}}function Parser(){this.yy={}}var parser={trace:function(){},yy:{},symbols_:{error:2,root:3,statements:4,EOF:5,program:6,simpleInverse:7,statement:8,openInverse:9,closeBlock:10,openBlock:11,mustache:12,partial:13,CONTENT:14,COMMENT:15,OPEN_BLOCK:16,sexpr:17,CLOSE:18,OPEN_INVERSE:19,OPEN_ENDBLOCK:20,path:21,OPEN:22,OPEN_UNESCAPED:23,CLOSE_UNESCAPED:24,OPEN_PARTIAL:25,partialName:26,partial_option0:27,sexpr_repetition0:28,sexpr_option0:29,dataName:30,param:31,STRING:32,INTEGER:33,BOOLEAN:34,OPEN_SEXPR:35,CLOSE_SEXPR:36,hash:37,hash_repetition_plus0:38,hashSegment:39,ID:40,EQUALS:41,DATA:42,pathSegments:43,SEP:44,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",14:"CONTENT",15:"COMMENT",16:"OPEN_BLOCK",18:"CLOSE",19:"OPEN_INVERSE",20:"OPEN_ENDBLOCK",22:"OPEN",23:"OPEN_UNESCAPED",24:"CLOSE_UNESCAPED",25:"OPEN_PARTIAL",32:"STRING",33:"INTEGER",34:"BOOLEAN",35:"OPEN_SEXPR",36:"CLOSE_SEXPR",40:"ID",41:"EQUALS",42:"DATA",44:"SEP"},productions_:[0,[3,2],[3,1],[6,2],[6,3],[6,2],[6,1],[6,1],[6,0],[4,1],[4,2],[8,3],[8,3],[8,1],[8,1],[8,1],[8,1],[11,3],[9,3],[10,3],[12,3],[12,3],[13,4],[7,2],[17,3],[17,1],[31,1],[31,1],[31,1],[31,1],[31,1],[31,3],[37,1],[39,3],[26,1],[26,1],[26,1],[30,2],[21,1],[43,3],[43,1],[27,0],[27,1],[28,0],[28,2],[29,0],[29,1],[38,1],[38,2]],performAction:function(yytext,yyleng,yylineno,yy,yystate,$$){var $0=$$.length-1;
switch(yystate){case 1:return new yy.ProgramNode($$[$0-1],this._$);case 2:return new yy.ProgramNode([],this._$);case 3:this.$=new yy.ProgramNode([],$$[$0-1],$$[$0],this._$);break;case 4:this.$=new yy.ProgramNode($$[$0-2],$$[$0-1],$$[$0],this._$);break;case 5:this.$=new yy.ProgramNode($$[$0-1],$$[$0],[],this._$);break;case 6:this.$=new yy.ProgramNode($$[$0],this._$);break;case 7:this.$=new yy.ProgramNode([],this._$);break;case 8:this.$=new yy.ProgramNode([],this._$);break;case 9:this.$=[$$[$0]];break;case 10:$$[$0-1].push($$[$0]),this.$=$$[$0-1];break;case 11:this.$=new yy.BlockNode($$[$0-2],$$[$0-1].inverse,$$[$0-1],$$[$0],this._$);break;case 12:this.$=new yy.BlockNode($$[$0-2],$$[$0-1],$$[$0-1].inverse,$$[$0],this._$);break;case 13:this.$=$$[$0];break;case 14:this.$=$$[$0];break;case 15:this.$=new yy.ContentNode($$[$0],this._$);break;case 16:this.$=new yy.CommentNode($$[$0],this._$);break;case 17:this.$=new yy.MustacheNode($$[$0-1],null,$$[$0-2],stripFlags($$[$0-2],$$[$0]),this._$);break;case 18:this.$=new yy.MustacheNode($$[$0-1],null,$$[$0-2],stripFlags($$[$0-2],$$[$0]),this._$);break;case 19:this.$={path:$$[$0-1],strip:stripFlags($$[$0-2],$$[$0])};break;case 20:this.$=new yy.MustacheNode($$[$0-1],null,$$[$0-2],stripFlags($$[$0-2],$$[$0]),this._$);break;case 21:this.$=new yy.MustacheNode($$[$0-1],null,$$[$0-2],stripFlags($$[$0-2],$$[$0]),this._$);break;case 22:this.$=new yy.PartialNode($$[$0-2],$$[$0-1],stripFlags($$[$0-3],$$[$0]),this._$);break;case 23:this.$=stripFlags($$[$0-1],$$[$0]);break;case 24:this.$=new yy.SexprNode([$$[$0-2]].concat($$[$0-1]),$$[$0],this._$);break;case 25:this.$=new yy.SexprNode([$$[$0]],null,this._$);break;case 26:this.$=$$[$0];break;case 27:this.$=new yy.StringNode($$[$0],this._$);break;case 28:this.$=new yy.IntegerNode($$[$0],this._$);break;case 29:this.$=new yy.BooleanNode($$[$0],this._$);break;case 30:this.$=$$[$0];break;case 31:$$[$0-1].isHelper=!0,this.$=$$[$0-1];break;case 32:this.$=new yy.HashNode($$[$0],this._$);break;case 33:this.$=[$$[$0-2],$$[$0]];break;case 34:this.$=new yy.PartialNameNode($$[$0],this._$);break;case 35:this.$=new yy.PartialNameNode(new yy.StringNode($$[$0],this._$),this._$);break;case 36:this.$=new yy.PartialNameNode(new yy.IntegerNode($$[$0],this._$));break;case 37:this.$=new yy.DataNode($$[$0],this._$);break;case 38:this.$=new yy.IdNode($$[$0],this._$);break;case 39:$$[$0-2].push({part:$$[$0],separator:$$[$0-1]}),this.$=$$[$0-2];break;case 40:this.$=[{part:$$[$0]}];break;case 43:this.$=[];break;case 44:$$[$0-1].push($$[$0]);break;case 47:this.$=[$$[$0]];break;case 48:$$[$0-1].push($$[$0])}},table:[{3:1,4:2,5:[1,3],8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],22:[1,13],23:[1,14],25:[1,15]},{1:[3]},{5:[1,16],8:17,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],22:[1,13],23:[1,14],25:[1,15]},{1:[2,2]},{5:[2,9],14:[2,9],15:[2,9],16:[2,9],19:[2,9],20:[2,9],22:[2,9],23:[2,9],25:[2,9]},{4:20,6:18,7:19,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,21],20:[2,8],22:[1,13],23:[1,14],25:[1,15]},{4:20,6:22,7:19,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,21],20:[2,8],22:[1,13],23:[1,14],25:[1,15]},{5:[2,13],14:[2,13],15:[2,13],16:[2,13],19:[2,13],20:[2,13],22:[2,13],23:[2,13],25:[2,13]},{5:[2,14],14:[2,14],15:[2,14],16:[2,14],19:[2,14],20:[2,14],22:[2,14],23:[2,14],25:[2,14]},{5:[2,15],14:[2,15],15:[2,15],16:[2,15],19:[2,15],20:[2,15],22:[2,15],23:[2,15],25:[2,15]},{5:[2,16],14:[2,16],15:[2,16],16:[2,16],19:[2,16],20:[2,16],22:[2,16],23:[2,16],25:[2,16]},{17:23,21:24,30:25,40:[1,28],42:[1,27],43:26},{17:29,21:24,30:25,40:[1,28],42:[1,27],43:26},{17:30,21:24,30:25,40:[1,28],42:[1,27],43:26},{17:31,21:24,30:25,40:[1,28],42:[1,27],43:26},{21:33,26:32,32:[1,34],33:[1,35],40:[1,28],43:26},{1:[2,1]},{5:[2,10],14:[2,10],15:[2,10],16:[2,10],19:[2,10],20:[2,10],22:[2,10],23:[2,10],25:[2,10]},{10:36,20:[1,37]},{4:38,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,7],22:[1,13],23:[1,14],25:[1,15]},{7:39,8:17,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,21],20:[2,6],22:[1,13],23:[1,14],25:[1,15]},{17:23,18:[1,40],21:24,30:25,40:[1,28],42:[1,27],43:26},{10:41,20:[1,37]},{18:[1,42]},{18:[2,43],24:[2,43],28:43,32:[2,43],33:[2,43],34:[2,43],35:[2,43],36:[2,43],40:[2,43],42:[2,43]},{18:[2,25],24:[2,25],36:[2,25]},{18:[2,38],24:[2,38],32:[2,38],33:[2,38],34:[2,38],35:[2,38],36:[2,38],40:[2,38],42:[2,38],44:[1,44]},{21:45,40:[1,28],43:26},{18:[2,40],24:[2,40],32:[2,40],33:[2,40],34:[2,40],35:[2,40],36:[2,40],40:[2,40],42:[2,40],44:[2,40]},{18:[1,46]},{18:[1,47]},{24:[1,48]},{18:[2,41],21:50,27:49,40:[1,28],43:26},{18:[2,34],40:[2,34]},{18:[2,35],40:[2,35]},{18:[2,36],40:[2,36]},{5:[2,11],14:[2,11],15:[2,11],16:[2,11],19:[2,11],20:[2,11],22:[2,11],23:[2,11],25:[2,11]},{21:51,40:[1,28],43:26},{8:17,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,3],22:[1,13],23:[1,14],25:[1,15]},{4:52,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,5],22:[1,13],23:[1,14],25:[1,15]},{14:[2,23],15:[2,23],16:[2,23],19:[2,23],20:[2,23],22:[2,23],23:[2,23],25:[2,23]},{5:[2,12],14:[2,12],15:[2,12],16:[2,12],19:[2,12],20:[2,12],22:[2,12],23:[2,12],25:[2,12]},{14:[2,18],15:[2,18],16:[2,18],19:[2,18],20:[2,18],22:[2,18],23:[2,18],25:[2,18]},{18:[2,45],21:56,24:[2,45],29:53,30:60,31:54,32:[1,57],33:[1,58],34:[1,59],35:[1,61],36:[2,45],37:55,38:62,39:63,40:[1,64],42:[1,27],43:26},{40:[1,65]},{18:[2,37],24:[2,37],32:[2,37],33:[2,37],34:[2,37],35:[2,37],36:[2,37],40:[2,37],42:[2,37]},{14:[2,17],15:[2,17],16:[2,17],19:[2,17],20:[2,17],22:[2,17],23:[2,17],25:[2,17]},{5:[2,20],14:[2,20],15:[2,20],16:[2,20],19:[2,20],20:[2,20],22:[2,20],23:[2,20],25:[2,20]},{5:[2,21],14:[2,21],15:[2,21],16:[2,21],19:[2,21],20:[2,21],22:[2,21],23:[2,21],25:[2,21]},{18:[1,66]},{18:[2,42]},{18:[1,67]},{8:17,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,4],22:[1,13],23:[1,14],25:[1,15]},{18:[2,24],24:[2,24],36:[2,24]},{18:[2,44],24:[2,44],32:[2,44],33:[2,44],34:[2,44],35:[2,44],36:[2,44],40:[2,44],42:[2,44]},{18:[2,46],24:[2,46],36:[2,46]},{18:[2,26],24:[2,26],32:[2,26],33:[2,26],34:[2,26],35:[2,26],36:[2,26],40:[2,26],42:[2,26]},{18:[2,27],24:[2,27],32:[2,27],33:[2,27],34:[2,27],35:[2,27],36:[2,27],40:[2,27],42:[2,27]},{18:[2,28],24:[2,28],32:[2,28],33:[2,28],34:[2,28],35:[2,28],36:[2,28],40:[2,28],42:[2,28]},{18:[2,29],24:[2,29],32:[2,29],33:[2,29],34:[2,29],35:[2,29],36:[2,29],40:[2,29],42:[2,29]},{18:[2,30],24:[2,30],32:[2,30],33:[2,30],34:[2,30],35:[2,30],36:[2,30],40:[2,30],42:[2,30]},{17:68,21:24,30:25,40:[1,28],42:[1,27],43:26},{18:[2,32],24:[2,32],36:[2,32],39:69,40:[1,70]},{18:[2,47],24:[2,47],36:[2,47],40:[2,47]},{18:[2,40],24:[2,40],32:[2,40],33:[2,40],34:[2,40],35:[2,40],36:[2,40],40:[2,40],41:[1,71],42:[2,40],44:[2,40]},{18:[2,39],24:[2,39],32:[2,39],33:[2,39],34:[2,39],35:[2,39],36:[2,39],40:[2,39],42:[2,39],44:[2,39]},{5:[2,22],14:[2,22],15:[2,22],16:[2,22],19:[2,22],20:[2,22],22:[2,22],23:[2,22],25:[2,22]},{5:[2,19],14:[2,19],15:[2,19],16:[2,19],19:[2,19],20:[2,19],22:[2,19],23:[2,19],25:[2,19]},{36:[1,72]},{18:[2,48],24:[2,48],36:[2,48],40:[2,48]},{41:[1,71]},{21:56,30:60,31:73,32:[1,57],33:[1,58],34:[1,59],35:[1,61],40:[1,28],42:[1,27],43:26},{18:[2,31],24:[2,31],32:[2,31],33:[2,31],34:[2,31],35:[2,31],36:[2,31],40:[2,31],42:[2,31]},{18:[2,33],24:[2,33],36:[2,33],40:[2,33]}],defaultActions:{3:[2,2],16:[2,1],50:[2,42]},parseError:function(str){throw new Error(str)},parse:function(input){function lex(){var token;return token=self.lexer.lex()||1,"number"!=typeof token&&(token=self.symbols_[token]||token),token}var self=this,stack=[0],vstack=[null],lstack=[],table=this.table,yytext="",yylineno=0,yyleng=0,recovering=0;this.lexer.setInput(input),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,this.yy.parser=this,"undefined"==typeof this.lexer.yylloc&&(this.lexer.yylloc={});var yyloc=this.lexer.yylloc;lstack.push(yyloc);var ranges=this.lexer.options&&this.lexer.options.ranges;"function"==typeof this.yy.parseError&&(this.parseError=this.yy.parseError);for(var symbol,preErrorSymbol,state,action,r,p,len,newState,expected,yyval={};;){if(state=stack[stack.length-1],this.defaultActions[state]?action=this.defaultActions[state]:((null===symbol||"undefined"==typeof symbol)&&(symbol=lex()),action=table[state]&&table[state][symbol]),"undefined"==typeof action||!action.length||!action[0]){var errStr="";if(!recovering){expected=[];for(p in table[state])this.terminals_[p]&&p>2&&expected.push("'"+this.terminals_[p]+"'");errStr=this.lexer.showPosition?"Parse error on line "+(yylineno+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+expected.join(", ")+", got '"+(this.terminals_[symbol]||symbol)+"'":"Parse error on line "+(yylineno+1)+": Unexpected "+(1==symbol?"end of input":"'"+(this.terminals_[symbol]||symbol)+"'"),this.parseError(errStr,{text:this.lexer.match,token:this.terminals_[symbol]||symbol,line:this.lexer.yylineno,loc:yyloc,expected:expected})}}if(action[0]instanceof Array&&action.length>1)throw new Error("Parse Error: multiple actions possible at state: "+state+", token: "+symbol);switch(action[0]){case 1:stack.push(symbol),vstack.push(this.lexer.yytext),lstack.push(this.lexer.yylloc),stack.push(action[1]),symbol=null,preErrorSymbol?(symbol=preErrorSymbol,preErrorSymbol=null):(yyleng=this.lexer.yyleng,yytext=this.lexer.yytext,yylineno=this.lexer.yylineno,yyloc=this.lexer.yylloc,recovering>0&&recovering--);break;case 2:if(len=this.productions_[action[1]][1],yyval.$=vstack[vstack.length-len],yyval._$={first_line:lstack[lstack.length-(len||1)].first_line,last_line:lstack[lstack.length-1].last_line,first_column:lstack[lstack.length-(len||1)].first_column,last_column:lstack[lstack.length-1].last_column},ranges&&(yyval._$.range=[lstack[lstack.length-(len||1)].range[0],lstack[lstack.length-1].range[1]]),r=this.performAction.call(yyval,yytext,yyleng,yylineno,this.yy,action[1],vstack,lstack),"undefined"!=typeof r)return r;len&&(stack=stack.slice(0,-1*len*2),vstack=vstack.slice(0,-1*len),lstack=lstack.slice(0,-1*len)),stack.push(this.productions_[action[1]][0]),vstack.push(yyval.$),lstack.push(yyval._$),newState=table[stack[stack.length-2]][stack[stack.length-1]],stack.push(newState);break;case 3:return!0}}return!0}},lexer=function(){var lexer={EOF:1,parseError:function(str,hash){if(!this.yy.parser)throw new Error(str);this.yy.parser.parseError(str,hash)},setInput:function(input){return this._input=input,this._more=this._less=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var ch=this._input[0];this.yytext+=ch,this.yyleng++,this.offset++,this.match+=ch,this.matched+=ch;var lines=ch.match(/(?:\r\n?|\n).*/g);return lines?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),ch},unput:function(ch){var len=ch.length,lines=ch.split(/(?:\r\n?|\n)/g);this._input=ch+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-len-1),this.offset-=len;var oldLines=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),lines.length-1&&(this.yylineno-=lines.length-1);var r=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:lines?(lines.length===oldLines.length?this.yylloc.first_column:0)+oldLines[oldLines.length-lines.length].length-lines[0].length:this.yylloc.first_column-len},this.options.ranges&&(this.yylloc.range=[r[0],r[0]+this.yyleng-len]),this},more:function(){return this._more=!0,this},less:function(n){this.unput(this.match.slice(n))},pastInput:function(){var past=this.matched.substr(0,this.matched.length-this.match.length);return(past.length>20?"...":"")+past.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var next=this.match;return next.length<20&&(next+=this._input.substr(0,20-next.length)),(next.substr(0,20)+(next.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var pre=this.pastInput(),c=new Array(pre.length+1).join("-");return pre+this.upcomingInput()+"\n"+c+"^"},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var token,match,tempMatch,index,lines;this._more||(this.yytext="",this.match="");for(var rules=this._currentRules(),i=0;i<rules.length&&(tempMatch=this._input.match(this.rules[rules[i]]),!tempMatch||match&&!(tempMatch[0].length>match[0].length)||(match=tempMatch,index=i,this.options.flex));i++);return match?(lines=match[0].match(/(?:\r\n?|\n).*/g),lines&&(this.yylineno+=lines.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:lines?lines[lines.length-1].length-lines[lines.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+match[0].length},this.yytext+=match[0],this.match+=match[0],this.matches=match,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._input=this._input.slice(match[0].length),this.matched+=match[0],token=this.performAction.call(this,this.yy,this,rules[index],this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),token?token:void 0):""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var r=this.next();return"undefined"!=typeof r?r:this.lex()},begin:function(condition){this.conditionStack.push(condition)},popState:function(){return this.conditionStack.pop()},_currentRules:function(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules},topState:function(){return this.conditionStack[this.conditionStack.length-2]},pushState:function(condition){this.begin(condition)}};return lexer.options={},lexer.performAction=function(yy,yy_,$avoiding_name_collisions,YY_START){function strip(start,end){return yy_.yytext=yy_.yytext.substr(start,yy_.yyleng-end)}switch($avoiding_name_collisions){case 0:if("\\\\"===yy_.yytext.slice(-2)?(strip(0,1),this.begin("mu")):"\\"===yy_.yytext.slice(-1)?(strip(0,1),this.begin("emu")):this.begin("mu"),yy_.yytext)return 14;break;case 1:return 14;case 2:return this.popState(),14;case 3:return strip(0,4),this.popState(),15;case 4:return 35;case 5:return 36;case 6:return 25;case 7:return 16;case 8:return 20;case 9:return 19;case 10:return 19;case 11:return 23;case 12:return 22;case 13:this.popState(),this.begin("com");break;case 14:return strip(3,5),this.popState(),15;case 15:return 22;case 16:return 41;case 17:return 40;case 18:return 40;case 19:return 44;case 20:break;case 21:return this.popState(),24;case 22:return this.popState(),18;case 23:return yy_.yytext=strip(1,2).replace(/\\"/g,'"'),32;case 24:return yy_.yytext=strip(1,2).replace(/\\'/g,"'"),32;case 25:return 42;case 26:return 34;case 27:return 34;case 28:return 33;case 29:return 40;case 30:return yy_.yytext=strip(1,2),40;case 31:return"INVALID";case 32:return 5}},lexer.rules=[/^(?:[^\x00]*?(?=(\{\{)))/,/^(?:[^\x00]+)/,/^(?:[^\x00]{2,}?(?=(\{\{|\\\{\{|\\\\\{\{|$)))/,/^(?:[\s\S]*?--\}\})/,/^(?:\()/,/^(?:\))/,/^(?:\{\{(~)?>)/,/^(?:\{\{(~)?#)/,/^(?:\{\{(~)?\/)/,/^(?:\{\{(~)?\^)/,/^(?:\{\{(~)?\s*else\b)/,/^(?:\{\{(~)?\{)/,/^(?:\{\{(~)?&)/,/^(?:\{\{!--)/,/^(?:\{\{![\s\S]*?\}\})/,/^(?:\{\{(~)?)/,/^(?:=)/,/^(?:\.\.)/,/^(?:\.(?=([=~}\s\/.)])))/,/^(?:[\/.])/,/^(?:\s+)/,/^(?:\}(~)?\}\})/,/^(?:(~)?\}\})/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:@)/,/^(?:true(?=([~}\s)])))/,/^(?:false(?=([~}\s)])))/,/^(?:-?[0-9]+(?=([~}\s)])))/,/^(?:([^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=([=~}\s\/.)]))))/,/^(?:\[[^\]]*\])/,/^(?:.)/,/^(?:$)/],lexer.conditions={mu:{rules:[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32],inclusive:!1},emu:{rules:[2],inclusive:!1},com:{rules:[3],inclusive:!1},INITIAL:{rules:[0,1,32],inclusive:!0}},lexer}();return parser.lexer=lexer,Parser.prototype=parser,parser.Parser=Parser,new Parser}();return __exports__=handlebars}(),__module8__=function(__dependency1__,__dependency2__){function parse(input){return input.constructor===AST.ProgramNode?input:(parser.yy=AST,parser.parse(input))}var __exports__={},parser=__dependency1__,AST=__dependency2__;return __exports__.parser=parser,__exports__.parse=parse,__exports__}(__module9__,__module7__),__module10__=function(__dependency1__){function Compiler(){}function precompile(input,options,env){if(null==input||"string"!=typeof input&&input.constructor!==env.AST.ProgramNode)throw new Exception("You must pass a string or Handlebars AST to Handlebars.precompile. You passed "+input);options=options||{},"data"in options||(options.data=!0);var ast=env.parse(input),environment=(new env.Compiler).compile(ast,options);return(new env.JavaScriptCompiler).compile(environment,options)}function compile(input,options,env){function compileInput(){var ast=env.parse(input),environment=(new env.Compiler).compile(ast,options),templateSpec=(new env.JavaScriptCompiler).compile(environment,options,void 0,!0);return env.template(templateSpec)}if(null==input||"string"!=typeof input&&input.constructor!==env.AST.ProgramNode)throw new Exception("You must pass a string or Handlebars AST to Handlebars.compile. You passed "+input);options=options||{},"data"in options||(options.data=!0);var compiled;return function(context,options){return compiled||(compiled=compileInput()),compiled.call(this,context,options)}}var __exports__={},Exception=__dependency1__;return __exports__.Compiler=Compiler,Compiler.prototype={compiler:Compiler,disassemble:function(){for(var opcode,params,param,opcodes=this.opcodes,out=[],i=0,l=opcodes.length;l>i;i++)if(opcode=opcodes[i],"DECLARE"===opcode.opcode)out.push("DECLARE "+opcode.name+"="+opcode.value);else{params=[];for(var j=0;j<opcode.args.length;j++)param=opcode.args[j],"string"==typeof param&&(param='"'+param.replace("\n","\\n")+'"'),params.push(param);out.push(opcode.opcode+" "+params.join(" "))}return out.join("\n")},equals:function(other){var len=this.opcodes.length;if(other.opcodes.length!==len)return!1;for(var i=0;len>i;i++){var opcode=this.opcodes[i],otherOpcode=other.opcodes[i];if(opcode.opcode!==otherOpcode.opcode||opcode.args.length!==otherOpcode.args.length)return!1;for(var j=0;j<opcode.args.length;j++)if(opcode.args[j]!==otherOpcode.args[j])return!1}if(len=this.children.length,other.children.length!==len)return!1;for(i=0;len>i;i++)if(!this.children[i].equals(other.children[i]))return!1;return!0},guid:0,compile:function(program,options){this.opcodes=[],this.children=[],this.depths={list:[]},this.options=options;var knownHelpers=this.options.knownHelpers;if(this.options.knownHelpers={helperMissing:!0,blockHelperMissing:!0,each:!0,"if":!0,unless:!0,"with":!0,log:!0},knownHelpers)for(var name in knownHelpers)this.options.knownHelpers[name]=knownHelpers[name];return this.accept(program)},accept:function(node){var ret,strip=node.strip||{};return strip.left&&this.opcode("strip"),ret=this[node.type](node),strip.right&&this.opcode("strip"),ret},program:function(program){for(var statements=program.statements,i=0,l=statements.length;l>i;i++)this.accept(statements[i]);return this.isSimple=1===l,this.depths.list=this.depths.list.sort(function(a,b){return a-b}),this},compileProgram:function(program){var depth,result=(new this.compiler).compile(program,this.options),guid=this.guid++;this.usePartial=this.usePartial||result.usePartial,this.children[guid]=result;for(var i=0,l=result.depths.list.length;l>i;i++)depth=result.depths.list[i],2>depth||this.addDepth(depth-1);return guid},block:function(block){var mustache=block.mustache,program=block.program,inverse=block.inverse;program&&(program=this.compileProgram(program)),inverse&&(inverse=this.compileProgram(inverse));var sexpr=mustache.sexpr,type=this.classifySexpr(sexpr);"helper"===type?this.helperSexpr(sexpr,program,inverse):"simple"===type?(this.simpleSexpr(sexpr),this.opcode("pushProgram",program),this.opcode("pushProgram",inverse),this.opcode("emptyHash"),this.opcode("blockValue")):(this.ambiguousSexpr(sexpr,program,inverse),this.opcode("pushProgram",program),this.opcode("pushProgram",inverse),this.opcode("emptyHash"),this.opcode("ambiguousBlockValue")),this.opcode("append")},hash:function(hash){var pair,val,pairs=hash.pairs;this.opcode("pushHash");for(var i=0,l=pairs.length;l>i;i++)pair=pairs[i],val=pair[1],this.options.stringParams?(val.depth&&this.addDepth(val.depth),this.opcode("getContext",val.depth||0),this.opcode("pushStringParam",val.stringModeValue,val.type),"sexpr"===val.type&&this.sexpr(val)):this.accept(val),this.opcode("assignToHash",pair[0]);this.opcode("popHash")},partial:function(partial){var partialName=partial.partialName;this.usePartial=!0,partial.context?this.ID(partial.context):this.opcode("push","depth0"),this.opcode("invokePartial",partialName.name),this.opcode("append")},content:function(content){this.opcode("appendContent",content.string)},mustache:function(mustache){this.sexpr(mustache.sexpr),this.opcode(mustache.escaped&&!this.options.noEscape?"appendEscaped":"append")},ambiguousSexpr:function(sexpr,program,inverse){var id=sexpr.id,name=id.parts[0],isBlock=null!=program||null!=inverse;this.opcode("getContext",id.depth),this.opcode("pushProgram",program),this.opcode("pushProgram",inverse),this.opcode("invokeAmbiguous",name,isBlock)},simpleSexpr:function(sexpr){var id=sexpr.id;"DATA"===id.type?this.DATA(id):id.parts.length?this.ID(id):(this.addDepth(id.depth),this.opcode("getContext",id.depth),this.opcode("pushContext")),this.opcode("resolvePossibleLambda")},helperSexpr:function(sexpr,program,inverse){var params=this.setupFullMustacheParams(sexpr,program,inverse),name=sexpr.id.parts[0];if(this.options.knownHelpers[name])this.opcode("invokeKnownHelper",params.length,name);else{if(this.options.knownHelpersOnly)throw new Exception("You specified knownHelpersOnly, but used the unknown helper "+name,sexpr);this.opcode("invokeHelper",params.length,name,sexpr.isRoot)}},sexpr:function(sexpr){var type=this.classifySexpr(sexpr);"simple"===type?this.simpleSexpr(sexpr):"helper"===type?this.helperSexpr(sexpr):this.ambiguousSexpr(sexpr)},ID:function(id){this.addDepth(id.depth),this.opcode("getContext",id.depth);var name=id.parts[0];name?this.opcode("lookupOnContext",id.parts[0]):this.opcode("pushContext");for(var i=1,l=id.parts.length;l>i;i++)this.opcode("lookup",id.parts[i])},DATA:function(data){if(this.options.data=!0,data.id.isScoped||data.id.depth)throw new Exception("Scoped data references are not supported: "+data.original,data);this.opcode("lookupData");for(var parts=data.id.parts,i=0,l=parts.length;l>i;i++)this.opcode("lookup",parts[i])},STRING:function(string){this.opcode("pushString",string.string)},INTEGER:function(integer){this.opcode("pushLiteral",integer.integer)},BOOLEAN:function(bool){this.opcode("pushLiteral",bool.bool)},comment:function(){},opcode:function(name){this.opcodes.push({opcode:name,args:[].slice.call(arguments,1)})},declare:function(name,value){this.opcodes.push({opcode:"DECLARE",name:name,value:value})},addDepth:function(depth){0!==depth&&(this.depths[depth]||(this.depths[depth]=!0,this.depths.list.push(depth)))},classifySexpr:function(sexpr){var isHelper=sexpr.isHelper,isEligible=sexpr.eligibleHelper,options=this.options;if(isEligible&&!isHelper){var name=sexpr.id.parts[0];options.knownHelpers[name]?isHelper=!0:options.knownHelpersOnly&&(isEligible=!1)}return isHelper?"helper":isEligible?"ambiguous":"simple"},pushParams:function(params){for(var param,i=params.length;i--;)param=params[i],this.options.stringParams?(param.depth&&this.addDepth(param.depth),this.opcode("getContext",param.depth||0),this.opcode("pushStringParam",param.stringModeValue,param.type),"sexpr"===param.type&&this.sexpr(param)):this[param.type](param)},setupFullMustacheParams:function(sexpr,program,inverse){var params=sexpr.params;return this.pushParams(params),this.opcode("pushProgram",program),this.opcode("pushProgram",inverse),sexpr.hash?this.hash(sexpr.hash):this.opcode("emptyHash"),params}},__exports__.precompile=precompile,__exports__.compile=compile,__exports__}(__module5__),__module11__=function(__dependency1__,__dependency2__){function Literal(value){this.value=value}function JavaScriptCompiler(){}var __exports__,COMPILER_REVISION=__dependency1__.COMPILER_REVISION,REVISION_CHANGES=__dependency1__.REVISION_CHANGES,log=__dependency1__.log,Exception=__dependency2__;JavaScriptCompiler.prototype={nameLookup:function(parent,name){var wrap,ret;return 0===parent.indexOf("depth")&&(wrap=!0),ret=/^[0-9]+$/.test(name)?parent+"["+name+"]":JavaScriptCompiler.isValidJavaScriptVariableName(name)?parent+"."+name:parent+"['"+name+"']",wrap?"("+parent+" && "+ret+")":ret},compilerInfo:function(){var revision=COMPILER_REVISION,versions=REVISION_CHANGES[revision];return"this.compilerInfo = ["+revision+",'"+versions+"'];\n"},appendToBuffer:function(string){return this.environment.isSimple?"return "+string+";":{appendToBuffer:!0,content:string,toString:function(){return"buffer += "+string+";"}}},initializeBuffer:function(){return this.quotedString("")},namespace:"Handlebars",compile:function(environment,options,context,asObject){this.environment=environment,this.options=options||{},log("debug",this.environment.disassemble()+"\n\n"),this.name=this.environment.name,this.isChild=!!context,this.context=context||{programs:[],environments:[],aliases:{}},this.preamble(),this.stackSlot=0,this.stackVars=[],this.registers={list:[]},this.hashes=[],this.compileStack=[],this.inlineStack=[],this.compileChildren(environment,options);var opcode,opcodes=environment.opcodes;this.i=0;for(var l=opcodes.length;this.i<l;this.i++)opcode=opcodes[this.i],"DECLARE"===opcode.opcode?this[opcode.name]=opcode.value:this[opcode.opcode].apply(this,opcode.args),opcode.opcode!==this.stripNext&&(this.stripNext=!1);if(this.pushSource(""),this.stackSlot||this.inlineStack.length||this.compileStack.length)throw new Exception("Compile completed with content left on stack");return this.createFunctionContext(asObject)},preamble:function(){var out=[];if(this.isChild)out.push("");else{var namespace=this.namespace,copies="helpers = this.merge(helpers, "+namespace+".helpers);";this.environment.usePartial&&(copies=copies+" partials = this.merge(partials, "+namespace+".partials);"),this.options.data&&(copies+=" data = data || {};"),out.push(copies)}out.push(this.environment.isSimple?"":", buffer = "+this.initializeBuffer()),this.lastContext=0,this.source=out},createFunctionContext:function(asObject){var locals=this.stackVars.concat(this.registers.list);if(locals.length>0&&(this.source[1]=this.source[1]+", "+locals.join(", ")),!this.isChild)for(var alias in this.context.aliases)this.context.aliases.hasOwnProperty(alias)&&(this.source[1]=this.source[1]+", "+alias+"="+this.context.aliases[alias]);this.source[1]&&(this.source[1]="var "+this.source[1].substring(2)+";"),this.isChild||(this.source[1]+="\n"+this.context.programs.join("\n")+"\n"),this.environment.isSimple||this.pushSource("return buffer;");for(var params=this.isChild?["depth0","data"]:["Handlebars","depth0","helpers","partials","data"],i=0,l=this.environment.depths.list.length;l>i;i++)params.push("depth"+this.environment.depths.list[i]);var source=this.mergeSource();if(this.isChild||(source=this.compilerInfo()+source),asObject)return params.push(source),Function.apply(this,params);var functionSource="function "+(this.name||"")+"("+params.join(",")+") {\n  "+source+"}";return log("debug",functionSource+"\n\n"),functionSource},mergeSource:function(){for(var buffer,source="",i=0,len=this.source.length;len>i;i++){var line=this.source[i];line.appendToBuffer?buffer=buffer?buffer+"\n    + "+line.content:line.content:(buffer&&(source+="buffer += "+buffer+";\n  ",buffer=void 0),source+=line+"\n  ")}return source},blockValue:function(){this.context.aliases.blockHelperMissing="helpers.blockHelperMissing";var params=["depth0"];this.setupParams(0,params),this.replaceStack(function(current){return params.splice(1,0,current),"blockHelperMissing.call("+params.join(", ")+")"})},ambiguousBlockValue:function(){this.context.aliases.blockHelperMissing="helpers.blockHelperMissing";var params=["depth0"];this.setupParams(0,params);var current=this.topStack();params.splice(1,0,current),this.pushSource("if (!"+this.lastHelper+") { "+current+" = blockHelperMissing.call("+params.join(", ")+"); }")},appendContent:function(content){this.pendingContent&&(content=this.pendingContent+content),this.stripNext&&(content=content.replace(/^\s+/,"")),this.pendingContent=content},strip:function(){this.pendingContent&&(this.pendingContent=this.pendingContent.replace(/\s+$/,"")),this.stripNext="strip"},append:function(){this.flushInline();var local=this.popStack();this.pushSource("if("+local+" || "+local+" === 0) { "+this.appendToBuffer(local)+" }"),this.environment.isSimple&&this.pushSource("else { "+this.appendToBuffer("''")+" }")},appendEscaped:function(){this.context.aliases.escapeExpression="this.escapeExpression",this.pushSource(this.appendToBuffer("escapeExpression("+this.popStack()+")"))},getContext:function(depth){this.lastContext!==depth&&(this.lastContext=depth)},lookupOnContext:function(name){this.push(this.nameLookup("depth"+this.lastContext,name,"context"))},pushContext:function(){this.pushStackLiteral("depth"+this.lastContext)},resolvePossibleLambda:function(){this.context.aliases.functionType='"function"',this.replaceStack(function(current){return"typeof "+current+" === functionType ? "+current+".apply(depth0) : "+current})},lookup:function(name){this.replaceStack(function(current){return current+" == null || "+current+" === false ? "+current+" : "+this.nameLookup(current,name,"context")})},lookupData:function(){this.pushStackLiteral("data")},pushStringParam:function(string,type){this.pushStackLiteral("depth"+this.lastContext),this.pushString(type),"sexpr"!==type&&("string"==typeof string?this.pushString(string):this.pushStackLiteral(string))},emptyHash:function(){this.pushStackLiteral("{}"),this.options.stringParams&&(this.push("{}"),this.push("{}"))},pushHash:function(){this.hash&&this.hashes.push(this.hash),this.hash={values:[],types:[],contexts:[]}},popHash:function(){var hash=this.hash;this.hash=this.hashes.pop(),this.options.stringParams&&(this.push("{"+hash.contexts.join(",")+"}"),this.push("{"+hash.types.join(",")+"}")),this.push("{\n    "+hash.values.join(",\n    ")+"\n  }")},pushString:function(string){this.pushStackLiteral(this.quotedString(string))},push:function(expr){return this.inlineStack.push(expr),expr},pushLiteral:function(value){this.pushStackLiteral(value)},pushProgram:function(guid){this.pushStackLiteral(null!=guid?this.programExpression(guid):null)},invokeHelper:function(paramSize,name,isRoot){this.context.aliases.helperMissing="helpers.helperMissing",this.useRegister("helper");var helper=this.lastHelper=this.setupHelper(paramSize,name,!0),nonHelper=this.nameLookup("depth"+this.lastContext,name,"context"),lookup="helper = "+helper.name+" || "+nonHelper;helper.paramsInit&&(lookup+=","+helper.paramsInit),this.push("("+lookup+",helper ? helper.call("+helper.callParams+") : helperMissing.call("+helper.helperMissingParams+"))"),isRoot||this.flushInline()},invokeKnownHelper:function(paramSize,name){var helper=this.setupHelper(paramSize,name);this.push(helper.name+".call("+helper.callParams+")")},invokeAmbiguous:function(name,helperCall){this.context.aliases.functionType='"function"',this.useRegister("helper"),this.emptyHash();var helper=this.setupHelper(0,name,helperCall),helperName=this.lastHelper=this.nameLookup("helpers",name,"helper"),nonHelper=this.nameLookup("depth"+this.lastContext,name,"context"),nextStack=this.nextStack();helper.paramsInit&&this.pushSource(helper.paramsInit),this.pushSource("if (helper = "+helperName+") { "+nextStack+" = helper.call("+helper.callParams+"); }"),this.pushSource("else { helper = "+nonHelper+"; "+nextStack+" = typeof helper === functionType ? helper.call("+helper.callParams+") : helper; }")
},invokePartial:function(name){var params=[this.nameLookup("partials",name,"partial"),"'"+name+"'",this.popStack(),"helpers","partials"];this.options.data&&params.push("data"),this.context.aliases.self="this",this.push("self.invokePartial("+params.join(", ")+")")},assignToHash:function(key){var context,type,value=this.popStack();this.options.stringParams&&(type=this.popStack(),context=this.popStack());var hash=this.hash;context&&hash.contexts.push("'"+key+"': "+context),type&&hash.types.push("'"+key+"': "+type),hash.values.push("'"+key+"': ("+value+")")},compiler:JavaScriptCompiler,compileChildren:function(environment,options){for(var child,compiler,children=environment.children,i=0,l=children.length;l>i;i++){child=children[i],compiler=new this.compiler;var index=this.matchExistingProgram(child);null==index?(this.context.programs.push(""),index=this.context.programs.length,child.index=index,child.name="program"+index,this.context.programs[index]=compiler.compile(child,options,this.context),this.context.environments[index]=child):(child.index=index,child.name="program"+index)}},matchExistingProgram:function(child){for(var i=0,len=this.context.environments.length;len>i;i++){var environment=this.context.environments[i];if(environment&&environment.equals(child))return i}},programExpression:function(guid){if(this.context.aliases.self="this",null==guid)return"self.noop";for(var depth,child=this.environment.children[guid],depths=child.depths.list,programParams=[child.index,child.name,"data"],i=0,l=depths.length;l>i;i++)depth=depths[i],programParams.push(1===depth?"depth0":"depth"+(depth-1));return(0===depths.length?"self.program(":"self.programWithDepth(")+programParams.join(", ")+")"},register:function(name,val){this.useRegister(name),this.pushSource(name+" = "+val+";")},useRegister:function(name){this.registers[name]||(this.registers[name]=!0,this.registers.list.push(name))},pushStackLiteral:function(item){return this.push(new Literal(item))},pushSource:function(source){this.pendingContent&&(this.source.push(this.appendToBuffer(this.quotedString(this.pendingContent))),this.pendingContent=void 0),source&&this.source.push(source)},pushStack:function(item){this.flushInline();var stack=this.incrStack();return item&&this.pushSource(stack+" = "+item+";"),this.compileStack.push(stack),stack},replaceStack:function(callback){var stack,createdStack,usedLiteral,prefix="",inline=this.isInline();if(inline){var top=this.popStack(!0);if(top instanceof Literal)stack=top.value,usedLiteral=!0;else{createdStack=!this.stackSlot;var name=createdStack?this.incrStack():this.topStackName();prefix="("+this.push(name)+" = "+top+"),",stack=this.topStack()}}else stack=this.topStack();var item=callback.call(this,stack);return inline?(usedLiteral||this.popStack(),createdStack&&this.stackSlot--,this.push("("+prefix+item+")")):(/^stack/.test(stack)||(stack=this.nextStack()),this.pushSource(stack+" = ("+prefix+item+");")),stack},nextStack:function(){return this.pushStack()},incrStack:function(){return this.stackSlot++,this.stackSlot>this.stackVars.length&&this.stackVars.push("stack"+this.stackSlot),this.topStackName()},topStackName:function(){return"stack"+this.stackSlot},flushInline:function(){var inlineStack=this.inlineStack;if(inlineStack.length){this.inlineStack=[];for(var i=0,len=inlineStack.length;len>i;i++){var entry=inlineStack[i];entry instanceof Literal?this.compileStack.push(entry):this.pushStack(entry)}}},isInline:function(){return this.inlineStack.length},popStack:function(wrapped){var inline=this.isInline(),item=(inline?this.inlineStack:this.compileStack).pop();if(!wrapped&&item instanceof Literal)return item.value;if(!inline){if(!this.stackSlot)throw new Exception("Invalid stack pop");this.stackSlot--}return item},topStack:function(wrapped){var stack=this.isInline()?this.inlineStack:this.compileStack,item=stack[stack.length-1];return!wrapped&&item instanceof Literal?item.value:item},quotedString:function(str){return'"'+str.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")+'"'},setupHelper:function(paramSize,name,missingParams){var params=[],paramsInit=this.setupParams(paramSize,params,missingParams),foundHelper=this.nameLookup("helpers",name,"helper");return{params:params,paramsInit:paramsInit,name:foundHelper,callParams:["depth0"].concat(params).join(", "),helperMissingParams:missingParams&&["depth0",this.quotedString(name)].concat(params).join(", ")}},setupOptions:function(paramSize,params){var param,inverse,program,options=[],contexts=[],types=[];options.push("hash:"+this.popStack()),this.options.stringParams&&(options.push("hashTypes:"+this.popStack()),options.push("hashContexts:"+this.popStack())),inverse=this.popStack(),program=this.popStack(),(program||inverse)&&(program||(this.context.aliases.self="this",program="self.noop"),inverse||(this.context.aliases.self="this",inverse="self.noop"),options.push("inverse:"+inverse),options.push("fn:"+program));for(var i=0;paramSize>i;i++)param=this.popStack(),params.push(param),this.options.stringParams&&(types.push(this.popStack()),contexts.push(this.popStack()));return this.options.stringParams&&(options.push("contexts:["+contexts.join(",")+"]"),options.push("types:["+types.join(",")+"]")),this.options.data&&options.push("data:data"),options},setupParams:function(paramSize,params,useRegister){var options="{"+this.setupOptions(paramSize,params).join(",")+"}";return useRegister?(this.useRegister("options"),params.push("options"),"options="+options):(params.push(options),"")}};for(var reservedWords="break else new var case finally return void catch for switch while continue function this with default if throw delete in try do instanceof typeof abstract enum int short boolean export interface static byte extends long super char final native synchronized class float package throws const goto private transient debugger implements protected volatile double import public let yield".split(" "),compilerWords=JavaScriptCompiler.RESERVED_WORDS={},i=0,l=reservedWords.length;l>i;i++)compilerWords[reservedWords[i]]=!0;return JavaScriptCompiler.isValidJavaScriptVariableName=function(name){return!JavaScriptCompiler.RESERVED_WORDS[name]&&/^[a-zA-Z_$][0-9a-zA-Z_$]*$/.test(name)?!0:!1},__exports__=JavaScriptCompiler}(__module2__,__module5__),__module0__=function(__dependency1__,__dependency2__,__dependency3__,__dependency4__,__dependency5__){var __exports__,Handlebars=__dependency1__,AST=__dependency2__,Parser=__dependency3__.parser,parse=__dependency3__.parse,Compiler=__dependency4__.Compiler,compile=__dependency4__.compile,precompile=__dependency4__.precompile,JavaScriptCompiler=__dependency5__,_create=Handlebars.create,create=function(){var hb=_create();return hb.compile=function(input,options){return compile(input,options,hb)},hb.precompile=function(input,options){return precompile(input,options,hb)},hb.AST=AST,hb.Compiler=Compiler,hb.JavaScriptCompiler=JavaScriptCompiler,hb.Parser=Parser,hb.parse=parse,hb};return Handlebars=create(),Handlebars.create=create,__exports__=Handlebars}(__module1__,__module7__,__module8__,__module10__,__module11__);return __module0__}();define("handlebars",function(global){return function(){var ret;return ret||global.Handlebars}}(this)),define("handlebars.partials",["handlebars"],function(Handlebars){Handlebars.registerPartial("activityFooterDefaultActions",Handlebars.template(function(Handlebars,depth0,helpers,partials,data){function program1(depth0,data){var buffer="";return buffer+="\n            "+escapeExpression(helpers.gettext.call(depth0,"1 Comment",{hash:{},data:data}))+"\n        "}function program3(depth0,data){var stack1,buffer="";return buffer+="\n            "+escapeExpression(helpers.gettext.call(depth0,"%(posts)s Comments",{hash:{posts:(stack1=depth0&&depth0.thread,null==stack1||stack1===!1?stack1:stack1.posts)},data:data}))+"\n        "}function program5(depth0,data){var stack1,buffer="";return buffer+='\n    <li class="action">\n        <a class="action-favorite',stack1=helpers["if"].call(depth0,depth0&&depth0.favorited,{hash:{},inverse:self.noop,fn:self.program(6,program6,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+='" href="#" data-action="favorite">\n            Favorite<span class="active-text">d</span> <span class="icon icon-star"></span>\n        </a>\n    </li>\n'}function program6(){return" active"}this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var stack1,helper,options,buffer="",escapeExpression=this.escapeExpression,self=this,functionType="function",helperMissing=helpers.helperMissing;return buffer+='<li class="action">\n    <a class="action-comments" href="/home/',(helper=helpers.discussionRoute)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.discussionRoute,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'">\n        ',helper=helpers.eq||depth0&&depth0.eq,options={hash:{},data:data},stack1=helper?helper.call(depth0,(stack1=depth0&&depth0.thread,null==stack1||stack1===!1?stack1:stack1.posts),1,options):helperMissing.call(depth0,"eq",(stack1=depth0&&depth0.thread,null==stack1||stack1===!1?stack1:stack1.posts),1,options),stack1=helpers["if"].call(depth0,stack1,{hash:{},inverse:self.program(3,program3,data),fn:self.program(1,program1,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+='\n        <span class="icon icon-comment"></span>\n    </a>\n</li>\n',stack1=helpers["if"].call(depth0,depth0&&depth0.authenticated,{hash:{},inverse:self.noop,fn:self.program(5,program5,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n"})),Handlebars.registerPartial("cardTitle",Handlebars.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),partials=this.merge(partials,Handlebars.partials),data=data||{};var stack1,buffer="",functionType="function",escapeExpression=this.escapeExpression,self=this;return buffer+='<div class="card-title">\n    <h2 class="discussion-title">\n        <a href="'+escapeExpression((stack1=depth0&&depth0.thread,stack1=null==stack1||stack1===!1?stack1:stack1.link,typeof stack1===functionType?stack1.apply(depth0):stack1))+'" class="link-gray-darker" target="_blank" data-role="thread-link">',stack1=depth0&&depth0.thread,stack1=null==stack1||stack1===!1?stack1:stack1.clean_title,stack1=typeof stack1===functionType?stack1.apply(depth0):stack1,(stack1||0===stack1)&&(buffer+=stack1),buffer+='</a>\n    </h2>\n    on\n    <a href="/home/'+escapeExpression((stack1=depth0&&depth0.thread,stack1=null==stack1||stack1===!1?stack1:stack1.forum,stack1=null==stack1||stack1===!1?stack1:stack1.forumRoute,typeof stack1===functionType?stack1.apply(depth0):stack1))+'" class="link-gray-darker discussion-community">\n    ',stack1=self.invokePartial(partials.forumName,"forumName",(stack1=depth0&&depth0.thread,null==stack1||stack1===!1?stack1:stack1.forum),helpers,partials,data),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n    </a>\n</div>\n"})),Handlebars.registerPartial("cards",Handlebars.template(function(Handlebars,depth0,helpers,partials,data){return this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{},"cards here\n"})),Handlebars.registerPartial("channelAvatar",Handlebars.template(function(Handlebars,depth0,helpers,partials,data){function program1(depth0,data){var stack1,helper,buffer="";return buffer+='\n        <img class="favicon" src="'+escapeExpression((stack1=depth0&&depth0.options,stack1=null==stack1||stack1===!1?stack1:stack1.favicon,typeof stack1===functionType?stack1.apply(depth0):stack1))+'" alt="',(helper=helpers.name)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.name,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'"/>\n    '}this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var stack1,helper,buffer="",functionType="function",escapeExpression=this.escapeExpression,self=this;return buffer+='<a class="discussion-origin-name" href="/home/channel/',(helper=helpers.slug)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.slug,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'">\n    ',stack1=helpers["if"].call(depth0,(stack1=depth0&&depth0.options,null==stack1||stack1===!1?stack1:stack1.favicon),{hash:{},inverse:self.noop,fn:self.program(1,program1,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n</a>\n"})),Handlebars.registerPartial("channelLink",Handlebars.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),partials=this.merge(partials,Handlebars.partials),data=data||{};var stack1,helper,buffer="",functionType="function",escapeExpression=this.escapeExpression,self=this;return buffer+='<a href="/home/channel/',(helper=helpers.slug)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.slug,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'">\n    ',stack1=self.invokePartial(partials.forumName,"forumName",depth0,helpers,partials,data),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n</a>\n"})),Handlebars.registerPartial("defaultForumAvatar",Handlebars.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var stack1,helper,buffer="",functionType="function",escapeExpression=this.escapeExpression;return buffer+='<a href="/home/forums/',(helper=helpers.id)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.id,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'" class="avatar">\n    <svg class="art-forum-blank" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 50 50" enable-background="new 0 0 50 50" xml:space="preserve"><path d="M22.9 38c5.9 0 10.6-4.9 10.6-11s-4.8-11-10.6-11 s-10.6 4.9-10.6 11c0 1.6 0.3 3.2 1 4.6L11.5 36l4.5-0.6C17.9 37 20.3 38 22.9 38z" class="style0"/><path d="M31.2 29c-4.8 0-8.7-4-8.7-9s3.9-9 8.7-9s8.7 4 8.7 9 c0 1.3-0.3 2.6-0.8 3.7l1.4 3.7l-3.7-0.5C35.3 28.2 33.3 29 31.2 29z" class="style1"/></svg>\n</a>\n'})),Handlebars.registerPartial("forumAvatar",Handlebars.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var stack1,helper,buffer="",functionType="function",escapeExpression=this.escapeExpression;return buffer+='<a href="/home/forums/',(helper=helpers.id)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.id,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'" class="avatar"><img class="forum-favicon" src="'+escapeExpression((stack1=depth0&&depth0.favicon,stack1=null==stack1||stack1===!1?stack1:stack1.cache,typeof stack1===functionType?stack1.apply(depth0):stack1))+'" alt="',(helper=helpers.name)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.name,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'"></a>\n'})),Handlebars.registerPartial("forumLink",Handlebars.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),partials=this.merge(partials,Handlebars.partials),data=data||{};var stack1,helper,buffer="",functionType="function",escapeExpression=this.escapeExpression,self=this;return buffer+='<a href="/home/forums/',(helper=helpers.id)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.id,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'">\n    ',stack1=self.invokePartial(partials.forumName,"forumName",depth0,helpers,partials,data),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n</a>\n"})),Handlebars.registerPartial("forumName",Handlebars.template(function(Handlebars,depth0,helpers,partials,data){function program1(depth0,data){var stack1,helper;return(helper=helpers.name)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.name,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),escapeExpression(stack1)}function program3(depth0,data){var stack1,helper;return(helper=helpers.id)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.id,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),escapeExpression(stack1)}this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var stack1,buffer="",functionType="function",escapeExpression=this.escapeExpression,self=this;return stack1=helpers["if"].call(depth0,depth0&&depth0.name,{hash:{},inverse:self.program(3,program3,data),fn:self.program(1,program1,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer})),Handlebars.registerPartial("forumPreview",Handlebars.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),partials=this.merge(partials,Handlebars.partials),data=data||{};var stack1,buffer="",self=this;return stack1=self.invokePartial(partials.forumAvatar,"forumAvatar",depth0,helpers,partials,data),(stack1||0===stack1)&&(buffer+=stack1),stack1=self.invokePartial(partials.forumName,"forumName",depth0,helpers,partials,data),(stack1||0===stack1)&&(buffer+=stack1),buffer})),Handlebars.registerPartial("navUserIcon",Handlebars.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var stack1,helper,buffer="",functionType="function",escapeExpression=this.escapeExpression;return buffer+='<a href="/home/user/',(helper=helpers.username)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.username,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'" class="nav-profile" data-page-icon="user/',(helper=helpers.username)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.username,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'">\n    <img src="'+escapeExpression((stack1=depth0&&depth0.avatar,stack1=null==stack1||stack1===!1?stack1:stack1.cache,typeof stack1===functionType?stack1.apply(depth0):stack1))+'" alt="',(helper=helpers.username)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.username,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'">\n</a>\n'})),Handlebars.registerPartial("profileCoverAttributes",Handlebars.template(function(Handlebars,depth0,helpers,partials,data){function program1(depth0,data){var stack1,helper,buffer="";return buffer+='\n        <li class="cover-attribute user-upvotes tooltipped"\n            data-toggle="tooltip" data-placement="bottom" title="Upvotes received">\n            ',(helper=helpers.numLikesReceived)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.numLikesReceived,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'\n            <span class="icon-arrow-2"></span>\n        </li>\n    '}function program3(depth0,data){var stack1,helper,buffer="";return buffer+='\n        <li class="cover-attribute bullet">\n            ',(helper=helpers.location)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.location,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"\n        </li>\n    "}function program5(depth0,data){var stack1,helper,buffer="";return buffer+='\n        <li class="cover-attribute bullet">\n            <a href="',(helper=helpers.url)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.url,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'" target="_blank">',(helper=helpers.url)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.url,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"</a>\n        </li>\n    "}function program7(depth0){var stack1,buffer="";return buffer+='\n        <li class="cover-attribute social">\n            <a href="'+escapeExpression((stack1=depth0&&depth0.connections,stack1=null==stack1||stack1===!1?stack1:stack1.facebook,stack1=null==stack1||stack1===!1?stack1:stack1.url,typeof stack1===functionType?stack1.apply(depth0):stack1))+'" target="_blank"><span class="icon-facebook-circle"></span></a>\n        </li>\n    '}function program9(depth0){var stack1,buffer="";return buffer+='\n        <li class="cover-attribute social">\n            <a href="'+escapeExpression((stack1=depth0&&depth0.connections,stack1=null==stack1||stack1===!1?stack1:stack1.twitter,stack1=null==stack1||stack1===!1?stack1:stack1.url,typeof stack1===functionType?stack1.apply(depth0):stack1))+'" target="_blank"><span class="icon-twitter-circle"></span></a>\n        </li>\n    '}function program11(depth0){var stack1,buffer="";return buffer+='\n        <li class="cover-attribute social">\n            <a href="'+escapeExpression((stack1=depth0&&depth0.connections,stack1=null==stack1||stack1===!1?stack1:stack1.gogle,stack1=null==stack1||stack1===!1?stack1:stack1.url,typeof stack1===functionType?stack1.apply(depth0):stack1))+'" target="_blank"><span class="icon-google-plus-circle"></span></a>\n        </li>\n    '}this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var stack1,buffer="",functionType="function",escapeExpression=this.escapeExpression,self=this;return buffer+='<ul class="cover-attributes">\n    ',stack1=helpers["if"].call(depth0,depth0&&depth0.numLikesReceived,{hash:{},inverse:self.noop,fn:self.program(1,program1,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n    ",stack1=helpers["if"].call(depth0,depth0&&depth0.location,{hash:{},inverse:self.noop,fn:self.program(3,program3,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n    ",stack1=helpers["if"].call(depth0,depth0&&depth0.url,{hash:{},inverse:self.noop,fn:self.program(5,program5,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n    ",stack1=helpers["if"].call(depth0,(stack1=depth0&&depth0.connections,stack1=null==stack1||stack1===!1?stack1:stack1.facebook,null==stack1||stack1===!1?stack1:stack1.url),{hash:{},inverse:self.noop,fn:self.program(7,program7,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n    ",stack1=helpers["if"].call(depth0,(stack1=depth0&&depth0.connections,stack1=null==stack1||stack1===!1?stack1:stack1.twitter,null==stack1||stack1===!1?stack1:stack1.url),{hash:{},inverse:self.noop,fn:self.program(9,program9,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n    ",stack1=helpers["if"].call(depth0,(stack1=depth0&&depth0.connections,stack1=null==stack1||stack1===!1?stack1:stack1.google,null==stack1||stack1===!1?stack1:stack1.url),{hash:{},inverse:self.noop,fn:self.program(11,program11,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n</ul>\n"})),Handlebars.registerPartial("settingsDropdown",Handlebars.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),partials=this.merge(partials,Handlebars.partials),data=data||{};var stack1,buffer="",self=this;return buffer+='<div class="nav-settings dropdown" data-action="toggle-dropdown" data-dropdown="settings">\n    <a data-toggle="dropdown" class="dropdown-toggle" href="#">\n        \n        <svg class="icon-settings" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="Layer_1" x="0px" y="0px" viewBox="0 0 40 40" enable-background="new 0 0 40 40" xml:space="preserve"><path fill-rule="evenodd" clip-rule="evenodd" d="M40 23.9v-7.7h-4.2c-0.4-1.6-1-3.1-1.9-4.6l3-3l-5.5-5.5l-3 3 c-1.4-0.9-2.9-1.5-4.6-1.9V0h-7.7v4.2c-1.6 0.4-3.2 1-4.6 1.9l-3-3L3.1 8.6l3 3c-0.8 1.4-1.5 2.9-1.9 4.6H0v7.7h4.3 c0.4 1.6 1.1 3.1 1.9 4.5l-3 3l5.5 5.5l3.1-3.1c1.4 0.8 2.9 1.5 4.5 1.8V40h7.7v-4.3c1.6-0.4 3.1-1 4.5-1.8l3.1 3.1l5.5-5.5l-3.1-3 c0.8-1.4 1.5-2.9 1.9-4.5H40z M13.3 20c0-3.7 3-6.7 6.7-6.7s6.7 3 6.7 6.7s-3 6.7-6.7 6.7S13.3 23.7 13.3 20z"/></svg>\n    </a>\n\n    <ul class="dropdown-menu dropdown-settings" data-mix-location="user menu">\n        ',stack1=self.invokePartial(partials.settingsLinks,"settingsLinks",depth0,helpers,partials,data),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n    </ul>\n</div>\n"})),Handlebars.registerPartial("settingsLinks",Handlebars.template(function(Handlebars,depth0,helpers,partials,data){function program1(){return'\n    <a href="/admin/" class="no-mobile" data-action="admin-click">\n        Admin\n    </a>\n    '}this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var stack1,buffer="",self=this;return buffer+='<li>\n    <a href="#" class="no-mobile" data-action="show-edit-profile">\n        Edit Profile\n    </a>\n</li>\n<li>\n    <a href="#" class="no-mobile" data-action="show-account">\n        Settings\n    </a>\n</li>\n<li>\n    <a href="#" data-action="opt-out">\n        Switch Back\n    </a>\n</li>\n\n<li role="presentation" class="divider no-mobile"></li>\n\n<li>\n    ',stack1=helpers["if"].call(depth0,depth0&&depth0.moderatesForum,{hash:{},inverse:self.noop,fn:self.program(1,program1,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+='\n</li>\n<li>\n    <a href="/follow/facebook/" class="no-mobile">\n        Find Friends\n    </a>\n</li>\n<li>\n    <a href="/admin/create/" class="no-mobile">\n        Add Disqus To Site\n    </a>\n</li>\n\n<li role="presentation" class="divider no-mobile"></li>\n\n<li>\n    \n    <a href="https://disqus.com/home/forums/channel-discussdisqus" target="_blank">\n        Feedback?\n    </a>\n</li>\n<li>\n    <a href="https://help.disqus.com/" target="_blank" data-role="help">\n        Help\n    </a>\n</li>\n<li>\n    <a href="/logout/?redirect=http%3A%2F%2Fdisqus.com">\n        Log Out\n    </a>\n</li>\n'})),Handlebars.registerPartial("settingsMobileIcon",Handlebars.template(function(Handlebars,depth0,helpers,partials,data){return this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{},'<div class="nav-settings-mobile" data-action="toggle-sidebar" data-mix-location="mobile">\n    <svg class="icon-settings" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="Layer_1" x="0px" y="0px" viewBox="0 0 40 40" enable-background="new 0 0 40 40" xml:space="preserve"><path fill-rule="evenodd" clip-rule="evenodd" d="M40 23.9v-7.7h-4.2c-0.4-1.6-1-3.1-1.9-4.6l3-3l-5.5-5.5l-3 3 c-1.4-0.9-2.9-1.5-4.6-1.9V0h-7.7v4.2c-1.6 0.4-3.2 1-4.6 1.9l-3-3L3.1 8.6l3 3c-0.8 1.4-1.5 2.9-1.9 4.6H0v7.7h4.3 c0.4 1.6 1.1 3.1 1.9 4.5l-3 3l5.5 5.5l3.1-3.1c1.4 0.8 2.9 1.5 4.5 1.8V40h7.7v-4.3c1.6-0.4 3.1-1 4.5-1.8l3.1 3.1l5.5-5.5l-3.1-3 c0.8-1.4 1.5-2.9 1.9-4.5H40z M13.3 20c0-3.7 3-6.7 6.7-6.7s6.7 3 6.7 6.7s-3 6.7-6.7 6.7S13.3 23.7 13.3 20z"/></svg>\n    <svg class="icon-x" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 40 40" enable-background="new 0 0 40 40" xml:space="preserve"><polygon points="40,5.5 34.5,0 20,14.5 5.5,0 0,5.5 14.5,20 0,34.5 5.5,40 20,25.5 34.5,40 40,34.5 25.5,20"/></svg>\n</div>\n'})),Handlebars.registerPartial("threadImage",Handlebars.template(function(Handlebars,depth0,helpers,partials,data){function program1(depth0){var stack1,buffer="";return buffer+='\n    <a href="'+escapeExpression((stack1=depth0&&depth0.thread,stack1=null==stack1||stack1===!1?stack1:stack1.link,typeof stack1===functionType?stack1.apply(depth0):stack1))+'" class="discussion-image" target="_blank">\n        <img src="'+escapeExpression((stack1=depth0&&depth0.image,stack1=null==stack1||stack1===!1?stack1:stack1.src,typeof stack1===functionType?stack1.apply(depth0):stack1))+'" alt="'+escapeExpression((stack1=depth0&&depth0.image,stack1=null==stack1||stack1===!1?stack1:stack1.title,typeof stack1===functionType?stack1.apply(depth0):stack1))+'">\n    </a>\n'}this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var stack1,buffer="",functionType="function",escapeExpression=this.escapeExpression,self=this;return stack1=helpers["if"].call(depth0,depth0&&depth0.image,{hash:{},inverse:self.noop,fn:self.program(1,program1,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n"})),Handlebars.registerPartial("userAvatar",Handlebars.template(function(Handlebars,depth0,helpers,partials,data){function program1(depth0,data){var stack1,helper,buffer="";return buffer+='\n<a href="/home/user/',(helper=helpers.username)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.username,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'" class="avatar">\n    ',stack1=self.invokePartial(partials.userAvatarNoLink,"userAvatarNoLink",depth0,helpers,partials,data),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n</a>\n"}function program3(depth0,data){var stack1,buffer="";return buffer+='\n<span class="avatar">\n    ',stack1=self.invokePartial(partials.userAvatarNoLink,"userAvatarNoLink",depth0,helpers,partials,data),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n</span>\n"}this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),partials=this.merge(partials,Handlebars.partials),data=data||{};var stack1,buffer="",functionType="function",escapeExpression=this.escapeExpression,self=this;return stack1=helpers["if"].call(depth0,depth0&&depth0.username,{hash:{},inverse:self.program(3,program3,data),fn:self.program(1,program1,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n"})),Handlebars.registerPartial("userAvatarNoLink",Handlebars.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var stack1,helper,buffer="",functionType="function",escapeExpression=this.escapeExpression;return buffer+='<img src="'+escapeExpression((stack1=depth0&&depth0.avatar,stack1=null==stack1||stack1===!1?stack1:stack1.cache,typeof stack1===functionType?stack1.apply(depth0):stack1))+'" alt="',(helper=helpers.displayName)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.displayName,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'">\n'})),Handlebars.registerPartial("userGroup",Handlebars.template(function(Handlebars,depth0,helpers,partials,data){function program1(depth0,data){var stack1,buffer="";return buffer+='\n        <span class="actor">\n            ',stack1=self.invokePartial(partials.userPreview,"userPreview",depth0,helpers,partials,data),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n        </span>\n    "}function program3(depth0,data){var buffer="";return buffer+='\n        <a href="#" class="actor name link-gray-darker" data-role="actors">\n            \n            '+escapeExpression(helpers.gettext.call(depth0,"%(numUsers)s others",{hash:{numUsers:depth0&&depth0.numRemainingActors},data:data}))+"\n        </a>\n    "
}this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),partials=this.merge(partials,Handlebars.partials),data=data||{};var stack1,buffer="",self=this,escapeExpression=this.escapeExpression;return buffer+='<span class="actors">\n    ',stack1=helpers.each.call(depth0,depth0&&depth0.shownActors,{hash:{},inverse:self.noop,fn:self.program(1,program1,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n    ",stack1=helpers["if"].call(depth0,depth0&&depth0.numRemainingActors,{hash:{},inverse:self.noop,fn:self.program(3,program3,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n</span>\n"})),Handlebars.registerPartial("userGroupNames",Handlebars.template(function(Handlebars,depth0,helpers,partials,data){function program1(depth0,data){var stack1,helper,options,buffer="";return buffer+='\n        <span class="actor-group" data-role="actors">\n            ',helper=helpers.gt||depth0&&depth0.gt,options={hash:{},data:data},stack1=helper?helper.call(depth0,depth0&&depth0.numRemainingActors,1,options):helperMissing.call(depth0,"gt",depth0&&depth0.numRemainingActors,1,options),stack1=helpers["if"].call(depth0,stack1,{hash:{},inverse:self.program(4,program4,data),fn:self.program(2,program2,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n        </span>\n    "}function program2(depth0,data){var buffer="";return buffer+="\n                "+escapeExpression(helpers.gettext.call(depth0,"%(numUsers)s others",{hash:{numUsers:depth0&&depth0.numRemainingActors},data:data}))+"\n            "}function program4(depth0,data){var buffer="";return buffer+="\n                "+escapeExpression(helpers.gettext.call(depth0,"1 other",{hash:{},data:data}))+"\n            "}this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),partials=this.merge(partials,Handlebars.partials),data=data||{};var stack1,buffer="",escapeExpression=this.escapeExpression,helperMissing=helpers.helperMissing,self=this;return buffer+='<span class="actors">\n    <span class="actor">\n        ',stack1=self.invokePartial(partials.userName,"userName",depth0&&depth0.firstActor,helpers,partials,data),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n    </span>\n    ",stack1=helpers["if"].call(depth0,depth0&&depth0.numRemainingActors,{hash:{},inverse:self.noop,fn:self.program(1,program1,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n</span>\n"})),Handlebars.registerPartial("userName",Handlebars.template(function(Handlebars,depth0,helpers,partials,data){function program1(depth0,data){var stack1,helper,buffer="";return buffer+='\n<a href="/home/user/',(helper=helpers.username)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.username,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'" class="name">',(helper=helpers.name)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.name,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"</a>\n"}function program3(depth0,data){var stack1,buffer="";return buffer+="\n",stack1=helpers["if"].call(depth0,depth0&&depth0.name,{hash:{},inverse:self.program(6,program6,data),fn:self.program(4,program4,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n"}function program4(depth0,data){var stack1,helper,buffer="";return buffer+="\n",(helper=helpers.name)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.name,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"\n"}function program6(){return"\nGuest\n"}this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var stack1,buffer="",functionType="function",escapeExpression=this.escapeExpression,self=this;return stack1=helpers["if"].call(depth0,depth0&&depth0.username,{hash:{},inverse:self.program(3,program3,data),fn:self.program(1,program1,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n"})),Handlebars.registerPartial("userPreview",Handlebars.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),partials=this.merge(partials,Handlebars.partials),data=data||{};var stack1,buffer="",self=this;return stack1=self.invokePartial(partials.userAvatar,"userAvatar",depth0,helpers,partials,data),(stack1||0===stack1)&&(buffer+=stack1),stack1=self.invokePartial(partials.userName,"userName",depth0,helpers,partials,data),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n"})),Handlebars.registerPartial("userSpan",Handlebars.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var stack1,helper,buffer="",functionType="function",escapeExpression=this.escapeExpression;return buffer+='<span data-user="',(helper=helpers.id)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.id,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'" data-role="username">',(helper=helpers.name)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.name,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"</span>\n"})),Handlebars.registerPartial("cardGuestUpvoterText",Handlebars.template(function(Handlebars,depth0,helpers,partials,data){function program1(depth0,data){var buffer="";return buffer+=" "+escapeExpression(helpers.gettext.call(depth0,"%(guestCount)s Guest Votes",{hash:{guestCount:depth0&&depth0.guestCount},data:data}))+" "}function program3(depth0,data){var buffer="";return buffer+=" "+escapeExpression(helpers.gettext.call(depth0,"1 Guest Vote",{hash:{},data:data}))+" "}this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var stack1,helper,options,buffer="",escapeExpression=this.escapeExpression,helperMissing=helpers.helperMissing,self=this;return helper=helpers.gt||depth0&&depth0.gt,options={hash:{},data:data},stack1=helper?helper.call(depth0,depth0&&depth0.guestCount,1,options):helperMissing.call(depth0,"gt",depth0&&depth0.guestCount,1,options),stack1=helpers["if"].call(depth0,stack1,{hash:{},inverse:self.program(3,program3,data),fn:self.program(1,program1,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n"})),Handlebars.registerPartial("cardGuestUser",Handlebars.template(function(Handlebars,depth0,helpers,partials,data){function program1(depth0,data){var stack1,helper,buffer="";return buffer+='\n    <li class="user ',stack1=helpers["if"].call(depth0,depth0&&depth0.highlight,{hash:{},inverse:self.noop,fn:self.program(2,program2,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+='" data-role="guest">\n        <span class="avatar" title="',(helper=helpers.guestText)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.guestText,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'">\n            <img src="',(helper=helpers.guestAvatarUrl)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.guestAvatarUrl,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'" alt="'+escapeExpression(helpers.gettext.call(depth0,"Avatar",{hash:{},data:data}))+'" />\n        </span>\n        <span class="username" title="',(helper=helpers.guestText)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.guestText,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'">\n            ',(helper=helpers.guestText)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.guestText,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"\n        </span>\n    </li>\n"}function program2(){return"highlight"}this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var stack1,buffer="",self=this,functionType="function",escapeExpression=this.escapeExpression;return stack1=helpers["if"].call(depth0,depth0&&depth0.guestCount,{hash:{},inverse:self.noop,fn:self.program(1,program1,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n"})),Handlebars.registerPartial("cardOtherUserText",Handlebars.template(function(Handlebars,depth0,helpers,partials,data){function program1(depth0,data){var buffer="";return buffer+=" "+escapeExpression(helpers.gettext.call(depth0,"%(guestCount)s Others",{hash:{guestCount:depth0&&depth0.guestCount},data:data}))+" "}function program3(depth0,data){var buffer="";return buffer+=" "+escapeExpression(helpers.gettext.call(depth0,"1 Other",{hash:{},data:data}))+" "}this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var stack1,helper,options,buffer="",escapeExpression=this.escapeExpression,helperMissing=helpers.helperMissing,self=this;return helper=helpers.gt||depth0&&depth0.gt,options={hash:{},data:data},stack1=helper?helper.call(depth0,depth0&&depth0.guestCount,1,options):helperMissing.call(depth0,"gt",depth0&&depth0.guestCount,1,options),stack1=helpers["if"].call(depth0,stack1,{hash:{},inverse:self.program(3,program3,data),fn:self.program(1,program1,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n"})),Handlebars.registerPartial("cardUser",Handlebars.template(function(Handlebars,depth0,helpers,partials,data){function program1(){return"highlight"}this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var stack1,helper,buffer="",self=this,functionType="function",escapeExpression=this.escapeExpression;return buffer+='<li class="user ',stack1=helpers["if"].call(depth0,depth0&&depth0.highlight,{hash:{},inverse:self.noop,fn:self.program(1,program1,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+='" data-action="profile" data-user="',(helper=helpers.id)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.id,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'" data-username="',(helper=helpers.username)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.username,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'">\n    \n    <a class="avatar" href="#" title="',(helper=helpers.name)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.name,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'">\n        <img src="'+escapeExpression((stack1=depth0&&depth0.avatar,stack1=null==stack1||stack1===!1?stack1:stack1.cache,typeof stack1===functionType?stack1.apply(depth0):stack1))+'" alt="'+escapeExpression(helpers.gettext.call(depth0,"Avatar",{hash:{},data:data}))+'" />\n    </a>\n    <a class="username" href="#" title="',(helper=helpers.name)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.name,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'">\n        ',(helper=helpers.name)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.name,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"\n    </a>\n</li>\n"}))}),define("home/templates/main",["handlebars","handlebars.partials"],function(Handlebars){return Handlebars.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var stack1,helper,buffer="",functionType="function",escapeExpression=this.escapeExpression;return buffer+='\n        <div id="container-content">\n\n            \n            <div class="cover">\n                <div class="cover-message">\n                    <h3 class="headline">Something\'s gone wrong <span class="face face-sad">:(</span></h3>\n                    <p class="description">Please try to reload the page, or check back momentarily. Still not working? <a href="http://disqus.com/support/">Get help &raquo;</a></p>\n                </div>\n            </div>\n            <div class="empty-message">\n                \n                <a href="#"><svg class="art-refresh" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 60 53" enable-background="new 0 0 60 53" xml:space="preserve"><path d="M26.1 0c14.2 0 25.7 11.5 26.1 25.8H60L48.3 39.1L36.5 25.8h9.1c-0.3-10.7-9-19.2-19.5-19.2 c-10.8 0-19.6 8.9-19.6 19.9s8.8 19.9 19.6 19.9c4.3 0 8.3-1.4 11.6-3.9l4.5 4.9c-4.4 3.5-10 5.6-16.1 5.6C11.7 53 0 41.1 0 26.5 S11.7 0 26.1 0z"/></svg></br>Click to reload</a>\n            </div>\n\n            \n            <div class="empty-message">\n\n                \n                <svg class="art-empty-notifications" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 164.8 50" enable-background="new 0 0 164.8 50" xml:space="preserve"><path d="M0 11h13.7v3.6H0V11z" class="arm"/><path d="M15.4 11h4.2l18.1 37h-4.2L15.4 11z" class="arm"/><path d="M39 44.2h24.2V48H39V44.2z" class="arm"/><path d="M101.6 44.2h24.2V48h-24.2V44.2z" class="arm"/><path d="M145 11h4.2l-18.1 37h-4.2L145 11z" class="arm"/><path d="M151.1 11h13.7v3.6h-13.7V11z" class="arm"/><path d="M57.9 25c0-13.8 11.2-25 25-25s25 11.2 25 25s-11.2 25-25 25 S57.9 38.8 57.9 25z" class="body"/><path d="M71.1 20.7C71.8 26.5 76.8 31 82.9 31s11-4.5 11.8-10.3c-2.3 2.2-6.7 3-11.8 3S73.4 22.9 71.1 20.7z" class="mouth"/><path d="M63.3 16c0-2.1 1.8-3.9 4-3.9c2.2 0 4 1.7 4 3.9s-1.8 3.9-4 3.9 C65.1 19.9 63.3 18.1 63.3 16z" class="eye"/><path d="M94.4 15.6c0-2.1 1.8-3.8 4-3.8c2.2 0 4 1.7 4 3.8 c0 2.1-1.8 3.8-4 3.8C96.2 19.5 94.4 17.8 94.4 15.6z" class="eye"/></svg>\n\n                <div class="notifications-empty-headline">No Notifications</div>\n                You must be new. Or quiet.\n            </div>\n\n            \n            <div class="empty-message">\n\n                \n                <svg class="art-empty-community" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 94 128" enable-background="new 0 0 94 128" xml:space="preserve"><path class="house" d="M61 118.4l-9.8-10c-0.5-0.5-1.3-0.5-1.8 0l-9.8 10c-0.5 0.5-0.3 1 0.4 1h2v7.7c0 0.6 0 1 1 1h4.8v-7.7h5 v7.7h5c0.8 0 0.8-0.4 0.8-1v-7.7h2C61.3 119.3 61.5 118.9 61 118.4z" /><path class="bubble-top" d="M75.2 21C75.2 9.4 66.2 0 55 0C43.8 0 34.8 9.4 34.8 21c0 3.1 0.7 6.1 1.8 8.7l-3.4 8.5l8.7-1.2 c3.5 3.1 8.1 5 13.1 5C66.2 42 75.2 32.6 75.2 21z M56.4 26.6h-1.9V22h-5.1v4.5h-1.9V15.8h1.9v4.5h5.1v-4.5h1.9V26.6z M60.9 26.6 h-1.9v-8.1h1.9V26.6z M61 17.2h-2v-1.8h2V17.2z"/><path class="bubble-left" d="M79.3 47c-8 0-14.5 6.7-14.5 15c0 2.2 0.5 4.3 1.3 6.2l-2.4 6.1l6.2-0.9c2.5 2.2 5.8 3.6 9.3 3.6 c8 0 14.5-6.7 14.5-15S87.3 47 79.3 47z M80.5 66.6H79v-3.7h-4.2v3.7h-1.6v-8.9h1.6v3.7H79v-3.7h1.6V66.6z M84.3 66.6h-1.5v-6.7h1.5 V66.6z M84.3 58.9h-1.6v-1.5h1.6V58.9z" /><path class="bubble-right" d="M48.4 72c0-13.8-10.8-25-24.1-25C11 47 0.2 58.2 0.2 72S11 97 24.3 97c5.9 0 11.4-2.2 15.6-5.9l10.3 1.5 l-4-10.2C47.7 79.2 48.4 75.7 48.4 72z M26.4 78.6h-2.2v-5.3h-6v5.3H16V66h2.2v5.3h6V66h2.2V78.6z M31.7 78.6h-2.2v-9.5h2.2V78.6z M31.8 67.6h-2.3v-2.1h2.3V67.6z"/></svg>\n\n                The Dissolve hasn\'t been busy recently.</br><a href="#">Head back home to find interesting discussions &raquo;</a>\n            </div>\n\n            \n            <div class="empty-message">\n\n                \n                <svg class="art-empty-user" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 284 78" enable-background="new 0 0 284 78" xml:space="preserve"><path d="M202.9 42.3c-9.2-24.6-33-42.2-60.9-42.2S90.4 17.7 81.1 42.3H91c0-0.2 0-0.3 0-0.5c0-5.5 4.7-10 10.5-10 c2.9 0 5.6 1.2 7.5 3c1.9 1.8 3 4.3 3 7c0 0.1 0 0.1 0 0.2c0 0.1 0 0.2 0 0.3h60.1h0c-0.1-0.5-0.1-1-0.1-1.5c0-2.6 1-4.9 2.7-6.6 c1.9-2.1 4.7-3.4 7.8-3.4c5.8 0 10.5 4.5 10.5 10c0 0.5-0.1 1-0.1 1.5H202.9z"/><path class="finger" d="M39 42c0-3.3 2.7-6 6-6H45c3.3 0 6 2.7 6 6v20.9c0 3.3-2.7 6-6 6 H45c-3.3 0-6-2.7-6-6V42z" /><path class="finger" d="M58.2 51.8c-3.3 0-6-2.6-6-5.9v-0.3c0-3.2 2.7-5.9 6-5.9H66 c3.3 0 6 2.6 6 5.9V46c0 3.2-2.7 5.9-6 5.9H58.2z" /><path class="finger" d="M0 42.7c0-3.3 2.7-6 5.9-6h0.1c3.3 0 5.9 2.7 5.9 6v15.4 c0 3.3-2.7 6-5.9 6H5.9c-3.3 0-5.9-2.7-5.9-6V42.7z" /><path class="finger" d="M13 42c0-3.3 2.7-6 6-6H19c3.3 0 6 2.7 6 6v20.9c0 3.3-2.7 6-6 6 H19c-3.3 0-6-2.7-6-6V42z" /><path class="finger" d="M26 39.8c0-3.3 2.7-6 6-6H32c3.3 0 6 2.7 6 6v32.1 c0 3.3-2.7 6-6 6H32c-3.3 0-6-2.7-6-6V39.8z" /><path class="finger" d="M245 42c0-3.3-2.7-6-5.9-6h-0.1c-3.3 0-5.9 2.7-5.9 6v20.9 c0 3.3 2.7 6 5.9 6h0.1c3.3 0 5.9-2.7 5.9-6V42z" /><path class="finger" d="M225.8 51.8c3.3 0 6-2.6 6-5.9v-0.3c0-3.2-2.7-5.9-6-5.9H218 c-3.3 0-6 2.6-6 5.9V46c0 3.2 2.7 5.9 6 5.9H225.8z" /><path class="finger" d="M284 42.7c0-3.3-2.7-6-6-6H278c-3.3 0-6 2.7-6 6v15.4 c0 3.3 2.7 6 6 6h0.1c3.3 0 6-2.7 6-6V42.7z" /><path class="finger" d="M271 42c0-3.3-2.7-6-6-6H265c-3.3 0-6 2.7-6 6v20.9 c0 3.3 2.7 6 6 6h0.1c3.3 0 6-2.7 6-6V42z" /><path class="finger" d="M258 39.8c0-3.3-2.7-6-5.9-6h-0.1c-3.3 0-5.9 2.7-5.9 6v32.1 c0 3.3 2.7 6 5.9 6h0.1c3.3 0 5.9-2.7 5.9-6V39.8z" /></svg>\n\n                \n                <div class="empty-user-line"></div>\n\n                Ted Fuller is a quiet soul. <a href="http://disqus.com/follow/facebook/">Find and follow more vocal friends on Disqus &raquo;</a>\n            </div>\n\n            \n            <div class="cover">\n                <div class="cover-message">\n                    <h3 class="headline">Your feed\'s empty! <span class="face face-sad">:(</span></h3>\n                    <p class="description">To get the best experience, follow some communities. We recommend these:</p>\n                </div>\n            </div>\n            <header class="nav-tabs-container">\n                <ul class="nav-tabs">\n                    <li class="active">\n                        <a href="#" data-mix-location="interests" data-action="change-feed" data-feed="interests"><span class="text-wide">Communities</span></a>\n                    </li>\n                    <li>\n                        <a href="#" data-mix-location="dashboard" data-action="change-feed" data-feed="dashboard">People</a>\n                    </li>\n                    <li>\n                        <a href="#" data-mix-location="reply" data-action="change-feed" data-feed="reply"><span class="text-wide">Channels</a>\n                    </li>\n                </ul>\n            </header>\n            <div class="carousel">\n                <div class="carousel-cards">\n                    <div class="carousel-card">\n                        <a href="#" class="avatar"><img src="http://www.placehold.it/48x48" alt=""></a>\n                        <h3 class="name"><a class="link-gray-dark" href="#">Nic Uhlerrd</a></h3>\n                        <p class="bio">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Fugit ea non nesciunt iste dolor laborum!</p>\n                        <button class="btn btn-light btn-follow" onclick="$(this).toggleClass(\'active\'); return false;"><span class="symbol-default"><span class="icon-plus"></span></span><span class="text-default">Follow</span><span class="symbol-following"><span class="icon-checkmark"></span></span><span class="text-following">Following</span></button>\n                    </div>\n                    <div class="carousel-card">\n                        <a href="#" class="avatar"><img src="http://www.placehold.it/48x48" alt=""></a>\n                        <h3 class="name"><a class="link-gray-dark" href="#">The Dissolve</a></h3>\n                        <p class="bio">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Fugit ea non nesciunt iste dolor laborum!</p>\n                        <button class="btn btn-light btn-follow" onclick="$(this).toggleClass(\'active\'); return false;"><span class="symbol-default"><span class="icon-plus"></span></span><span class="text-default">Follow</span><span class="symbol-following"><span class="icon-checkmark"></span></span><span class="text-following">Following</span></button>\n                    </div>\n                    <div class="carousel-card">\n                        <a href="#" class="avatar"><img src="http://www.placehold.it/48x48" alt=""></a>\n                        <h3 class="name"><a class="link-gray-dark" href="#">Nic Uhlerrd</a></h3>\n                        <p class="bio">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Fugit ea non nesciunt iste dolor laborum!</p>\n                        <button class="btn btn-light btn-follow" onclick="$(this).toggleClass(\'active\'); return false;"><span class="symbol-default"><span class="icon-plus"></span></span><span class="text-default">Follow</span><span class="symbol-following"><span class="icon-checkmark"></span></span><span class="text-following">Following</span></button>\n                    </div>\n                </div>\n            </div>\n\n            \n            <div class="cover">\n                <div class="cover-action">\n                    <button class="btn btn-default"><span class="text-desktop">Close</span><span class="text-mobile"><span class="icon-cancel"></span></span></button>\n                </div>\n                <div class="cover-message">\n                    <h3 class="headline">You fed your feed <span class="face face-happy">:)</span></h3>\n                </div>\n            </div>\n\n\n            <div class="cards">\n\n                <div class="card notif unread">\n                    <div class="card-reason">\n                        <svg class="icon icon-notif-follow" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 20 20" enable-background="new 0 0 20 20" xml:space="preserve"><path d="M10 0C4.5 0 0 4.5 0 10s4.5 10 10 10s10-4.5 10-10S15.5 0 10 0z M3.8 9C2.9 9 2.2 8.3 2.2 7.4 c0-0.8 0.7-1.5 1.6-1.5c0.9 0 1.6 0.7 1.6 1.5C5.4 8.3 4.7 9 3.8 9z M10 14.4c-2.4 0-4.4-1.8-4.7-4.2c0.9 0.9 2.7 1.2 4.7 1.2 s3.8-0.3 4.7-1.2C14.4 12.6 12.4 14.4 10 14.4z M16.2 8.8c-0.9 0-1.6-0.7-1.6-1.5s0.7-1.5 1.6-1.5c0.9 0 1.6 0.7 1.6 1.5 S17.1 8.8 16.2 8.8z"/></svg><a href="" class="name link-gray-dark">Sam Parker</a> followed you <span class="time">30m ago</span>\n                    </div>\n                    <div class="card-user">\n                        <div class="card-aside">\n                            <button class="btn btn-light btn-follow" onclick="$(this).toggleClass(\'active\'); return false;"><span class="symbol-default"><span class="icon-plus"></span></span><span class="text-default">Follow</span><span class="symbol-following"><span class="icon-checkmark"></span></span><span class="text-following">Following</span></button>\n                        </div>\n                        <div class="card-body">\n                            <a href="#" class="avatar"><img src="https://fbcdn-profile-a.akamaihd.net/hprofile-ak-frc3/t1.0-1/p160x160/521478_10102087896730036_1593232052_n.jpg" alt=""></a>\n                            <div class="user-info">\n                                <a href="#" class="name link-gray-dark">Sam Parker</a>\n                                <p class="description">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Illo, quas, quod, illum vel perferendis facere voluptate dolor rem enim iure ratione voluptatum id consequuntur aut eligendi velit blanditiis excepturi officiis.</p>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n\n                <div class="card notif">\n                    <div class="card-reason">\n                        <svg class="icon icon-notif-reply" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 20 20" enable-background="new 0 0 20 20" xml:space="preserve"><path  d="M10 0C4.5 0 0 4.5 0 10s4.5 10 10 10s10-4.5 10-10S15.5 0 10 0z M11.3 13.9v-3.2c-3.4 0-6 0.3-7.8 3.5 c0 0 1.4-7.2 7.8-7.2V4.2L16.5 9L11.3 13.9z"/></svg><a href="" class="name link-gray-dark">Sam Parker</a> replied to you <span class="time">30m ago</span>\n                    </div>\n                    <div class="card-discussion-notif">\n                        <div class="card-body">\n                            <div class="card-title">\n                                <h2 class="discussion-title"><a href="#" class="link-gray">How To Make A Beer Flavored Jelly Belly People Actually Want To Eat </a></h2> on <a href="#" class="discussion-community link-gray">Disqus Taste</a>\n                            </div>\n                            <div class="card-comment-notif">\n                                <div class="comment-message">\n                                    Lorem ipsum dolor sit amet, consectetur adipisicing elit Lorem ipsum dolor sit....\n                                </div>\n                                <a class="card-comment-view link-gray" href="#">View your comment <span class="icon-expand"></span></a>\n                            </div>\n                            <div class="card-comment">\n                                <a href="#" class="avatar"><img src="http://a.disquscdn.com/uploads/users/263/9572/avatar92.jpg?1288254637" alt=""></a>\n                                <div class="comment-body">\n                                    <header class="comment-header">\n                                        <a href="#" class="name link-gray-dark">Sam Parker</a> &middot; <span class="time">30m ago</span>\n                                    </header>\n                                    <div class="comment-message">\n                                        <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Distinctio, doloremque, ipsam. Est, nobis ipsum dolores minima deleniti fuga eveniet suscipit labore dignissimos cupiditate vero nisi deser</p>\n                                    </div>\n                                    <footer class="comment-actions">\n                                        <a href="#" class="vote-up"><span class="vote-count">50</span><span class="icon-arrow-2"></span></a><a href="#" class="vote-down"><span class="icon-arrow"></span></a><a href="#" class="reply link-gray-light">Reply</a>\n                                    </footer>\n\n                                    <div class="card-comment">\n                                        <a href="#" class="avatar"><img src="http://a.disquscdn.com/uploads/users/263/9572/avatar92.jpg?1288254637" alt=""><span class="icon-checkmark"></span></a>\n                                        <div class="comment-body confirmed">\n                                            <header class="comment-header">\n                                                <a href="#" class="name link-gray-dark">Sam Parker</a> &middot; <a href="#" class="link-gray-light time">30m ago</a>\n                                            </header>\n                                            <div class="comment-message">\n                                                <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Distinctio, doloremque, ipsam. Est, nobis ipsum dolores minima deleniti fuga eveniet suscipit labore dignissimos... <a href="#">more</a></p>\n                                            </div>\n                                        </div>\n                                    </div>\n\n                                </div>\n                            </div>\n\n                        </div>\n                    </div>\n                </div>\n\n\n                <div class="card notif unread">\n                    <div class="card-reason">\n                        <svg class="icon icon-notif-upvote" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 20 20" enable-background="new 0 0 20 20" xml:space="preserve"><path d="M10 0C4.5 0 0 4.5 0 10s4.5 10 10 10s10-4.5 10-10S15.5 0 10 0z M14.7 12.2c-0.2 0.2-0.5 0.3-0.7 0.3 s-0.5-0.1-0.7-0.3L10 8.9l-3.3 3.3c-0.4 0.4-1 0.4-1.4 0s-0.4-1 0-1.4l4-4c0.4-0.4 1-0.4 1.4 0l4 4C15.1 11.2 15.1 11.8 14.7 12.2z" class="style0"/></svg><a href="" class="name link-gray-dark">Sam Parker</a> and <strong>5 others</strong> upvoted you <span class="time">30m ago</span>\n                    </div>\n                    <div class="card-discussion-notif">\n                        <div class="card-body">\n                            <div class="card-title">\n                                <h2 class="discussion-title"><a href="#" class="link-gray">How To Make A Beer Flavored Jelly Belly People Actually Want To Eat </a></h2> on <a href="#" class="discussion-community link-gray">Disqus Taste</a>\n                            </div>\n                            <div class="card-comment-notif">\n                                <div class="comment-message">\n                                    Lorem ipsum dolor sit amet, consectetur elit Lorem ipsum dolor sit....\n                                </div>\n                                <a href="#" class="card-comment-view link-gray">View your comment <span class="icon-expand"></span></a>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n\n\n\n\n\n\n\n                \n                <div style="display: block;">\n\n                <div class="card user">\n                    <div class="card-user">\n                        <div class="card-aside">\n                            <button class="btn btn-light btn-follow" onclick="$(this).toggleClass(\'active\'); return false;"><span class="symbol-default"><span class="icon-plus"></span></span><span class="text-default">Follow</span><span class="symbol-following"><span class="icon-checkmark"></span></span><span class="text-following">Following</span></button>\n                        </div>\n                        <div class="card-body">\n                            <a href="#" class="avatar"><img src="https://fbcdn-profile-a.akamaihd.net/hprofile-ak-frc3/t1.0-1/p160x160/521478_10102087896730036_1593232052_n.jpg" alt=""></a>\n                            <div class="user-info">\n                                <a href="#" class="name link-gray-dark">Sam Parker</a>\n                                <p class="description">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Illo, quas, quod, illum vel perferendis facere voluptate dolor rem enim iure ratione voluptatum id consequuntur aut eligendi velit blanditiis excepturi officiis.</p>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div class="card user">\n                    <div class="card-user">\n                       <div class="card-aside">\n                            <button class="btn btn-light btn-follow" onclick="$(this).toggleClass(\'active\'); return false;"><span class="symbol-default"><span class="icon-plus"></span></span><span class="text-default">Follow</span><span class="symbol-following"><span class="icon-checkmark"></span></span><span class="text-following">Following</span></button>\n                        </div>\n                        <div class="card-body">\n                            <a href="#" class="avatar"><img src="https://fbcdn-profile-a.akamaihd.net/hprofile-ak-frc3/t1.0-1/p160x160/521478_10102087896730036_1593232052_n.jpg" alt=""></a>\n                            <div class="user-info">\n                                <a href="#" class="name link-gray-dark">Sam Parker</a>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n\n                \n                <div class="card discussion">\n                    <div class="card-discussion">\n                        <div class="card-aside">\n                           <a href="#" class="discussion-image"><img src="http://images.nationalgeographic.com/wpf/media-live/photos/000/788/cache/sherpa-community-avalanche-1_78882_990x742.jpg" alt=""></a>\n                        </div>\n\n                        \n                        <div class="card-body">\n                            \n                            <div class="card-comment-count">3</div>\n                            <div class="card-reason">\n                                <a href="#" class="avatar"><img src="http://a.disquscdn.com/uploads/users/263/9572/avatar92.jpg?1288254637" alt=""></a> <a href="" class="name link-gray-dark">Sam Parker</a> commented <span class="time">30m ago</span>\n                            </div>\n\n                            \n                            <div class="card-title">\n                                <h2 class="discussion-title"><a href="#" class="link-gray-dark">I dabble: 18 critics who became artists</a></h2> on <a href="#" class="discussion-community link-gray-dark">A.V. Club</a>\n                            </div>\n\n                            \n                            <div class="card-comment">\n                                <a href="#" class="avatar"><img src="http://a.disquscdn.com/uploads/users/263/9572/avatar92.jpg?1288254637" alt=""></a>\n                                <div class="comment-body">\n                                    <header class="comment-header">\n                                        <a href="#" class="name link-gray-dark">Sam Parker</a> &middot; <span class="time">30m ago</span>\n                                    </header>\n                                    <div class="comment-message">\n                                        <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Distinctio, doloremque, ipsam. Est, nobis ipsum dolores minima deleniti fuga eveniet suscipit labore dignissimos cupiditate vero nisi deserunt quis animi beatae consectetur nostrum non tenetur vitae blanditiis dolore placeat quibusdam incidunt culpa iusto quo totam maxime velit quod eius unde omnis dicta!</p>\n                                    </div>\n\n                                    \n                                    <footer class="comment-actions">\n                                        <a href="#" class="vote-up"><span class="vote-count">50</span><span class="icon-arrow-2"></span></a><a href="#" class="vote-down"><span class="icon-arrow"></span></a><a href="#" class="reply link-gray-light">Reply</a>\n                                    </footer>\n\n                                    <div class="card-comment">\n                                        <a href="#" class="avatar"><img src="http://a.disquscdn.com/uploads/users/263/9572/avatar92.jpg?1288254637" alt=""><span class="icon-checkmark"></span></a>\n                                        <div class="comment-body confirmed">\n                                            <header class="comment-header">\n                                                <a href="#" class="name link-gray-dark">Sam Parker</a> &middot; <a href="#" class="link-gray-light time">30m ago</a>\n                                            </header>\n                                            <div class="comment-message">\n                                                <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Distinctio, doloremque, ipsam. Est, nobis ipsum dolores minima deleniti fuga eveniet suscipit labore dignissimos... <a href="#">more</a></p>\n                                            </div>\n                                        </div>\n                                    </div>\n\n                                </div>\n                            </div>\n\n                            \n                            <footer class="card-footer">\n                                <ul class="actions">\n                                    <li class="action">\n                                        <a class="link-gray-light action-discussion" href="#">Discussion <span class="icon-comment"></span></a>\n                                    </li>\n                                    <li class="action">\n                                        <a class="link-gray-light action-favorite" href="#">Favorite <span class="icon-star"></span></a>\n                                    </li>\n                                </ul>\n                            </footer>\n                        </div>\n                    </div>\n                </div>\n\n                \n                <div class="card discussion">\n                    <div class="card-discussion">\n                        <div class="card-aside">\n                            <a href="#" class="discussion-image"><img src="http://l2.yimg.com/bt/api/res/1.2/QnVfydbLggfzYyHwaBSrhA--/YXBwaWQ9eW5ld3M7Zmk9ZmlsbDtoPTQ3NDtweW9mZj0wO3E9NzU7dz02MzA-/http://l.yimg.com/os/publish-images/sports/2014-04-18/a50ddb70-c740-11e3-a0d7-03589fb7c15b_GGGPP41814.jpg" alt=""></a>\n                        </div>\n                        <div class="card-body">\n                            <div class="card-comment-count">10k</div>\n                            <div class="card-reason">\n                                <a href="#" class="avatar"><img src="http://a.disquscdn.com/uploads/users/263/9572/avatar92.jpg?1288254637" alt=""></a> <a href="" class="name link-gray-dark">Sam Parker</a> replied to <a href="" class="name link-gray-dark">Sam Parker</a> <span class="time">30m ago</span>\n                            </div>\n                            <div class="card-title">\n                                <h2 class="discussion-title"><a href="#" class="link-gray-dark">How To Make A Beer Flavored Jelly Belly People Actually Want To Eat </a></h2> on <a href="#" class="discussion-community link-gray-dark">Disqus Taste</a>\n                            </div>\n\n\n                            \n                            <div class="card-comment">\n\n                                \n                                <div class="reply-line"></div>\n\n                                <a href="#" class="avatar"><img src="http://a.disquscdn.com/uploads/users/263/9572/avatar92.jpg?1288254637" alt=""></a>\n                                <div class="comment-body">\n                                    <header class="comment-header">\n                                        <a href="#" class="name link-gray-dark">Sam Parker</a> &middot; <span class="time">30m ago</span>\n                                    </header>\n                                    <div class="comment-message">\n                                        <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Distinctio, doloremque, ipsam. Est, nobis ipsum dolores minima deleniti fuga eveniet suscipit labore dignissimos cupiditate vero nisi deser</p>\n                                    </div>\n                                    <footer class="comment-actions">\n                                        <a href="#" class="vote-up"><span class="vote-count">50</span><span class="icon-arrow-2"></span></a><a href="#" class="vote-down"><span class="icon-arrow"></span></a><a href="#" class="reply link-gray-light">Reply</a>\n                                    </footer>\n\n                                    <div class="card-comment">\n                                        <a href="#" class="avatar"><img src="http://a.disquscdn.com/uploads/users/263/9572/avatar92.jpg?1288254637" alt=""><span class="icon-checkmark"></span></a>\n                                        <div class="comment-body confirmed">\n                                            <header class="comment-header">\n                                                <a href="#" class="name link-gray-dark">Sam Parker</a> &middot; <a href="#" class="link-gray-light time">30m ago</a>\n                                            </header>\n                                            <div class="comment-message">\n                                                <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Distinctio, doloremque, ipsam. Est, nobis ipsum dolores minima deleniti fuga eveniet suscipit labore dignissimos... <a href="#">more</a></p>\n                                            </div>\n                                        </div>\n                                    </div>\n\n                                </div>\n\n                            </div>\n                            <div class="card-comment">\n                                <a href="#" class="avatar"><img src="http://a.disquscdn.com/uploads/users/263/9572/avatar92.jpg?1288254637" alt=""></a>\n                                <div class="comment-body">\n                                    <header class="comment-header">\n                                        <a href="#" class="name link-gray-dark">Sam Parker</a> &middot; <span class="time">30m ago</span>\n                                    </header>\n                                    <div class="comment-message">\n                                        <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Distinctio, doloremque, ipsam. Est, nobis ipsum dolores minima deleniti fuga eveniet suscipit labore dignissimos cupiditate vero nisi deserun</p>\n                                    </div>\n                                    <footer class="comment-actions">\n                                        <a href="#" class="vote-up"><span class="vote-count">50</span><span class="icon-arrow-2"></span></a><a href="#" class="vote-down"><span class="icon-arrow"></span></a><a href="#" class="reply link-gray-light">Reply</a>\n                                    </footer>\n\n                                    <div class="card-comment">\n                                        <a href="#" class="avatar"><img src="http://a.disquscdn.com/uploads/users/263/9572/avatar92.jpg?1288254637" alt=""><span class="icon-checkmark"></span></a>\n                                        <div class="comment-body confirmed">\n                                            <header class="comment-header">\n                                                <a href="#" class="name link-gray-dark">Sam Parker</a> &middot; <a href="#" class="link-gray-light time">30m ago</a>\n                                            </header>\n                                            <div class="comment-message">\n                                                <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Distinctio, doloremque, ipsam. Est, nobis ipsum dolores minima deleniti fuga eveniet suscipit labore dignissimos... <a href="#">more</a></p>\n                                            </div>\n                                        </div>\n                                    </div>\n\n                                </div>\n                            </div>\n\n                            <footer class="card-footer">\n                                <ul class="actions">\n                                    <li class="action">\n                                        <a class="link-gray-light action-discussion" href="#">Discussion <span class="icon-comment"></span></a>\n                                    </li>\n                                    <li class="action">\n                                        <a class="link-gray-light action-favorite" href="#">Favorite <span class="icon-star"></span></a>\n                                    </li>\n                                </ul>\n                            </footer>\n                        </div>\n                    </div>\n                </div>\n\n\n                <div class="card discussion">\n                    <div class="card-discussion">\n                        <div class="card-aside">\n                        </div>\n                        <div class="card-body">\n                            <div class="card-comment-count">342</div>\n                            <div class="card-reason">\n                                <a href="#" class="avatar"><img src="http://a.disquscdn.com/uploads/users/263/9572/avatar92.jpg?1288254637" alt=""></a> <a href="" class="name link-gray-dark">Sam Parker</a> favorited this discussion <span class="time">30m ago</span>\n                            </div>\n                            <div class="card-title">\n                                <h2 class="discussion-title"><a href="#" class="link-gray-dark">How To Make A Beer Flavored The World\'s First Burrito Vending Machine Launches at USC </a></h2> on <a href="#" class="discussion-community link-gray-dark">Budget Travel</a>\n                            </div>\n                            <footer class="card-footer">\n                                <ul class="actions">\n                                    <li class="action">\n                                        <a class="link-gray-light action-discussion" href="#">Discussion <span class="icon-comment"></span></a>\n                                    </li>\n                                    <li class="action">\n                                        <a class="link-gray-light action-favorite" href="#" onclick="$(this).toggleClass(\'active\'); return false;">Favorite <span class="icon-star"></span></a>\n                                    </li>\n                                </ul>\n                            </footer>\n                        </div>\n                    </div>\n                </div>\n\n            <div class="card">\n                <a href="#" class="btn btn-default btn-block">More</a>\n            </div>\n\n\n\n\n            <div class="cover community">\n                <div class="cover-body">\n                    <div class="cover-body-right">\n                        \n                        <a href="#" class="btn btn-primary btn-follow" onclick="$(this).toggleClass(\'active\'); return false;"><span class="symbol-default"><span class="icon-plus"></span></span><span class="text-default">Follow</span><span class="symbol-following"><span class="icon-checkmark"></span></span><span class="text-following">Following</span></a>\n                    </div>\n                    <div class="cover-body-left">\n                        <h1 class="cover-title">Atlantic Cities</h1>\n                        <p class="cover-description">Trending discussions</p>\n                    </div>\n                </div>\n            </div>\n            <div class="cover channel">\n                <div class="cover-body">\n                    <div class="cover-body-left">\n                        <h1 class="cover-title">News</h1>\n                    </div>\n                </div>\n            </div>\n            <div class="cover notifs">\n                <div class="cover-body">\n                    <div class="cover-body-right">\n                        <a href="#" class="notif-settings link-gray-light">Notification Settings</a>\n                    </div>\n                    <div class="cover-body-left">\n                        <h1 class="cover-title">Notifications</h1>\n                    </div>\n                </div>\n            </div>\n            <div class="cover user">\n                <div class="cover-user-avatar"><img src="https://fbcdn-profile-a.akamaihd.net/hprofile-ak-frc3/t1.0-1/p160x160/521478_10102087896730036_1593232052_n.jpg" alt=""></div>\n                <div class="cover-body">\n                    <div class="cover-body-right">\n                        <a href="#" class="btn btn-primary btn-follow" onclick="$(this).toggleClass(\'active\'); return false;"><span class="symbol-default"><span class="icon-plus"></span></span><span class="text-default">Follow</span><span class="symbol-following"><span class="icon-checkmark"></span></span><span class="text-following">Following</span></a>\n                    </div>\n                    <div class="cover-body-left">\n                        <h1 class="cover-title">Benjamin Schmidt</h1>\n                        <p class="cover-description">\n                            Product designer at Corporation. Noun at another noun. I verb all day and am married to pronoun.\n                        </p>\n\n                        \n                        <ul class="cover-attributes">\n                            <li class="cover-attribute user-upvotes" title="Upvotes received">5 <span class="icon-arrow-2"></span></li>\n                            <li class="cover-attribute bullet">San Francisco</li>\n                            <li class="cover-attribute bullet"><a href="#">website.com</a></li>\n                            <li class="cover-attribute social"><a href="#"><span class="icon-facebook-circle"></span></a></li>\n                            <li class="cover-attribute social"><a href="#"><span class="icon-twitter-circle"></span></a></li>\n                            <li class="cover-attribute social"><a href="#"><span class="icon-google-plus-circle"></span></a></li>\n                        </ul>\n                    </div>\n                </div>\n                <footer class="cover-meta">\n                    <div class="cover-meta-right">\n                        <ul class="cover-stats">\n                            <li class="cover-stat active"><a href="#"><strong>42</strong><small>Comments</small></a></li>\n                            <li class="cover-stat"><a href="#"><strong>85</strong><small>Followers</small></a></li>\n                            <li class="cover-stat"><a href="#"><strong>123</strong><small>Following</small></a></li>\n                            <li class="cover-stat"><strong>5</strong><small>Favorites</small></li>\n                        </ul>\n                    </div>\n                    <div class="cover-meta-left">\n                        <ul class="cover-attributes">\n                            <li class="cover-attribute user-upvotes" title="Upvotes received">5 <span class="icon-arrow-2"></span></li>\n                            <li class="cover-attribute bullet">San Francisco</li>\n                            <li class="cover-attribute bullet"><a href="#">website.com</a></li>\n                            <li class="cover-attribute social"><a href="#"><span class="icon-facebook-circle"></span></a></li>\n                            <li class="cover-attribute social"><a href="#"><span class="icon-twitter-circle"></span></a></li>\n                            <li class="cover-attribute social"><a href="#"><span class="icon-google-plus-circle"></span></a></li>\n                        </ul>\n                    </div>\n                </footer>\n            </div>\n            <div class="cover user">\n                <div class="cover-user-avatar"><img src="',(helper=helpers.CDN_ROOT)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.CDN_ROOT,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'/img/avatar-default.png" alt=""></div>\n                <div class="cover-body">\n                    <div class="cover-body-right">\n                        <a href="#" class="btn btn-default">Edit Profile</a>\n                    </div>\n                    <div class="cover-body-left">\n                        <h1 class="cover-title">Benjamin Schmidt</h1>\n                    </div>\n                </div>\n                <footer class="cover-meta">\n                    <div class="cover-meta-right">\n                        <ul class="stats">\n                            <li class="cover-stat"><a href="#"><strong>42</strong><small>Comments</small></a></li>\n                            <li class="cover-stat"><a href="#"><strong>85</strong><small>Followers</small></a></li>\n                            <li class="cover-stat"><a href="#"><strong>123</strong><small>Following</small></a></li>\n                            <li class="cover-stat"><strong>5</strong><small>Favorites</small></li>\n                        </ul>\n                    </div>\n                    <div class="cover-meta-left">\n                    </div>\n                </footer>\n            </div>\n\n\n            \n            \n            <div class="card">\n                <div class="spinner"></div>\n            </div>\n            \n            <div class="spinner"></div>\n\n            </div>\n\n        </div>\n'
})}),define("home/templates/preload",["handlebars","handlebars.partials"],function(Handlebars){return Handlebars.template(function(Handlebars,depth0,helpers,partials,data){return this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{},"<p></p>\n"})}),define("core/frameBus",["jquery","underscore","backbone"],function($,_,Backbone){function getUID(location){return location.hash.slice(1).replace(/(^\d+).*/,"$1")}function _origin(url){var t=url.split("/");return t[0]+"//"+t[2]}var uid=getUID(window.location),channel=window.opener||window.parent,referrer=document.referrer,origins={};origins.client=_origin(document.location.href),origins.host=referrer?_origin(referrer):origins.client;var FrameBus={getUID:getUID,origins:origins,messageHandler:function(event){event=event.originalEvent;var message;try{message=JSON.parse(event.data)}catch(e){return}if(!message.name||"!"!==message.name[0]||event.origin===origins.client)switch(message.scope){case"host":break;case"client":FrameBus.trigger(message.name,message.data)}},postMessage:function(message){message.sender=uid,message=JSON.stringify(message),channel.postMessage(message,"*")},sendHostMessage:function(name,params){params=params||[],FrameBus.postMessage({scope:"host",name:name,data:params})}};return _.extend(FrameBus,Backbone.Events),$(window).on("message",FrameBus.messageHandler),$(window).on("unload",function(){FrameBus.sendHostMessage("die")}),FrameBus}),define("core/utils",["underscore"],function(_){function colorToHex(color){function hex(x){return x=Number(x).toString(16),1===x.length?"0"+x:x}if("#"===color.substr(0,1))return color;var digits=/.*?rgb\((\d+),\s*(\d+),\s*(\d+)\)/.exec(color);if(!digits||4!==digits.length)return"";var r=hex(digits[1]),g=hex(digits[2]),b=hex(digits[3]);return"#"+r+g+b}function escapeColor(color){return colorToHex(color).replace(/[^#A-Fa-f0-9]/g,"")}function preventDefaultHandler(handler){return function(e){return e&&e.preventDefault&&e.preventDefault(),handler.apply(this,arguments)}}function getDomain(url){if(!url)return"";url="http://"+url.replace(/^([a-z+.-]+:)?\/+/i,"");var link=document.createElement("a");link.href=url;var domain=link.hostname.replace(/^www\d*\./i,"");return domain=domain.toLowerCase()}function serializeArgs(params){var pcs=[];return _.each(params,function(val,key){void 0!==val&&pcs.push(key+(null!==val?"="+encodeURIComponent(val):""))}),pcs.join("&")}function serialize(url,params,nocache){if(params&&(url+=url.indexOf("?")>-1?"&"===url.charAt(url.length-1)?"":"&":"?",url+=this.serializeArgs(params)),nocache){var ncp={};return ncp[(new Date).getTime()]=null,this.serialize(url,ncp)}var len=url.length;return"&"===url.charAt(len-1)?url.slice(0,len-1):url}var emailPatt=/^[a-z0-9_.%+\-]+@[0-9a-z.\-]+\.[a-z.]{2,6}$/i,validateEmail=function(email){return emailPatt.test(email)},htmlDecode=function(text){var el=document.createElement("div");return el.innerHTML=text,0===el.childNodes.length?"":el.childNodes[0].nodeValue},TLDS="zw|zm|za|yu|yt|ye|xn|ws|wf|vu|vn|vi|vg|ve|vc|va|uz|uy|us|uk|ug|ua|tz|tw|tv|tt|travel|tr|tp|to|tn|tm|tl|tk|tj|th|tg|tf|tel|td|tc|sz|sy|sv|su|st|sr|so|sn|sm|sl|sk|sj|si|sh|sg|se|sd|sc|sb|sa|rw|ru|rs|ro|re|qa|py|pw|pt|ps|pro|pr|pn|pm|pl|pk|ph|pg|pf|pe|pa|org|om|nz|nu|nr|np|no|nl|ni|ng|nf|net|ne|nc|name|na|mz|my|mx|mw|mv|museum|mu|mt|ms|mr|mq|mp|mobi|mo|mn|mm|ml|mk|mil|mh|mg|me|md|mc|ma|ly|lv|lu|lt|ls|lr|lk|li|lc|lb|la|kz|ky|kw|kr|kp|kn|km|ki|kh|kg|ke|jp|jobs|jo|jm|je|it|is|ir|iq|io|int|info|in|im|il|ie|id|hu|ht|hr|hn|hm|hk|gy|gw|gu|gt|gs|gr|gq|gp|gov|gn|gm|gl|gi|gh|gg|gf|ge|gd|gb|ga|fr|fo|fm|fk|fj|fi|eu|et|es|er|eg|ee|edu|ec|dz|do|dm|dk|dj|de|cz|cy|cx|cv|cu|cr|coop|com|co|cn|cm|cl|ck|ci|ch|cg|cf|cd|cc|cat|ca|bz|by|bw|bv|bt|bs|br|bo|bn|bm|bj|biz|bi|bh|bg|bf|be|bd|bb|ba|az|ax|aw|au|at|asia|as|arpa|ar|aq|ao|an|am|al|ai|ag|af|aero|ae|ad|ac|",URL_RE=new RegExp("([^@.]|^)\\b(?:\\w[\\w-]*:/{0,3}(?:(?:\\w+:)?\\w+@)?)?([\\w-]+\\.)+(?:"+TLDS+')(?!\\.\\w)\\b(?:[/?][^\\s\\{\\}\\|\\\\\\^\\[\\]`<>"\\x80-\\xFF\\x00-\\x1F\\x7F]*)?',"g"),isUrl=function(urlStr){return!!urlStr.match(URL_RE)},terminatingPuncRe=new RegExp("[\\u0021-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007E\\u00A1-\\u00BF\\u2010-\\u2027\\u2030-\\u205E\\u2300-\\u23FF\\u2E00-\\u2E7F\\u3001-\\u303F\\uFE10-\\uFE19\\uFE30-\\uFE4F\\uFE50-\\uFE6B\\uFF01-\\uFF0F\\uFF1A-\\uFF20\\uFF3B-\\uFF40\\uFF5B-\\uFF60\\uFF5F-\\uFF64]+$"),niceTruncate=function(text,upperLimit){if(text.length<=upperLimit)return text;text=text.slice(0,upperLimit-1);var max=text,matches=/(^.*\S)\s/.exec(text);matches&&(text=matches[1]);var endPunctuation=terminatingPuncRe.exec(text);return endPunctuation&&(text=text.slice(0,text.length-endPunctuation[0].length)),text.length<.5*max.length&&(text=max),text+"…"},transitionEndEvent=function(){var el=document.createElement("fakeelement"),transitions={transition:"transitionend",OTransition:"otransitionend",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(var t in transitions)if(void 0!==el.style[t])return transitions[t];return null}(),isMobile=function(win){var userAgent=win.navigator.userAgent;return-1!==userAgent.indexOf("Mobi")},isPhone=function(win){return isMobile(win)&&-1===win.navigator.userAgent.indexOf("iPad")},strip=function(html){var tmp=document.createElement("DIV");return tmp.innerHTML=html,tmp.textContent||tmp.innerText};return{validateEmail:validateEmail,isUrl:isUrl,htmlDecode:htmlDecode,niceTruncate:niceTruncate,transitionEndEvent:transitionEndEvent,isMobile:isMobile,isPhone:isPhone,strip:strip,escapeColor:escapeColor,preventDefaultHandler:preventDefaultHandler,getDomain:getDomain,serializeArgs:serializeArgs,serialize:serialize}}),define("core/config",[],function(){return{urls:{avatar:{generic:"//a.disquscdn.com/current/images/noavatar92.png"},api:"//disqus.com/api/3.0/",apiSecure:"https://disqus.com/api/3.0/"},keys:{api:"E8Uh5l5fHZ6gD8U3KycjAIAk46f68Zw7C6eW8WSjZvCLXebZ7p0r1yrYDrLilk2F"},debug:!1}}),define("core/api",["jquery","underscore","backbone","core/config"],function($,_,Backbone,config){function parseOrigin(url){return anchor.href=url,_.pick(anchor,"hostname","protocol","port")}function useFormTransport(options){return api.xhrSupportsCredentialedRequests?!1:isCrossOrigin(window.location,options.url)}function isCrossOrigin(source,target){var sourceParts=parseOrigin(source),targetParts=parseOrigin(target),protocol=window.location.protocol;return":"===sourceParts.protocol&&(sourceParts.protocol=protocol),":"===targetParts.protocol&&(targetParts.protocol=protocol),targetParts.protocol!==sourceParts.protocol||targetParts.hostname!==sourceParts.hostname||targetParts.port!==sourceParts.port}function formTransport(options){function callback(event){var origin=event.originalEvent.origin;if(config.urls.apiSecure.slice(0,origin.length)===origin){var message=JSON.parse(event.originalEvent.data);if(message.requestId===uid){var func=0===message.code?options.success:options.error;func=func||function(){},delete message.requestId,func(message),document.body.removeChild(frame),document.body.removeChild(form),$(window).off("message",callback)}}}options=_.defaults(options,defaults),options.secure&&(options.url=makeHttps(options.url));var frame,uid=_.uniqueId("ft_"),div=document.createElement("div"),form=document.createElement("form"),fname="frame_"+uid;div.innerHTML='<iframe name="'+fname+'"></iframe>',frame=div.childNodes[0],form.target=fname,form.action=options.url.replace(".json",".pm"),form.method=options.method||"GET",options.data=_.extend(options.data,{callback:uid,referrer:document.referrer}),_.each(options.data,function(value,key){value===!0?value=[1]:value===!1?value=[0]:null===value?value=[""]:_.isArray(value)||(value=[value]),_.each(value,function(v){var el=document.createElement("input");el.type="hidden",el.name=key,el.value=v,form.appendChild(el)})}),$(window).on("message",callback),document.body.appendChild(frame),document.body.appendChild(form),form.submit()}function makeHttps(url){return url.replace(/^(http\:)?\/\//,"https://")}function ajaxTransport(options){options=_.defaults(options,defaults),options.secure&&(options.url=makeHttps(options.url)),options.traditional=!0;var location=window.location;anchor.href=options.url,(location.host!==anchor.host||location.protocol!==anchor.protocol)&&(options.xhrFields={withCredentials:!0}),options.omitDisqusApiKey||(options.data=options.data||{},options.data.api_key=config.keys.api);var originalErrorHandler=options.error;return options.error=function(xhr){api.trigger("error",xhr),_.isFunction(originalErrorHandler)&&originalErrorHandler(xhr)},$.ajax(options)}function call(endpoint,options){options=options||{},options.url=getURL(endpoint,{secure:options.secure}),options.data=_.extend(options.data||{},{api_key:config.keys.api}),api.trigger("call",options);var promise=(useFormTransport(options)?formTransport:ajaxTransport)(options);return promise&&promise.always(_.bind(this.trigger,this,"complete")),promise}function getURL(endpoint,options){return options=options||{},/(https?\:)?\/\//.test(endpoint)?endpoint:(void 0!==options.secure?options.secure:defaults.secure)||"https:"===window.location.protocol?config.urls.apiSecure+endpoint:config.urls.api+endpoint}var anchor=document.createElement("a"),defaults={},xhrSupportsCredentialedRequests="withCredentials"in new XMLHttpRequest,api={ajax:ajaxTransport,call:call,getURL:getURL,defaults:function(options){var key,value,existingValue;for(key in options)value=options[key],existingValue=defaults[key],_.isObject(value)&&_.isObject(existingValue)?_.extend(existingValue,value):defaults[key]=value},headers:function(headers){var newHeaders=_.extend({},defaults.headers,headers);return defaults.headers=_.pick(newHeaders,_.map(newHeaders,function(v,k){return v?k:void 0})),defaults.headers},useFormTransport:useFormTransport,xhrSupportsCredentialedRequests:xhrSupportsCredentialedRequests,makeHttps:makeHttps};return _.extend(api,Backbone.Events),api}),define("core/models/BaseUser",["backbone","core/config"],function(Backbone,config){var BaseUser=Backbone.Model.extend({defaults:{about:null,avatar:{cache:config.urls.avatar.generic,permalink:config.urls.avatar.generic},connections:{},email:null,isAnonymous:!0,isFollowedBy:null,isFollowing:null,joinedAt:null,name:null,profileUrl:null,url:null,username:null,numPosts:null,numFollowing:null,numFollowers:null,numLikesReceived:null},hasValidAvatar:function(attrs){attrs||(attrs=this.attributes);var avatar=attrs.avatar;return avatar&&avatar.cache},isAnonymous:function(){return!this.get("id")},isRegistered:function(){return!this.isAnonymous()},validate:function(attrs){return this.hasValidAvatar(attrs)?void 0:"None of the avatar related properties can be null, undefined or empty on User models."},toJSON:function(){var data=Backbone.Model.prototype.toJSON.apply(this,arguments);return data.thread={},this.hasValidAvatar()||(data.avatar=this.defaults.avatar),data.isRegistered=this.isRegistered(),data}});return BaseUser}),define("core/strings",[],function(){function get(text){var trans=exports.translations[text];return void 0!==trans?trans:text}function interpolate(string,ctx){function fromContext(key){var result="";return key in ctx?result=void 0!==ctx[key]&&null!==ctx[key]?ctx[key].toString():"":DISQUS&&DISQUS.logError&&DISQUS.logError("Key `"+key+"` not found in context for: ",string),result}return string.replace(/%\(\w+\)s/g,function(match){return fromContext(match.slice(2,-2))})}var exports={get:get,interpolate:interpolate,translations:{}};return exports}),define("core/models/User",["underscore","backbone","core/config","core/utils","core/strings","core/api","core/models/BaseUser"],function(_,Backbone,config,utils,strings,api,BaseUser){function addError(validationErrors,name,error){validationErrors[name]=validationErrors[name]||[],validationErrors[name].push(error)}var gettext=strings.get,User=BaseUser.extend({validate:function(attrs){var validationErrors={};return attrs.display_name||addError(validationErrors,"display_name",gettext("Please enter your name.")),attrs.email||addError(validationErrors,"email",gettext("Please enter your email address.")),utils.validateEmail(attrs.email)||addError(validationErrors,"email",gettext("Invalid email address.")),this.isNew()&&(attrs.password?attrs.password.length<User.MIN_PASSWORD_LEN&&addError(validationErrors,"password",gettext("Password must have at least 6 characters.")):addError(validationErrors,"password",gettext("Please enter a password."))),attrs.name&&(attrs.name.length<User.MIN_NAME_LEN&&addError(validationErrors,"name",strings.interpolate(gettext("Name must have at least %(minLength)s characters."),{minLength:User.MIN_NAME_LEN})),attrs.name.length>User.MAX_NAME_LEN&&addError(validationErrors,"name",strings.interpolate(gettext("Name must have less than %(maxLength)s characters."),{maxLength:User.MAX_NAME_LEN}))),attrs.location&&attrs.location.length>User.MAX_LOCATION_LEN&&addError(validationErrors,"location",strings.interpolate(gettext("Location must have less than %(maxLength)s characters."),{maxLength:User.MAX_LOCATION_LEN})),attrs.url&&(attrs.url.length>User.MAX_URL_LEN&&addError(validationErrors,"url",strings.interpolate(gettext("Site must have less than %(maxLength)s characters."),{maxLength:User.MAX_URL_LEN})),utils.isUrl(attrs.url)||addError(validationErrors,"url",gettext("Please enter a valid site."))),_.isEmpty(validationErrors)?void 0:validationErrors},fetch:function(options){var self=this;options=options||{};var data={};return self.id?data.user=self.id:self.get("username")&&(data.user="username:"+self.get("username")),api.call("users/details.json",{data:data,success:function(data){data=data.response,self.set(data),options.success&&options.success(data),options.complete&&options.complete(data),self.trigger("sync",self,data,options)},error:function(data){options.error&&options.error(data),options.complete&&options.complete(data)}})},register:function(options){var self=this;options=options||{},api.call("internal/users/register.json",{secure:!0,data:this.toRegisterJSON(),method:"POST",success:function(data){self.set(data.response),options.success&&options.success(data)},error:options.error})},saveAvatar:function(fileInput){var formData=new FormData;return formData.append("avatar_file",fileInput),formData.append("api_key",config.keys.api),api.call("internal/users/updateAvatar.json",{method:"post",data:formData,cache:!1,contentType:!1,processData:!1})},saveProfile:function(){return api.call("users/updateProfile.json",{method:"POST",data:{name:this.get("name"),about:this.get("about"),location:this.get("location"),url:this.get("url")}})},toRegisterJSON:function(){return _.pick(this.toJSON(),"display_name","email","password")},isSession:function(session){return session.user.id&&session.user.id===this.id},isEditable:function(session){return this.isSession(session)&&!this.get("remote")},toJSON:function(options){options=options||{};var json=BaseUser.prototype.toJSON.call(this),thread=this.collection&&this.collection.thread;return json.thread.canModerate=!!thread&&thread.isModerator(this),options.session&&(json.isSession=this.isSession(options.session),json.isEditable=this.isEditable(options.session)),json},_changeFollowState:function(state){this.set("isFollowing",state);var endpoint="users/"+(state?"follow":"unfollow"),self=this;api.call(endpoint+".json",{data:{target:this.id},method:"POST",success:function(resp){self.trigger("sync",self,resp,{})}})},follow:function(){this._changeFollowState(!0)},unfollow:function(){this._changeFollowState(!1)},toggleFollowState:function(){this._changeFollowState(!this.get("isFollowing"))}},{MIN_PASSWORD_LEN:6,MIN_NAME_LEN:2,MAX_NAME_LEN:30,MAX_LOCATION_LEN:255,MAX_URL_LEN:200});return User}),define("core/models/Session",["underscore","backbone","core/api","core/models/BaseUser","core/models/User"],function(_,Backbone,api,BaseUser,User){var Session=Backbone.Model.extend({initialize:function(){this.user=new this.getAnonUserInstance},setUser:function(user){this.user&&this.stopListening(this.user),this.user=user,this.listenTo(user,"all",this.trigger),this.trigger("change:id",user)},isLoggedOut:function(){return!this.isLoggedIn()},isLoggedIn:function(){return!!this.user.get("id")},fetch:function(options){options=options||{};var data={};return data["_"+(new Date).getTime()]=1,api.call("users/details.json",{data:data,success:_.bind(function(data){data=data.response,data.id&&this.setUser(this.getUserInstance(data)),options.success&&options.success(data),options.complete&&options.complete(data)},this),error:_.bind(function(data){options.error&&options.error(data),options.complete&&options.complete(data)},this)})},getAnonUserInstance:function(attrs){return new BaseUser(attrs)},getUserInstance:function(attrs){return new User(attrs)}});return Session}),define("home/models/common/UniqueModel",["underscore"],function(_){var UniqueModel=function(Model,attrs,options){var pool=UniqueModel.pool(Model),key=attrs&&attrs[Model.prototype.idAttribute];if(!key)return new Model(attrs,options);var instance=UniqueModel.get(Model,key);return instance?pool[key].set(attrs):pool[key]=new Model(attrs,options),pool[key]};return UniqueModel.pool={},UniqueModel.pool=function(Model){var pool=UniqueModel.pool[Model.__type__];if(!pool)throw new Error("Model not registered. Use UniqueModel.addType");return pool},UniqueModel.get=function(Model,key){return UniqueModel.pool(Model)[key]},UniqueModel.set=function(Model,model){var pool=UniqueModel.pool(Model),key=model&&model.get(Model.prototype.idAttribute);if(!key)return model;var instance=UniqueModel.get(Model,key);return instance?instance.set(model.attributes):instance=pool[key]=model,instance},UniqueModel.addType=function(name,obj){obj.__type__&&UniqueModel.pool[name]||(obj.__type__=name,UniqueModel.pool[name]={})},UniqueModel.boundModel=function(Model){var constructor=_.bind(UniqueModel,UniqueModel,Model);return constructor.prototype=Model.prototype,constructor},UniqueModel}),define("home/models/Topic",["underscore","backbone","home/models/common/UniqueModel"],function(_,Backbone,UniqueModel){var Topic=Backbone.Model.extend({defaults:{name:null},initialize:function(){if(!this.get("name"))throw"Topic must be initialized with a name"},getTitle:function(){return this.get("name")}});return UniqueModel.addType("Topic",Topic),Topic}),define("home/mixins/withRelatedTopics",["underscore","backbone","home/models/common/UniqueModel","home/models/Topic","core/api"],function(_,Backbone,UniqueModel,Topic,api){var fetchTopics=function(){return Backbone.ajax({url:api.getURL("forums/listTopics?forum="+this.get("id")),success:function(data){var topics=_.map(data.response,function(topic){return new UniqueModel(Topic,topic)}),Collections=require("home/apps/dashboard/collections");this.topics=new Collections.TopicCollection(topics),this.trigger("change:topics")},context:this})},withRelatedTopics=function(){this.fetchTopics=fetchTopics;var _toJSON=this.toJSON;this.toJSON=function(){return _.extend({},_toJSON.apply(this,arguments),{topics:this.topics?this.topics.toJSON():[]})}};return withRelatedTopics}),define("home/models/Forum",["underscore","backbone","require","home/mixins/withRelatedTopics","home/models/common/UniqueModel","core/api"],function(_,Backbone,require,withRelatedTopics,UniqueModel,api){var Forum=Backbone.Model.extend({defaults:{followUrl:api.getURL("forums/follow"),unfollowUrl:api.getURL("forums/unfollow"),followed:!1},getFriendlyUrl:function(){var url=this.get("url")||"";return url.replace(/^https?:\/\//,"").replace(/\/$/,"")},initialize:function(attrs,options){if(!this.get("id"))throw"Forum must be initialized with an id";this.buildChannel(options)},buildChannel:function(options){var channel=options&&options.channel||this.get("channel");if(!channel)return void this.listenToOnce(this,"change:channel",_.bind(this.buildChannel,this,options));var Channel=require("home/models/Channel");this.initializeRelated("channel",_.defaults({primaryForum:this},options),Channel)},url:function(){return api.getURL("forums/details?forum="+this.get("id"))},parse:function(response){return response.response||response},shouldFetch:function(){return!this.get("name")},hasFavicon:function(){var favicon=(this.get("favicon")||{}).cache;return favicon&&!favicon.match(/favicon-default\.png/)},_changeFollowingState:function(url){var self=this;return Backbone.ajax({url:url,type:"POST",data:{target:self.get("id")},success:function(){self.trigger("sync:change:followed",self,self.get("followed"))}})},follow:function(){this.set("followed",!0);var Session=require("home/models/Session"),session=new Session,sessionUser=session.user;return sessionUser.trigger("followed:forum",this),this._changeFollowingState(this.get("followUrl"))},unfollow:function(){this.set("followed",!1);var Session=require("home/models/Session"),session=new Session,sessionUser=session.user;return sessionUser.trigger("unfollowed:forum",this),this._changeFollowingState(this.get("unfollowUrl"))},toggleFollowed:function(){return this.get("followed")?this.unfollow():this.follow()},toJSON:function(){var existing=Backbone.Model.prototype.toJSON.apply(this,arguments);return _.defaults({forumRoute:this.getForumRoute()},existing)},getForumRoute:function(){var route=this.channel?["channel",this.channel.id]:["forum",this.id];return route.join("/")}});return withRelatedTopics.call(Forum.prototype),UniqueModel.addType("Forum",Forum),Forum}),define("home/utils/backboneUtils",["jquery"],function($){return{memoizedFetch:function(){if(this.fetchPromise)return this.fetchPromise;var self=this;return this.fetchPromise=this.constructor.__super__.fetch.apply(this,arguments).then(function(){return self.fetchPromise=null,self.fetched=!0,arguments},function(err){return self.fetchPromise=null,err}),this.fetchPromise},getPromiseFor:function(model,attributeName){var attributeValue=$.Deferred();return model.get(attributeName)?attributeValue.resolve(model.get(attributeName)):model.once("change:"+attributeName,function(model,value){attributeValue.resolve(value)}),attributeValue.promise()}}}),define("home/apps/common/backboneUtils",["home/utils/backboneUtils"],function(backboneUtils){return backboneUtils}),define("home/models/common/BaseUser",["backbone","core/config"],function(Backbone,config){var BaseUser=Backbone.Model.extend({defaults:{id:null,username:null,name:null,avatar:{cache:config.urls.avatar.generic,permalink:config.urls.avatar.generic},joinedAt:null,isAnonymous:!0,numFollowers:null,numFollowing:null,numPosts:null,numForumsFollowing:null}});return BaseUser}),define("home/models/User",["underscore","backbone","home/apps/common/backboneUtils","home/models/common/UniqueModel","home/models/common/BaseUser","core/api","core/config"],function(_,Backbone,BackboneUtils,UniqueModel,BaseUser,api,config){var User=BaseUser.extend({defaults:_.defaults({followUrl:api.getURL("users/follow"),unfollowUrl:api.getURL("users/unfollow")},BaseUser.prototype.defaults),idAttribute:"username",url:api.getURL("users/details"),initialize:function(){var Session=require("home/models/Session");this.session=new Session,this.listenTo(this,"followed:user",this.handleFollowedUser),this.listenTo(this,"unfollowed:user",this.handleUnfollowedUser),this.listenTo(this,"followed:forum",this.handleFollowedForum),this.listenTo(this,"unfollowed:forum",this.handleUnfollowedForum)},shouldFetch:function(){return!(this.get("name")&&this.has("numFollowers")&&this.has("numFollowing")&&this.has("numForumsFollowing"))},isSessionUser:function(){return this===this.session.user},parse:function(response){return response.response||response},fetch:function(options){return options=options||{},options.data=options.data||{},options.data.user=options.data.user||this.get("username")?"username:"+this.get("username"):this.get("id"),BackboneUtils.memoizedFetch.call(this,options)},toggleFollowed:function(){return this.get("isFollowing")?this.unfollow():this.follow()},_changeFollowingState:function(url){var self=this;return Backbone.ajax({url:url,type:"POST",data:{target:self.get("id")}})},follow:function(){this.set({isFollowing:!0,numFollowers:this.get("numFollowers")+1});var sessionUser=this.session.user;return sessionUser.trigger("followed:user",this),this._changeFollowingState(this.get("followUrl"))},unfollow:function(){this.set({isFollowing:!1,numFollowers:Math.max(0,this.get("numFollowers")-1)});var sessionUser=this.session.user;return sessionUser.trigger("unfollowed:user",this),this._changeFollowingState(this.get("unfollowUrl"))},handleFollowedUser:function(){this.set({numFollowing:this.get("numFollowing")+1})},handleUnfollowedUser:function(){this.set({numFollowing:Math.max(0,this.get("numFollowing")-1)})},handleFollowedForum:function(){this.set({numForumsFollowing:this.get("numForumsFollowing")+1})},handleUnfollowedForum:function(){this.set({numForumsFollowing:Math.max(0,this.get("numForumsFollowing")-1)})},toJSON:function(){var result=this.constructor.__super__.toJSON.apply(this,arguments);return result.isRegistered=!result.isAnonymous,result.displayName=result.name||result.username||"Guest",result.avatar.cache=result.avatar.cache||config.urls.avatar.generic,result}});return UniqueModel.addType("User",User),User}),define("core/collections/PaginatedCollection",["underscore","backbone"],function(_,Backbone){var PaginatedCollection=Backbone.Collection.extend({PER_PAGE:30,initialize:function(model,opts){opts=opts||{},this.cursor=opts.cursor||{}},fetch:function(options){return options=options||{},options.data=_.defaults(options.data||{},{cursor:options.cursor||"",limit:options.PER_PAGE||this.PER_PAGE}),Backbone.Collection.prototype.fetch.call(this,options)},hasNext:function(){return this.cursor.hasNext},more:function(options){function accum(model){added.push(model)}var self=this;if(options=options||{},!this.cursor.hasNext)return void self.trigger("nodata");var added=[];this.on("add",accum),this.fetch(_.extend({},options,{add:!0,remove:!1,cursor:this.cursor.next,limit:this.PER_PAGE,success:function(){self.trigger("add:many",added,self,options),self.off("add",accum),options.success&&options.success.apply(this,arguments)}}))},parse:function(response){return this.cursor=response.cursor||{hasNext:!1},response.response},getLength:function(){return this.length}});return PaginatedCollection}),define("home/collections/UserCollection",["underscore","require","core/collections/PaginatedCollection","home/models/common/UniqueModel","home/models/User"],function(_,require,PaginatedCollection,UniqueModel,User){var UserCollection=PaginatedCollection.extend({model:UniqueModel.boundModel(User),initialize:function(models,options){options&&options.url&&(this.url=options.url)}});return UserCollection}),function(undefined){function dfl(a,b,c){switch(arguments.length){case 2:return null!=a?a:b;case 3:return null!=a?a:null!=b?b:c;default:throw new Error("Implement me")}}function defaultParsingFlags(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1}}function printMsg(msg){moment.suppressDeprecationWarnings===!1&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+msg)}function deprecate(msg,fn){var firstTime=!0;return extend(function(){return firstTime&&(printMsg(msg),firstTime=!1),fn.apply(this,arguments)},fn)}function deprecateSimple(name,msg){deprecations[name]||(printMsg(msg),deprecations[name]=!0)}function padToken(func,count){return function(a){return leftZeroFill(func.call(this,a),count)}}function ordinalizeToken(func,period){return function(a){return this.localeData().ordinal(func.call(this,a),period)}}function Locale(){}function Moment(config,skipOverflow){skipOverflow!==!1&&checkOverflow(config),copyConfig(this,config),this._d=new Date(+config._d)}function Duration(duration){var normalizedInput=normalizeObjectUnits(duration),years=normalizedInput.year||0,quarters=normalizedInput.quarter||0,months=normalizedInput.month||0,weeks=normalizedInput.week||0,days=normalizedInput.day||0,hours=normalizedInput.hour||0,minutes=normalizedInput.minute||0,seconds=normalizedInput.second||0,milliseconds=normalizedInput.millisecond||0;this._milliseconds=+milliseconds+1e3*seconds+6e4*minutes+36e5*hours,this._days=+days+7*weeks,this._months=+months+3*quarters+12*years,this._data={},this._locale=moment.localeData(),this._bubble()}function extend(a,b){for(var i in b)b.hasOwnProperty(i)&&(a[i]=b[i]);return b.hasOwnProperty("toString")&&(a.toString=b.toString),b.hasOwnProperty("valueOf")&&(a.valueOf=b.valueOf),a}function copyConfig(to,from){var i,prop,val;if("undefined"!=typeof from._isAMomentObject&&(to._isAMomentObject=from._isAMomentObject),"undefined"!=typeof from._i&&(to._i=from._i),"undefined"!=typeof from._f&&(to._f=from._f),"undefined"!=typeof from._l&&(to._l=from._l),"undefined"!=typeof from._strict&&(to._strict=from._strict),"undefined"!=typeof from._tzm&&(to._tzm=from._tzm),"undefined"!=typeof from._isUTC&&(to._isUTC=from._isUTC),"undefined"!=typeof from._offset&&(to._offset=from._offset),"undefined"!=typeof from._pf&&(to._pf=from._pf),"undefined"!=typeof from._locale&&(to._locale=from._locale),momentProperties.length>0)for(i in momentProperties)prop=momentProperties[i],val=from[prop],"undefined"!=typeof val&&(to[prop]=val);return to}function absRound(number){return 0>number?Math.ceil(number):Math.floor(number)}function leftZeroFill(number,targetLength,forceSign){for(var output=""+Math.abs(number),sign=number>=0;output.length<targetLength;)output="0"+output;return(sign?forceSign?"+":"":"-")+output}function positiveMomentsDifference(base,other){var res={milliseconds:0,months:0};return res.months=other.month()-base.month()+12*(other.year()-base.year()),base.clone().add(res.months,"M").isAfter(other)&&--res.months,res.milliseconds=+other-+base.clone().add(res.months,"M"),res}function momentsDifference(base,other){var res;return other=makeAs(other,base),base.isBefore(other)?res=positiveMomentsDifference(base,other):(res=positiveMomentsDifference(other,base),res.milliseconds=-res.milliseconds,res.months=-res.months),res}function createAdder(direction,name){return function(val,period){var dur,tmp;return null===period||isNaN(+period)||(deprecateSimple(name,"moment()."+name+"(period, number) is deprecated. Please use moment()."+name+"(number, period)."),tmp=val,val=period,period=tmp),val="string"==typeof val?+val:val,dur=moment.duration(val,period),addOrSubtractDurationFromMoment(this,dur,direction),this}}function addOrSubtractDurationFromMoment(mom,duration,isAdding,updateOffset){var milliseconds=duration._milliseconds,days=duration._days,months=duration._months;updateOffset=null==updateOffset?!0:updateOffset,milliseconds&&mom._d.setTime(+mom._d+milliseconds*isAdding),days&&rawSetter(mom,"Date",rawGetter(mom,"Date")+days*isAdding),months&&rawMonthSetter(mom,rawGetter(mom,"Month")+months*isAdding),updateOffset&&moment.updateOffset(mom,days||months)}function isArray(input){return"[object Array]"===Object.prototype.toString.call(input)}function isDate(input){return"[object Date]"===Object.prototype.toString.call(input)||input instanceof Date}function compareArrays(array1,array2,dontConvert){var i,len=Math.min(array1.length,array2.length),lengthDiff=Math.abs(array1.length-array2.length),diffs=0;for(i=0;len>i;i++)(dontConvert&&array1[i]!==array2[i]||!dontConvert&&toInt(array1[i])!==toInt(array2[i]))&&diffs++;return diffs+lengthDiff}function normalizeUnits(units){if(units){var lowered=units.toLowerCase().replace(/(.)s$/,"$1");units=unitAliases[units]||camelFunctions[lowered]||lowered}return units}function normalizeObjectUnits(inputObject){var normalizedProp,prop,normalizedInput={};for(prop in inputObject)inputObject.hasOwnProperty(prop)&&(normalizedProp=normalizeUnits(prop),normalizedProp&&(normalizedInput[normalizedProp]=inputObject[prop]));return normalizedInput}function makeList(field){var count,setter;if(0===field.indexOf("week"))count=7,setter="day";else{if(0!==field.indexOf("month"))return;count=12,setter="month"
}moment[field]=function(format,index){var i,getter,method=moment._locale[field],results=[];if("number"==typeof format&&(index=format,format=undefined),getter=function(i){var m=moment().utc().set(setter,i);return method.call(moment._locale,m,format||"")},null!=index)return getter(index);for(i=0;count>i;i++)results.push(getter(i));return results}}function toInt(argumentForCoercion){var coercedNumber=+argumentForCoercion,value=0;return 0!==coercedNumber&&isFinite(coercedNumber)&&(value=coercedNumber>=0?Math.floor(coercedNumber):Math.ceil(coercedNumber)),value}function daysInMonth(year,month){return new Date(Date.UTC(year,month+1,0)).getUTCDate()}function weeksInYear(year,dow,doy){return weekOfYear(moment([year,11,31+dow-doy]),dow,doy).week}function daysInYear(year){return isLeapYear(year)?366:365}function isLeapYear(year){return year%4===0&&year%100!==0||year%400===0}function checkOverflow(m){var overflow;m._a&&-2===m._pf.overflow&&(overflow=m._a[MONTH]<0||m._a[MONTH]>11?MONTH:m._a[DATE]<1||m._a[DATE]>daysInMonth(m._a[YEAR],m._a[MONTH])?DATE:m._a[HOUR]<0||m._a[HOUR]>23?HOUR:m._a[MINUTE]<0||m._a[MINUTE]>59?MINUTE:m._a[SECOND]<0||m._a[SECOND]>59?SECOND:m._a[MILLISECOND]<0||m._a[MILLISECOND]>999?MILLISECOND:-1,m._pf._overflowDayOfYear&&(YEAR>overflow||overflow>DATE)&&(overflow=DATE),m._pf.overflow=overflow)}function isValid(m){return null==m._isValid&&(m._isValid=!isNaN(m._d.getTime())&&m._pf.overflow<0&&!m._pf.empty&&!m._pf.invalidMonth&&!m._pf.nullInput&&!m._pf.invalidFormat&&!m._pf.userInvalidated,m._strict&&(m._isValid=m._isValid&&0===m._pf.charsLeftOver&&0===m._pf.unusedTokens.length)),m._isValid}function normalizeLocale(key){return key?key.toLowerCase().replace("_","-"):key}function chooseLocale(names){for(var j,next,locale,split,i=0;i<names.length;){for(split=normalizeLocale(names[i]).split("-"),j=split.length,next=normalizeLocale(names[i+1]),next=next?next.split("-"):null;j>0;){if(locale=loadLocale(split.slice(0,j).join("-")))return locale;if(next&&next.length>=j&&compareArrays(split,next,!0)>=j-1)break;j--}i++}return null}function loadLocale(name){var oldLocale=null;if(!locales[name]&&hasModule)try{oldLocale=moment.locale(),require("./locale/"+name),moment.locale(oldLocale)}catch(e){}return locales[name]}function makeAs(input,model){return model._isUTC?moment(input).zone(model._offset||0):moment(input).local()}function removeFormattingTokens(input){return input.match(/\[[\s\S]/)?input.replace(/^\[|\]$/g,""):input.replace(/\\/g,"")}function makeFormatFunction(format){var i,length,array=format.match(formattingTokens);for(i=0,length=array.length;length>i;i++)array[i]=formatTokenFunctions[array[i]]?formatTokenFunctions[array[i]]:removeFormattingTokens(array[i]);return function(mom){var output="";for(i=0;length>i;i++)output+=array[i]instanceof Function?array[i].call(mom,format):array[i];return output}}function formatMoment(m,format){return m.isValid()?(format=expandFormat(format,m.localeData()),formatFunctions[format]||(formatFunctions[format]=makeFormatFunction(format)),formatFunctions[format](m)):m.localeData().invalidDate()}function expandFormat(format,locale){function replaceLongDateFormatTokens(input){return locale.longDateFormat(input)||input}var i=5;for(localFormattingTokens.lastIndex=0;i>=0&&localFormattingTokens.test(format);)format=format.replace(localFormattingTokens,replaceLongDateFormatTokens),localFormattingTokens.lastIndex=0,i-=1;return format}function getParseRegexForToken(token,config){var a,strict=config._strict;switch(token){case"Q":return parseTokenOneDigit;case"DDDD":return parseTokenThreeDigits;case"YYYY":case"GGGG":case"gggg":return strict?parseTokenFourDigits:parseTokenOneToFourDigits;case"Y":case"G":case"g":return parseTokenSignedNumber;case"YYYYYY":case"YYYYY":case"GGGGG":case"ggggg":return strict?parseTokenSixDigits:parseTokenOneToSixDigits;case"S":if(strict)return parseTokenOneDigit;case"SS":if(strict)return parseTokenTwoDigits;case"SSS":if(strict)return parseTokenThreeDigits;case"DDD":return parseTokenOneToThreeDigits;case"MMM":case"MMMM":case"dd":case"ddd":case"dddd":return parseTokenWord;case"a":case"A":return config._locale._meridiemParse;case"X":return parseTokenTimestampMs;case"Z":case"ZZ":return parseTokenTimezone;case"T":return parseTokenT;case"SSSS":return parseTokenDigits;case"MM":case"DD":case"YY":case"GG":case"gg":case"HH":case"hh":case"mm":case"ss":case"ww":case"WW":return strict?parseTokenTwoDigits:parseTokenOneOrTwoDigits;case"M":case"D":case"d":case"H":case"h":case"m":case"s":case"w":case"W":case"e":case"E":return parseTokenOneOrTwoDigits;case"Do":return parseTokenOrdinal;default:return a=new RegExp(regexpEscape(unescapeFormat(token.replace("\\","")),"i"))}}function timezoneMinutesFromString(string){string=string||"";var possibleTzMatches=string.match(parseTokenTimezone)||[],tzChunk=possibleTzMatches[possibleTzMatches.length-1]||[],parts=(tzChunk+"").match(parseTimezoneChunker)||["-",0,0],minutes=+(60*parts[1])+toInt(parts[2]);return"+"===parts[0]?-minutes:minutes}function addTimeToArrayFromToken(token,input,config){var a,datePartArray=config._a;switch(token){case"Q":null!=input&&(datePartArray[MONTH]=3*(toInt(input)-1));break;case"M":case"MM":null!=input&&(datePartArray[MONTH]=toInt(input)-1);break;case"MMM":case"MMMM":a=config._locale.monthsParse(input),null!=a?datePartArray[MONTH]=a:config._pf.invalidMonth=input;break;case"D":case"DD":null!=input&&(datePartArray[DATE]=toInt(input));break;case"Do":null!=input&&(datePartArray[DATE]=toInt(parseInt(input,10)));break;case"DDD":case"DDDD":null!=input&&(config._dayOfYear=toInt(input));break;case"YY":datePartArray[YEAR]=moment.parseTwoDigitYear(input);break;case"YYYY":case"YYYYY":case"YYYYYY":datePartArray[YEAR]=toInt(input);break;case"a":case"A":config._isPm=config._locale.isPM(input);break;case"H":case"HH":case"h":case"hh":datePartArray[HOUR]=toInt(input);break;case"m":case"mm":datePartArray[MINUTE]=toInt(input);break;case"s":case"ss":datePartArray[SECOND]=toInt(input);break;case"S":case"SS":case"SSS":case"SSSS":datePartArray[MILLISECOND]=toInt(1e3*("0."+input));break;case"X":config._d=new Date(1e3*parseFloat(input));break;case"Z":case"ZZ":config._useUTC=!0,config._tzm=timezoneMinutesFromString(input);break;case"dd":case"ddd":case"dddd":a=config._locale.weekdaysParse(input),null!=a?(config._w=config._w||{},config._w.d=a):config._pf.invalidWeekday=input;break;case"w":case"ww":case"W":case"WW":case"d":case"e":case"E":token=token.substr(0,1);case"gggg":case"GGGG":case"GGGGG":token=token.substr(0,2),input&&(config._w=config._w||{},config._w[token]=toInt(input));break;case"gg":case"GG":config._w=config._w||{},config._w[token]=moment.parseTwoDigitYear(input)}}function dayOfYearFromWeekInfo(config){var w,weekYear,week,weekday,dow,doy,temp;w=config._w,null!=w.GG||null!=w.W||null!=w.E?(dow=1,doy=4,weekYear=dfl(w.GG,config._a[YEAR],weekOfYear(moment(),1,4).year),week=dfl(w.W,1),weekday=dfl(w.E,1)):(dow=config._locale._week.dow,doy=config._locale._week.doy,weekYear=dfl(w.gg,config._a[YEAR],weekOfYear(moment(),dow,doy).year),week=dfl(w.w,1),null!=w.d?(weekday=w.d,dow>weekday&&++week):weekday=null!=w.e?w.e+dow:dow),temp=dayOfYearFromWeeks(weekYear,week,weekday,doy,dow),config._a[YEAR]=temp.year,config._dayOfYear=temp.dayOfYear}function dateFromConfig(config){var i,date,currentDate,yearToUse,input=[];if(!config._d){for(currentDate=currentDateArray(config),config._w&&null==config._a[DATE]&&null==config._a[MONTH]&&dayOfYearFromWeekInfo(config),config._dayOfYear&&(yearToUse=dfl(config._a[YEAR],currentDate[YEAR]),config._dayOfYear>daysInYear(yearToUse)&&(config._pf._overflowDayOfYear=!0),date=makeUTCDate(yearToUse,0,config._dayOfYear),config._a[MONTH]=date.getUTCMonth(),config._a[DATE]=date.getUTCDate()),i=0;3>i&&null==config._a[i];++i)config._a[i]=input[i]=currentDate[i];for(;7>i;i++)config._a[i]=input[i]=null==config._a[i]?2===i?1:0:config._a[i];config._d=(config._useUTC?makeUTCDate:makeDate).apply(null,input),null!=config._tzm&&config._d.setUTCMinutes(config._d.getUTCMinutes()+config._tzm)}}function dateFromObject(config){var normalizedInput;config._d||(normalizedInput=normalizeObjectUnits(config._i),config._a=[normalizedInput.year,normalizedInput.month,normalizedInput.day,normalizedInput.hour,normalizedInput.minute,normalizedInput.second,normalizedInput.millisecond],dateFromConfig(config))}function currentDateArray(config){var now=new Date;return config._useUTC?[now.getUTCFullYear(),now.getUTCMonth(),now.getUTCDate()]:[now.getFullYear(),now.getMonth(),now.getDate()]}function makeDateFromStringAndFormat(config){if(config._f===moment.ISO_8601)return void parseISO(config);config._a=[],config._pf.empty=!0;var i,parsedInput,tokens,token,skipped,string=""+config._i,stringLength=string.length,totalParsedInputLength=0;for(tokens=expandFormat(config._f,config._locale).match(formattingTokens)||[],i=0;i<tokens.length;i++)token=tokens[i],parsedInput=(string.match(getParseRegexForToken(token,config))||[])[0],parsedInput&&(skipped=string.substr(0,string.indexOf(parsedInput)),skipped.length>0&&config._pf.unusedInput.push(skipped),string=string.slice(string.indexOf(parsedInput)+parsedInput.length),totalParsedInputLength+=parsedInput.length),formatTokenFunctions[token]?(parsedInput?config._pf.empty=!1:config._pf.unusedTokens.push(token),addTimeToArrayFromToken(token,parsedInput,config)):config._strict&&!parsedInput&&config._pf.unusedTokens.push(token);config._pf.charsLeftOver=stringLength-totalParsedInputLength,string.length>0&&config._pf.unusedInput.push(string),config._isPm&&config._a[HOUR]<12&&(config._a[HOUR]+=12),config._isPm===!1&&12===config._a[HOUR]&&(config._a[HOUR]=0),dateFromConfig(config),checkOverflow(config)}function unescapeFormat(s){return s.replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(matched,p1,p2,p3,p4){return p1||p2||p3||p4})}function regexpEscape(s){return s.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function makeDateFromStringAndArray(config){var tempConfig,bestMoment,scoreToBeat,i,currentScore;if(0===config._f.length)return config._pf.invalidFormat=!0,void(config._d=new Date(0/0));for(i=0;i<config._f.length;i++)currentScore=0,tempConfig=copyConfig({},config),tempConfig._pf=defaultParsingFlags(),tempConfig._f=config._f[i],makeDateFromStringAndFormat(tempConfig),isValid(tempConfig)&&(currentScore+=tempConfig._pf.charsLeftOver,currentScore+=10*tempConfig._pf.unusedTokens.length,tempConfig._pf.score=currentScore,(null==scoreToBeat||scoreToBeat>currentScore)&&(scoreToBeat=currentScore,bestMoment=tempConfig));extend(config,bestMoment||tempConfig)}function parseISO(config){var i,l,string=config._i,match=isoRegex.exec(string);if(match){for(config._pf.iso=!0,i=0,l=isoDates.length;l>i;i++)if(isoDates[i][1].exec(string)){config._f=isoDates[i][0]+(match[6]||" ");break}for(i=0,l=isoTimes.length;l>i;i++)if(isoTimes[i][1].exec(string)){config._f+=isoTimes[i][0];break}string.match(parseTokenTimezone)&&(config._f+="Z"),makeDateFromStringAndFormat(config)}else config._isValid=!1}function makeDateFromString(config){parseISO(config),config._isValid===!1&&(delete config._isValid,moment.createFromInputFallback(config))}function makeDateFromInput(config){var matched,input=config._i;input===undefined?config._d=new Date:isDate(input)?config._d=new Date(+input):null!==(matched=aspNetJsonRegex.exec(input))?config._d=new Date(+matched[1]):"string"==typeof input?makeDateFromString(config):isArray(input)?(config._a=input.slice(0),dateFromConfig(config)):"object"==typeof input?dateFromObject(config):"number"==typeof input?config._d=new Date(input):moment.createFromInputFallback(config)}function makeDate(y,m,d,h,M,s,ms){var date=new Date(y,m,d,h,M,s,ms);return 1970>y&&date.setFullYear(y),date}function makeUTCDate(y){var date=new Date(Date.UTC.apply(null,arguments));return 1970>y&&date.setUTCFullYear(y),date}function parseWeekday(input,locale){if("string"==typeof input)if(isNaN(input)){if(input=locale.weekdaysParse(input),"number"!=typeof input)return null}else input=parseInt(input,10);return input}function substituteTimeAgo(string,number,withoutSuffix,isFuture,locale){return locale.relativeTime(number||1,!!withoutSuffix,string,isFuture)}function relativeTime(posNegDuration,withoutSuffix,locale){var duration=moment.duration(posNegDuration).abs(),seconds=round(duration.as("s")),minutes=round(duration.as("m")),hours=round(duration.as("h")),days=round(duration.as("d")),months=round(duration.as("M")),years=round(duration.as("y")),args=seconds<relativeTimeThresholds.s&&["s",seconds]||1===minutes&&["m"]||minutes<relativeTimeThresholds.m&&["mm",minutes]||1===hours&&["h"]||hours<relativeTimeThresholds.h&&["hh",hours]||1===days&&["d"]||days<relativeTimeThresholds.d&&["dd",days]||1===months&&["M"]||months<relativeTimeThresholds.M&&["MM",months]||1===years&&["y"]||["yy",years];return args[2]=withoutSuffix,args[3]=+posNegDuration>0,args[4]=locale,substituteTimeAgo.apply({},args)}function weekOfYear(mom,firstDayOfWeek,firstDayOfWeekOfYear){var adjustedMoment,end=firstDayOfWeekOfYear-firstDayOfWeek,daysToDayOfWeek=firstDayOfWeekOfYear-mom.day();return daysToDayOfWeek>end&&(daysToDayOfWeek-=7),end-7>daysToDayOfWeek&&(daysToDayOfWeek+=7),adjustedMoment=moment(mom).add(daysToDayOfWeek,"d"),{week:Math.ceil(adjustedMoment.dayOfYear()/7),year:adjustedMoment.year()}}function dayOfYearFromWeeks(year,week,weekday,firstDayOfWeekOfYear,firstDayOfWeek){var daysToAdd,dayOfYear,d=makeUTCDate(year,0,1).getUTCDay();return d=0===d?7:d,weekday=null!=weekday?weekday:firstDayOfWeek,daysToAdd=firstDayOfWeek-d+(d>firstDayOfWeekOfYear?7:0)-(firstDayOfWeek>d?7:0),dayOfYear=7*(week-1)+(weekday-firstDayOfWeek)+daysToAdd+1,{year:dayOfYear>0?year:year-1,dayOfYear:dayOfYear>0?dayOfYear:daysInYear(year-1)+dayOfYear}}function makeMoment(config){var input=config._i,format=config._f;return config._locale=config._locale||moment.localeData(config._l),null===input||format===undefined&&""===input?moment.invalid({nullInput:!0}):("string"==typeof input&&(config._i=input=config._locale.preparse(input)),moment.isMoment(input)?new Moment(input,!0):(format?isArray(format)?makeDateFromStringAndArray(config):makeDateFromStringAndFormat(config):makeDateFromInput(config),new Moment(config)))}function pickBy(fn,moments){var res,i;if(1===moments.length&&isArray(moments[0])&&(moments=moments[0]),!moments.length)return moment();for(res=moments[0],i=1;i<moments.length;++i)moments[i][fn](res)&&(res=moments[i]);return res}function rawMonthSetter(mom,value){var dayOfMonth;return"string"==typeof value&&(value=mom.localeData().monthsParse(value),"number"!=typeof value)?mom:(dayOfMonth=Math.min(mom.date(),daysInMonth(mom.year(),value)),mom._d["set"+(mom._isUTC?"UTC":"")+"Month"](value,dayOfMonth),mom)}function rawGetter(mom,unit){return mom._d["get"+(mom._isUTC?"UTC":"")+unit]()}function rawSetter(mom,unit,value){return"Month"===unit?rawMonthSetter(mom,value):mom._d["set"+(mom._isUTC?"UTC":"")+unit](value)}function makeAccessor(unit,keepTime){return function(value){return null!=value?(rawSetter(this,unit,value),moment.updateOffset(this,keepTime),this):rawGetter(this,unit)}}function daysToYears(days){return 400*days/146097}function yearsToDays(years){return 146097*years/400}function makeDurationGetter(name){moment.duration.fn[name]=function(){return this._data[name]}}function makeGlobal(shouldDeprecate){"undefined"==typeof ender&&(oldGlobalMoment=globalScope.moment,globalScope.moment=shouldDeprecate?deprecate("Accessing Moment through the global scope is deprecated, and will be removed in an upcoming release.",moment):moment)}for(var moment,oldGlobalMoment,i,VERSION="2.8.1",globalScope="undefined"!=typeof global?global:this,round=Math.round,YEAR=0,MONTH=1,DATE=2,HOUR=3,MINUTE=4,SECOND=5,MILLISECOND=6,locales={},momentProperties=[],hasModule="undefined"!=typeof module&&module.exports,aspNetJsonRegex=/^\/?Date\((\-?\d+)/i,aspNetTimeSpanJsonRegex=/(\-)?(?:(\d*)\.)?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?)?/,isoDurationRegex=/^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/,formattingTokens=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Q|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,4}|X|zz?|ZZ?|.)/g,localFormattingTokens=/(\[[^\[]*\])|(\\)?(LT|LL?L?L?|l{1,4})/g,parseTokenOneOrTwoDigits=/\d\d?/,parseTokenOneToThreeDigits=/\d{1,3}/,parseTokenOneToFourDigits=/\d{1,4}/,parseTokenOneToSixDigits=/[+\-]?\d{1,6}/,parseTokenDigits=/\d+/,parseTokenWord=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,parseTokenTimezone=/Z|[\+\-]\d\d:?\d\d/gi,parseTokenT=/T/i,parseTokenTimestampMs=/[\+\-]?\d+(\.\d{1,3})?/,parseTokenOrdinal=/\d{1,2}/,parseTokenOneDigit=/\d/,parseTokenTwoDigits=/\d\d/,parseTokenThreeDigits=/\d{3}/,parseTokenFourDigits=/\d{4}/,parseTokenSixDigits=/[+-]?\d{6}/,parseTokenSignedNumber=/[+-]?\d+/,isoRegex=/^\s*(?:[+-]\d{6}|\d{4})-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,isoFormat="YYYY-MM-DDTHH:mm:ssZ",isoDates=[["YYYYYY-MM-DD",/[+-]\d{6}-\d{2}-\d{2}/],["YYYY-MM-DD",/\d{4}-\d{2}-\d{2}/],["GGGG-[W]WW-E",/\d{4}-W\d{2}-\d/],["GGGG-[W]WW",/\d{4}-W\d{2}/],["YYYY-DDD",/\d{4}-\d{3}/]],isoTimes=[["HH:mm:ss.SSSS",/(T| )\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],parseTimezoneChunker=/([\+\-]|\d\d)/gi,unitMillisecondFactors=("Date|Hours|Minutes|Seconds|Milliseconds".split("|"),{Milliseconds:1,Seconds:1e3,Minutes:6e4,Hours:36e5,Days:864e5,Months:2592e6,Years:31536e6}),unitAliases={ms:"millisecond",s:"second",m:"minute",h:"hour",d:"day",D:"date",w:"week",W:"isoWeek",M:"month",Q:"quarter",y:"year",DDD:"dayOfYear",e:"weekday",E:"isoWeekday",gg:"weekYear",GG:"isoWeekYear"},camelFunctions={dayofyear:"dayOfYear",isoweekday:"isoWeekday",isoweek:"isoWeek",weekyear:"weekYear",isoweekyear:"isoWeekYear"},formatFunctions={},relativeTimeThresholds={s:45,m:45,h:22,d:26,M:11},ordinalizeTokens="DDD w W M D d".split(" "),paddedTokens="M D H h m s w W".split(" "),formatTokenFunctions={M:function(){return this.month()+1},MMM:function(format){return this.localeData().monthsShort(this,format)},MMMM:function(format){return this.localeData().months(this,format)},D:function(){return this.date()},DDD:function(){return this.dayOfYear()},d:function(){return this.day()},dd:function(format){return this.localeData().weekdaysMin(this,format)},ddd:function(format){return this.localeData().weekdaysShort(this,format)},dddd:function(format){return this.localeData().weekdays(this,format)},w:function(){return this.week()},W:function(){return this.isoWeek()},YY:function(){return leftZeroFill(this.year()%100,2)},YYYY:function(){return leftZeroFill(this.year(),4)},YYYYY:function(){return leftZeroFill(this.year(),5)},YYYYYY:function(){var y=this.year(),sign=y>=0?"+":"-";return sign+leftZeroFill(Math.abs(y),6)},gg:function(){return leftZeroFill(this.weekYear()%100,2)},gggg:function(){return leftZeroFill(this.weekYear(),4)},ggggg:function(){return leftZeroFill(this.weekYear(),5)},GG:function(){return leftZeroFill(this.isoWeekYear()%100,2)},GGGG:function(){return leftZeroFill(this.isoWeekYear(),4)},GGGGG:function(){return leftZeroFill(this.isoWeekYear(),5)},e:function(){return this.weekday()},E:function(){return this.isoWeekday()},a:function(){return this.localeData().meridiem(this.hours(),this.minutes(),!0)},A:function(){return this.localeData().meridiem(this.hours(),this.minutes(),!1)},H:function(){return this.hours()},h:function(){return this.hours()%12||12},m:function(){return this.minutes()},s:function(){return this.seconds()},S:function(){return toInt(this.milliseconds()/100)},SS:function(){return leftZeroFill(toInt(this.milliseconds()/10),2)},SSS:function(){return leftZeroFill(this.milliseconds(),3)},SSSS:function(){return leftZeroFill(this.milliseconds(),3)},Z:function(){var a=-this.zone(),b="+";return 0>a&&(a=-a,b="-"),b+leftZeroFill(toInt(a/60),2)+":"+leftZeroFill(toInt(a)%60,2)},ZZ:function(){var a=-this.zone(),b="+";return 0>a&&(a=-a,b="-"),b+leftZeroFill(toInt(a/60),2)+leftZeroFill(toInt(a)%60,2)},z:function(){return this.zoneAbbr()},zz:function(){return this.zoneName()},X:function(){return this.unix()},Q:function(){return this.quarter()}},deprecations={},lists=["months","monthsShort","weekdays","weekdaysShort","weekdaysMin"];ordinalizeTokens.length;)i=ordinalizeTokens.pop(),formatTokenFunctions[i+"o"]=ordinalizeToken(formatTokenFunctions[i],i);for(;paddedTokens.length;)i=paddedTokens.pop(),formatTokenFunctions[i+i]=padToken(formatTokenFunctions[i],2);formatTokenFunctions.DDDD=padToken(formatTokenFunctions.DDD,3),extend(Locale.prototype,{set:function(config){var prop,i;for(i in config)prop=config[i],"function"==typeof prop?this[i]=prop:this["_"+i]=prop},_months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),months:function(m){return this._months[m.month()]},_monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),monthsShort:function(m){return this._monthsShort[m.month()]},monthsParse:function(monthName){var i,mom,regex;for(this._monthsParse||(this._monthsParse=[]),i=0;12>i;i++)if(this._monthsParse[i]||(mom=moment.utc([2e3,i]),regex="^"+this.months(mom,"")+"|^"+this.monthsShort(mom,""),this._monthsParse[i]=new RegExp(regex.replace(".",""),"i")),this._monthsParse[i].test(monthName))return i},_weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdays:function(m){return this._weekdays[m.day()]},_weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysShort:function(m){return this._weekdaysShort[m.day()]},_weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),weekdaysMin:function(m){return this._weekdaysMin[m.day()]},weekdaysParse:function(weekdayName){var i,mom,regex;for(this._weekdaysParse||(this._weekdaysParse=[]),i=0;7>i;i++)if(this._weekdaysParse[i]||(mom=moment([2e3,1]).day(i),regex="^"+this.weekdays(mom,"")+"|^"+this.weekdaysShort(mom,"")+"|^"+this.weekdaysMin(mom,""),this._weekdaysParse[i]=new RegExp(regex.replace(".",""),"i")),this._weekdaysParse[i].test(weekdayName))return i},_longDateFormat:{LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY LT",LLLL:"dddd, MMMM D, YYYY LT"},longDateFormat:function(key){var output=this._longDateFormat[key];return!output&&this._longDateFormat[key.toUpperCase()]&&(output=this._longDateFormat[key.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,function(val){return val.slice(1)}),this._longDateFormat[key]=output),output},isPM:function(input){return"p"===(input+"").toLowerCase().charAt(0)},_meridiemParse:/[ap]\.?m?\.?/i,meridiem:function(hours,minutes,isLower){return hours>11?isLower?"pm":"PM":isLower?"am":"AM"},_calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},calendar:function(key,mom){var output=this._calendar[key];return"function"==typeof output?output.apply(mom):output},_relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},relativeTime:function(number,withoutSuffix,string,isFuture){var output=this._relativeTime[string];return"function"==typeof output?output(number,withoutSuffix,string,isFuture):output.replace(/%d/i,number)},pastFuture:function(diff,output){var format=this._relativeTime[diff>0?"future":"past"];return"function"==typeof format?format(output):format.replace(/%s/i,output)},ordinal:function(number){return this._ordinal.replace("%d",number)},_ordinal:"%d",preparse:function(string){return string},postformat:function(string){return string},week:function(mom){return weekOfYear(mom,this._week.dow,this._week.doy).week},_week:{dow:0,doy:6},_invalidDate:"Invalid date",invalidDate:function(){return this._invalidDate}}),moment=function(input,format,locale,strict){var c;return"boolean"==typeof locale&&(strict=locale,locale=undefined),c={},c._isAMomentObject=!0,c._i=input,c._f=format,c._l=locale,c._strict=strict,c._isUTC=!1,c._pf=defaultParsingFlags(),makeMoment(c)},moment.suppressDeprecationWarnings=!1,moment.createFromInputFallback=deprecate("moment construction falls back to js Date. This is discouraged and will be removed in upcoming major release. Please refer to https://github.com/moment/moment/issues/1407 for more info.",function(config){config._d=new Date(config._i)}),moment.min=function(){var args=[].slice.call(arguments,0);return pickBy("isBefore",args)},moment.max=function(){var args=[].slice.call(arguments,0);return pickBy("isAfter",args)},moment.utc=function(input,format,locale,strict){var c;return"boolean"==typeof locale&&(strict=locale,locale=undefined),c={},c._isAMomentObject=!0,c._useUTC=!0,c._isUTC=!0,c._l=locale,c._i=input,c._f=format,c._strict=strict,c._pf=defaultParsingFlags(),makeMoment(c).utc()},moment.unix=function(input){return moment(1e3*input)},moment.duration=function(input,key){var sign,ret,parseIso,diffRes,duration=input,match=null;return moment.isDuration(input)?duration={ms:input._milliseconds,d:input._days,M:input._months}:"number"==typeof input?(duration={},key?duration[key]=input:duration.milliseconds=input):(match=aspNetTimeSpanJsonRegex.exec(input))?(sign="-"===match[1]?-1:1,duration={y:0,d:toInt(match[DATE])*sign,h:toInt(match[HOUR])*sign,m:toInt(match[MINUTE])*sign,s:toInt(match[SECOND])*sign,ms:toInt(match[MILLISECOND])*sign}):(match=isoDurationRegex.exec(input))?(sign="-"===match[1]?-1:1,parseIso=function(inp){var res=inp&&parseFloat(inp.replace(",","."));return(isNaN(res)?0:res)*sign},duration={y:parseIso(match[2]),M:parseIso(match[3]),d:parseIso(match[4]),h:parseIso(match[5]),m:parseIso(match[6]),s:parseIso(match[7]),w:parseIso(match[8])}):"object"==typeof duration&&("from"in duration||"to"in duration)&&(diffRes=momentsDifference(moment(duration.from),moment(duration.to)),duration={},duration.ms=diffRes.milliseconds,duration.M=diffRes.months),ret=new Duration(duration),moment.isDuration(input)&&input.hasOwnProperty("_locale")&&(ret._locale=input._locale),ret},moment.version=VERSION,moment.defaultFormat=isoFormat,moment.ISO_8601=function(){},moment.momentProperties=momentProperties,moment.updateOffset=function(){},moment.relativeTimeThreshold=function(threshold,limit){return relativeTimeThresholds[threshold]===undefined?!1:limit===undefined?relativeTimeThresholds[threshold]:(relativeTimeThresholds[threshold]=limit,!0)},moment.lang=deprecate("moment.lang is deprecated. Use moment.locale instead.",function(key,value){return moment.locale(key,value)}),moment.locale=function(key,values){var data;return key&&(data="undefined"!=typeof values?moment.defineLocale(key,values):moment.localeData(key),data&&(moment.duration._locale=moment._locale=data)),moment._locale._abbr},moment.defineLocale=function(name,values){return null!==values?(values.abbr=name,locales[name]||(locales[name]=new Locale),locales[name].set(values),moment.locale(name),locales[name]):(delete locales[name],null)},moment.langData=deprecate("moment.langData is deprecated. Use moment.localeData instead.",function(key){return moment.localeData(key)}),moment.localeData=function(key){var locale;if(key&&key._locale&&key._locale._abbr&&(key=key._locale._abbr),!key)return moment._locale;if(!isArray(key)){if(locale=loadLocale(key))return locale;key=[key]}return chooseLocale(key)},moment.isMoment=function(obj){return obj instanceof Moment||null!=obj&&obj.hasOwnProperty("_isAMomentObject")},moment.isDuration=function(obj){return obj instanceof Duration};for(i=lists.length-1;i>=0;--i)makeList(lists[i]);moment.normalizeUnits=function(units){return normalizeUnits(units)},moment.invalid=function(flags){var m=moment.utc(0/0);return null!=flags?extend(m._pf,flags):m._pf.userInvalidated=!0,m},moment.parseZone=function(){return moment.apply(null,arguments).parseZone()},moment.parseTwoDigitYear=function(input){return toInt(input)+(toInt(input)>68?1900:2e3)},extend(moment.fn=Moment.prototype,{clone:function(){return moment(this)},valueOf:function(){return+this._d+6e4*(this._offset||0)},unix:function(){return Math.floor(+this/1e3)},toString:function(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},toDate:function(){return this._offset?new Date(+this):this._d},toISOString:function(){var m=moment(this).utc();return 0<m.year()&&m.year()<=9999?formatMoment(m,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):formatMoment(m,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")},toArray:function(){var m=this;return[m.year(),m.month(),m.date(),m.hours(),m.minutes(),m.seconds(),m.milliseconds()]},isValid:function(){return isValid(this)},isDSTShifted:function(){return this._a?this.isValid()&&compareArrays(this._a,(this._isUTC?moment.utc(this._a):moment(this._a)).toArray())>0:!1},parsingFlags:function(){return extend({},this._pf)},invalidAt:function(){return this._pf.overflow},utc:function(keepLocalTime){return this.zone(0,keepLocalTime)},local:function(keepLocalTime){return this._isUTC&&(this.zone(0,keepLocalTime),this._isUTC=!1,keepLocalTime&&this.add(this._d.getTimezoneOffset(),"m")),this},format:function(inputString){var output=formatMoment(this,inputString||moment.defaultFormat);return this.localeData().postformat(output)},add:createAdder(1,"add"),subtract:createAdder(-1,"subtract"),diff:function(input,units,asFloat){var diff,output,that=makeAs(input,this),zoneDiff=6e4*(this.zone()-that.zone());return units=normalizeUnits(units),"year"===units||"month"===units?(diff=432e5*(this.daysInMonth()+that.daysInMonth()),output=12*(this.year()-that.year())+(this.month()-that.month()),output+=(this-moment(this).startOf("month")-(that-moment(that).startOf("month")))/diff,output-=6e4*(this.zone()-moment(this).startOf("month").zone()-(that.zone()-moment(that).startOf("month").zone()))/diff,"year"===units&&(output/=12)):(diff=this-that,output="second"===units?diff/1e3:"minute"===units?diff/6e4:"hour"===units?diff/36e5:"day"===units?(diff-zoneDiff)/864e5:"week"===units?(diff-zoneDiff)/6048e5:diff),asFloat?output:absRound(output)},from:function(time,withoutSuffix){return moment.duration({to:this,from:time}).locale(this.locale()).humanize(!withoutSuffix)},fromNow:function(withoutSuffix){return this.from(moment(),withoutSuffix)},calendar:function(time){var now=time||moment(),sod=makeAs(now,this).startOf("day"),diff=this.diff(sod,"days",!0),format=-6>diff?"sameElse":-1>diff?"lastWeek":0>diff?"lastDay":1>diff?"sameDay":2>diff?"nextDay":7>diff?"nextWeek":"sameElse";return this.format(this.localeData().calendar(format,this))},isLeapYear:function(){return isLeapYear(this.year())},isDST:function(){return this.zone()<this.clone().month(0).zone()||this.zone()<this.clone().month(5).zone()},day:function(input){var day=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=input?(input=parseWeekday(input,this.localeData()),this.add(input-day,"d")):day},month:makeAccessor("Month",!0),startOf:function(units){switch(units=normalizeUnits(units)){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===units?this.weekday(0):"isoWeek"===units&&this.isoWeekday(1),"quarter"===units&&this.month(3*Math.floor(this.month()/3)),this},endOf:function(units){return units=normalizeUnits(units),this.startOf(units).add(1,"isoWeek"===units?"week":units).subtract(1,"ms")},isAfter:function(input,units){return units="undefined"!=typeof units?units:"millisecond",+this.clone().startOf(units)>+moment(input).startOf(units)},isBefore:function(input,units){return units="undefined"!=typeof units?units:"millisecond",+this.clone().startOf(units)<+moment(input).startOf(units)},isSame:function(input,units){return units=units||"ms",+this.clone().startOf(units)===+makeAs(input,this).startOf(units)},min:deprecate("moment().min is deprecated, use moment.min instead. https://github.com/moment/moment/issues/1548",function(other){return other=moment.apply(null,arguments),this>other?this:other
}),max:deprecate("moment().max is deprecated, use moment.max instead. https://github.com/moment/moment/issues/1548",function(other){return other=moment.apply(null,arguments),other>this?this:other}),zone:function(input,keepLocalTime){var localAdjust,offset=this._offset||0;return null==input?this._isUTC?offset:this._d.getTimezoneOffset():("string"==typeof input&&(input=timezoneMinutesFromString(input)),Math.abs(input)<16&&(input=60*input),!this._isUTC&&keepLocalTime&&(localAdjust=this._d.getTimezoneOffset()),this._offset=input,this._isUTC=!0,null!=localAdjust&&this.subtract(localAdjust,"m"),offset!==input&&(!keepLocalTime||this._changeInProgress?addOrSubtractDurationFromMoment(this,moment.duration(offset-input,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,moment.updateOffset(this,!0),this._changeInProgress=null)),this)},zoneAbbr:function(){return this._isUTC?"UTC":""},zoneName:function(){return this._isUTC?"Coordinated Universal Time":""},parseZone:function(){return this._tzm?this.zone(this._tzm):"string"==typeof this._i&&this.zone(this._i),this},hasAlignedHourOffset:function(input){return input=input?moment(input).zone():0,(this.zone()-input)%60===0},daysInMonth:function(){return daysInMonth(this.year(),this.month())},dayOfYear:function(input){var dayOfYear=round((moment(this).startOf("day")-moment(this).startOf("year"))/864e5)+1;return null==input?dayOfYear:this.add(input-dayOfYear,"d")},quarter:function(input){return null==input?Math.ceil((this.month()+1)/3):this.month(3*(input-1)+this.month()%3)},weekYear:function(input){var year=weekOfYear(this,this.localeData()._week.dow,this.localeData()._week.doy).year;return null==input?year:this.add(input-year,"y")},isoWeekYear:function(input){var year=weekOfYear(this,1,4).year;return null==input?year:this.add(input-year,"y")},week:function(input){var week=this.localeData().week(this);return null==input?week:this.add(7*(input-week),"d")},isoWeek:function(input){var week=weekOfYear(this,1,4).week;return null==input?week:this.add(7*(input-week),"d")},weekday:function(input){var weekday=(this.day()+7-this.localeData()._week.dow)%7;return null==input?weekday:this.add(input-weekday,"d")},isoWeekday:function(input){return null==input?this.day()||7:this.day(this.day()%7?input:input-7)},isoWeeksInYear:function(){return weeksInYear(this.year(),1,4)},weeksInYear:function(){var weekInfo=this.localeData()._week;return weeksInYear(this.year(),weekInfo.dow,weekInfo.doy)},get:function(units){return units=normalizeUnits(units),this[units]()},set:function(units,value){return units=normalizeUnits(units),"function"==typeof this[units]&&this[units](value),this},locale:function(key){return key===undefined?this._locale._abbr:(this._locale=moment.localeData(key),this)},lang:deprecate("moment().lang() is deprecated. Use moment().localeData() instead.",function(key){return key===undefined?this.localeData():(this._locale=moment.localeData(key),this)}),localeData:function(){return this._locale}}),moment.fn.millisecond=moment.fn.milliseconds=makeAccessor("Milliseconds",!1),moment.fn.second=moment.fn.seconds=makeAccessor("Seconds",!1),moment.fn.minute=moment.fn.minutes=makeAccessor("Minutes",!1),moment.fn.hour=moment.fn.hours=makeAccessor("Hours",!0),moment.fn.date=makeAccessor("Date",!0),moment.fn.dates=deprecate("dates accessor is deprecated. Use date instead.",makeAccessor("Date",!0)),moment.fn.year=makeAccessor("FullYear",!0),moment.fn.years=deprecate("years accessor is deprecated. Use year instead.",makeAccessor("FullYear",!0)),moment.fn.days=moment.fn.day,moment.fn.months=moment.fn.month,moment.fn.weeks=moment.fn.week,moment.fn.isoWeeks=moment.fn.isoWeek,moment.fn.quarters=moment.fn.quarter,moment.fn.toJSON=moment.fn.toISOString,extend(moment.duration.fn=Duration.prototype,{_bubble:function(){var seconds,minutes,hours,milliseconds=this._milliseconds,days=this._days,months=this._months,data=this._data,years=0;data.milliseconds=milliseconds%1e3,seconds=absRound(milliseconds/1e3),data.seconds=seconds%60,minutes=absRound(seconds/60),data.minutes=minutes%60,hours=absRound(minutes/60),data.hours=hours%24,days+=absRound(hours/24),years=absRound(daysToYears(days)),days-=absRound(yearsToDays(years)),months+=absRound(days/30),days%=30,years+=absRound(months/12),months%=12,data.days=days,data.months=months,data.years=years},abs:function(){return this._milliseconds=Math.abs(this._milliseconds),this._days=Math.abs(this._days),this._months=Math.abs(this._months),this._data.milliseconds=Math.abs(this._data.milliseconds),this._data.seconds=Math.abs(this._data.seconds),this._data.minutes=Math.abs(this._data.minutes),this._data.hours=Math.abs(this._data.hours),this._data.months=Math.abs(this._data.months),this._data.years=Math.abs(this._data.years),this},weeks:function(){return absRound(this.days()/7)},valueOf:function(){return this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*toInt(this._months/12)},humanize:function(withSuffix){var output=relativeTime(this,!withSuffix,this.localeData());return withSuffix&&(output=this.localeData().pastFuture(+this,output)),this.localeData().postformat(output)},add:function(input,val){var dur=moment.duration(input,val);return this._milliseconds+=dur._milliseconds,this._days+=dur._days,this._months+=dur._months,this._bubble(),this},subtract:function(input,val){var dur=moment.duration(input,val);return this._milliseconds-=dur._milliseconds,this._days-=dur._days,this._months-=dur._months,this._bubble(),this},get:function(units){return units=normalizeUnits(units),this[units.toLowerCase()+"s"]()},as:function(units){var days,months;if(units=normalizeUnits(units),days=this._days+this._milliseconds/864e5,"month"===units||"year"===units)return months=this._months+12*daysToYears(days),"month"===units?months:months/12;switch(days+=yearsToDays(this._months/12),units){case"week":return days/7;case"day":return days;case"hour":return 24*days;case"minute":return 24*days*60;case"second":return 24*days*60*60;case"millisecond":return 24*days*60*60*1e3;default:throw new Error("Unknown unit "+units)}},lang:moment.fn.lang,locale:moment.fn.locale,toIsoString:deprecate("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",function(){return this.toISOString()}),toISOString:function(){var years=Math.abs(this.years()),months=Math.abs(this.months()),days=Math.abs(this.days()),hours=Math.abs(this.hours()),minutes=Math.abs(this.minutes()),seconds=Math.abs(this.seconds()+this.milliseconds()/1e3);return this.asSeconds()?(this.asSeconds()<0?"-":"")+"P"+(years?years+"Y":"")+(months?months+"M":"")+(days?days+"D":"")+(hours||minutes||seconds?"T":"")+(hours?hours+"H":"")+(minutes?minutes+"M":"")+(seconds?seconds+"S":""):"P0D"},localeData:function(){return this._locale}});for(i in unitMillisecondFactors)unitMillisecondFactors.hasOwnProperty(i)&&makeDurationGetter(i.toLowerCase());moment.duration.fn.asMilliseconds=function(){return this.as("ms")},moment.duration.fn.asSeconds=function(){return this.as("s")},moment.duration.fn.asMinutes=function(){return this.as("m")},moment.duration.fn.asHours=function(){return this.as("h")},moment.duration.fn.asDays=function(){return this.as("d")},moment.duration.fn.asWeeks=function(){return this.as("weeks")},moment.duration.fn.asMonths=function(){return this.as("M")},moment.duration.fn.asYears=function(){return this.as("y")},moment.locale("en",{ordinal:function(number){var b=number%10,output=1===toInt(number%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th";return number+output}}),hasModule?module.exports=moment:"function"==typeof define&&define.amd?(define("moment",["require","exports","module"],function(require,exports,module){return module.config&&module.config()&&module.config().noGlobal===!0&&(globalScope.moment=oldGlobalMoment),moment}),makeGlobal(!0)):makeGlobal()}.call(this),define("core/time",[],function(){function assureTzOffset(createdAt){return createdAt.indexOf("+")>=0?createdAt:createdAt+"+00:00"}var ISO_8601="YYYY-MM-DDTHH:mm:ssZ";return{ISO_8601:ISO_8601,assureTzOffset:assureTzOffset}}),define("core/advice",["underscore"],function(_){function withAdvice(){_.each(["before","after","around"],function(m){this[m]=function(method,advice){return this[method]="function"==typeof this[method]?fn[m](this[method],advice):advice}},this)}var fn={around:function(base,wrapped){return function(){var args=_.toArray(arguments);return wrapped.apply(this,[_.bind(base,this)].concat(args))}},before:function(base,before){return fn.around(base,function(){var args=_.toArray(arguments),orig=args.shift();return before.apply(this,args),orig.apply(this,args)})},after:function(base,after){return fn.around(base,function(){var args=_.toArray(arguments),orig=args.shift(),res=orig.apply(this,args);return after.apply(this,args),res})}};return{withAdvice:withAdvice}}),define("core/models/mixins",["underscore","moment","core/time"],function(_,moment,time){function withCreatedAt(){this._getCreatedMoment=_.memoize(function(){var datetime=this.get("createdAt");if(datetime)return moment(time.assureTzOffset(datetime),time.ISO_8601)},function(){return this.get("createdAt")}),this.getRelativeCreatedAt=function(){var datetime=this._getCreatedMoment();return datetime&&datetime.from(+new Date)},this.getFormattedCreatedAt=_.memoize(function(){var datetime=this._getCreatedMoment();return datetime&&datetime.format("LLLL")},function(){return this.get("createdAt")})}return{withCreatedAt:withCreatedAt}}),define("core/collections/UserCollection",["underscore","backbone","core/api","core/models/User"],function(_,Backbone,api,User){var UserCollection=Backbone.Collection.extend({model:User,initialize:function(models,options){Backbone.Collection.prototype.initialize.apply(this,arguments),this.thread=options&&options.thread}});return UserCollection}),define("core/collections/UpvotersUserCollection",["underscore","backbone","core/api","core/collections/UserCollection"],function(_,Backbone,api,UserCollection){var UpvotersUserCollection=UserCollection.extend({LIMIT:50,url:function(){return api.getURL("posts/listUsersVotedPost")},initialize:function(models,options){this.postId=options.postId,this.threadId=options.threadId},fetch:function(options){return Backbone.Collection.prototype.fetch.call(this,_.extend({data:{post:this.postId,thread:this.threadId,vote:1,limit:this.LIMIT}},options))}});return UpvotersUserCollection}),define("core/models/Vote",["backbone"],function(Backbone){var Vote=Backbone.Model.extend({defaults:{score:0}});return Vote}),define("core/collections/VoteCollection",["backbone","core/models/Vote"],function(Backbone,Vote){var VoteCollection=Backbone.Collection.extend({model:Vote});return VoteCollection}),define("core/models/Post",["jquery","underscore","backbone","moment","core/api","core/strings","core/time","core/utils","core/advice","core/models/mixins","core/models/User","core/collections/UserCollection","core/collections/UpvotersUserCollection","core/collections/VoteCollection"],function($,_,Backbone,moment,api,strings,time,utils,advice,modelMixins,User,UserCollection,UpvotersUserCollection,VoteCollection){var gettext=strings.get,Post=Backbone.Model.extend({upvotersCollectionClass:UpvotersUserCollection,defaults:function(){return{createdAt:moment().format(time.ISO_8601),dislikes:0,isApproved:!0,isDeleted:!1,isEdited:!1,isFlagged:!1,isFlaggedByUser:!1,isHighlighted:!1,isRealtime:!1,isImmediateReply:!1,isMinimized:null,hasMedia:!1,message:null,raw_message:null,likes:0,media:[],parent:null,points:0,depth:0,userScore:0}},initialize:function(){this.votes=new VoteCollection},messageText:function(){var msg=this.get("message");return utils.strip(msg)},relatedIds:function(){var forum=this.get("forum");_.isObject(forum)&&(forum=forum.id);var thread=this.get("thread");return _.isObject(thread)&&(thread=thread.id),{forum:forum,thread:thread,post:this.id}},permalink:function(thread,useCurrentPage){var id=this.id;if(!id||!thread)return"";var baseUrl=useCurrentPage!==!1&&thread.currentUrl||thread.permalink(),urlTool=document.createElement("a");return urlTool.href=baseUrl,urlTool.hash="#comment-"+id,urlTool.href},twitterText:function(permalink){var charsRemaining=140,author=this.author.get("name")||this.author.get("username");charsRemaining-=author.length+3,charsRemaining-=permalink.length+1,charsRemaining-=2;var text=utils.niceTruncate(this.messageText(),charsRemaining);return'"'+text+'" — '+author},toJSON:function(options){var json=Backbone.Model.prototype.toJSON.call(this);if(options){var session=options.session,thread=options.thread;json.canBeEdited=this.canBeEdited(session,thread),json.canBeRepliedTo=this.canBeRepliedTo(session,thread),json.canBeShared=this.canBeShared(),json.permalink=this.permalink(thread)}return json.isMinimized=this.isMinimized(),json.relativeCreatedAt=this.getRelativeCreatedAt(),json.formattedCreatedAt=this.getFormattedCreatedAt(),json.cid=this.cid,json},isPublic:function(){return this.get("isHighlighted")||this.get("isSponsored")?!0:this.get("isDeleted")?!1:this.get("isApproved")},isMinimized:function(){return this.get("isHighlighted")?!1:this.get("isMinimized")===!1?!1:!this.get("isApproved")},isAuthorSessionUser:function(){return!1},canBeEdited:function(){return!1},canBeRepliedTo:function(){return!1},canBeShared:function(){return!1},validate:function(attrs){if(!this.id&&!attrs.id){if(_.isString(attrs.raw_message)){if(""===attrs.raw_message)return gettext("Comments can't be blank.");if(attrs.raw_message.length<2)return gettext("Comments must have at least 2 characters.")}return""===attrs.author_email&&""===attrs.author_name?gettext("Please sign in or enter a name and email address."):""===attrs.author_email||""===attrs.author_name?gettext("Please enter both a name and email address."):_.isString(attrs.author_email)&&!this.validateEmail(attrs.author_email)?gettext("Invalid email address format."):void 0}},validateEmail:function(email){return utils.validateEmail(email)},report:function(){this.set("isFlagged",!0),api.call("posts/report.json",{data:{post:this.id},method:"POST"})},_highlight:function(shouldBeHighlighted){this.set("isHighlighted",shouldBeHighlighted),api.call("posts/"+(shouldBeHighlighted?"highlight":"unhighlight")+".json",{data:{post:this.id},method:"POST"})},highlight:function(){this._highlight(!0)},unhighlight:function(){this._highlight(!1)},getThreadId:function(){return this.get("thread")},getUpvotersUserCollection:_.memoize(function(){var CollectionClass=this.upvotersCollectionClass;return new CollectionClass(void 0,{postId:this.id,threadId:this.getThreadId()})},function(){return this.id}),_vote:function(vote,score,voter){var delta=vote-score,updates={likes:this.get("likes"),dislikes:this.get("dislikes"),points:this.get("points")};return 0===delta?delta:(vote>0?(updates.likes+=vote,updates.dislikes+=score):0>vote?(updates.dislikes-=vote,updates.likes-=score):score>0?updates.likes-=score:updates.dislikes+=score,updates.points+=delta,voter&&this.getUpvotersUserCollection()[vote>0?"add":"remove"](voter),this.set(updates),delta)},vote:function(vote){var self=this,delta=self._vote(vote,self.get("userScore"));0!==delta&&(self.set("userScore",vote),api.call("posts/vote.json",{data:{post:self.id,vote:vote},method:"POST",success:function(data){self.votes.add({id:data.response.id,score:vote},{merge:!0})}}))},_delete:function(){return this.set({isApproved:!1,isDeleted:!0}),api.call("posts/remove.json",{data:{post:this.id},method:"POST"})},spam:function(){this.set({isApproved:!1,isDeleted:!0,isSpam:!0}),this.trigger("spam"),api.call("posts/spam.json",{data:{post:this.id},method:"POST"})},_create:function(model,options){var self=this,attrs=model.attributes,params={thread:attrs.thread,message:attrs.raw_message};return attrs.parent&&(params.parent=attrs.parent),attrs.author_name&&(params.author_name=attrs.author_name,params.author_email=attrs.author_email),api.call("posts/create.json",{data:params,method:"POST",success:function(data){self.set(data.response),options.success&&options.success()},error:options.error})},_update:function(model,options){var self=this,attrs=model.attributes,params={post:attrs.id,message:attrs.raw_message};return api.call("posts/update.json",{data:params,method:"POST",success:function(data){self.set(data.response),options.success&&options.success()},error:options.error})},_read:function(model,options){var self=this;return options=options||{},api.call("posts/details.json",{data:{post:self.id},method:"GET",success:function(data){self.set(data.response),options.success&&options.success()},error:options.error})},sync:function(method,model,options){options=options||{};var error=options.error;switch(error&&(options.error=function(xhr){error(JSON.parse(xhr.responseText||"{}"))}),method){case"create":return this._create(model,options);case"update":return this._update(model,options);case"delete":return this._delete();case"read":return this._read(model,options)}}},{formatMessage:function(){var paragraphReg=/(?:\r\n|\r|\n){2,}/,lineReg=/\r\n|\r|\n/;return function(text){var paragraphs=_.chain(text.split(paragraphReg)).compact().value(),html=_.map(paragraphs,function(p){return _.chain(p.split(lineReg)).compact().map(_.escape).join("<br>").value()}).join("</p><p>");return"<p>"+html+"</p>"}}()});return modelMixins.withCreatedAt.call(Post.prototype),advice.withAdvice.call(Post.prototype),Post.withAuthor=function(User){this.after("set",function(attrs){attrs&&"string"!=typeof attrs&&attrs.author&&(this.author=new User(attrs.author),delete attrs.author)}),this.around("toJSON",function(toJSON){var json=toJSON.apply(this,_.rest(arguments));return this.author&&(json.author=this.author.toJSON()),json})},Post.withMediaCollection=function(MediaCollection){this.after("set",function(attrs){attrs&&"string"!=typeof attrs&&(_.isUndefined(attrs.media)||(this.media?this.media.reset(attrs.media):this.media=new MediaCollection(attrs.media),delete attrs.media))}),this.around("toJSON",function(toJSON){var json=toJSON.apply(this,_.rest(arguments));return this.media&&(json.media=this.media.toJSON()),json})},Post}),define("home/utils/datetimeUtils",["moment"],function(moment){var ISO_8601="YYYY-MM-DDTHH:mm:ssZ",assureTzOffset=function(createdAt){return createdAt.indexOf("+")>=0?createdAt:createdAt+"+00:00"},getRelativeDatetime=function(datetime){return datetime&&1/0!==datetime?(datetime=assureTzOffset(datetime),moment.utc(datetime,ISO_8601).local().fromNow()):null};return{getRelativeDatetime:getRelativeDatetime}}),define("home/templates/confirmModal",["handlebars","handlebars.partials"],function(Handlebars){return Handlebars.template(function(Handlebars,depth0,helpers,partials,data){function program1(){return'\n            <button type="button" class="btn btn-light" data-dismiss="modal">Cancel</button>\n            <button type="button" class="btn btn-primary" data-dismiss="modal" data-action="confirm">Confirm</button>\n        '}function program3(){return'\n            <button type="button" class="btn btn-light" data-dismiss="modal">Close</button>\n        '}this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var stack1,helper,options,buffer="",helperMissing=helpers.helperMissing,self=this;return buffer+='<div class="modal fade" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel" aria-hidden="true">\n  <div class="modal-dialog">\n    <div class="modal-content" data-role="content">\n    </div>\n    <div class="modal-footer">\n        ',helper=helpers.eq||depth0&&depth0.eq,options={hash:{},data:data},stack1=helper?helper.call(depth0,depth0&&depth0.type,(stack1=depth0&&depth0.types,null==stack1||stack1===!1?stack1:stack1.CONFIRM_CANCEL),options):helperMissing.call(depth0,"eq",depth0&&depth0.type,(stack1=depth0&&depth0.types,null==stack1||stack1===!1?stack1:stack1.CONFIRM_CANCEL),options),stack1=helpers["if"].call(depth0,stack1,{hash:{},inverse:self.noop,fn:self.program(1,program1,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n        ",helper=helpers.eq||depth0&&depth0.eq,options={hash:{},data:data},stack1=helper?helper.call(depth0,depth0&&depth0.type,(stack1=depth0&&depth0.types,null==stack1||stack1===!1?stack1:stack1.CLOSE),options):helperMissing.call(depth0,"eq",depth0&&depth0.type,(stack1=depth0&&depth0.types,null==stack1||stack1===!1?stack1:stack1.CLOSE),options),stack1=helpers["if"].call(depth0,stack1,{hash:{},inverse:self.noop,fn:self.program(3,program3,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n    </div>\n  </div>\n</div>\n"})}),define("home/utils/confirmModal",["jquery","home/templates/confirmModal"],function($,confirmModalTemplate){var TYPES={CLOSE:1,CONFIRM_CANCEL:2};return{confirmationPromise:function(type,content){type=type||TYPES.CLOSE;var deferred=$.Deferred(),$modal=$(confirmModalTemplate({type:type,types:TYPES})).on("hidden.bs.modal",function(){$modal.remove()});return $modal.find("[data-role=content]").html(content),$modal.on("click","[data-action=confirm]",function(){deferred.resolve()}),$("body").append($modal),$modal.modal("show"),deferred.promise()},TYPES:TYPES}}),define("home/templates/confirmDeleteThread",["handlebars","handlebars.partials"],function(Handlebars){return Handlebars.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var stack1,helper,buffer="",functionType="function",escapeExpression=this.escapeExpression;return buffer+='<div class="modal-header">\n    <h4 class="modal-title">Remove <b>',(helper=helpers.title)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.title,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'</b>?</h4>\n</div>\n<div class="modal-body">\n    <p>Click Confirm to remove and close the discussion so it can\'t be easily found. This prevents new comments from being posted.</p>\n</div>\n'})}),define("home/models/Thread",["underscore","backbone","home/utils/datetimeUtils","home/utils/confirmModal","home/models/common/UniqueModel","home/models/Forum","home/models/User","home/models/Post","home/templates/confirmDeleteThread","core/api","core/models/mixins"],function(_,Backbone,datetimeUtils,confirmModal,UniqueModel,Forum,User,Post,confirmDeleteThreadTemplate,api,mixins){var originalThreadUrlRegex=/^https:\/\/[^.]+\.disqus\.com\/thread\//,Thread=Backbone.Model.extend({defaults:{id:null,forum:null,link:null,slug:null,title:null,content:{title:"",description:"",keywords:[],image:{url:"",height:"",width:""}},message:void 0,posts:0,likes:0,dislikes:0,userScore:0},initialize:function(attrs,options){this.initializeRelated("forum",options,Forum,"name"),this.listenTo(this,"change:forum",function(thread,value){value instanceof Backbone.Model||this.forum.set(value)}),this.listenTo(this,"change:message",this._clearDescriptions),this.checkUserGenerated(options)},validate:function(attrs){if(void 0!==attrs.title){if(!attrs.title.trim())return{attrName:"title",message:"Please enter a title for your discussion."};if(attrs.title.length>200)return{attrName:"title",message:"Please shorten your title."}}},checkUserGenerated:function(options){return options=options||{},this.shouldFetch()?void this.listenToOnce(this,"sync",_.bind(this.checkUserGenerated,this,options)):void(this.forum.channel&&(this.initializeAuthor(options),this.initializePost(options),this.initializeRecentPosts(options),this.set({isUserGenerated:!0})))},initializeAuthor:function(options){var authorId=this.get("author");if(_.isObject(options.author))this.initializeRelated("author",options,User);else if((_.isString(authorId)||_.isNumber(authorId))&&(this.author=_.findWhere(UniqueModel.pool(User),{id:authorId}),!this.author)){var author=new User({id:authorId}),self=this;author.fetch().then(function(){self.author=UniqueModel.set(User,author),self.trigger("changeRelated:author")})}},initializePost:function(options){this.get("message")||(options.highlightedPost||this.get("highlightedPost"))&&(Post||(Post=require("home/models/Post")),this.initializeRelated("post",{post:options.highlightedPost||this.get("highlightedPost"),thread:this},Post))},initializeRecentPosts:function(options){Post||(Post=require("home/models/Post")),this.recentPosts=new Backbone.Collection(_.map(options.recentPosts,function(post){return post instanceof Post?post:new UniqueModel(Post,post,{thread:this})},this))},getLinks:function(){var links=[];return this.get("isUserGenerated")?this.get("message")?links=this.getLinksFromMessage():this.post&&(links=this.post.getLinks()):links=[this.get("link")],links},getLinksFromMessage:_.memoize(function(){var $wrapper=$("<div>").html(this.get("message"));return $wrapper.find("a[href]").map(function(index,el){return $(el).attr("href")})},function(){return this.id}),shouldFetch:function(){return!this.get("clean_title")},url:function(type){return this.urls[type]||this.urls.read},urls:{read:api.getURL("threads/details"),create:api.getURL("threads/create"),update:api.getURL("threads/update"),"delete":api.getURL("threads/remove"),close:api.getURL("threads/close")},fetch:function(options){if(this.fetchPromise)return this.fetchPromise;options=options||{},options.data=options.data||{};var thread,forumId;if(this.get("id"))thread=this.get("id");else{if(!this.get("slug")||!(forumId=this.forum.id))throw"Cannot fetch thread without an id or a slug plus forum";thread="slug:"+this.get("slug")}options.data.thread||(options.data.thread=thread),forumId&&(options.data.forum=forumId),this.forum.shouldFetch()&&(options.data.related="forum"),this.fetchPromise=Backbone.Model.prototype.fetch.call(this,options);var self=this;return this.fetchPromise.always(function(){self.fetchPromise=null}),this.fetchPromise},sync:function(method,self,options){var attrs=self.attributes;switch(options=options||{},options.url=this.url(method),options.processData=!0,options.emulateHTTP=!0,method){case"create":var forum=attrs.forum;attrs.forum||(forum=this.forum.id);var required={title:attrs.title,forum:forum},optional={message:attrs.message};options.data=_.extend(required,optional,options.data);break;case"update":var updatable={title:attrs.title,message:attrs.message};options.data=_.extend({thread:attrs.id},updatable);break;case"delete":options.data=_.extend({thread:attrs.id},options.data);break;case"close":options.data=_.extend({thread:attrs.id},options.data),options.type="POST"}return Backbone.sync(method,self,options)},parse:function(resp){return resp.response||resp},toJSON:function(){var obj=_.extend({},this.attributes,{forum:this.forum.toJSON(),author:this.author?this.author.toJSON():void 0});return obj.link?originalThreadUrlRegex.test(obj.link)&&(obj.link="/home/"+this.getDiscussionRoute()):obj.slug&&(obj.link="/home/"+this.getDiscussionRoute()),obj},getThread:function(){return this},getHostname:function(){var url=this.get("link");if(!url)return"";var a=$("<a>").attr("href",url)[0];return a.hostname||url},getRelativeCreatedAt:function(){return datetimeUtils.getRelativeDatetime(this.get("createdAt"))},getRelativeCommentTimestamp:function(){return datetimeUtils.getRelativeDatetime(this.get("most_recent_comment_timestamp"))},getMostRecentCommenter:function(){var commenter=this.get("most_recent_commenter");return commenter&&!commenter.isAnonymous?commenter:void 0},setEmbedlyData:function(data){this.set({content:{title:data.title,description:data.description,image:data.images&&data.images[0]||{},keywords:data.keywords.length?data.keywords.slice(0,3):[]}})},getImage:function(){var image;return this.get("isUserGenerated")&&(image=this.getUserGeneratedImage()),image||this.getEmbedlyImage()},getEmbedlyImage:function(){var content=this.get("content");return content&&content.image&&content.image.url?{src:content.image.url,title:this.get("title")}:void 0},getUserGeneratedImage:function(){var media=this.getMedia(),firstMedia=media&&media[0];return firstMedia&&firstMedia.thumbnailUrl?{src:firstMedia.thumbnailUrl,title:firstMedia.title}:void 0},getMedia:function(){return this.get("message")?this.get("media"):this.post?this.post.get("media"):[]},hasPreview:function(){var content=this.get("content");return!(!content||!content.image.url&&!content.description)},getDiscussionRoute:function(channel){var route=["discussion",this.forum.id,this.get("slug")];return channel=channel||this.forum.channel,channel&&(route=["channel",channel.get("slug")].concat(route)),route.join("/")},toggleFavorited:function(){var vote=this.get("userScore")?0:1;this.set({userScore:vote}),Backbone.ajax({url:api.getURL("threads/vote"),type:"POST",data:{vote:vote,thread:this.id}})},getDefaultDescription:function(){return this._getDescription(70)},getShortDescription:function(){return this._getDescription(50)},getLongDescription:function(){return this._getDescription(200)},getFullDescription:function(){return this._getDescription(1/0)},_getDescription:function(numWords){if(this.descriptions&&this.descriptions[numWords])return this.descriptions[numWords];var description;if(this.get("isUserGenerated")?this.get("message")?description=this.get("message"):this.post&&(description=this.post.get("message")):this.has("content")&&(description=this.get("content").description),!description||!numWords)return"";var truncated=this._truncate(description,numWords);return this._storeDescription(truncated,numWords),truncated},_truncate:function(text,numWords){var words=text.split(" "),wordsLength=words.length;if(numWords>=wordsLength)return text;var distance,breakIndex,word;for(distance=0;(numWords-1-distance>=0||wordsLength>numWords+distance-1)&&(breakIndex=numWords-1+distance,word=words[breakIndex],!word||"."!==word.slice(-1))&&(breakIndex=numWords-1-distance,word=words[breakIndex],!word||"."!==word.slice(-1));distance++)breakIndex=wordsLength-1;return words.slice(0,breakIndex+1).join(" ")},_storeDescription:function(description,numWords){this.descriptions||(this.descriptions={}),this.descriptions[numWords]=description},_clearDescriptions:function(){this.descriptions={}},confirmDelete:function(){confirmModal.confirmationPromise(confirmModal.TYPES.CONFIRM_CANCEL,confirmDeleteThreadTemplate(this.toJSON())).then(_.bind(function(){this.sync("delete",this).then(_.bind(this.set,this,{isDeleted:!0})),this.sync("close",this).then(_.bind(this.set,this,{isClosed:!0})),Backbone.history.navigate("channel/"+this.forum.channel.id,{trigger:!0,replace:!0})},this))}});return UniqueModel.addType("Thread",Thread),mixins.withCreatedAt.call(Thread.prototype),Thread}),define("home/collections/UpvotersUserCollection",["home/models/common/UniqueModel","home/models/User","core/collections/UpvotersUserCollection"],function(UniqueModel,User,UpvotersUserCollection){return UpvotersUserCollection.extend({model:UniqueModel.boundModel(User),parse:function(response){return response.response}})}),define("home/models/Post",["jquery","underscore","backbone","core/models/Post","home/models/common/UniqueModel","home/models/Thread","home/models/User","home/collections/UpvotersUserCollection","core/api"],function($,_,Backbone,CorePost,UniqueModel,Thread,User,UpvotersUserCollection,api){var Post=CorePost.extend({upvotersCollectionClass:UpvotersUserCollection,initialize:function(attrs,options){this.set({state:this._getPostState()}),this.initializeRelated("thread",_.extend({forum:attrs.forum},options),Thread),this.initializeRelated("author",options,User)},set:Backbone.Model.prototype.set,toJSON:function(){return _.extend({},this.attributes,{author:this.author.toJSON(),thread:this.thread.toJSON()})},getLinks:_.memoize(function(){var $wrapper=$("<div>").html(this.get("message"));return $wrapper.find("a[href]").map(function(index,el){return $(el).attr("href")})},function(){return this.id}),getThreadId:function(){return this.thread.id},_getPostState:function(){return this.get("isSpam")?"spam":this.get("isDeleted")?"deleted":this.get("isFlagged")&&!this.get("isApproved")?"flagged":this.get("isApproved")?"visible":"pending"},vote:function(vote){var newUserScore,likes=this.get("likes"),dislikes=this.get("dislikes"),oldUserScore=this.get("userScore");
1==vote?1==oldUserScore?(vote=0,likes--,newUserScore=0):(-1==oldUserScore&&dislikes--,likes++,newUserScore=1):0>vote&&(-1==oldUserScore?(vote=0,dislikes--,newUserScore=0):(1==oldUserScore&&likes--,dislikes++,newUserScore=-1)),this.set({likes:likes,dislikes:dislikes,userScore:newUserScore}),this.trigger("change:action:votes"),Backbone.ajax({url:api.getURL("posts/vote"),type:"POST",data:{vote:vote,post:this.id}})}});return UniqueModel.addType("Post",Post),Post}),define("home/collections/UserPostCollection",["underscore","core/collections/PaginatedCollection","home/models/common/UniqueModel","home/models/Post","core/api"],function(_,PaginatedCollection,UniqueModel,Post,api){var UserPostCollection=PaginatedCollection.extend({url:api.getURL("users/listPosts"),fetch:function(options){options=options||{},options.data=options.data||{},_.extend(options.data,{related:["thread","forum"]}),PaginatedCollection.prototype.fetch.call(this,options)},parse:function(response){return response.response=_.map(response.response,function(attrs){return new UniqueModel(Post,attrs,{forum:attrs.forum})}),PaginatedCollection.prototype.parse.apply(this,arguments)}});return UserPostCollection}),define("home/collections/common/ExtensibleCollection",["underscore","backbone","core/collections/PaginatedCollection"],function(_,Backbone,PaginatedCollection){var ExtensibleCollection=PaginatedCollection.extend({initialize:function(){PaginatedCollection.prototype.initialize.call(this,arguments),this.once("sync",this.extendData,this),this.on("add:many",this.extendData,this),this.on("nodata",this.onNoData,this)},fetch:function(options){return options=this.prepareFetchOptions(options),PaginatedCollection.prototype.fetch.call(this,options)},more:function(options){return options=this.prepareFetchOptions(options),PaginatedCollection.prototype.more.call(this,options)},prepareFetchOptions:function(options){return options=options||this.lastOptions,this.lastOptions=_.clone(options),this.lastOptions.data=_.clone(options.data),options},extendData:function(data){var models;if(data.models?models=data.models:data instanceof Backbone.Model?(models=[data],this.once("sync",this.extendData,this)):models=data,!models.length)return this.cursor.hasNext=!1,void this.trigger("nodata");var from=0;this.extensionRequestsCount=0;do{var to=Math.min(from+10,models.length),subset=models.slice(from,to);this.requestExData(subset),from+=10,this.extensionRequestsCount++}while(from<=models.length-1)},getThreadFromModel:function(model){if(!model.getThread)throw"Any model that is in an ExtensibleCollection must define function getThread";return model.getThread()},requestExData:function(models,attempts){attempts=attempts||0;var modelsByUrl={};_.each(models,function(model){var thread=this.getThreadFromModel(model),links=thread&&thread.getLinks()||[],url=1===links.length?links[0]:null;return this.shouldExtend(thread,url)?(thread.set({extending:!0}),void(modelsByUrl[url]=model)):void(thread&&thread.set({extending:!1}))},this);var escapedUrls=_.chain(modelsByUrl).keys().map(escape).value();if(escapedUrls.length){var params="urls="+escapedUrls.join(",")+"&words=200";$.ajax({url:ExtensibleCollection.EXTRACT_URL,data:params,processData:!1,dataType:"jsonp",success:function(response){models.timeouts=0,this.onExtendData(response,modelsByUrl)},error:function(response){this.extendDataFailed(response,models,attempts)},context:this,timeout:3e3,complete:this.checkExtendDataComplete})}},shouldExtend:function(thread,url){return thread&&url&&!_.any(thread.getMedia(),function(media){return media.url===url})},onExtendData:function(response,modelsByUrl){this.extensionRequestsCount--,_.each(response,function(item){var model=modelsByUrl[item.original_url];if(model){var thread=this.getThreadFromModel(model);thread.setEmbedlyData(item),thread.set({extending:!1})}},this)},extendDataFailed:function(response,models,attempts){return"timeout"===response.statusText&&3>attempts?void this.handleTimeout(models,attempts):(this.trackError(response),_.each(models,function(model){var thread=this.getThreadFromModel(model);thread.set({extending:!1})},this),void this.extensionRequestsCount--)},handleTimeout:function(models,attempts){var MixpanelUtils=require("home/utils/mixpanelUtils");MixpanelUtils.trackError("timeout: load",null,{properties:{url:ExtensibleCollection.EXTRACT_URL}}),this.requestExData(models,attempts+1)},trackError:function(response){var MixpanelUtils=require("home/utils/mixpanelUtils");MixpanelUtils.trackError("error loading",null,{properties:{resp:response.statusText,url:ExtensibleCollection.EXTRACT_URL}})},checkExtendDataComplete:function(){this.extensionRequestsCount||this.finalizeExtendingData(this.cursor.hasNext)},finalizeExtendingData:function(hasNext){this.trigger("extend",hasNext)},onNoData:function(){this.finalizeExtendingData()}},{EXTRACT_URL:"//extract.services.disqus.com"});return ExtensibleCollection}),define("home/models/ActivityFeedItem",["jquery","underscore","backbone","home/utils/datetimeUtils","home/models/common/UniqueModel"],function($,_,Backbone,datetimeUtils,UniqueModel){var ActivityFeedItem=Backbone.Model.extend({initialize:function(attributes,options){this.activities=options.activities,this.id||(this.id=ActivityFeedItem.buildId(this.activities)),this.set({isUnread:this.activities[0].get("isUnread")})},toJSON:function(){return _.defaults({activities:_.invoke(this.activities,"toJSON"),actors:_.invoke(this.actors,"toJSON"),thread:this.thread&&this.thread.toJSON()},Backbone.Model.prototype.toJSON.apply(this,arguments))},getThread:function(){return this.thread},hasThreadImage:function(){var image=$.Deferred(),thread=this.thread,imageData=thread&&thread.getImage();return thread?imageData?image.resolve(!0):thread.get("extending")===!1?image.resolve(!1):thread.on("change:extending",function(thread,isExtending){isExtending===!1&&(imageData=thread.getImage(),image.resolve(imageData?!0:!1))}):image.resolve(!1),image.promise()},getBackendId:function(){return this.activities[0].get("backendId")},getRelativeTimestamp:function(){return datetimeUtils.getRelativeDatetime(this.get("published"))}},{buildId:function(activities){return _.pluck(activities,"id").join("|")}});return UniqueModel.addType("ActivityFeedItem",ActivityFeedItem),ActivityFeedItem}),define("home/activityExpander",["underscore","backbone","home/models/common/UniqueModel","home/models/User","home/models/Post","home/models/Thread"],function(_,Backbone,UniqueModel,User,Post,Thread){return{parseObject:function(objects,attrs){return _.isString(attrs)?objects[attrs]:attrs},buildPost:function(objects,postAttrs){if(postAttrs instanceof Post)return postAttrs;postAttrs=this.parseObject(objects,postAttrs);var threadAttrs=this.parseObject(objects,postAttrs.thread)||objects["forums.Thread?id="+postAttrs.thread]||UniqueModel.pool(Thread)[postAttrs.thread];return new UniqueModel(Post,postAttrs,{author:this.parseObject(objects,postAttrs.author),thread:this.buildThread(objects,threadAttrs)})},buildNote:function(objects,noteAttrs){return new Backbone.Model(this.parseObject(objects,noteAttrs))},buildThread:function(objects,threadAttrs){return threadAttrs instanceof Thread?threadAttrs:(threadAttrs=this.parseObject(objects,threadAttrs),_.has(objects,"auth.User?id="+threadAttrs.author)&&(threadAttrs.author="auth.User?id="+threadAttrs.author),new UniqueModel(Thread,threadAttrs,{forum:this.parseObject(objects,threadAttrs.forum),author:this.parseObject(objects,threadAttrs.author),highlightedPost:this.parseObject(objects,threadAttrs.highlightedPost)}))},buildUser:function(objects,userAttrs){return userAttrs instanceof User?userAttrs:(userAttrs=this.parseObject(objects,userAttrs),new UniqueModel(User,userAttrs))}}}),define("home/models/Activity",["require","underscore","backbone","home/utils/datetimeUtils","home/models/common/UniqueModel"],function(require,_,Backbone,datetimeUtils,UniqueModel){var Activity=Backbone.Model.extend({defaults:{version:0,verb:null},buildId:function(attributes){return attributes=attributes||this.attributes,this.constructor.buildId(attributes.actor,attributes.verb||this.constructor.prototype.defaults.verb,attributes.target,attributes.object)},parse:function(resp,options){return resp.id&&options&&options.objects&&(resp=this.parseRelatedModels(resp,options.objects),resp.backendId=resp.id,resp.id=this.buildId(resp)),resp},toJSON:function(){return _.defaults({actor:this.actor&&this.actor.toJSON(),target:this.target&&this.target.toJSON(),object:this.object&&this.object.toJSON(),thread:this.thread&&this.thread.toJSON(),forum:this.thread&&this.thread.forum.toJSON()},this.attributes)},getThread:function(){return this.thread},getRelativeCreatedAt:function(){return datetimeUtils.getRelativeDatetime(this.object.get("createdAt"))},vote:function(vote,postId){var post=this.object;vote&&post.id==postId&&post.vote(vote)},isAuthorSessionUser:function(){var Session=require("home/models/Session"),session=new Session;return session.isSessionUser(this.actor.id)},isReplyToSessionUser:function(){return"reply"===this.get("verb")&&this.target.author.isSessionUser()},canPermalink:function(){var state=this.object.get("state");return"visible"===state||"pending"===state},canEdit:function(){return this.isAuthorSessionUser()&&!this.object.isHighlighted}},{buildId:function(actor,verb,object,target){return[actor?actor.id:"",verb,object?object.id:"",target?target.id:""].join("|")}});return UniqueModel.addType("Activity",Activity),Activity}),define("home/models/activities/FavoriteThreadActivity",["home/models/Activity","home/activityExpander"],function(Activity,activityExpander){var FavoriteThreadActivity=Activity.extend({defaults:{verb:"favorite"},initialize:function(attributes){this.actor=attributes.actor,this.target=attributes.target,this.thread=this.target},parseRelatedModels:function(attributes,objects){return attributes.actor=activityExpander.buildUser(objects,attributes.actor),attributes.target=activityExpander.buildThread(objects,attributes.object),attributes}});return FavoriteThreadActivity}),define("home/models/activities/ReplyActivity",["home/models/Activity","home/activityExpander"],function(Activity,activityExpander){return Activity.extend({defaults:{verb:"reply"},initialize:function(attributes){this.actor=attributes.actor,this.object=attributes.object,this.target=attributes.target,this.thread=this.object.thread},parseRelatedModels:function(attributes,objects){return attributes.object=activityExpander.buildPost(objects,attributes.object),attributes.actor=attributes.actor?activityExpander.buildUser(objects,attributes.actor):attributes.object.author,attributes.target=activityExpander.buildPost(objects,attributes.object.get("parent_post")),attributes}})}),define("home/models/activities/PostActivity",["home/models/Activity","home/activityExpander"],function(Activity,activityExpander){var PostActivity=Activity.extend({defaults:{verb:"post"},initialize:function(attributes){this.actor=attributes.actor,this.object=attributes.object,this.target=this.object.thread,this.thread=this.object.thread},parseRelatedModels:function(attributes,objects){return attributes.actor=activityExpander.buildUser(objects,attributes.actor),attributes.object=activityExpander.buildPost(objects,attributes.object),attributes.target=attributes.object.thread,attributes}});return PostActivity}),define("home/models/activities/LikePostActivity",["home/models/Activity","home/activityExpander"],function(Activity,activityExpander){return Activity.extend({defaults:{verb:"favorite"},initialize:function(attributes){this.actor=attributes.actor,this.target=attributes.target,this.thread=this.target.thread},parseRelatedModels:function(attributes,objects){return attributes.actor=activityExpander.buildUser(objects,attributes.actor),attributes.target=activityExpander.buildPost(objects,attributes.object),attributes}})}),define("home/models/activities/TrendingThreadActivity",["home/models/Activity","home/activityExpander"],function(Activity,activityExpander){return Activity.extend({defaults:{verb:"trending"},initialize:function(attributes){this.target=attributes.target,this.thread=this.target},parseRelatedModels:function(attributes,objects){return attributes.target=activityExpander.buildThread(objects,attributes.object),attributes.thread=attributes.target,attributes}})}),define("home/models/activities/FollowUserActivity",["home/models/Activity","home/activityExpander"],function(Activity,activityExpander){return Activity.extend({defaults:{verb:"follow"},initialize:function(attributes){this.actor=attributes.actor,this.target=attributes.target},parseRelatedModels:function(attributes,objects){return attributes.actor=activityExpander.buildUser(objects,attributes.actor),attributes.target=activityExpander.buildUser(objects,attributes.object),attributes}})}),define("home/models/activities/NoteActivity",["home/models/Activity","home/activityExpander"],function(Activity,activityExpander){return Activity.extend({defaults:{verb:"send"},initialize:function(attributes){this.object=attributes.object},parseRelatedModels:function(attributes,objects){return attributes.object=activityExpander.buildNote(objects,attributes.object),attributes}})}),define("home/models/activities/CreateThreadActivity",["underscore","home/models/Activity","home/activityExpander"],function(_,Activity,activityExpander){return Activity.extend({defaults:{verb:"create"},initialize:function(attributes){this.target=attributes.target,this.thread=this.target},parseRelatedModels:function(attributes,objects){return attributes.target=activityExpander.buildThread(objects,attributes.object),attributes.thread=attributes.target,attributes.thread.initializeRecentPosts({recentPosts:_.map(attributes.recentPosts,_.bind(activityExpander.buildPost,activityExpander,objects))}),attributes}})}),define("home/ActivityFactory",["underscore","backbone","home/activityExpander","home/models/common/UniqueModel","home/models/Activity","home/models/activities/FavoriteThreadActivity","home/models/activities/ReplyActivity","home/models/activities/PostActivity","home/models/activities/LikePostActivity","home/models/activities/TrendingThreadActivity","home/models/activities/FollowUserActivity","home/models/activities/NoteActivity","home/models/activities/CreateThreadActivity"],function(_,Backbone,activityExpander,UniqueModel,Activity,FavoriteThreadActivity,ReplyActivity,PostActivity,LikePostActivity,TrendingThreadActivity,FollowUserActivity,NoteActivity,CreateThreadActivity){var ActivityFactory=function(){},methods={createActivity:function(attributes,options){var ActivityClass=this.getActivityClass(attributes,options);if(!ActivityClass)return null;var activity=new ActivityClass(attributes,options);return UniqueModel.set(Activity,activity)},getActivityClass:function(attributes,options){switch(attributes.type){case"RegisteredUserFavoriteThread":case"AnonymouseUserFavoriteThread":return attributes.verb=FavoriteThreadActivity.prototype.defaults.verb,FavoriteThreadActivity;case"RegisteredUserSubmitPost":case"AnonymousUserSubmitPost":var object=activityExpander.buildPost(options.objects,attributes.object);return attributes.object=object,object.get("parent_post")?(attributes.verb=ReplyActivity.prototype.defaults.verb,ReplyActivity):(attributes.verb=PostActivity.prototype.defaults.verb,PostActivity);case"RegisteredUserLikePost":case"AnonymousUserLikePost":return attributes.verb=LikePostActivity.prototype.defaults.verb,LikePostActivity;case"RegisteredUserCreateThread":return attributes.verb=CreateThreadActivity.prototype.defaults.verb,CreateThreadActivity;case"TrendingThread":return attributes.verb=TrendingThreadActivity.prototype.defaults.verb,TrendingThreadActivity;case"UserFollowUser":return attributes.verb=FollowUserActivity.prototype.defaults.verb,FollowUserActivity;case"UserSendNoteToUserGroup":return NoteActivity;case"UserSendNoteToUser":return NoteActivity;case"UserFollowForum":return null}}};return _.extend(ActivityFactory.prototype,methods),ActivityFactory}),define("home/collections/FeedItemCollection",["underscore","backbone","home/collections/common/ExtensibleCollection","home/models/common/UniqueModel","home/models/ActivityFeedItem","home/ActivityFactory","home/activityExpander","core/api"],function(_,Backbone,ExtensibleCollection,UniqueModel,ActivityFeedItem,ActivityFactory,activityExpander,api){var FeedItemCollection=ExtensibleCollection.extend({url:api.getURL("timelines/activities?type=universal"),parse:function(response){var boundTransform=_.bind(FeedItemCollection.transform,FeedItemCollection,response.response.objects);return response.response=_.chain(response.response.activities).map(boundTransform).compact().value(),ExtensibleCollection.prototype.parse.call(this,response)}},{activityFactory:new ActivityFactory,transform:function(objects,item){return item.items?this.buildFeedItemFromGroupedActivities(objects,item):this.buildFeedItemFromSingleActivity(objects,item)},buildFeedItemFromGroupedActivities:function(objects,group){group.actors=group.actors||{items:[]};var activities=_.chain(group.items).map(_.bind(this.buildActivity,this,objects)).compact().value(),actors=_.map(group.actors.items,_.bind(activityExpander.buildUser,activityExpander,objects)),activity=activities[0],verb=activity&&activity.get("verb");if(activity){!actors.length&&activity.actor&&(group.actors.totalItems=1,actors=[activity.actor]);var feedItemId=ActivityFeedItem.buildId(activities),attributes={id:feedItemId,verb:"reply"===verb&&activities.length>1?"post":verb,published:group.published,totalActors:group.actors&&group.actors.totalItems||0,totalActivities:group.totalItems},options={activities:activities},feedItem=new UniqueModel(ActivityFeedItem,attributes,options);return feedItem.actors=actors,feedItem.thread=activity.thread,feedItem}},buildFeedItemFromSingleActivity:function(objects,item){var activity=this.buildActivity(objects,item);if(activity){var activities=[activity],feedItemId=ActivityFeedItem.buildId(activities),attributes=_.defaults({id:feedItemId,totalActors:1,totalActivities:1,verb:activity.get("verb")},item),options={activities:activities},feedItem=new UniqueModel(ActivityFeedItem,attributes,options);return feedItem.thread=activity.thread,feedItem.actors=activity.actor?[activity.actor]:[],feedItem}},buildActivity:function(objects,item){try{return this.activityFactory.createActivity(item,{objects:objects,parse:!0})}catch(err){return void Raven.captureMessage("error parsing activity item",{extra:item})}}});return FeedItemCollection}),define("home/collections/ForumCollection",["underscore","core/collections/PaginatedCollection","home/models/common/UniqueModel","home/models/Forum"],function(_,PaginatedCollection,UniqueModel,Forum){var ForumCollection=PaginatedCollection.extend({model:UniqueModel.boundModel(Forum)});return ForumCollection}),define("home/collections/FollowingForumCollection",["underscore","home/utils/backboneUtils","core/collections/PaginatedCollection","home/collections/ForumCollection","core/api"],function(_,BackboneUtils,PaginatedCollection,ForumCollection,api){var FollowingForumCollection=ForumCollection.extend({url:api.getURL("users/listFollowingForums"),initialize:function(){this.on("add",this.completeModel)},completeModel:function(model){model.get("name")||model.fetch()},fetch:function(options){return options=options||{},options.data=_.defaults({limit:100},options.data),BackboneUtils.memoizedFetch.call(this,options)}});return FollowingForumCollection}),define("home/collections/FollowingUserCollection",["home/collections/UserCollection","core/api"],function(UserCollection,api){return UserCollection.extend({url:api.getURL("users/listFollowing")})}),define("home/models/Feed",["underscore","jquery","backbone"],function(_,$,Backbone){var Feed=Backbone.Model.extend({defaults:function(){return{fetching:!1,hasNext:!0,error:!1,items:null,numPages:0,fetchOptions:{},active:!1}},initialize:function(attrs,options){if(!options||!options.collectionClass&&!options.collection)throw"Feed must specify the type of collection it maintains, or pass the collection";var items=options.collection||new options.collectionClass([],options.collectionOptions);items.cursor&&_.has(items.cursor,"hasNext")&&this.set("hasNext",items.cursor.hasNext),options.collectionUrl&&(items.url=options.collectionUrl),this.set({items:items}),items.on("extend",this.onExtendComplete,this),items.on("sync",this.onSync,this),this.listenTo(items,"all",this.propagateCollectionEvents),this.on("change:active",this.activeChanged,this)},propagateCollectionEvents:function(){var args=Array.prototype.slice.apply(arguments);args[0]="items:"+args[0],this.trigger.apply(this,args)},activeChanged:function(){this.get("active")&&!this.get("items").length&&this.fetchItems()},fetchItems:function(options){if(options=options||{},(options.reset||this.get("hasNext"))&&(!this.get("fetching")||this.get("timeouts"))){this.set({fetching:!0}),options.data=options.data||{},_.extend(options.data,this.get("fetchOptions"));var existingErr=options.error,existingSuccess=options.success,self=this,MixpanelUtils=require("home/utils/mixpanelUtils");options.error=function(collection,resp){return"timeout"===resp.statusText&&(self.get("timeouts")||0)<3?(MixpanelUtils.trackError("timeout: load",null,{properties:{url:_.result(collection,"url"),params:$.param(self.get("fetchOptions"))}}),self.set({timeouts:(self.get("timeouts")||0)+1}),void self.fetchItems()):(MixpanelUtils.trackError("error loading",null,{properties:{resp:resp.responseText,url:_.result(collection,"url"),params:$.param(self.get("fetchOptions"))}}),self.set({fetching:!1,error:!0,hasNext:!1,timeouts:0}),void(existingErr&&existingErr.apply(this,arguments)))},options.success=function(){self.set({error:!1,timeouts:0,numPages:self.get("numPages")+1}),existingSuccess&&existingSuccess.apply(this,arguments)};var isInitialFetch=$.isEmptyObject(self.get("items").cursor)||options.reset;return isInitialFetch||MixpanelUtils.track("fetched more feed items",null,{properties:{url:options.url||_.result(self.get("items"),"url"),params:$.param(self.get("fetchOptions"))}}),self.get("items")[isInitialFetch?"fetch":"more"](options)}},onSync:function(items,response){this.set({fetching:!1,hasNext:response.cursor&&response.cursor.hasNext})},onExtendComplete:function(hasNext){this.set({hasNext:hasNext})}});return Feed}),define("home/models/UserProfile",["underscore","backbone","home/apps/common/backboneUtils","home/collections/UserCollection","home/collections/UserPostCollection","home/collections/FeedItemCollection","home/collections/FollowingForumCollection","home/collections/FollowingUserCollection","home/models/common/UniqueModel","home/models/User","home/models/Feed","core/api"],function(_,Backbone,BackboneUtils,UserCollection,UserPostCollection,FeedItemCollection,FollowingForumCollection,FollowingUserCollection,UniqueModel,User,Feed,api){var UserProfile=Backbone.Model.extend({idAttribute:"username",initialize:function(attrs,options){this.initializeRelated("user",_.defaults({user:{username:this.get("username")}},options),User),this.listenTo(this.user,"change:isFollowing",this.updateFollowers);var fetchOptions={user:"username:"+this.user.get("username"),order:"desc"};this.forumsFollowing=new Feed({fetchOptions:fetchOptions},{collectionClass:FollowingForumCollection}),this.following=new Feed({fetchOptions:fetchOptions},{collectionClass:FollowingUserCollection}),this.followers=new Feed({fetchOptions:fetchOptions},{collectionClass:UserCollection,collectionUrl:api.getURL("users/listFollowers")}),fetchOptions={target:"user:username:"+this.user.get("username")},this.posts=new Feed({fetchOptions:fetchOptions},{collectionClass:FeedItemCollection,collectionUrl:api.getURL("timelines/activities?type=profile")}),this.profileFeed=this.posts},isPrivate:function(){return!this.user.isSessionUser()&&this.user.get("isPrivate")},toJSON:function(){return _.defaults({user:this.user.toJSON(),following:this.following.toJSON(),followers:this.followers.toJSON(),posts:this.posts.toJSON(),profileFeed:this.profileFeed.toJSON()},this.attributes)},ensureFetched:function(){if(!this.user.get("username"))throw"UserProfile requires a username or id in order to be fetched";this.user.shouldFetch()&&this.user.fetch({data:{user:"username:"+this.user.get("username")}}),this.following.get("items").fetched||this.fetchFollowing(),this.forumsFollowing.get("items").fetched||this.fetchForumsFollowing(),this.followers.get("items").fetched||this.followers.fetchItems({reset:!0}),this.posts.get("items").length||this.posts.fetchItems({reset:!0})},fetchFollowing:function(){this.following.fetchItems({reset:!0})},fetchForumsFollowing:function(){this.forumsFollowing.fetchItems({reset:!0})},updateFollowers:function(){var Session=require("home/models/Session"),session=new Session;if(!session.isAnonymous()){var sessionUser=session.user,method=this.user.get("isFollowing")?"add":"remove";this.followers.get("items")[method](sessionUser)}}});return UniqueModel.addType("UserProfile",UserProfile),UserProfile}),define("home/collections/RepliesCollection",["underscore","backbone","home/collections/FeedItemCollection","core/api"],function(_,Backbone,FeedItemCollection,api){var RepliesCollection=FeedItemCollection.extend({url:api.getURL("activity/list?source=reply"),parse:function(response){var boundTransform=_.bind(RepliesCollection.transform,RepliesCollection);return response.response.objects={},response.response.activities=_.map(response.response,boundTransform),FeedItemCollection.prototype.parse.call(this,response)}},{transform:function(item){return item.target.thread.forum=item.target.forum,{items:[{object:item.target,routings:[{type:"DirectRelation",relation:"object.parent.author"}],actor:item.target.author,id:item.id,verb:"submit",published:item.timestamp,type:item.target.author.id?"RegisteredUserSubmitPost":"AnonymousUserSubmitPost",isUnread:!1}],verb:"submit",actors:{totalItems:1,items:[item.target.author]},published:item.timestamp,totalItems:1,type:"Collection"}}});return RepliesCollection}),define("home/models/RepliesFeed",["underscore","home/models/Feed","home/collections/RepliesCollection"],function(_,Feed,RepliesCollection){var RepliesFeed=Feed.extend({initialize:function(options){Feed.prototype.initialize.call(this,{},_.extend({collectionClass:RepliesCollection},options))}});return RepliesFeed}),define("home/collections/NotificationCollection",["underscore","backbone-marionette","home/collections/FeedItemCollection"],function(_,Marionette,FeedItemCollection){var NotificationCollection=FeedItemCollection.extend({parse:function(response){Marionette.triggerMethod.call(this,"parse",response);var parsed=FeedItemCollection.prototype.parse.apply(this,arguments);return _.filter(parsed,function(item){return/reply|favorite|follow|send/.test(item.get("verb"))?!0:void Raven.captureMessage("unsupported activity item",{extra:item})})}});return NotificationCollection}),define("home/models/TimelineFilter",["jquery","backbone","underscore","core/api","core/config"],function($,Backbone,_,api,config){return Backbone.Model.extend({urls:{update:api.getURL("timelines/filters/add"),"delete":api.getURL("timelines/filters/remove")},parse:function(response){return response.response||response},serializeData:function(){return{filter:this.id,api_key:config.keys.api}},sync:function(method,model,options){return options.emulateHTTP=!0,options.emulateJSON=!1,("update"===method||"delete"===method)&&(options.data=$.param(model.serializeData())),options.url=this.urls[method],Backbone.Model.prototype.sync.call(this,method,model,options)}})}),define("home/collections/TimelineFiltersCollection",["jquery","backbone","underscore","core/api","core/config","home/models/TimelineFilter"],function($,Backbone,_,api,config,Filter){return Backbone.Collection.extend({model:Filter,initialize:function(items,options){options=options||{},this.type=options.type},url:function(){return api.getURL("timelines/filters/list")+"?"+$.param({type:this.type})},addFilter:function(filterName){var exists=this.get(filterName);return exists||(exists=this.add({id:filterName})),exists.save()},removeFilter:function(filterName){var exists=this.get(filterName);return exists||(exists=new Filter({id:filterName})),exists.destroy()},parse:function(response){return response.response||response}})}),define("home/models/Notifications",["underscore","backbone","home/models/Feed","home/models/RepliesFeed","home/collections/NotificationCollection","home/collections/TimelineFiltersCollection","core/api"],function(_,Backbone,Feed,RepliesFeed,NotificationCollection,TimelineFiltersCollection,api){var Notifications=Backbone.Model.extend({defaults:{numUnread:0},initialize:function(){var timeComparator=function(notification){return-1*new Date(notification.get("published")).getTime()};this.all=new Feed({},{collectionClass:NotificationCollection,collectionUrl:api.getURL("timelines/activities?type=notifications"),collectionOptions:{comparator:timeComparator}}),this.replies=new RepliesFeed({collectionOptions:{comparator:timeComparator}}),this.listenTo(this.all,"items:sync",this.updateNumUnread),this.listenTo(this.all,"clearUnreadCount",this.clearUnreadCount),this.listenTo(this.all,"items:sync",this.syncRepliesAcrossFeeds),this.listenTo(this.replies,"items:sync",this.syncRepliesAcrossFeeds),this.listenTo(this.replies,"items:sync",this.markRepliesUnread),this.listenTo(this.all,"items:parse",this.parseReadCursors),this.filters=new TimelineFiltersCollection},markRepliesUnread:function(){if(!this.get("readPosition"))return void this.once("change:readPosition",_.bind(this.markRepliesUnread,this));var notificationTimestamp,readTimestamp=this.backendIdToTimestamp(this.get("readPosition"));this.replies.get("items").each(function(notification){notificationTimestamp=new Date(notification.activities[0].get("published")).getTime(),notification.set({isUnread:notificationTimestamp>=readTimestamp})},this)},backendIdToTimestamp:function(backendId){if(backendId=backendId.replace(/-/g,""),32!==backendId.length)return Date.now();var hiTime=backendId.substring(backendId.length-16-3,backendId.length-16),midTime=backendId.substring(backendId.length-20-4,backendId.length-20),loTime=backendId.substring(0,backendId.length-24),time=hiTime+midTime+loTime,offsetTimestamp=parseInt(time,16),retval=(offsetTimestamp-122192928e9)/1e7*1e3;return 11783232e5>retval||retval>Date.now()?Date.now():retval},getOtherFeed:function(feed){return feed===this.all||feed===this.all.get("items")?this.replies:this.all},syncRepliesAcrossFeeds:function(fetched,response){var other=this.getOtherFeed(fetched);this.syncFeeds(response.response,other.get("items")),this.syncFeeds(other.get("items").models,fetched)},syncFeeds:function(source,target){if(target.length){var i,notification,oldest=new Date(target.last().get("published"));for(i=0;i<source.length&&(notification=source[i],!(new Date(notification.get("published"))<oldest));i++)"reply"===notification.get("verb")&&target.add(notification)}},getUnreadCount:function(){return this.all.get("items").reduce(function(count,item){return count+Number(item.get("isUnread"))},0)},updateNumUnread:function(){this.set({numUnread:this.getUnreadCount()})},parseReadCursors:function(response){var fetchOptions=this.all.get("fetchOptions")||{};fetchOptions.readPosition=response.response.readPosition,this.all.set({fetchOptions:fetchOptions}),this.set({latestPosition:response.response.latestPosition,readPosition:response.response.readPosition}),this.stopListening(this.all,"items:parse",this.parseReadCursors)},refetch:function(){return this.listenTo(this.all,"items:parse",this.parseReadCursors),this.all.fetchItems({reset:!0,success:_.bind(this.all.trigger,this.all,"clearUnreadCount")})},ensureFetched:function(){this.all.fetched||this.all.fetchItems(),this.replies.fetched||this.replies.fetchItems()},clearUnreadCount:function(){this.set({numUnread:0}),this.stopListening(this.all,"items:sync",this.updateNumUnread),this.get("latestPosition")&&Backbone.ajax({url:api.getURL("timelines/setReadPosition"),type:"POST",data:{type:"notifications",position:this.get("latestPosition")}})
}});return Notifications}),define("home/utils/iframeUtils",[],function(){var exports={};return exports.isIframed=function(win){try{return win.self!==win.top}catch(e){return!0}},exports}),define("home/utils/navigationUtils",["jquery","underscore","backbone","home/utils/iframeUtils"],function($,_,Backbone,IframeUtils){var leadingHashRegex=/^#/,trailingHashRegex=/#.*$/,navigateToLogin=function(){$("body").html('<div class="spinner"></div>'),window.location="https://disqus.com/profile/login/?next="+encodeURIComponent("https://disqus.com"+window.location.pathname)},NavigationUtils={init:function(){this.scrollPositions={},this.listenForNav(),this.fixScrollAfterNav(),IframeUtils.isIframed(window)||$("body").on("click","a",_.bind(this.captureLinks,this))},isInboundLinkClick:function(ev){if(!ev.isDefaultPrevented()){var link=ev.currentTarget,fragment=decodeURI(link.pathname+link.search+link.hash),root=Backbone.history.root;if(link.href&&!this.isExternalLink(link)&&!leadingHashRegex.test(fragment)&&(this.matchesRoot(fragment)&&(fragment=fragment.slice(root.length)),this.matchesAnyRoute(fragment.replace(trailingHashRegex,""))&&!ev.metaKey&&!ev.ctrlKey))return!0}},scrollToElement:function(e){if(e){e.preventDefault();var selector=$(e.currentTarget).attr("href"),$el=$(selector),$header=$("header.nav-container-outer"),headerHeight=$header.height();return $("body").scrollTop($el.offset().top-headerHeight),!1}},cleanFragment:function(fragment){var root=Backbone.history.root;return this.matchesRoot(fragment)&&(fragment=fragment.slice(root.length)),fragment},captureLinks:function(ev){if(!this.isInboundLinkClick(ev))return void $(ev.currentTarget).attr("target","_blank");var link=ev.currentTarget,fragment=decodeURI(link.pathname+link.search+link.hash);ev.preventDefault(),Backbone.history.navigate(this.cleanFragment(fragment),!0),link.hash&&this.scrollToElement(ev)},matchesRoot:function(fragment){var root=Backbone.history.root;return 0===fragment.indexOf(root)||fragment===root.replace(/\/$/,"")},matchesAnyRoute:function(fragment){return _.any(Backbone.history.handlers,function(handler){return handler.route.test(fragment)})},listenForNav:function(){$("body").on("click","a[href]",_.bind(this.storeScrollPosition,this));var origNavigate=Backbone.History.prototype.navigate,self=this;Backbone.History.prototype.navigate=function(){return self.storeScrollPosition.call(self),origNavigate.apply(this,arguments)}},isExternalLink:function(link){var location=window.location;return link.protocol!==location.protocol||link.host!==location.host||!this.matchesRoot(link.pathname)},fixScrollAfterNav:function(){var origLoadUrl=Backbone.History.prototype.loadUrl,self=this;Backbone.History.prototype.loadUrl=function(){var retval=origLoadUrl.apply(this,arguments);return self.applyScrollPosition.call(self),retval}},storeScrollPosition:function(){this.scrollPositions[Backbone.history.getFragment()]=window.pageYOffset||document.documentElement.scrollTop},applyScrollPosition:function(){window.scrollTo(0,this.scrollPositions[Backbone.history.getFragment()])},navigateToLoginOnAuthFail:function(xhr){if(!xhr.responseText)return xhr;var response=JSON.parse(xhr.responseText);return"/home/welcome"!==window.location.pathname&&(4===response.code||2===response.code&&/authenticate/.test(response.response))&&navigateToLogin(),xhr},navigateToLogin:navigateToLogin};return NavigationUtils}),define("home/models/AnonUser",["home/models/common/BaseUser","home/utils/navigationUtils"],function(BaseUser,navigationUtils){var AnonUser=BaseUser.extend({initialize:function(){this.listenTo(this,"followed:user",this.promptLogin),this.listenTo(this,"unfollowed:user",this.promptLogin),this.listenTo(this,"followed:forum",this.promptLogin),this.listenTo(this,"unfollowed:forum",this.promptLogin)},promptLogin:function(){navigationUtils.navigateToLogin()}});return function(){var _anonUser;return function(){return _anonUser||(_anonUser=new AnonUser),_anonUser}}()}),define("home/models/Session",["underscore","backbone","core/api","core/models/Session","home/models/common/UniqueModel","home/models/Forum","home/models/User","home/models/UserProfile","home/models/Notifications","home/models/AnonUser","home/utils/backboneUtils"],function(_,Backbone,api,SharedSession,UniqueModel,Forum,User,UserProfile,Notifications,AnonUser,BackboneUtils){var Session=SharedSession.extend({initialize:function(){SharedSession.prototype.initialize.apply(this,arguments),this.moderatedForums=[]},getAnonUserInstance:function(attrs){return new AnonUser(attrs)},isAnonymous:function(){return this.user.get("isAnonymous")},setUser:function(user){return this.user&&this.stopListening(this.user),this.listenTo(user,"all",this.trigger),SharedSession.prototype.setUser.apply(this,arguments)},fetchModeratedForums:function(){var user=this.user,self=this;Backbone.ajax({url:api.getURL("internal/users/details"),success:function(data){var moderatedForums=data.response.moderated_forums;self.moderatedForums=moderatedForums,self.trigger("setModeratedForums",moderatedForums),user.set({moderatesForum:!!moderatedForums.length})},context:user})},fetch:function(){var self=this,fetchPromise=BackboneUtils.memoizedFetch.apply(this,arguments);return fetchPromise.then(function(){self.trigger("fetch:success")},function(){self.trigger("fetch:error")}),fetchPromise},getUserInstance:function(attrs){return new UniqueModel(User,attrs)},getUserProfile:function(){return this.isAnonymous()?void 0:this.userProfile},getOrCreateNotifications:function(){return this.notifications||(this.notifications=new Notifications,this.notifications.ensureFetched()),this.notifications},toJSON:function(){return this.user.toJSON.apply(this.user,arguments)},initUserProfile:function(username){if(username){this.userProfile&&this.userProfile.stopListening(this),this.userProfile=new UniqueModel(UserProfile,{username:username}),this.userProfile.forumsFollowing.once("items:sync",function(forums){forums.each(function(forum){forum.set({followed:!0})})});var followingUsers=this.userProfile.following.get("items"),followingForums=this.userProfile.forumsFollowing.get("items");this.userProfile.listenTo(this,"followed:user",_.bind(followingUsers.add,followingUsers)),this.userProfile.listenTo(this,"unfollowed:user",_.bind(followingUsers.remove,followingUsers)),this.userProfile.listenTo(this,"followed:forum",_.bind(followingForums.add,followingForums)),this.userProfile.listenTo(this,"unfollowed:forum",_.bind(followingForums.remove,followingForums)),this.userProfile.fetchFollowing(),this.userProfile.fetchForumsFollowing()}}});return function(){var _session;return function(){return _session||(_session=new Session),_session}}()}),define("home/utils/mixpanelUtils",["jquery","underscore","home/models/Session"],function($,_,Session){var baseUrlPath="/home/",queue=[];return{queue:queue,buildProductProperties:function(){return{product:require("home/utils/trackingUtils").productName()}},buildLocationProperties:function(e,includeDetails){if(!e)return{};var properties={},$target=$(e.target),locationElements=$target.parents("[data-mix-location],[data-mix-location-dtl]");return($target.data("mixLocation")||$target.data("mixLocationDtl"))&&locationElements.splice(0,0,$target[0]),properties.location=locationElements.map(function(i,element){return $(element).data("mixLocation")}).toArray().reverse().join(" "),includeDetails&&(properties.detailedLocation=locationElements.map(function(i,element){return $(element).data("mixLocation")||$(element).data("mixLocationDtl")}).toArray().reverse()),properties},buildUserProperties:function(skipFetch){this.session||(this.session=new Session);var promises=[];!skipFetch&&this.session.fetchPromise&&promises.push(this.session.fetchPromise);var onFetched=_.bind(function(){var user=this.session.user,attrs=[];return this.session.isAnonymous()?attrs.push("anon"):(user.get("numPosts")>0&&attrs.push("commenter"),user.get("numFollowing")>0&&attrs.push("userFollower"),user.get("numForumsFollowing")>0&&attrs.push("forumFollower"),attrs.length||attrs.push("inactive")),{user:attrs.join(",")}},this);return $.when.apply(this,promises).then(onFetched,onFetched)},trackUser:function(user){window.mixpanel&&(window.mixpanel.identify(user.get("id")),window.mixpanel.people.set({name:user.get("name"),username:user.get("username"),joinedAt:user.get("joinedAt")}))},doesUrlLeavePage:function(url){return"#"===url[0]?!1:url.slice(0,baseUrlPath.length)!==baseUrlPath},trackError:function(){return this.track.apply(this,arguments)},track:function(eventName,e,options){if(window.mixpanel){var $target,href;options=options||{},options.properties=_.extend({version:"2"},options.properties),e&&($target=$(e.target),href=$target.attr("href")),!options.callback&&$target&&$target.is("a")&&"_blank"!==$target.attr("target")&&href&&this.doesUrlLeavePage(href)&&(e.preventDefault(),options.callback=function(){window.location=href}),options.properties=_.extend(this.buildLocationProperties(e,options.includeDetails),options.properties),_.extend(options.properties,this.buildProductProperties());var skipFetch=!!options.callback||options.skipUserProperties;this.buildUserProperties(skipFetch).always(function(userProperties){options.properties=_.extend(userProperties,options.properties),window.mixpanel.track(eventName,options.properties,options.callback)})}}}}),define("home/mixins/asEmbedLayout",["jquery","underscore","backbone","core/frameBus","core/utils","home/utils/mixpanelUtils"],function($,_,Backbone,FrameBus,coreUtils,MixpanelUtils){var asEmbedLayout=function(){var _events=this.events||{};this.events=_.extend({"click [data-action=close-drawer]":"closeDrawer","click .viewport":"closeDrawerOnClick","click [data-action=full-root]":"openFullRoot","click [data-action=refresh-drawer]":"handleRefresh"},_events),this.handleRefresh=function(e){e.preventDefault();var elem=$(e.currentTarget);elem.addClass("loading");var notifications=this.session.getOrCreateNotifications(),allUpdated=$.Deferred(),repliesUpdated=$.Deferred();this.listenToOnce(notifications.all,"items:parse",_.bind(notifications.parseReadCursors,notifications)),$.when(allUpdated,repliesUpdated).done(function(){elem.removeClass("loading"),notifications.all.trigger("clearUnreadCount")}),notifications.all.fetchItems({reset:!0,success:function(){allUpdated.resolve()}}),notifications.replies.fetchItems({reset:!0,success:function(){repliesUpdated.resolve()}})},this.openFullRoot=function(e){MixpanelUtils.track("click full root",e)},this.closeDrawerOnClick=function(e){$(e.target).hasClass("viewport")&&this.closeDrawer(e)},this.isIE10=function(){return 10===document.documentMode},this.closeDrawer=function(e){e.preventDefault();var body=$("body");body.removeClass("active"),this.isIE10()||!coreUtils.transitionEndEvent?_.delay(_.bind(FrameBus.sendHostMessage,this,"close"),300):body.one(coreUtils.transitionEndEvent,function(){FrameBus.sendHostMessage("close")})};var _onDomRefresh=this.onDomRefresh;this.onDomRefresh=function(){_onDomRefresh.apply(this,arguments),_.defer(_.bind(FrameBus.trigger,FrameBus,"mainlayoutRendered"))}};return asEmbedLayout}),define("core/utils/cookies",[],function(){var cookies={getCookieDomain:function(url){return url.split("/")[2].replace(/\:[0-9]+/,"")},deprecated:{create:function(name,value){var lifetime=31536e6;cookies.create(name,value,{domain:cookies.getCookieDomain(window.location+""),expiresIn:lifetime})},erase:function(name){cookies.erase(name,{domain:cookies.getCookieDomain(window.location+"")})}},create:function(name,value,options){var date,cookie=name+"="+value+"; path="+(options.path||"/");options.domain&&(cookie+="; domain=."+options.domain),options.expiresIn&&(date=new Date,date.setTime(date.getTime()+options.expiresIn),cookie+="; expires="+date.toGMTString()),document.cookie=cookie},read:function(name){for(var cookie,nameEQ=name+"=",cookies=document.cookie.split(";"),i=0;i<cookies.length;i++){for(cookie=cookies[i];" "===cookie.charAt(0);)cookie=cookie.substring(1,cookie.length);if(0===cookie.indexOf(nameEQ))return cookie.substring(nameEQ.length,cookie.length)}return null},erase:function(name,options){var cookie,date=new Date;date.setTime(date.getTime()+-864e5),cookie=name+"=; path=/;expires="+date.toGMTString(),options.domain&&(cookie+="; domain=."+options.domain),document.cookie=cookie}};return cookies}),define("home/utils/releaseUtils",["underscore","modernizr","remote/config","core/utils/cookies"],function(_,Modernizr,config){function alertLocalStorageNotSupported(){window.alert("You must enable Local Storage in your browser in order to do that.")}var DISQUS_ADMIN_USERNAMES=["Jason","danielha","ro_gupta","ryanvalentin","kimskitchensink","JoeDudas","TaltonFiggins","gabalafou","SamParker","noodlezrulez","davidericfleck","NorthIsUp","nfluxx","mpattyfly","mls888","jono","tkaemming","madBYK","JimHirshfield","fuziontech","SteveRoy44","mandytong","chaseneil","iamfrancisyo","mattrobenolt","chazcb","podlipensky","qarly","macrinaivazian","met48","davidzabowski","Rsadi","ernestwaynewong","TOB_DQ_NY","kalail610","jimwaggoner","alec_schmidt","jelias19","Marjie4123","zaizhuang","caromurph","nicoleallard","ValdesJuanCarlos","annmony","brandenr","cynthiacgutierrez88","kaelibain","sayshelen","mkslattery","vexillifer","wedamija","rygreaves","Oneeyeshut7","benjaminkowalski","ProductNate","HomeModelUser","HomeActiveCommenter","HomeNewUser","RenR","tonyhue","Bravado_General","derrickpetzold","michaelmaltese","snudelz","paulivanov","Jameslm86","min_diesel"],OPT_OUT_NAME="dhome_v2oo",localStorageSupported=Modernizr.localstorage;return{isDisqusAdmin:function(user){return _.contains(DISQUS_ADMIN_USERNAMES,user.get("username"))||_.contains(config.lounge.home_other_admin_accounts,user.get("username"))},optOutOfRedesign:function(){return localStorageSupported?(localStorage.setItem(OPT_OUT_NAME,"true"),void location.reload()):void alertLocalStorageNotSupported()},optIn:function(){return localStorageSupported?(localStorage.setItem(OPT_OUT_NAME,"optedin"),void location.reload()):void alertLocalStorageNotSupported()}}}),define("core/utils/fingerprint",[],function(){function getFingerprint(){try{var offset=(new Date).getTimezoneOffset(),screenRes=1,screen=window.screen;screen&&screen.availWidth?screenRes=screen.availWidth*screen.availHeight+screen.colorDepth:screen&&screen.width&&(screenRes=screen.width*screen.height);var doc=document.documentElement,browser=doc.clientWidth*doc.clientHeight;return Math.abs(17*offset+25*screenRes-browser)}catch(e){return 1}}return{get:getFingerprint}}),define("core/utils/guid",["core/utils/fingerprint"],function(fp){function random(){try{var ab=new Uint32Array(1);return window.crypto.getRandomValues(ab)[0]}catch(e){return Math.floor(1e9*Math.random())}}function getNavigationTime(){if(window.performance&&window.performance.timing){var timing=window.performance.timing,dns=timing.domainLookupEnd-timing.domainLookupStart,connection=timing.connectEnd-timing.connectStart,navigation=timing.responseStart-timing.navigationStart;return 11*dns+13*connection+17*navigation}return 1e5}function generateGUID(){var time=+(new Date).getTime().toString().substring(3),guid=Math.abs(time+getNavigationTime()-fp.get()).toString(32);return guid+=random().toString(32)}return{generate:generateGUID}}),define("core/utils/hash",[],function(){var calculate=function(str){var i,l,character,hash=0;if(0===str.length)return hash;for(i=0,l=str.length;l>i;i++)character=str.charCodeAt(i),hash=(hash<<5)-hash+character,hash|=0;return hash};return{calculate:calculate}}),define("core/analytics/identity",["backbone","core/utils/cookies","core/utils/guid","core/utils/hash","core/utils/fingerprint"],function(Backbone,cookies,guid,hash,fingerprint){var impManager=function(){var Singleton=Backbone.Model.extend({COOKIE_NAME:"__jid",TTL:18e5,initialize:function(){this.prevImp=cookies.read(this.COOKIE_NAME),this.impId=guid.generate(),this.persist()},persist:function(){cookies.create(this.COOKIE_NAME,this.impId,{expiresIn:this.TTL})}});return new Singleton}(),disqusUniqueManager=function(){var Singleton=Backbone.Model.extend({COOKIE_NAME:"disqus_unique",isPersistent:function(){return cookies.read(this.COOKIE_NAME)===this.get("value")},initialize:function(){var value=cookies.read(this.COOKIE_NAME);value||(value=guid.generate()),cookies.deprecated.create(this.COOKIE_NAME,value),this.set("value",value)}});return new Singleton}(),clientId=function(){var value,manager=disqusUniqueManager;return manager.isPersistent()&&(value=manager.get("value")),value||fingerprint.get().toString()},clientPercent=function(){return Math.abs(hash.calculate(this.clientId())%100)};return{unique:disqusUniqueManager,impression:impManager,clientId:clientId,clientPercent:clientPercent}}),define("core/analytics/experiment",["underscore","remote/config","core/analytics/identity","core/utils/cookies"],function(_,config,identity,cookies){var exports={},isWithinInterval=function(percent,range){return range[0]<=percent&&percent<range[1]},isValidExperiment=function(config){var isNumber=_.isNumber;return config&&config.active&&isNumber(config.active[0])&&isNumber(config.active[1])&&config.bucket&&isNumber(config.bucket[0])&&isNumber(config.bucket[1])};return exports._current=null,exports.getCurrent=function(){if(exports._current)return exports._current;var experiments=config.experiments||{},isForced=!1,percent=0,activeExperiment=cookies.read("experiment");return activeExperiment&&_.has(experiments,activeExperiment)?isForced=!0:_.isObject(experiments)&&(percent=identity.clientPercent(),activeExperiment=_.chain(experiments).keys().find(function(experimentName){var experiment=this[experimentName];return isValidExperiment(experiment)&&isWithinInterval(percent,experiment.bucket)?!0:void 0},experiments).value()),exports._current=activeExperiment?{experiment:activeExperiment,variant:isForced||isWithinInterval(percent,experiments[activeExperiment].active)?"active":"control"}:{experiment:"default",variant:"control"}},exports.disable=function(){exports._current={experiment:"default",variant:"control"}},exports.isActive=function(experiment){var current=this.getCurrent();return current.experiment===experiment&&"active"===current.variant},exports}),define("core/config/urls",[],function(){return{jester:"https://referrer."+document.location.host+"/juggler"}}),define("core/analytics/jester",["jquery","underscore","backbone","core/analytics/experiment","core/analytics/identity","core/config/urls"],function($,_,Backbone,experiment,identity,urls){var ActivityClient=Backbone.Model.extend({url:urls.jester+"/event.js",initialize:function(){this.set(experiment.getCurrent())},setHostReferrer:function(url){url&&-1!==url.indexOf("http")&&this.set("page_referrer",url)},decoratePayload:function(payload){payload=_.extend(this.toJSON(),payload),_.extend(payload,{event:"activity",imp:identity.impression.impId,prev_imp:identity.impression.prevImp}),payload.section||(payload.section="default"),payload.area||(payload.area="n/a");var qsaLength=$.param(payload).length;if(qsaLength>2048&&this.has("page_referrer")){var referrerLink=document.createElement("a");referrerLink.href=this.get("page_referrer");var hostname=referrerLink.hostname;hostname&&(payload.page_referrer_domain=hostname),delete payload.page_referrer}return payload},emit:function(payload){return $.ajax({url:_.result(this,"url"),data:this.decoratePayload(payload),dataType:"script",cache:!0})}}),client=new ActivityClient;return{ActivityClient:ActivityClient,client:client}}),define("core/mixins/asScrollableContainer",["underscore"],function(_){var asScrollableContainer=function(options){this.scrollMeasureSelector=options.scrollMeasureSelector,this.events=_.extend(ScrollableContainer.getScrollEvents(options.childSelector),this.events),_.extend(this,_.pick(ScrollableContainer,"getScrollMeasure","handleScrollEvent"))},ScrollableContainer={getScrollEvents:function(childSelector){var scrollEvents=[["mousewheel","handleScrollEvent"],["wheel","handleScrollEvent"]];return childSelector&&(scrollEvents=_.map(scrollEvents,function(event){return event[0]=event[0]+" "+childSelector,event})),_.object(scrollEvents)},getScrollMeasure:function(){return this.scrollMeasure&&this.scrollMeasure.parent().length||(this.scrollMeasure=this.$el,this.scrollMeasureSelector&&(this.scrollMeasure=this.$el.find(this.scrollMeasureSelector))),this.scrollMeasure},handleScrollEvent:function(e){var event=e.originalEvent,dir=event.wheelDeltaY||-event.deltaY,el=this.$el,height=el.height(),measure=this.getScrollMeasure(),scrollHeight=measure.height(),scrollTop=measure.parent()[0].scrollTop,isBottom=scrollTop>=scrollHeight-height,isTop=0===scrollTop;(isBottom&&0>dir||isTop&&dir>0)&&e.preventDefault()}};return asScrollableContainer}),define("home/utils/inspectletUtils",["underscore","modernizr","remote/config","core/utils/cookies","core/analytics/identity","core/analytics/experiment","home/models/Session"],function(_,Modernizr,config,cookies,identity,experiment,Session){function InspectletWrapper(session){this.session=session}function getUsername(){var authStr=cookies.read("disqusauth");if(authStr)return authStr.split("|")[1]}function loadInspectlet(){window.__insp=window.__insp||[],__insp.push(["wid",1759063951]);var insp=document.createElement("script");insp.type="text/javascript",insp.async=!0,insp.id="inspsync",insp.src=("https:"===document.location.protocol?"https":"http")+"://cdn.inspectlet.com/inspectlet.js";var x=document.getElementsByTagName("script")[0];x.parentNode.insertBefore(insp,x)}var methods={init:function(){this.shouldLoadInspectlet()&&loadInspectlet(),this.session.isAnonymous()?this.session.once("change:id",_.bind(this.tagSessionWithUserStats,this)):this.tagSessionWithUserStats(this.session.user)},fromEmbed:function(){return this.inUrl("utm_source=disqus_embed")&&identity.clientPercent()<=config.lounge.homeception_inspectlet_percent},inUrl:function(searchStr){return-1!==window.location.search.indexOf(searchStr)},shouldLoadInspectlet:function(){return-1!==window.location.search.indexOf("inspectlet=1")||this.fromEmbed()?(Modernizr.history&&history.replaceState(null,null,window.location.href.split("?")[0]),!0):_.contains(config.lounge.home_inspectlet_usernames,getUsername())||identity.clientPercent()<=config.lounge.home_inspectlet_percent},tagSessionWithUserStats:function(user){var totalFollowing=user.get("numFollowing")+user.get("numForumsFollowing");this.tagSession({commentCount:user.get("numPosts"),totalFollowCount:totalFollowing,followPeopleCount:user.get("numFollowing"),followCommunityCount:user.get("numForumsFollowing"),username:user.get("username")}),this.fromEmbed()&&this.tagSession("homeception"),0===totalFollowing?this.tagSession("followsNone"):10>totalFollowing?this.tagSession("followsFew"):50>totalFollowing?this.tagSession("followsSome"):totalFollowing>=50&&this.tagSession("followsMany")},tagSession:function(tag){window.__insp&&__insp.push(["tagSession",tag])}};return _.extend(InspectletWrapper.prototype,methods),new InspectletWrapper(new Session)}),define("home/utils/settingsUtils",["home/utils/mixpanelUtils","home/utils/inspectletUtils"],function(mixpanelUtils,inspectletUtils){var exports={};return exports.showSettingsModal=function(e,tabName){e&&e.preventDefault&&e.preventDefault();var hideSettingsModal=this.hideSettingsModal;$('<iframe id="settings-frame">').css({position:"fixed",top:0,left:0,height:"100%",width:"100%","z-index":1e4}).attr("src","/home/edit-profile.html").appendTo("body").load(function(){var self=this,profileEditModal=new self.contentWindow.DISQUS.ui.ProfileEditModal;profileEditModal.open({selectedTab:tabName,onClose:function(){hideSettingsModal()}});var $body=$(this.contentWindow.document.body),$html=$body.parent("html");$html.css({height:"100%",overflow:"hidden"}),$body.css({height:"100%"}).click(function(e){var $target=$(e.target);(0===$target.closest("#dsq-popup-message").length||$target.closest(".dsq-popup-close").length)&&hideSettingsModal()}).keypress(function(e){27===e.keyCode&&hideSettingsModal()})}).focus()},exports.hideSettingsModal=function(){$("#settings-frame").remove()},exports.openNotificationPane=function(e){mixpanelUtils.track("open settings",e),inspectletUtils.tagSession("viewed settings"),exports.showSettingsModal(e,"notifications")},exports.openProfilePane=function(e){mixpanelUtils.track("open profile edit",e),exports.showSettingsModal(e,"profile")},exports.openAccountPane=function(e){mixpanelUtils.track("open settings",e),inspectletUtils.tagSession("viewed settings"),exports.showSettingsModal(e,"account")},exports}),define("home/mixins/asEmbedNavView",["jquery","underscore","core/frameBus","home/models/Notifications"],function($,_,FrameBus,Notifications){var asEmbedNavView=function(){var _getNotifications=this.getNotifications;this.getNotifications=function(){this.notifications=new Notifications,this.app.showPathReceived.done(_getNotifications)}};return asEmbedNavView}),define("home/templates/discoverMenu",["handlebars","handlebars.partials"],function(Handlebars){return Handlebars.template(function(Handlebars,depth0,helpers,partials,data){function program1(depth0,data){var stack1,helper,buffer="";return buffer+='\n                        <li><a href="/home/user/',(helper=helpers.username)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.username,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'">',(helper=helpers.name)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.name,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"</a></li>\n                    "}function program3(){return'\n                        <li class="blank">You\'re not following anyone.</li>\n                    '}function program5(depth0,data){var stack1,helper,buffer="";return buffer+='\n                         <li><a href="/home/forums/',(helper=helpers.id)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.id,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'" class="truncate-css">',(helper=helpers.name)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.name,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"</a></li>\n                    "}function program7(){return'\n                         <li class="blank">You\'re not following any communities.</li>\n                    '}function program9(){return"ed"}function program11(){return'\n                    <a href="/follow/facebook/" class="btn btn-facebook btn-block">\n                        Connect <span class="icon-facebook"></span></a>\n                    '}this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var stack1,helper,buffer="",functionType="function",escapeExpression=this.escapeExpression,self=this;return buffer+='<div class="nav-discover dropdown" data-action="toggle-dropdown" data-dropdown="discover">\n\n    <a data-toggle="dropdown" class="dropdown-toggle" href="#">\n        \n        <svg class="icon-discover" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 40 40" enable-background="new 0 0 40 40" xml:space="preserve"><path class="dot" d="M0 4c0-2.2 1.8-4 4-4s4 1.8 4 4S6.2 8 4 8S0 6.2 0 4z"/><path class="dot" d="M0 20c0-2.2 1.8-4 4-4s4 1.8 4 4s-1.8 4-4 4S0 22.2 0 20z"/><path class="dot" d="M0 36c0-2.2 1.8-4 4-4s4 1.8 4 4s-1.8 4-4 4S0 38.2 0 36z"/><path class="dot" d="M16 4c0-2.2 1.8-4 4-4s4 1.8 4 4s-1.8 4-4 4S16 6.2 16 4z"/><path class="dot" d="M16 20c0-2.2 1.8-4 4-4s4 1.8 4 4s-1.8 4-4 4S16 22.2 16 20z"/><path class="dot" d="M16 36c0-2.2 1.8-4 4-4s4 1.8 4 4s-1.8 4-4 4S16 38.2 16 36z"/><path class="dot" d="M32 4c0-2.2 1.8-4 4-4s4 1.8 4 4s-1.8 4-4 4S32 6.2 32 4z"/><path class="dot" d="M32 20c0-2.2 1.8-4 4-4s4 1.8 4 4s-1.8 4-4 4S32 22.2 32 20z"/><path class="dot" d="M32 36c0-2.2 1.8-4 4-4s4 1.8 4 4s-1.8 4-4 4S32 38.2 32 36z"/></svg>\n    </a>\n\n    <div class="dropdown-menu dropdown-discover" role="menu" aria-labeledby="drop-discover">\n        <div class="dropdown-discover-following">\n            <header class="dropdown-discover-header">\n                <h4>Following <a href="/home/user/',(helper=helpers.username)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.username,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'/following" class="count">',(helper=helpers.numTotalFollowing)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.numTotalFollowing,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'</a></h4>\n                <p>Follow people and communities to find more stories.</p>\n            </header>\n            <div class="following">\n                <div class="following-people">\n                    <h5>People</h5>\n                    <ul>\n                    ',stack1=helpers.each.call(depth0,depth0&&depth0.users,{hash:{},inverse:self.program(3,program3,data),fn:self.program(1,program1,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+='\n                    </ul>\n                </div>\n                <div class="following-communities">\n                    <h5>Communities</h5>\n                    <ul id="suggestion-nav-forums">\n                    ',stack1=helpers.each.call(depth0,depth0&&depth0.forums,{hash:{},inverse:self.program(7,program7,data),fn:self.program(5,program5,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+='\n                    </ul>\n                </div>\n            </div>\n\n            <footer>\n                <div class="connect',stack1=helpers["if"].call(depth0,(stack1=depth0&&depth0.users,null==stack1||stack1===!1?stack1:stack1.length),{hash:{},inverse:self.noop,fn:self.program(9,program9,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+='">\n                    ',stack1=helpers.unless.call(depth0,(stack1=depth0&&depth0.users,null==stack1||stack1===!1?stack1:stack1.length),{hash:{},inverse:self.noop,fn:self.program(11,program11,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+='\n                    <a href="/home/user/',(helper=helpers.username)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.username,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'/following" class="btn btn-light btn-block">Manage All</a>\n                </div>\n            </footer>\n        </div>\n        <div class="dropdown-discover-browse">\n            <header class="dropdown-discover-header">\n                <h4>Browse</h4>\n                <p>Disqus shows you community-powered stories.</p>\n            </header>\n            <ul class="browse-links">\n                <li><a href="/home/topics/business">Business</a></li>\n                <li><a href="/home/topics/celebrity">Celebrity</a></li>\n                <li><a href="/home/topics/culture">Culture</a></li>\n                <li><a href="/home/topics/entertainment">Entertainment</a></li>\n                <li><a href="/home/topics/games">Games</a></li>\n                <li><a href="/home/topics/living">Living</a></li>\n                <li><a href="/home/topics/news">News</a></li>\n                <li><a href="/home/topics/sports">Sports</a></li>\n                <li><a href="/home/topics/style">Style</a></li>\n                <li><a href="/home/topics/tech">Tech</a></li>\n            </ul>\n            <a href="https://help.disqus.com/customer/portal/articles/1587748" target="_blank" class="btn btn-light btn-block">Learn More</a>\n        </div>\n    </div>\n</div>\n'})}),define("home/views/DiscoverMenuView",["backbone-marionette","home/templates/discoverMenu"],function(Marionette,discoverMenuTemplate){return Marionette.ItemView.extend({template:discoverMenuTemplate,templateHelpers:function(){var followingForums=this.followingForums?this.followingForums.toJSON():[],followingUsers=this.followingUsers?this.followingUsers.toJSON():[],sessionUser=this.model.user;
return{users:followingUsers.slice(0,10),forums:followingForums.slice(0,10),numTotalFollowing:sessionUser.get("numForumsFollowing")+sessionUser.get("numFollowing"),forumsOverflow:followingForums.length>9}},modelEvents:{"change:id":"render"},initialize:function(){this.model.isAnonymous()?this.listenToOnce(this.model,"change:id",this.bindToFollowing):this.bindToFollowing()},bindToFollowing:function(){var userProfile=this.model.getUserProfile();userProfile&&(this.followingUsers=userProfile.following.get("items"),this.followingForums=userProfile.forumsFollowing.get("items"),this.listenTo(this.followingUsers,"add remove reset",this.render),this.listenTo(this.followingForums,"add remove reset",this.render))}})}),define("home/templates/nav",["handlebars","handlebars.partials"],function(Handlebars){return Handlebars.template(function(Handlebars,depth0,helpers,partials,data){function program1(){return"\n            <a>+</a>&nbsp;&nbsp;\n        "}this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),partials=this.merge(partials,Handlebars.partials),data=data||{};var stack1,buffer="",self=this;return buffer+='<div class="nav-container-inner" data-mix-location="nav">\n    <div class="nav-right">\n\n        ',stack1=helpers["if"].call(depth0,depth0&&depth0.canStartDiscussion,{hash:{},inverse:self.noop,fn:self.program(1,program1,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+='\n\n        <div id="discover-menu" class="nav-discover-wrapper tooltipped"\n            data-toggle="tooltip" data-placement="bottom" title="Discover"\n        ></div>\n\n        <div class="nav-settings-wrapper tooltipped"\n            data-toggle="tooltip" data-placement="bottom" title="Settings">\n            ',stack1=self.invokePartial(partials.settingsDropdown,"settingsDropdown",depth0,helpers,partials,data),(stack1||0===stack1)&&(buffer+=stack1),buffer+='\n        </div>\n\n        <div class="nav-settings-mobile-wrapper">\n            ',stack1=self.invokePartial(partials.settingsMobileIcon,"settingsMobileIcon",depth0,helpers,partials,data),(stack1||0===stack1)&&(buffer+=stack1),buffer+='\n        </div>\n    </div>\n    <div class="nav-left">\n        <a href="/home/" class="nav-logo">\n            <img class="logo-desktop" src="//a.disquscdn.com/dotcom/d-9c2c241/img/brand/disqus-logo-blue-white.svg" alt="Disqus">\n            <img class="logo-mobile" src="//a.disquscdn.com/dotcom/d-9c2c241/img/brand/disqus-social-icon-blue-white.svg" alt="Disqus">\n        </a>\n        <div class="nav-home-wrapper tooltipped" data-toggle="tooltip" data-placement="bottom" title="Home Feed">\n            <a href="/home/" class="nav-home" data-page-icon="">\n                \n                <svg class="icon-home" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 40 40" enable-background="new 0 0 40 40" xml:space="preserve"><path d="M39.5 20.7L21.7 2.5c-0.9-1-2.4-1-3.3 0L0.5 20.7c-0.9 1-0.6 1.7 0.8 1.7H5v13.9c0 1 0 1.8 1.8 1.8h8.7v-14 h9.1v14h9.1c1.4 0 1.4-0.8 1.4-1.8V22.4h3.7C40.1 22.4 40.4 21.6 39.5 20.7z"/></svg>\n            </a>\n        </div>\n    </div>\n    <div class="nav-center">\n        <div class="nav-profile-wrapper tooltipped"\n            data-role="user" data-toggle="tooltip" data-placement="bottom" title="Me">\n\n            ',stack1=self.invokePartial(partials.navUserIcon,"navUserIcon",depth0,helpers,partials,data),(stack1||0===stack1)&&(buffer+=stack1),buffer+='\n\n        </div>\n        <div class="nav-notif-wrapper tooltipped"\n            data-toggle="tooltip" data-placement="bottom" title="Replies & Notifications">\n\n            <a href="/home/inbox" class="nav-notif" data-role="notifications" data-page-icon="inbox">\n                <div class="notif-count" data-role="unread-notification-count"></div>\n                \n                <svg class="icon-notif" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="159.8 0 480.2 480" enable-background="new 159.8 0 480.2 480" xml:space="preserve"><path class="fill" d="M409 480c-52.5 0-103.5-18-145.5-52.5l-87 12c-6 0-10.5-1.5-13.5-6s-4.5-10.5-1.5-15l33-85.5 c-12-30-18-61.5-18-93C176.5 108 280 0 409 0c127.5 0 231 108 231 240S536.5 480 409 480z"/><path class="outline" d="M409 480c-52.5 0-103.5-18-145.5-52.5l-87 12c-6 0-10.5-1.5-13.5-6s-4.5-10.5-1.5-15l33-85.5 c-12-30-18-61.5-18-93C176.4 108 280 0 409 0c127.5 0 231 108 231 240S536.5 480 409 480z M270.4 396.7c3 0 5.7 0.6 8.1 2.3 c36 31.5 82.5 49.5 130.5 49.5c111 1.5 201-93 201-208.5S520 30 409 30c-112.5 0-202.5 94.5-202.5 210c0 30 6 60 18 87 c1.5 3 1.5 7.5 0 12l-27 67.5l67.5-9C267.6 397 270.4 396.7 270.4 396.7z"/><path class="arrow" d="M419.5 252v48l78-73.5l-78-72v42c-94.5 0-117 108-117 108C329.5 256.5 367 252 419.5 252z"/></svg>\n            </a>\n\n        </div>\n    </div>\n</div>\n'})}),define("home/templates/anonNav",["handlebars","handlebars.partials"],function(Handlebars){return Handlebars.template(function(Handlebars,depth0,helpers,partials,data){function program1(depth0,data){var buffer="";return buffer+='\n    <div class="nav-right">\n        <div class="nav-buttons">\n            <a href="//disqus.com/profile/signup/?next=https%3A%2F%2Fdisqus.com%2Fhome%2F" class="btn btn-primary active btn-large">'+escapeExpression(helpers.gettext.call(depth0,"Sign Up",{hash:{},data:data}))+'</a>\n            <a href="//disqus.com/profile/login/?next=https%3A%2F%2Fdisqus.com%2Fhome%2F" class="btn btn-light-solid btn-large">'+escapeExpression(helpers.gettext.call(depth0,"Log In",{hash:{},data:data}))+"</a>\n        </div>\n    </div>\n    "}this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var stack1,buffer="",escapeExpression=this.escapeExpression,self=this;return buffer+='<div class="nav-container-inner" data-mix-location="nav">\n    ',stack1=helpers.unless.call(depth0,depth0&&depth0.sessionIsFetching,{hash:{},inverse:self.noop,fn:self.program(1,program1,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+='\n    <div class="nav-left">\n        <a href="/home/" class="nav-logo">\n            <img class="logo-desktop" src="//a.disquscdn.com/dotcom/d-9c2c241/img/brand/disqus-logo-blue-white.svg" alt="Disqus">\n            <img class="logo-mobile" src="//a.disquscdn.com/dotcom/d-9c2c241/img/brand/disqus-social-icon-blue-white.svg" alt="Disqus">\n        </a>\n    </div>\n</div>\n'})}),define("home/views/NavView",["underscore","jquery","backbone","backbone-marionette","handlebars","remote/config","home/utils/settingsUtils","home/utils/mixpanelUtils","home/utils/iframeUtils","home/mixins/asEmbedNavView","home/models/Session","home/views/DiscoverMenuView","home/templates/nav","home/templates/anonNav"],function(_,$,Backbone,Marionette,Handlebars,config,settingsUtils,MixpanelUtils,IframeUtils,asEmbedNavView,Session,DiscoverMenuView,navTemplate,anonNavTemplate){var NavView=Marionette.Layout.extend({className:"compensation",regions:{discoverMenuRegion:"#discover-menu"},template:function(data){return data.id?navTemplate(data):anonNavTemplate(data)},templateHelpers:function(){return{canStartDiscussion:_.contains(config.lounge.home_start_discussion,this.session.user.get("username")),sessionIsFetching:this.session.fetchPromise}},events:{"click [data-action=toggle-sidebar]":"toggleSidebar","click [data-action=show-edit-profile]":settingsUtils.openProfilePane,"click [data-action=show-account]":settingsUtils.openAccountPane,"show.bs.dropdown [data-action=toggle-dropdown][data-dropdown=settings]":"trackOpenedSettings","show.bs.dropdown [data-action=toggle-dropdown][data-dropdown=discover]":"trackOpenedDiscover","show.bs.dropdown [data-action=toggle-dropdown]":"removeTooltip","hide.bs.dropdown [data-action=toggle-dropdown]":"addTooltip","click [data-role=user]":"trackOpenedProfile","click [data-action=admin-click]":"trackOpenedAdmin"},toggleSidebar:function(e){var $container=$("#container-page");$container.hasClass("slide-left")||this.trackOpenedSettings(e),$container.toggleClass("slide-left")},initialize:function(options){this.session=new Session,this.app=options.app,this.getNotifications(),this.listenTo(this.session,"change:id fetch:error fetch:success change:moderatesForum",this.debouncedRender),this.listenTo(this.notifications,"change:numUnread",this.updateNotifications),this.listenTo(this.app,"route",this.activatePageIcon)},getNotifications:function(){this.notifications=this.session.getOrCreateNotifications()},debouncedRender:_.debounce(function(){this.render.apply(this,arguments)},300),render:function(){this.model=this.session.user;var result=this.constructor.__super__.render.apply(this,arguments);return this.activatePageIcon(),this.updateNotifications(),result},onDomRefresh:function(){this.discoverMenuRegion.show(new DiscoverMenuView({model:this.session})),$(".tooltipped").tooltip()},updateNotifications:function(){var numUnread=this.notifications.get("numUnread");this.$("[data-role=notifications]").toggleClass("has-notifs",!!numUnread),this.$("[data-role=unread-notification-count]").text(numUnread>9?"9+":numUnread)},activatePageIcon:function(){this.curRoute=Backbone.history.getFragment(),this.$("[data-page-icon].active").removeClass("active"),this.$('[data-page-icon="'+this.curRoute+'"]').addClass("active")},removeTooltip:function(e){e&&$(e.currentTarget).closest(".tooltipped").tooltip("destroy")},addTooltip:function(e){e&&$(e.currentTarget).closest(".tooltipped").tooltip()},trackOpenedDiscover:function(e){MixpanelUtils.track("open discover menu",e)},trackOpenedSettings:function(e){MixpanelUtils.track("open user menu",e)},trackOpenedProfile:function(e){MixpanelUtils.track("open profile",e)},trackOpenedAdmin:function(e){MixpanelUtils.track("open admin",e)}});return IframeUtils.isIframed(window)&&asEmbedNavView.call(NavView.prototype),NavView}),define("home/templates/mainLayout",["handlebars","handlebars.partials"],function(Handlebars){return Handlebars.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),partials=this.merge(partials,Handlebars.partials),data=data||{};var stack1,buffer="",escapeExpression=this.escapeExpression,self=this;return buffer+='\n<div class="viewport">\n    <header class="nav-container-outer" data-role="nav-view">\n    </header>\n\n    \n    <div class="nav-drawer">\n        <a href="/home/" data-action="full-root" target="_blank" class="nav-logo">\n            <img src="//a.disquscdn.com/dotcom/d-9c2c241/img/brand/disqus-logo-blue-white.svg" alt="Disqus">\n        </a>\n        <div class="nav-drawer-right">\n            <a class="nav-expand truncate-line" data-action="full-root" target="_blank" href="/home/">\n                \n                <svg class="icon-home" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 40 40" enable-background="new 0 0 40 40" xml:space="preserve"><path d="M39.5 20.7L21.7 2.5c-0.9-1-2.4-1-3.3 0L0.5 20.7c-0.9 1-0.6 1.7 0.8 1.7H5v13.9c0 1 0 1.8 1.8 1.8h8.7v-14 h9.1v14h9.1c1.4 0 1.4-0.8 1.4-1.8V22.4h3.7C40.1 22.4 40.4 21.6 39.5 20.7z"/></svg>\n                <span class="text-desktop">'+escapeExpression(helpers.gettext.call(depth0,"Disqus Home",{hash:{},data:data}))+'</span>\n            </a>\n            <a class="nav-feedback truncate-line" target="_blank" href="https://disqus.com/home/channel/discussdisqus">\n                \n                <svg class="icon-discussion" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 18.7 16.7" enable-background="new 0 0 18.7 16.7" xml:space="preserve"><path d="M16.3 1H8.6C7.7 1 6.9 1.8 6.9 2.7v6.7h5.9l2.6 2.5V9.3h0.8 c0.9 0 1.7-0.8 1.7-1.7v-5C18 1.8 17.2 1 16.3 1z M5.9 10.3V5.2H2.7C1.8 5.2 1 5.9 1 6.8v5c0 0.9 0.8 1.7 1.7 1.7h0.8V16l2.5-2.5 h4.3c0.9 0 1.7-0.8 1.7-1.7v-1.5c-0.1 0-0.1 0-0.2 0H5.9z"/></svg>\n                <span class="text-desktop">'+escapeExpression(helpers.gettext.call(depth0,"Feedback",{hash:{},data:data}))+'</span>\n            </a>\n            <a class="nav-refresh truncate-line" data-action="refresh-drawer" href="#">\n                <svg class="icon-refresh" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 466.6 405.8" enable-background="new 0 0 466.6 405.8" xml:space="preserve"><path d="M363.7 307.2l102.8-116.9h-66.9c-3.2-50.3-24.3-97.1-60-132.5C302.1 20.5 252.5 0 200 0C89.7 0 0 91 0 202.9 c0 111.9 89.7 202.9 200 202.9c44.8 0 88.6-15.2 123.4-42.9l6.3-5l-43.2-47.1l-5.4 4.1c-23.5 17.8-51.5 27.2-81 27.2 c-75.6 0-137-62.5-137-139.3S124.4 63.7 200 63.7c35.5 0 69.2 13.9 94.9 39.1c23.9 23.5 38.3 54.3 41 87.5H260L363.7 307.2z" class="style0"/></svg>\n                <span class="text-desktop">'+escapeExpression(helpers.gettext.call(depth0,"Refresh",{hash:{},data:data}))+'</span>\n            </a>\n            <a class="nav-close" data-action="close-drawer" href="#"><span class="icon-cancel"></span></a>\n        </div>\n    </div>\n\n    <div id="container-main">\n    </div>\n</div>\n\n\n<div class="sidebar compensation" data-role="sidebar">\n    <ul class="sidebar-options" data-mix-location="user menu mobile">\n        ',stack1=self.invokePartial(partials.settingsLinks,"settingsLinks",depth0,helpers,partials,data),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n    </ul>\n</div>\n"})}),define("home/views/MainLayout",["jquery","underscore","backbone-marionette","home/mixins/asEmbedLayout","home/utils/iframeUtils","home/utils/mixpanelUtils","home/utils/layoutUtils","home/utils/releaseUtils","core/analytics/jester","core/mixins/asScrollableContainer","core/utils/cookies","home/views/NavView","home/templates/mainLayout"],function($,_,Marionette,asEmbedLayout,IframeUtils,MixpanelUtils,LayoutUtils,releaseUtils,jester,asScrollableContainer,cookies,NavView,mainLayoutTemplate){var MainLayout=Marionette.Layout.extend({id:"container-page",template:mainLayoutTemplate,serializeData:function(){var data=Marionette.Layout.prototype.serializeData.apply(this,arguments),user=this.session.user;user&&user.toJSON&&_.extend(data,user.toJSON());var authStr=cookies.read("disqusauth");return authStr&&(data.userId=authStr.split("|")[6]),data},events:{"click [data-role=sidebar] a":"toggleSidebar","click [data-role=help]":"trackClickedHelp","click [data-role=faq]":"trackClickedFaq","click [data-action=opt-out]":"optOut"},optOut:function(e){e&&e.preventDefault(),jester.client.emit({verb:"opt-out",object_type:"product",object_id:"home",zone:"activityfeed"}),setTimeout(function(){releaseUtils.optOutOfRedesign()},250)},toggleSidebar:function(){this.$el.removeClass("slide-left")},regions:{content:{selector:"#container-main"},nav:"[data-role=nav-view]"},initialize:function(options){this.session=options.session,this.app=options.app,this.windowHeight=$(window).height(),$(window).resize(_.bind(function(){this.windowHeight=$(window).height(),this.toggleHeight()},this))},onDomRefresh:function(){this.nav.show(new NavView({app:this.app}))},showViews:function(views){return this._isShown?(this.$(this.content.el).removeData("height"),this.content.currentView&&this.stopListening(this.content.currentView),this.listenTo(views.content,"all",this.handleContentEvents),void this.content.show(views.content)):void this.listenToOnce(this,"show",_.bind(this.showViews,this,views))},handleContentEvents:function(eventName){"show"===eventName||"render"===eventName?this.toggleHeight():/toggleHeight/.test(eventName)&&this.toggleHeight(_.last(arguments))},toggleHeight:function(heightPreference){heightPreference||(heightPreference=this.content.$el.data("height")||"fill");var minHeight;switch(heightPreference){case"fill":this.navHeight=this.navHeight||this.nav.$el.height(),minHeight=this.windowHeight-this.navHeight+"px";break;case"content":minHeight=""}this.content.$el.css({"min-height":minHeight}).data({height:heightPreference}),LayoutUtils.scrollShownChanged()},trackClickedHelp:function(e){MixpanelUtils.track("open help",e)},trackClickedFaq:function(e){MixpanelUtils.track("open faq",e)}});return IframeUtils.isIframed(window)&&(asEmbedLayout.call(MainLayout.prototype),asScrollableContainer.call(MainLayout.prototype,{scrollMeasureSelector:"#container-main > div",childSelector:"#container-main"})),MainLayout}),define("home/views/common/AlertView",["underscore","modernizr","backbone-marionette"],function(_,Modernizr,Marionette){var localStorageSupported=Modernizr.localstorage;return Marionette.ItemView.extend({alertViewName:void 0,templateHelpers:function(){return{alertHidden:this.getRemainingViews()<=0}},events:{"click [data-action=hide-alert]":"forceExpireAlert"},onShow:function(){this.decrementRemainingViews()},forceExpireAlert:function(evt){evt&&evt.preventDefault(),this.setRemainingViews(-1),this.remove()},decrementRemainingViews:_.once(function(){var toSeeCount=this.getRemainingViews();toSeeCount>0&&this.setRemainingViews(toSeeCount-1)}),getRemainingViews:function(){if(localStorageSupported){var remainingViews=parseInt(localStorage.getItem(this.alertViewName),10);if(!isNaN(remainingViews))return remainingViews}return this.getNumberOfViews()+1},getNumberOfViews:function(){return this.defaultViews||5},setRemainingViews:function(value){localStorageSupported&&localStorage.setItem(this.alertViewName,value)}})}),define("templates/homeFeedCover",["handlebars","handlebars.partials"],function(Handlebars){return Handlebars.template(function(Handlebars,depth0,helpers,partials,data){function program1(){return'\n    <div class="onboard-message">\n        <button class="close" aria-hidden="true" title="Don\'t show this message again" data-action="hide-alert"><span class="icon-cancel"></span></button>\n        <header>\n            <h2>Ch-ch-changes!</h2>\n            <p>Disqus has gotten better than ever. We think you\'ll like what you see <span class="face face-happy">:)</span> </p>\n            <a href="https://help.disqus.com/customer/portal/articles/1587748" target="_blank">Learn more about what\'s new &raquo;</a>\n        </header>\n        <ul class="marketing-blocks thirds">\n            <li>\n                <a href="/home/inbox">\n                    <svg class="icon-notif" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 40 40" enable-background="new 0 0 40 40" xml:space="preserve"><path class="outline" d="M20.7 40c-4.4 0-8.7-1.6-12.1-4.4l-7.2 1c-0.4 0.1-0.9-0.1-1.2-0.5c-0.3-0.3-0.3-0.8-0.2-1.2l2.8-7.1 c-1-2.5-1.5-5.1-1.5-7.8C1.4 9 10 0 20.7 0C31.3 0 40 9 40 20S31.3 40 20.7 40z M9 33.1c0.3 0 0.6 0.1 0.8 0.3 c3 2.7 6.9 4.1 10.9 4.1c9.3 0 16.8-7.9 16.8-17.5S30 2.5 20.7 2.5C11.4 2.5 3.9 10.4 3.9 20c0 2.5 0.5 5 1.5 7.3 c0.1 0.3 0.1 0.7 0 1l-2.2 5.6l5.6-0.8C8.9 33.1 8.9 33.1 9 33.1z"/><path class="fill" d="M20.7 0C10 0 1.4 9 1.4 20c0 2.7 0.5 5.3 1.5 7.8l-2.8 7.1c-0.2 0.4-0.1 0.9 0.2 1.2 c0.3 0.3 0.7 0.5 1.2 0.5l7.2-1C12 38.4 16.3 40 20.7 40C31.3 40 40 31 40 20S31.3 0 20.7 0z"/><path class="dot" d="M11.2 20c0-1.4 1.1-2.5 2.5-2.5s2.5 1.1 2.5 2.5s-1.1 2.5-2.5 2.5 S11.2 21.4 11.2 20z"/><path class="dot" d="M18.7 20c0-1.4 1.1-2.5 2.5-2.5s2.5 1.1 2.5 2.5s-1.1 2.5-2.5 2.5 S18.7 21.4 18.7 20z"/><path class="dot" d="M26.2 20c0-1.4 1.1-2.5 2.5-2.5s2.5 1.1 2.5 2.5s-1.1 2.5-2.5 2.5 S26.2 21.4 26.2 20z"/></svg>\n                </a>\n                <h3>Notifications</h3>\n                <p>All of your notifications in one place with an all new ability to reply inline.</p>\n            </li>\n            <li>\n                <svg class="icon-home-line" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 35 32" enable-background="new 0 0 35 32" xml:space="preserve"><path d="M28.7 32h-7.5c-0.6 0-1-0.4-1-1V20.5h-5.5V31c0 0.6-0.4 1-1 1H6.6c-2.5 0-2.5-1.8-2.5-2.5V19H2 c-1.3 0-1.8-0.7-1.9-1c-0.1-0.3-0.3-1.1 0.6-2.1l14.7-15c1.1-1.1 3.1-1.2 4.2 0l14.7 15c0.9 1 0.7 1.8 0.6 2.1 c-0.1 0.3-0.6 1-1.9 1h-2.1v10.5C30.9 30.2 30.9 32 28.7 32z M22.2 30h6.5c0.1 0 0.1 0 0.1 0c0-0.1 0-0.4 0-0.5V18 c0-0.6 0.4-1 1-1h2.7L18.2 2.3c-0.4-0.4-1-0.4-1.3 0L2.4 17h2.7c0.6 0 1 0.4 1 1v11.5c0 0.1 0 0.4 0 0.5c0 0 0.2 0 0.5 0h6.1 V19.5c0-0.6 0.4-1 1-1h7.5c0.6 0 1 0.4 1 1V30z" /></svg>\n                <h3>One Feed</h3>\n                <p>All of the conversations you\'re interested in, all in one place.</p>\n            </li>\n            <li>\n                <a href="/home/user">\n                    <svg class="icon-face-line" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 32 32" enable-background="new 0 0 32 32" xml:space="preserve"><path d="M16 0C7.2 0 0 7.2 0 16s7.2 16 16 16s16-7.2 16-16S24.8 0 16 0z M16 30C8.3 30 2 23.7 2 16S8.3 2 16 2s14 6.3 14 14S23.7 30 16 30z"/><path d="M9.4 14.6c0.4 3.3 3.2 5.8 6.6 5.8s6.2-2.5 6.6-5.8 c-1.3 1.3-3.8 1.7-6.6 1.7S10.7 15.8 9.4 14.6z"/><ellipse cx="7.3" cy="12" rx="2.3" ry="2.1"/><path d="M24.7 9.6c-1.2 0-2.3 1-2.3 2.2c0 1.2 1 2.1 2.3 2.1 s2.3-1 2.3-2.1C27 10.6 26 9.6 24.7 9.6z"/></svg>\n                </a>\n                <h3>User Profiles</h3>\n                <p>A better view of Disqus users and what they\'re talking about.</p>\n            </li>\n        </ul>\n    </div>\n'}this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var stack1,buffer="",self=this;return stack1=helpers.unless.call(depth0,depth0&&depth0.alertHidden,{hash:{},inverse:self.noop,fn:self.program(1,program1,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n"})}),define("home/views/HomeFeedCoverView",["home/views/common/AlertView","templates/homeFeedCover"],function(AlertView,HomeFeedCoverTemplate){return AlertView.extend({template:HomeFeedCoverTemplate,alertViewName:"whatsNewViewsRemaining"})}),define("home/WrapperlessRegion",["jquery","backbone-marionette"],function($,Marionette){var WrapperlessRegion=Marionette.Region.extend({open:function(view){view.setElement(this.$el).render()},close:function(){var view=this.currentView;view&&view.setElement($("<div>")),Marionette.Region.prototype.close.apply(this,arguments)}});return WrapperlessRegion}),define("home/mixins/asCollapsibleCard",["underscore"],function(_){var asCollapsibleCard=function(){this.events=_.extend({"click [data-action=toggle-collapsed]":"toggleCollapsed"},this.events),this.toggleCollapsed=function(e){e&&e.preventDefault(),this.$(".card-collapsed, .card-expanded").addBack(".card-collapsed, .card-expanded").toggleClass("card-collapsed card-expanded")}};return asCollapsibleCard}),define("core/bus",["backbone","underscore"],function(Backbone,_){return _.extend({},Backbone.Events)}),define("core/utils/views",["underscore"],function(_){var preventDefaultHandler=function(handler){return function(e){return e&&e.preventDefault&&e.preventDefault(),handler.apply(this,arguments)}},mixin=function(viewClass,mixin,mixinConfig){var proto=viewClass.prototype,extendedMixin=_.extend({},mixin,mixinConfig);if(_.defaults(proto,extendedMixin),_.defaults(proto.events,extendedMixin.events),void 0!==proto.initialize&&void 0!==extendedMixin.initialize){var originalInit=proto.initialize;proto.initialize=function(){var value=originalInit.apply(this,arguments);return extendedMixin.initialize.apply(this,arguments),value}}};return{preventDefaultHandler:preventDefaultHandler,mixin:mixin}}),define("core/views/common/HoverCard",["jquery","underscore","backbone","core/bus","core/utils/views"],function($,_,Backbone,Bus,utils){var HoverCard=Backbone.View.extend({events:{mouseenter:"enter",mouseleave:"leave"},initialize:function(){this._id=_.uniqueId(),this._rendered=!1,this._hoverState="out",this._visible=!1,this._enterTimeout=null,this._leaveTimeout=null,HoverCard.open={},this.events=this.events||{},this.events["click [data-action=profile]"]="handleShowProfile",this.listenTo(this,"authenticating",this.keepOpen)},render:function(){this.hide(),$("body").append(this.el)},target:function($target){$target.on("mouseenter",_.bind(this.enter,this,$target)),$target.on("mouseleave",_.bind(this.leave,this))},enter:function($target){var self=this;$target&&(self.$target=$target),self._leaveTimeout&&clearTimeout(self._leaveTimeout),"in"!==self._hoverState&&(self._hoverState="in",self._enterTimeout=_.delay(function(){"in"===self._hoverState&&self.show(),self._enterTimeout=null},HoverCard.DELAY_ENTER),HoverCard.open[this.uid]=this)},leave:function(){var self=this;self._enterTimeout&&clearTimeout(self._enterTimeout),"out"!==self._hoverState&&(self._hoverState="out",self._leaveTimeout=_.delay(function(){"out"===self._hoverState&&self.hide(),self._leaveTimeout=null},HoverCard.DELAY_LEAVE),HoverCard.open[this.uid]&&delete HoverCard.open[this.uid])},show:function(){var self=this;self._rendered||(self._rendered=!0,self.render()),self.moveTo(self.$target),self.$el.show(),self._visible=!0},moveTo:function(target){if(target){var posOffset=HoverCard.POSITION_OFFSET,pos=target.offset(),el=this.$el,elHeight=el.height(),containerPos=this.getContainerPosition();pos.top-=posOffset,pos.top+elHeight+containerPos.containerOffset.top<=containerPos.pageOffset+containerPos.containerHeight?el.css("top",pos.top):el.css("top",pos.top-elHeight+2*posOffset),el.css("left",pos.left+posOffset)}},getContainerPosition:function(){return{pageOffset:$(window).scrollTop(),containerOffset:{top:0,height:$(window).height()},containerHeight:$(window).height()}},hide:function(){this._keepOpen||(this.$el.hide(),this._visible=!1)},keepOpen:function(){this._keepOpen=!0,this.setupKeepOpenCanceler()},setupKeepOpenCanceler:function(){var self=this,cancel=function(){"out"===self._hoverState&&(self.stopListening(Bus,"window.click",cancel),$("body").off("click",cancel),self._keepOpen=!1,self.hide())};_.delay(function(){self.listenTo(Bus,"window.click",cancel),$("body").on("click",cancel)},100)},isVisible:function(){return this._visible},handleShowProfile:utils.preventDefaultHandler(function(e){var $target=$(e.currentTarget),userid=$target.attr("data-user"),username=$target.attr("data-username");Bus.trigger("uiCallback:showProfile",userid,username),this.hide()})},{open:{},instances:{},DELAY_ENTER:350,DELAY_LEAVE:175,POSITION_OFFSET:20,exitAll:function(){_.invoke(HoverCard.open,"leave")},create:function(id,options,className,classConstructor){var classInstances=HoverCard.instances[className];classInstances||(HoverCard.instances[className]=classInstances={});var card=classInstances[id];return card||(card=new classConstructor(options),classInstances[id]=card),options.targetElement&&card.target(options.targetElement),card}});return function(){$(document).on("mouseout",_.debounce(function(e){var from=e.relatedTarget||e.toElement;from&&"HTML"!==from.nodeName||HoverCard.exitAll()},10))}(),HoverCard}),define("core/views/common/mixins/LocalScroll",[],function(){var LocalScroll={events:{mousewheel:"handleScrollEvent",wheel:"handleScrollEvent"},scrollMeasureSelector:"",getScrollMeasure:function(){return this.scrollMeasure||(this.scrollMeasure=this.$el,this.scrollMeasureSelector&&(this.scrollMeasure=this.$el.find(this.scrollMeasureSelector))),this.scrollMeasure},handleScrollEvent:function(e){var event=e.originalEvent,dir=event.wheelDeltaY||-event.deltaY,el=this.$el,height=el.height(),measure=this.getScrollMeasure(),scrollHeight=measure.height(),scrollTop=measure.parent()[0].scrollTop,isBottom=scrollTop>=scrollHeight-height,isTop=0===scrollTop;(isBottom&&0>dir||isTop&&dir>0)&&e.preventDefault()}};return LocalScroll}),define("core/templates/usersCard",["handlebars","handlebars.partials"],function(Handlebars){return Handlebars.template(function(Handlebars,depth0,helpers,partials,data){function program1(depth0,data){var stack1,buffer="";return buffer+="\n            ",stack1=helpers.each.call(depth0,depth0&&depth0.users,{hash:{},inverse:self.noop,fn:self.program(2,program2,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n        "}function program2(depth0,data){var stack1,buffer="";return buffer+="\n                ",stack1=self.invokePartial(partials.cardUser,"cardUser",depth0,helpers,partials,data),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n            "}this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),partials=this.merge(partials,Handlebars.partials),data=data||{};var stack1,buffer="",self=this;return buffer+='<div class="tooltip upvoters">\n    <ul class="scroll-measure" data-role="content">\n        ',stack1=helpers["if"].call(depth0,(stack1=depth0&&depth0.users,null==stack1||stack1===!1?stack1:stack1.length),{hash:{},inverse:self.noop,fn:self.program(1,program1,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+='\n    </ul>\n</div>\n<div class="tooltip-point hidden"></div>\n'})}),define("core/views/UsersCard",["underscore","handlebars","core/config","core/bus","core/utils/views","core/views/common/HoverCard","core/views/common/mixins/LocalScroll","core/templates/usersCard"],function(_,Handlebars,config,Bus,utils,HoverCard,LocalScrollMixin,usersCardTemplate){var UsersCard=HoverCard.extend({guestTextPartialName:"cardOtherUserText",className:"tooltip-outer upvoters-outer",initialize:function(options){HoverCard.prototype.initialize.call(this,options),this.collection=this.collection||options.collection,this.session=options.session,this.numUsers=options.numUsers,this.listenTo(this.collection,"add",this.addUser),this.listenTo(this.collection,"remove",this.removeUser),this.listenTo(this.collection,"reset",this.render)},addUser:function(user){user.get("isAnonymous")?this.updateGuests():this.$listEl&&this.$listEl.length&&(this.$listEl.prepend(Handlebars.partials.cardUser(_.extend({highlight:!0},user.toJSON()))),this.stopHighlightUsername())},removeUser:function(user){if(user.get("isAnonymous"))this.updateGuests();else{var userEl=this.$el.find("[data-user="+user.get("id")+"]");userEl.length&&userEl.remove()}},stopHighlightUsername:_.debounce(function(){var usernameEl=this.$el.find(".highlight");usernameEl.removeClass("highlight")},1100),getGuestCount:function(){return Math.max(this.numUsers-this.collection.length,0)},updateGuests:function(){var guestEl=this.$el.find("[data-role=guest]"),guestCount=this.getGuestCount(),guestText=Handlebars.partials[this.guestTextPartialName]({guestCount:guestCount}),data={guestCount:guestCount,guestAvatarUrl:config.urls.avatar.generic,highlight:guestEl.length,guestText:guestText},html=Handlebars.partials.cardGuestUser(data);guestEl.length?(guestEl.replaceWith(html),this.stopHighlightUsername()):this.$listEl&&this.$listEl.length&&this.$listEl.append(html)},render:function(){delete this.pointEl,this.$el.html(usersCardTemplate({users:this.collection.toJSON(),isLoading:this._loading,highlight:!1})),HoverCard.prototype.render.call(this),this.$listEl=this.$el.find(".upvoters ul"),this.updateGuests()},show:function(){this.numUsers&&!this.isVisible()&&(HoverCard.prototype.show.call(this),this.scrollMeasure&&this.scrollMeasure.height()>this.$el.height()&&this.$el.addClass("has-scroll"),Bus.trigger("uiAction:userCardShow"))},showPoint:function(position){var supportedPositions=["tl","bl"];this.pointEl||(this.pointEl=this.$el.find(".tooltip-point"),this.pointEl.removeClass("hidden")),_.each(supportedPositions,function(pos){this.pointEl.removeClass("point-position-"+pos)},this),this.pointEl.addClass("point-position-"+position)},moveTo:function(target,heightIncrease){if(target){var posOffset=HoverCard.POSITION_OFFSET,pos=target.offset(),el=this.$el,elHeight=el.height(),containerPos=this.getContainerPosition();heightIncrease&&(elHeight+=el.find("li.user").height()+10),pos.top-elHeight-posOffset>=0&&pos.top-elHeight+containerPos.containerOffset.top>=containerPos.pageOffset?(el.css({bottom:containerPos.containerOffset.height-pos.top+posOffset,top:"inherit"}),this.showPoint("bl")):(el.css({bottom:"inherit",top:pos.top+2*posOffset}),this.showPoint("tl")),el.css("left",pos.left-posOffset)
}},handleShowProfile:function(e){HoverCard.prototype.handleShowProfile.call(this,e),Bus.trigger("uiAction:showProfileFromUserCard")}},{create:function(id,options){return HoverCard.create(id,options,"UsersCard",UsersCard)}});return utils.mixin(UsersCard,LocalScrollMixin,{scrollMeasureSelector:"[data-role=content]"}),UsersCard}),define("home/utils/cardUtils",["backbone","core/bus","home/utils/iframeUtils"],function(Backbone,Bus,IframeUtils){Bus.on({"uiCallback:showProfile":function(userId,username){var userFragment="user/"+username;IframeUtils.isIframed(window)?window.open("/home/"+userFragment):Backbone.history.navigate(userFragment,{trigger:!0})}})}),define("home/views/ActivityActorsHoverCard",["underscore","backbone","home/models/Session","core/views/UsersCard","core/views/common/HoverCard","home/utils/cardUtils"],function(_,Backbone,Session,UsersCard,HoverCard){var ActivityActorsHoverCard=UsersCard.extend({initialize:function(options){var activityFeedItem=options.activityFeedItem,numShownActors=options.numShownActors;_.extend(options,{numUsers:activityFeedItem.get("totalActors")-numShownActors,session:new Session,collection:new Backbone.Collection(activityFeedItem.actors.slice(numShownActors))}),UsersCard.prototype.initialize.apply(this,arguments)},show:function(){UsersCard.prototype.show.apply(this,arguments),this.trigger("uiAction:activityActorsCardShow")}},{create:function(options){return HoverCard.create(options.activityId,options,"ActivityActorsHoverCard",ActivityActorsHoverCard)}});return ActivityActorsHoverCard}),define("home/mixins/withReasonOld",["underscore","home/views/ActivityActorsHoverCard","core/utils"],function(_,ActivityActorsHoverCard,utils){var initHoverCard=function(){if(!utils.isPhone(window)){var target=this.$("[data-role=actors]");target.length&&(this.hoverCard&&this.hoverCard.remove(),this.hoverCard=ActivityActorsHoverCard.create({targetElement:target,activityFeedItem:this.model,activityId:this.model.id,numShownActors:getShownActors.call(this).length}))}},getShownActors=function(){return this.model.actors?this.model.get("totalActors")<4?this.model.toJSON().actors:this.model.toJSON().actors.slice(0,2):[]},getNumOccurences=function(){if(!this.model.actors||1!==this.model.actors.length)return 0;var numOccurences=this.model.get("totalActivities");return numOccurences>1?numOccurences:0},withReason=function(){this.initialize=_.wrap(this.initialize,function(_initialize){_initialize.apply(this,_.rest(arguments)),this.listenTo(this,"render",initHoverCard)});var _templateHelpers=this.templateHelpers;this.templateHelpers=function(){var shownActors=getShownActors.call(this);return _.extend({relativeTime:this.model.getRelativeTimestamp(),shownActors:shownActors,numRemainingActors:this.model.get("totalActors")-shownActors.length,numOccurences:getNumOccurences.call(this)},_templateHelpers?_templateHelpers.apply(this,arguments):{})}};return withReason}),define("home/views/common/ActivityFooterView",["backbone-marionette","home/utils/mixpanelUtils","home/utils/inspectletUtils","home/models/Session"],function(Marionette,MixpanelUtils,inspectletUtils,Session){var ActivityFooterView=Marionette.ItemView.extend({templateHelpers:function(){var session=new Session;return{favorited:this.model.thread.get("userScore")>0,discussionRoute:this.model.thread.getDiscussionRoute(),authenticated:!session.isAnonymous()}},events:{"click [data-action=favorite]":"toggleThreadFavorited"},initialize:function(){this.listenTo(this.model.thread,"change:userScore",this.render)},toggleThreadFavorited:function(e){e&&e.preventDefault(),this.model.thread.get("userScore")<1&&(MixpanelUtils.track("like thread",e),inspectletUtils.tagSession("favorited")),this.model.thread.toggleFavorited()}});return ActivityFooterView}),define("home/templates/activityFooterFavorite",["handlebars","handlebars.partials"],function(Handlebars){return Handlebars.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),partials=this.merge(partials,Handlebars.partials),data=data||{};var stack1,buffer="",self=this;return buffer+='<ul class="actions">\n    ',stack1=self.invokePartial(partials.activityFooterDefaultActions,"activityFooterDefaultActions",depth0,helpers,partials,data),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n</ul>\n"})}),define("home/views/ActivityFooterFavoriteView",["home/views/common/ActivityFooterView","home/templates/activityFooterFavorite"],function(ActivityFooterView,activityFooterFavoriteTemplate){var ActivityFooterFavoriteView=ActivityFooterView.extend({template:activityFooterFavoriteTemplate});return ActivityFooterFavoriteView}),define("home/templates/activityCardFavorite",["handlebars","handlebars.partials"],function(Handlebars){return Handlebars.template(function(Handlebars,depth0,helpers,partials,data){function program1(depth0,data){var stack1,helper,options,buffer="";return buffer+="\n        ",helper=helpers.getPartial||depth0&&depth0.getPartial,options={hash:{},data:data},stack1=helper?helper.call(depth0,"userGroup",options):helperMissing.call(depth0,"getPartial","userGroup",options),buffer+=escapeExpression(helpers.gettext.call(depth0,"%(group)s favorited %(numOccurance)s times",{hash:{group:stack1,numOccurance:depth0&&depth0.numOccurance},data:data}))+"\n    "}function program3(depth0,data){var stack1,helper,options,buffer="";return buffer+="\n        ",helper=helpers.getPartial||depth0&&depth0.getPartial,options={hash:{},data:data},stack1=helper?helper.call(depth0,"userGroup",options):helperMissing.call(depth0,"getPartial","userGroup",options),buffer+=escapeExpression(helpers.gettext.call(depth0,"%(group)s favorited",{hash:{group:stack1},data:data}))+"\n    "}this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),partials=this.merge(partials,Handlebars.partials),data=data||{};var stack1,helper,buffer="",helperMissing=helpers.helperMissing,escapeExpression=this.escapeExpression,self=this,functionType="function";return buffer+='<div class="card-reason">\n    ',stack1=helpers["if"].call(depth0,depth0&&depth0.numOccurances,{hash:{},inverse:self.program(3,program3,data),fn:self.program(1,program1,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+='<span class="time">',(helper=helpers.relativeTime)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.relativeTime,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"</span>\n</div>\n",stack1=self.invokePartial(partials.cardTitle,"cardTitle",depth0,helpers,partials,data),(stack1||0===stack1)&&(buffer+=stack1),buffer+='\n<div class="card-summary">\n    <div class="card-summary-content">\n        ',(helper=helpers.threadDescription)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.threadDescription,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),(stack1||0===stack1)&&(buffer+=stack1),buffer+='\n    </div>\n</div>\n<footer class="card-footer" data-role="footer"></div>\n'})}),define("home/views/ActivityCardFavoriteView",["backbone-marionette","home/mixins/withReasonOld","home/views/ActivityFooterFavoriteView","home/templates/activityCardFavorite"],function(Marionette,withReason,ActivityFooterFavoriteView,activityCardFavoriteTemplate){var ActivityCardFavoriteView=Marionette.Layout.extend({template:activityCardFavoriteTemplate,templateHelpers:function(){return{discussionRoute:this.model.thread.getDiscussionRoute(),threadDescription:this.model.thread.getDefaultDescription()}},regions:{footerRegion:"[data-role=footer]"},initialize:function(){this.listenTo(this.model.thread,"change:content",this.render)},onDomRefresh:function(){this.footerRegion.show(new ActivityFooterFavoriteView({model:this.model}))}});return withReason.call(ActivityCardFavoriteView.prototype),ActivityCardFavoriteView}),define("home/templates/postActions",["handlebars","handlebars.partials"],function(Handlebars){return Handlebars.template(function(Handlebars,depth0,helpers,partials,data){function program1(){return" active"}function program3(depth0,data){var stack1,helper;return(helper=helpers.likes)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.likes,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),escapeExpression(stack1)}function program5(depth0,data){var stack1,helper,buffer="";return buffer+='\n<a href="/home/',(helper=helpers.discussionRoute)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.discussionRoute,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"#edit-",(helper=helpers.id)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.id,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'" class="edit link-gray">Edit</a>\n'}function program7(depth0,data){var buffer="";return buffer+='\n<a href="#" data-action="reply" class="reply link-gray">'+escapeExpression(helpers.gettext.call(depth0,"Reply",{hash:{},data:data}))+"</a>\n"}this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var stack1,helper,buffer="",functionType="function",escapeExpression=this.escapeExpression,self=this;return buffer+='<a href="#" class="vote-up',stack1=helpers["if"].call(depth0,depth0&&depth0.sessionUserHasUpvoted,{hash:{},inverse:self.noop,fn:self.program(1,program1,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+='" data-action="vote" data-vote="1">\n    <span class="vote-count" data-role="upvotes">',stack1=helpers["if"].call(depth0,depth0&&depth0.likes,{hash:{},inverse:self.noop,fn:self.program(3,program3,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+='</span><span class="icon-arrow-2"></span>\n</a>\n\n<a href="#" class="vote-down',stack1=helpers["if"].call(depth0,depth0&&depth0.sessionUserHasDownvoted,{hash:{},inverse:self.noop,fn:self.program(1,program1,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+='" data-action="vote" data-vote="-1">\n    <span class="icon-arrow"></span>\n</a>\n\n',stack1=helpers["if"].call(depth0,depth0&&depth0.wasAuthoredBySessionUser,{hash:{},inverse:self.program(7,program7,data),fn:self.program(5,program5,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+='\n\n<a href="'+escapeExpression((stack1=depth0&&depth0.thread,stack1=null==stack1||stack1===!1?stack1:stack1.link,typeof stack1===functionType?stack1.apply(depth0):stack1))+"#comment-",(helper=helpers.id)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.id,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'" target="_blank" class="view-comment link-gray"><span class="text-mobile">'+escapeExpression(helpers.gettext.call(depth0,"View",{hash:{},data:data}))+'</span><span class="text-desktop">'+escapeExpression(helpers.gettext.call(depth0,"View Comment",{hash:{},data:data}))+'</span><span class="icon-expand"></span></a>\n'})}),define("home/utils/features",["modernizr"],function(Modernizr){var defines={browser:{mobile:/iPhone|Android|iPod|iPad|webOS|Mobile Safari|Windows Phone|BlackBerry|Opera Mini|IEMobile/i.test(navigator.userAgent)}},canUseContentEditable=Modernizr.contenteditable&&!defines.browser.mobile&&!(window.opera&&window.opera.version);return{canUseContentEditable:function(){return canUseContentEditable}}}),define("core/extensions/jquery.autoresize",["jquery","underscore"],function($,_){return $.fn.autoresize=function(options){var settings=_.extend({extraSpace:0,maxHeight:1e3},options);return this.each(function(){var textarea=$(this).css({resize:"none",overflow:"hidden"}),method="true"===String(textarea[0].contentEditable)?"html":"val",newline="html"===method?"<br>":"\n",origHeight=textarea.height(),clone=function(){var props={};_.each(props,function(i,prop){props[prop]=textarea.css(prop)});var clone=$(textarea[0].cloneNode(!0));return clone.removeAttr("id").removeAttr("name").css({visibility:"hidden",position:"absolute",top:"-9999px",left:"-9999px",contentEditable:!1}).css(props).attr("tabIndex","-1"),clone.insertAfter(textarea[0]),clone}(),lastScrollTop=null,updateSize=function(){clone[0].style.height=0,clone[method](textarea[method]()+newline),clone.scrollTop(clone[0].scrollHeight);var scrollTop=Math.max(clone[0].scrollHeight,origHeight)+parseInt(settings.extraSpace,10);settings.maxHeight&&(scrollTop>=settings.maxHeight?(textarea.css("overflow",""),scrollTop=settings.maxHeight):textarea.css("overflow","hidden")),lastScrollTop!==scrollTop&&(lastScrollTop=scrollTop,textarea.height(scrollTop),textarea.trigger&&textarea.trigger("resize"))},throttledUpdateSize=_.throttle(updateSize,500),handleKeyUp=function(e){13===e.keyCode?updateSize():throttledUpdateSize()};textarea.bind("keyup",handleKeyUp).bind("paste",updateSize).css("overflow","hidden"),updateSize()})},$}),define("home/views/TextareaView",["jquery","backbone","core/extensions/jquery.autoresize"],function($,Backbone){var TextareaView=Backbone.View.extend({events:{"keyup    [data-role=editable]":"handleKeyUp","paste    [data-role=editable]":"handlePaste","focusin  [data-role=editable]":"handleFocusIn"},initialize:function(options){options=options||{},this.value=options.value,this.placeholder=options.placeholder},render:function(){var $input=this.$input=$("<textarea>").attr({"class":"textarea",placeholder:this.placeholder,"data-role":"editable"}).val(this.value).appendTo(this.el);return $input.autoresize({maxHeight:this.constructor.MAX_TEXTAREA_HEIGHT}),this},resize:function(){this.$input.trigger("paste",{fake:!0})},get:function(){return this.$input.val()},set:function(str){this.$input.val(str)},clear:function(){this.set("")},focus:function(){this.$input[0].focus()},handleKeyUp:function(){this.trigger("keychange")},handlePaste:function(){this.trigger("paste keychange"),this.$input.trigger("resize")},handleFocusIn:function(){this.trigger("focus")}},{MAX_TEXTAREA_HEIGHT:350});return TextareaView}),function(window){function normalizeSpace(str){return str.replace(nbspRe," ")}function getTextHelper(nodes,nodeCallback,blockJoin){var name,node,tmp,i,text="",blocks=[];for("string"!=typeof blockJoin&&(blockJoin="\n\n"),i=0;i<nodes.length;++i)node=nodes[i],name=node.nodeName.toLowerCase(),1===node.nodeType?(tmp=nodeCallback&&nodeCallback(node),tmp?text+=tmp:blockElems.hasOwnProperty(name)?(text&&blocks.push(text),text=getTextHelper(node.childNodes,nodeCallback,blockJoin)):text+="br"===name?"\n":getTextHelper(node.childNodes,nodeCallback,blockJoin)):3===node.nodeType&&(text+=normalizeSpace(node.nodeValue));return blocks.push(text),blocks.join(blockJoin)}function addEventListener(el,name,listener){if(el.addEventListener)el.addEventListener(name,listener,!1);else{if(!el.attachEvent)throw new Error("No event support.");el.attachEvent("on"+name,listener)}}var document=window.document,character="character",nbspRe=new RegExp(String.fromCharCode(160),"gi"),blockElemList="h1 h2 h3 h4 h5 h6 p pre blockquote address ul ol dir menu li dl div form".split(" "),blockElems={},i=0;for(i=0;i<blockElemList.length;i++)blockElems[blockElemList[i]]=!0;var Editable=function(elem,emulate,overrides){var self=this;if(!elem||!elem.contentEditable)throw"First argument must be contentEditable";this.elem=elem,this.emulateTextarea=elem.getAttribute("plaintext-only")||emulate,this.emulateTextarea&&(this.pasteHandler=function(){var func=self.plainTextReformat,later=function(){func.timeout=null,func.call(self)};func.timeout&&clearTimeout(func.timeout),func.timeout=setTimeout(later,0)},addEventListener(elem,"paste",this.pasteHandler));for(var prop in overrides)overrides.hasOwnProperty(prop)&&(this[prop]=overrides[prop])};Editable.prototype={insertHTML:function(html){if(document.all){var range=document.selection.createRange();return range.pasteHTML(html),range.collapse(!1),range.select()}return document.execCommand("insertHTML",!1,html)},insertNode:function(node){var selection,range,html;window.getSelection?(selection=window.getSelection(),selection.getRangeAt&&selection.rangeCount&&(range=selection.getRangeAt(0),range.deleteContents(),range.insertNode(node),range.collapse(!1),selection.removeAllRanges(),selection.addRange(range))):document.selection&&document.selection.createRange&&(range=document.selection.createRange(),html=3===node.nodeType?node.data:node.outerHTML,range.pasteHTML(html),range.collapse(!1))},getTextNodes:function(nodeList){var elem=this.elem;nodeList&&nodeList.nodeType?nodeList=[nodeList]:nodeList||(nodeList=elem.childNodes);for(var node,textNodes=[],i=0;i<nodeList.length;++i)if(node=nodeList[i])switch(node.nodeType){case 1:textNodes=textNodes.concat(this.getTextNodes(node.childNodes));break;case 3:/^\n\s+/.test(node.nodeValue)||textNodes.push(node)}return textNodes},text:function(nodeCallback){var out,nodes,i,elem=this.elem;try{nodes=Array.prototype.slice.call(elem.childNodes)}catch(e){for(nodes=[],i=0;i<elem.childNodes.length;++i)nodes.push(elem.childNodes[i])}return out=getTextHelper(nodes,nodeCallback,this.emulateTextarea&&"\n"),out.replace(/^\s+|\s+$/g,"")},setText:function(str){str=str||"";var i,par,p,el=document.createDocumentFragment(),paragraphs=this.emulateTextarea?[str.replace(/(?:\r\n|\r|\n){2,}/g,"\n\n")]:str.split(/(?:\r\n|\r|\n){2,}/),lenP=paragraphs&&paragraphs.length;for(i=0;lenP>i;i++)par=paragraphs[i],p=this.createParagraph(par),el.appendChild(p);el.lastChild.appendChild(document.createElement("br")),this.elem.innerHTML="",this.elem.appendChild(el);var sel=window.getSelection&&window.getSelection();sel&&sel.anchorNode===this.elem&&sel.modify&&sel.modify("move","forward","line")},createParagraph:function(text){var i,j,lines,line,lenL,lenC,children,p=document.createElement("p");for(lines=text.split(/\r\n|\r|\n/),j=0,lenL=lines.length;lenL>j;j++){for(line=lines[j],children=this.getHtmlElements(line),i=0,lenC=children.length;lenC>i;i++)p.appendChild(children[i]);p.appendChild(document.createElement("br"))}return p.lastChild&&p.removeChild(p.lastChild),p},getHtmlElements:function(line){return[document.createTextNode(line)]},plainTextReformat:function(){if(!(this.elem.getElementsByTagName("p").length<=1)){this.emulateTextarea=!1;var rawText=this.text();this.emulateTextarea=!0,this.setText(rawText)}},removeNode:function(node){var prev,sel,range;window.getSelection?(prev=node.previousSibling,node.parentNode.removeChild(node),sel=window.getSelection(),range=document.createRange(),prev&&(range.setStart(prev,prev.length),range.setEnd(prev,prev.length)),sel.addRange(range)):node.parentNode.removeChild(node)},selectedTextNode:function(){var sel,range,elem=this.elem;if(window.getSelection)return sel=window.getSelection(),sel.anchorNode;if(document.selection.createRange){for(range=document.selection.createRange().duplicate();-1e3===range.moveStart(character,-1e3);)continue;var node,textNode,textNodes,prevNode,snippet,i,j,text=range.text;for(i=0;i<elem.childNodes.length;++i)for(node=elem.childNodes[i],textNodes=this.getTextNodes(node),j=0;j<textNodes.length;++j)if(textNode=textNodes[j],snippet=normalizeSpace(textNode.nodeValue),text.indexOf(snippet)>-1)prevNode=textNode,text=text.replace(snippet,"");else if(snippet.indexOf(text)>-1)return textNode;return prevNode}},selectedTextNodeOffset:function(node){var range,newOffset;if(window.getSelection){var sel=window.getSelection();sel&&sel.anchorOffset&&(newOffset=sel.anchorOffset)}else if(node&&document.selection.createRange){range=document.selection.createRange();for(var textNodeText=normalizeSpace(node.nodeValue),r2=range.duplicate(),prevParent=r2.parentElement(),offset=0;0!==range.moveStart(character,-1)&&++offset&&0!==textNodeText.indexOf(normalizeSpace(range.text))&&prevParent===range.parentElement();)r2=range.duplicate(),prevParent=r2.parentElement();newOffset=offset}return isNaN(newOffset)?0:newOffset},selectNodeText:function(node,start,end){var sel,range,elem=this.elem;if(window.getSelection)return sel=window.getSelection(),sel.removeAllRanges(),range=document.createRange(),range.setStart(node,start),range.setEnd(node,end),sel.addRange(range),sel;if(document.selection.createRange){range=document.selection.createRange();var text=normalizeSpace(node.nodeValue);if("body"===range.parentElement().nodeName.toLowerCase()){for(elem.focus(),range=document.selection.createRange();-1e3===range.moveStart(character,-1e3);)continue;for(;1e3===range.moveEnd(character,1e3);)continue;var rangeText=normalizeSpace(range.text),index=rangeText.indexOf(text);index>0&&range.moveStart(character,index+2),range.collapse()}for(;-1===range.moveStart(character,-1)&&0!==text.indexOf(normalizeSpace(range.text));)continue;for(;1===range.moveEnd(character,1)&&text!==normalizeSpace(range.text);)continue;return range.moveStart(character,start),range.moveEnd(character,-1*(end-start-range.text.length)),range.select(),range}}},Editable.normalizeSpace=normalizeSpace,window.Editable=Editable}(this),define("editable",["jquery"],function(global){return function(){var ret;return ret||global.Editable}}(this)),define("home/views/ContentEditableView",["jquery","underscore","editable","home/views/TextareaView"],function($,_,Editable,TextareaView){var MAX_TEXTAREA_HEIGHT=350,ContentEditableView=TextareaView.extend({events:function(){return _.extend({},TextareaView.prototype.events,{"keydown  [data-role=editable]":"handleKeyDown","focusout [data-role=editable]":"handleFocusOut","click .placeholder":"handlePlaceholderClick"})},initialize:function(options){TextareaView.prototype.initialize.call(this,options),options=options||{},this.reset(),this.$input=null},reset:function(){this.anchorNode=null,this.anchorOffset=null,this.anchorLength=0},render:function(){var $input=this.$input=$("<div>").attr({"class":"textarea",tabIndex:this.el.tabIndex,role:"textbox","aria-multiline":"true",contenteditable:"true","data-role":"editable"}).css({overflow:"auto","max-height":MAX_TEXTAREA_HEIGHT+"px"}).appendTo(this.$el);this.content=new Editable($input[0],!0),this.set(this.value);var placeholder=this.placeholder;return placeholder&&($input.attr("aria-label",placeholder),this.$placeholder=$('<span class="placeholder">'+placeholder+"</span>"),this.content.text()||this.setPlaceholder()),this},setPlaceholder:function(){this.$el.prepend(this.$placeholder)},handlePlaceholderClick:function(){this.$input.focus()},handleFocusIn:function(){TextareaView.prototype.handleFocusIn.call(this),this.$placeholder.remove()},handleFocusOut:function(){""===this.content.text()&&this.setPlaceholder()},get:function(){return this.content.text()},set:function(str){this.content.setText(str),this.resize()},clear:function(){TextareaView.prototype.clear.call(this),this.setPlaceholder(),_.defer(function(self){self.$input.blur()},this)}});return ContentEditableView}),define("home/templates/postReply",["handlebars","handlebars.partials"],function(Handlebars){return Handlebars.template(function(Handlebars,depth0,helpers,partials,data){function program1(depth0,data){var stack1,buffer="";return buffer+='\n    <div class="avatar">\n        ',stack1=helpers["if"].call(depth0,(stack1=depth0&&depth0.user,null==stack1||stack1===!1?stack1:stack1.isRegistered),{hash:{},inverse:self.program(4,program4,data),fn:self.program(2,program2,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n    </div>\n    "}function program2(depth0,data){var stack1,buffer="";return buffer+="\n            ",stack1=self.invokePartial(partials.userAvatar,"userAvatar",depth0&&depth0.user,helpers,partials,data),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n        "}function program4(depth0){var stack1,buffer="";return buffer+='\n            <span class="user">\n                <img data-role="user-avatar" src="'+escapeExpression((stack1=depth0&&depth0.user,stack1=null==stack1||stack1===!1?stack1:stack1.avatar,stack1=null==stack1||stack1===!1?stack1:stack1.cache,typeof stack1===functionType?stack1.apply(depth0):stack1))+'"/>\n            </span>\n        '}function program6(){return'style="margin-left: 0"'}function program8(depth0,data){var stack1,buffer="";return buffer+='\n            <div class="post-actions">\n                <ul class="wysiwyg">\n                </ul>\n                \n                ',stack1=helpers["if"].call(depth0,(stack1=depth0&&depth0.user,null==stack1||stack1===!1?stack1:stack1.isRegistered),{hash:{},inverse:self.noop,fn:self.program(9,program9,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n            </div>\n            "}function program9(depth0,data){var stack1,helper,options,buffer="";return buffer+='\n                    <div class="logged-in">\n                        <section>\n                            <div class="temp-post" style="text-align: right">\n                                <button class="btn">\n                                ',helper=helpers.getPartial||depth0&&depth0.getPartial,options={hash:{},data:data},stack1=helper?helper.call(depth0,"userSpan",depth0&&depth0.user,options):helperMissing.call(depth0,"getPartial","userSpan",depth0&&depth0.user,options),buffer+=escapeExpression(helpers.gettext.call(depth0,"Post as %(username)s",{hash:{username:stack1},data:data}))+"\n                                </button>\n                            </div>\n                        </section>\n                    </div>\n                "}this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),partials=this.merge(partials,Handlebars.partials),data=data||{};var stack1,buffer="",self=this,functionType="function",escapeExpression=this.escapeExpression,helperMissing=helpers.helperMissing;return buffer+='<div class="alert error" style="display:none" role="alert">\n    <a class="close" data-action="dismiss-alert" title="Dismiss">×</a>\n    <span></span>\n</div>\n\n<div class="postbox">\n    ',stack1=helpers["if"].call(depth0,depth0&&depth0.showAvatar,{hash:{},inverse:self.noop,fn:self.program(1,program1,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+='\n\n        <div class="textarea-wrapper" ',stack1=helpers.unless.call(depth0,depth0&&depth0.showAvatar,{hash:{},inverse:self.noop,fn:self.program(6,program6,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+='\n            data-role="textarea" dir="auto">\n            <div class="edit-alert" role="postbox-alert"></div>\n            ',stack1=helpers["if"].call(depth0,depth0&&depth0.showSubmitButton,{hash:{},inverse:self.noop,fn:self.program(8,program8,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n        </div>\n</div>\n"})}),define("home/templates/postboxAlert",["handlebars","handlebars.partials"],function(Handlebars){return Handlebars.template(function(Handlebars,depth0,helpers,partials,data){function program1(depth0,data){var stack1,helper,buffer="";return buffer+="\n                ",(helper=helpers.message)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.message,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n            "}function program3(depth0,data){var stack1,helper,buffer="";return buffer+="\n                ",(helper=helpers.message)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.message,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"\n            "}this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var stack1,buffer="",functionType="function",escapeExpression=this.escapeExpression,self=this;return buffer+='<div class="alert">\n    <span class="icon-cancel"></span>\n    <p class="text">\n        <span>\n            ',stack1=helpers["if"].call(depth0,depth0&&depth0.safe,{hash:{},inverse:self.program(3,program3,data),fn:self.program(1,program1,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n        </span>\n    </p>\n</div>\n"})}),define("home/templates/blacklistErrorMessage",["handlebars","handlebars.partials"],function(Handlebars){return Handlebars.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var buffer="",escapeExpression=this.escapeExpression;return buffer+=escapeExpression(helpers.gettext.call(depth0,"We are unable to post your comment because you have been blocked by %(forumName)s",{hash:{forumName:depth0&&depth0.forumName},data:data}))+'\n<a target="_blank" href="https://help.disqus.com/customer/portal/articles/466223-who-deleted-or-removed-my-comment-">'+escapeExpression(helpers.gettext.call(depth0,'"Find out more."',{hash:{},data:data}))+"</a>\n"})}),define("home/templates/mustVerifyEmail",["handlebars","handlebars.partials"],function(Handlebars){return Handlebars.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var stack1,helper,buffer="",functionType="function",escapeExpression=this.escapeExpression;return(helper=helpers.forumName)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.forumName,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+' requires you to\n<a href="#" data-action="verify-email">verify your email address</a> before posting\n'})}),define("home/views/PostReplyView",["jquery","underscore","backbone","home/views/TextareaView","home/views/ContentEditableView","home/templates/postReply","home/templates/postboxAlert","home/templates/blacklistErrorMessage","home/templates/mustVerifyEmail","core/bus"],function($,_,Backbone,TextareaView,ContentEditableView,postReplyTemplate,postboxAlertTemplate,blacklistErrorMessageTemplate,mustVerifyEmailTemplate,bus){var PostReplyView=Backbone.View.extend({tagName:"form",className:"reply-form",events:{"click [data-action=cancel]":"hide",submit:"submitForm"},initialize:function(options){this.session=options.session,this.showSubmitButton=options.showSubmitButton!==!1,this.showAvatar=options.showAvatar!==!1,this.placeholderText=options.placeholder,this.canUseContentEditable=options.canUseContentEditable,this.postboxAlertSelector="[role=postbox-alert]",this._isHidden=!1,this.listenTo(this.model,{error:this.onerror,sync:this.onsync})},redraw:function(){var isExpanded=this.$el.hasClass("expanded"),oldEl=this.el,msg=this.$el.find("textarea").val();this.render(),this.$el.find("textarea").val(msg),isExpanded&&this.$el.addClass("expanded"),0!==$(oldEl).parent().length&&oldEl.parentNode.replaceChild(this.el,oldEl)},getPlaceholderText:function(){return this.placeholderText||"Discuss…"},render:function(){var self=this,$el=self.$el;return self.$el.html(postReplyTemplate({showAvatar:self.showAvatar,showSubmitButton:self.showSubmitButton,user:self.session.toJSON()})),this.model.get("parent")?$el.addClass("expanded"):$el.removeClass("expanded"),$el.addClass("authenticated"),self.initTextarea(),self.session.get("mustVerifyEmail")&&self._alertMustVerify(),self._isHidden&&$el.addClass("hidden"),this},initTextarea:function(){var self=this,TextareaViewClass=this.canUseContentEditable?ContentEditableView:TextareaView,textarea=this.textarea=new TextareaViewClass({placeholder:self.getPlaceholderText(),userSuggestions:this.userSuggestions,value:this.model.get("message")});self.$("[data-role=textarea]").prepend(textarea.render().el),self.listenTo(textarea,{focus:function(){self.$el.addClass("expanded"),_.delay(_.bind(self.resize,self),200)}})},resize:function(){this.textarea.resize()},focus:function(){this.textarea.focus()},clear:function(){var self=this;self.textarea.clear(),self.$el.removeClass("expanded"),self.model.get("parent")?self.hide():self.setInactive()},setInactive:function(){this.$el.removeClass("expanded")
},restore:function(post){var self=this;self.textarea.set(post.get("raw_message")),self.textarea.handleFocusIn(),_.delay(function(){self.resize()},200),self.model.get("parent")&&self.show()},_alertMustVerify:function(error){var msg=mustVerifyEmailTemplate({forumName:this.thread.forum.get("name")});this.alert(msg,{safe:!0,type:error?"error":"warn"})},alert:function(){this.displayPostboxAlert.apply(this,arguments)},dismissAlert:function(){this.clearPostboxAlert()},submitForm:function(ev){return ev.preventDefault(),this.dismissAlert(),this.createPost()},displayPostboxAlert:function(message,safe){var postboxAlert=postboxAlertTemplate({message:message,safe:safe});this.$el.find(this.postboxAlertSelector).html(postboxAlert)},clearPostboxAlert:function(){this.$el.find(this.postboxAlertSelector).empty()},onerror:function(model,response){var self=this,post=this.model;if(12===response.code&&/not have permission to post on this thread/.test(response.response)){var errorMessage=blacklistErrorMessageTemplate({forumName:self.thread.forum.get("name")});self.displayPostboxAlert(errorMessage,!0)}else 12===response.code&&/verify/.test(response.response)?self._alertMustVerify(!0):self.displayPostboxAlert(_.isString(response.response)?response.response:"Oops! We're having trouble posting your comment. Check your internet connection and try again.");self.restore(post)},createPost:function(){var post=this.model;this.clearPostboxAlert();var success=post.save({raw_message:this.textarea.get()});return success?(success.done(function(){bus.trigger("uiCallback:postCreated",post)}),this.clear(),post):void this.displayPostboxAlert(post.validationError)},prependTo:function(target){target=target[0],target.insertBefore(this.el,target.firstChild)},toggle:function(){this.isOpen()?this.hide():this.show()},show:function(){var self=this;self._isHidden=!1,self.$el.removeClass("hidden"),self.trigger("show")},hide:function(){var self=this;self._isHidden=!0,self.dismissAlert(),self.$el.addClass("hidden"),self.trigger("hide")},isOpen:function(){return!this._isHidden}});return PostReplyView}),define("home/ReplyViewManager",["underscore","jquery","backbone","home/utils/features","home/models/Post","home/models/Session","home/views/PostReplyView"],function(_,$,Backbone,featureUtils,Post,Session,PostReplyView){function ReplyViewManager(parentPostView){this.view=parentPostView,this.model=this.view.model,this.listenTo(this.view,"close",function(){this.stopListening()})}var protoFuncs={toggleReplyView:function(replyToggleEl){var $replyToggle=$(replyToggleEl);this.replyView?this.replyView.toggle():(this.replyView=this.createReplyView().render(),$replyToggle.parent().after(this.replyView.el)),this.replyView._isHidden||this.replyView.focus()},vivifyReply:function(model){var view=new this.view.constructor({model:model,session:new Session});this.replyView.$el.after(view.render().el),view.trigger("show"),this.replyView.remove(),this.replyView=null},createReplyView:function(){var reply=new Post({thread:this.model.thread.id,parent:this.model.id,depth:this.model.get("depth")+1,author:(new Session).user.id});return this.listenTo(reply,"change:id",this.vivifyReply),new PostReplyView({model:reply,session:new Session,canUseContentEditable:featureUtils.canUseContentEditable()})}};return _.extend(ReplyViewManager.prototype,protoFuncs,Backbone.Events),ReplyViewManager}),define("core/views/UpvotersCard",["underscore","core/views/common/HoverCard","core/views/UsersCard"],function(_,HoverCard,UsersCard){var UpvotersCard=UsersCard.extend({guestTextPartialName:"cardGuestUpvoterText",initialize:function(options){var model=options.model,collection=model.getUpvotersUserCollection();_.extend(options,{collection:collection,numUsers:model.get("likes")}),UsersCard.prototype.initialize.call(this,options),this.model=model,this.session=options.session,this.likes=model.get("likes"),this.hadLikes=!!this.likes,this._fetched=!1,this._loading=!1,this._rendered=!1,this.listenTo(this.model,"change:userScore",this.updateUserSet),this.listenTo(this.model,"change:likes",this.updateGuests)},updateGuests:function(){this.numUsers=this.model.get("likes")||0,UsersCard.prototype.updateGuests.apply(this,arguments)},updateUserSet:function(){var user=this.session.user,hadLikes=this.likes,heightIncrease=!1;if(this.likes=this.model.get("likes"),this.model.get("userScore")>0)if(this.session.user.get("isAnonymous")||this.collection.add(user),this.likes&&!hadLikes)this._rendered=!1,this.show();else{var guestLikes=this.likes-1-this.collection.length;heightIncrease=this.session.user.get("isAnonymous")?!0:!!guestLikes}else this.collection.remove(user),this.likes||this.hide();this.updateGuests(),this.moveTo(this.$target,heightIncrease)},show:function(){if(this.likes&&!this.isVisible()){if(this.hadLikes||(this._fetched=!0,this._loading=!1),!this._fetched&&!this.loading)return void this.collection.fetch().done(_.bind(function(){this._fetched=!0,this._loading=!1,this.show()},this));var user=this.session.user;this.model.get("userScore")>0&&!this.session.user.get("isAnonymous")&&!this.collection.contains(user)&&this.collection.add(user),UsersCard.prototype.show.call(this),this.trigger("uiAction:upvotersCardShow")}}},{create:function(options){return HoverCard.create(options.postId,options,"UpvotersCard",UpvotersCard)}});return UpvotersCard}),define("home/views/PostActionsView",["jquery","backbone-marionette","home/templates/postActions","home/utils/mixpanelUtils","home/ReplyViewManager","home/models/Session","core/views/UpvotersCard","core/bus","core/utils"],function($,Marionette,postActionsTemplate,MixpanelUtils,ReplyViewManager,Session,UpvotersCard,bus,utils){var PostActionView=Marionette.ItemView.extend({template:postActionsTemplate,templateHelpers:function(){return{discussionRoute:this.model.thread.getDiscussionRoute(),sessionUserHasUpvoted:this.model.get("userScore")>0,sessionUserHasDownvoted:this.model.get("userScore")<0,wasAuthoredBySessionUser:this.model.author.isSessionUser()}},events:{"click [data-action=vote]":"vote","click [data-action=reply]":"toggleReplyView"},initialize:function(options){this.replyViewManager=new ReplyViewManager(options.parentPostView)},onRender:function(){this.initUpvotersCard()},initUpvotersCard:function(){if(!utils.isPhone(window)){this.hoverCard&&this.hoverCard.remove();var target=this.$("[data-action=vote][data-vote=1]");target.length&&(this.hoverCard=UpvotersCard.create({targetElement:target,model:this.model,postId:this.model.get("id"),session:new Session}))}},vote:function(e){if(e){e.preventDefault(),e.stopPropagation(),MixpanelUtils.track("like post",e);var $anchor=$(e.currentTarget),vote=parseInt($anchor.data("vote"),10),isUndo=this.model.get("userScore")===vote;isUndo?bus.trigger("uiAction:postUnvote",this.model,e):1===vote?bus.trigger("uiAction:postUpvote",this.model,e):-1===vote&&bus.trigger("uiAction:postDownvote",this.model,e),this.model.vote(vote),this.$("[data-vote=1]").toggleClass("active",1===this.model.get("userScore")),this.$("[data-vote=-1]").toggleClass("active",-1===this.model.get("userScore")),this.$("[data-role=upvotes]").text(this.model.get("likes")||"")}},toggleReplyView:function(e){e&&(e.preventDefault(),e.stopPropagation(),this.replyViewManager.toggleReplyView(e.currentTarget))}});return PostActionView}),define("home/views/common/RichMediaView",["backbone-marionette"],function(Marionette){var RichMediaView=Marionette.ItemView.extend({className:"rich-media-wrapper"});return RichMediaView}),define("home/templates/iframeMedia",["handlebars","handlebars.partials"],function(Handlebars){return Handlebars.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var stack1,helper,buffer="",functionType="function",escapeExpression=this.escapeExpression;return buffer+='<a href="#" data-action="load-iframe" class=\'iframe-thumbnail ',(helper=helpers.mediaSource)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.mediaSource,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"'>\n    <img src=\"",(helper=helpers.thumbnailUrl)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.thumbnailUrl,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'"/>\n</a>\n'})}),define("home/views/IFrameRichMediaView",["underscore","home/views/common/RichMediaView","home/templates/iframeMedia"],function(_,RichMediaView,iframeMediaTemplate){var IFrameRichMediaView=RichMediaView.extend({template:iframeMediaTemplate,templateHelpers:function(){var templateHelpers=RichMediaView.prototype.templateHelpers;return _.isFunction(templateHelpers)&&(templateHelpers=templateHelpers.call(this)),_.extend({},templateHelpers,{mediaSource:IFrameRichMediaView.MEDIA_TYPES[this.model.get("mediaType")]})},events:function(){return _.extend({},RichMediaView.prototype.events,{"click [data-action=load-iframe]":"loadIframe"})}(),addAutoplay:function(iframeHtml){var srcRegex=/src=(("[^"]+)|('[^']+))/,iframeSrc=iframeHtml.match(srcRegex);if(iframeSrc){iframeSrc=iframeSrc[0];var argument;switch(this.model.get("mediaType")){case"3":case"12":argument="autoplay=1";break;case"10":argument="auto_play=true"}if(argument){var srcStartIndex=iframeHtml.search(srcRegex),argumentIndex=srcStartIndex+iframeSrc.length;iframeHtml=iframeHtml.substr(0,argumentIndex)+(/\?/.test(iframeSrc)?"&":"?")+argument+iframeHtml.substr(argumentIndex)}}return iframeHtml},loadIframe:function(e){e.preventDefault();var iframeHtml=this.addAutoplay(this.model.get("html"));this.$el.html(iframeHtml).fitVids()}},{MEDIA_TYPES:{3:"youtube",12:"vimeo",10:"soundcloud"}});return IFrameRichMediaView}),define("home/templates/webpageMedia",["handlebars","handlebars.partials"],function(Handlebars){return Handlebars.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var stack1,helper,buffer="",functionType="function",escapeExpression=this.escapeExpression;return buffer+='<a class="media-webpage" target="_blank" href="',(helper=helpers.url)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.url,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'">\n    <div class="media-webpage-title">',(helper=helpers.descriptionPreview)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.descriptionPreview,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'</div>\n    <div class="media-webpage-domain">',(helper=helpers.domain)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.domain,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"</div>\n</a>\n"})}),define("home/views/WebpageRichMediaView",["underscore","home/views/common/RichMediaView","home/templates/webpageMedia"],function(_,RichMediaView,webpageMediaTemplate){var WebpageRichMediaView=RichMediaView.extend({template:webpageMediaTemplate,templateHelpers:function(){var templateHelpers=RichMediaView.prototype.templateHelpers;return _.isFunction(templateHelpers)&&(templateHelpers=templateHelpers.call(this)),_.extend({},templateHelpers,{domain:WebpageRichMediaView.getDomain(this.model.get("url")),descriptionPreview:WebpageRichMediaView.niceTruncate(this.model.get("description"),60)})}},{getDomain:function(url){if(!url)return"";url="http://"+url.replace(/^([a-z+.-]+:)?\/+/i,"");var link=document.createElement("a");link.href=url;var domain=link.hostname.replace(/^www\d*\./i,"");return domain=domain.toLowerCase()},niceTruncate:function(text,upperLimit){if(text.length<=upperLimit)return text;text=text.slice(0,upperLimit-1);var max=text,matches=/(^.*\S)\s/.exec(text);matches&&(text=matches[1]);var endPunctuation=WebpageRichMediaView.terminatingPuncRe.exec(text);return endPunctuation&&(text=text.slice(0,text.length-endPunctuation[0].length)),text.length<.5*max.length&&(text=max),text+"…"},terminatingPuncRe:new RegExp("[\\u0021-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u007E\\u00A1-\\u00BF\\u2010-\\u2027\\u2030-\\u205E\\u2300-\\u23FF\\u2E00-\\u2E7F\\u3001-\\u303F\\uFE10-\\uFE19\\uFE30-\\uFE4F\\uFE50-\\uFE6B\\uFF01-\\uFF0F\\uFF1A-\\uFF20\\uFF3B-\\uFF40\\uFF5B-\\uFF60\\uFF5F-\\uFF64]+$")});return WebpageRichMediaView}),define("home/templates/imageMedia",["handlebars","handlebars.partials"],function(Handlebars){return Handlebars.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var stack1,helper,buffer="",functionType="function",escapeExpression=this.escapeExpression;return buffer+='<a target="_blank" href="',(helper=helpers.url)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.url,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'">\n    <img src="',(helper=helpers.thumbnailUrl)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.thumbnailUrl,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'"/>\n</a>\n'})}),define("home/views/ImageRichMediaView",["home/views/common/RichMediaView","home/templates/imageMedia"],function(RichMediaView,imageMediaTemplate){var ImageRichMediaView=RichMediaView.extend({template:imageMediaTemplate});return ImageRichMediaView}),define("home/RichMediaViewFactory",["home/views/IFrameRichMediaView","home/views/WebpageRichMediaView","home/views/ImageRichMediaView"],function(IFrameRichMediaView,WebpageRichMediaView,ImageRichMediaView){var RichMediaViewFactory={create:function(options){if(!options.model)throw"Model should have been passed into the contructor";switch(options.model.get("mediaType")){case"3":case"10":case"12":return new IFrameRichMediaView(options);case"4":case"6":case"7":case"5":return new WebpageRichMediaView(options);default:return new ImageRichMediaView(options)}}};return RichMediaViewFactory}),define("home/mixins/withCollapsing",["underscore","jquery","home/utils/mixpanelUtils"],function(_,$,MixpanelUtils){var CollapsingMixin={events:{"click [data-action=expand]":"expand"},collapse:function(options){var imagePromises=this.$("img").map(function(index,el){var deferred=$.Deferred(),$el=$(el);return $el.complete?deferred.resolve():$el.one("load",deferred.resolve),deferred.promise()}),self=this,maxHeight=options.maxHeight;$.when(imagePromises).then(function(){var $expand=self.$("[data-action=expand]"),$element=self.$(".expanded");$expand.length&&$element.height()>maxHeight&&($element.removeClass("expanded"),$expand.removeClass("hidden"))})},expand:function(e){e&&e.preventDefault();var $expand=$(e.target).closest("[data-action=expand]"),expandableSelector=$expand.data("target"),$expandable=$expand.siblings(expandableSelector),self=this;$expand.addClass("hidden"),$expandable.addClass("expanded").one("transitionend oTransitionEnd webkitTransitionEnd",function(){self.trigger("expandedComplete")}),MixpanelUtils.track("expand comment",e)}},withCollapsing=function(options){var _initialize=this.initialize;this.initialize=function(){_initialize.apply(this,arguments),this.listenTo(this,"show",this.collapse)},this.collapse=function(){CollapsingMixin.collapse.call(this,options)},this.expand=function(e){CollapsingMixin.expand.call(this,e,options)},this.events=_.defaults(CollapsingMixin.events,this.events)};return withCollapsing}),define("home/templates/postContent",["handlebars","handlebars.partials"],function(Handlebars){return Handlebars.template(function(Handlebars,depth0,helpers,partials,data){function program1(){return"comment-message-hidden"}this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var stack1,helper,buffer="",self=this,functionType="function",escapeExpression=this.escapeExpression;return buffer+='<div class="comment-message expanded ',stack1=helpers["if"].call(depth0,depth0&&depth0.isHidden,{hash:{},inverse:self.noop,fn:self.program(1,program1,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+='"\n    data-role="message">\n    ',(helper=helpers.message)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.message,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),(stack1||0===stack1)&&(buffer+=stack1),buffer+='\n    <div><ul class="post-media" data-role="post-media-list"></ul></div>\n</div>\n<a  href="#" class="curtain-truncate hidden" title="See more"\n  data-action="expand"\n  data-target=".comment-message">'+escapeExpression(helpers.gettext.call(depth0,"see more",{hash:{},data:data}))+"</a>\n"})}),define("home/views/PostContentView",["jquery","underscore","backbone","backbone-marionette","home/views/PostActionsView","home/utils/datetimeUtils","home/RichMediaViewFactory","home/WrapperlessRegion","home/mixins/withCollapsing","home/templates/postContent"],function($,_,Backbone,Marionette,PostActionsView,datetimeUtils,RichMediaViewFactory,WrapperlessRegion,withCollapsing,postContentTemplate){var PostContentView=Marionette.Layout.extend({template:postContentTemplate,templateHelpers:function(){return{isHidden:"visible"!==this.model.get("state")}},onRender:function(){this.renderRichMedia(this.model.get("media"))},renderRichMedia:function(media){if(media&&media.length){var $message=this.$("[data-role=message]");if($message.length){var links={};$message.find("a").each(function(i,link){var url=link.href;links[url]||(links[url]=$(link))}),this.richMediaViews=this.richMediaViews||{},_.each(media,function(m){var url=m.url;this.richMediaViews[url]||(this.richMediaViews[url]=RichMediaViewFactory.create({model:new Backbone.Model(m)}).render());var richMediaView=this.richMediaViews[url],$link=links[url],$parent=PostContentView.getHighestLinkParent($link);if($parent)$parent.append(richMediaView.$el);else{var mediaNode=this.$("[data-role=post-media-list]"),$li=$("<li>");if(!mediaNode.length)return;$li.append(richMediaView.$el),mediaNode.append($li)}richMediaView.delegateEvents()},this)}}}},{getHighestLinkParent:function(){var TAG_WHITELIST={B:!0,CAPTION:!0,EM:!0,I:!0,P:!0,S:!0,SPAN:!0,STRIKE:!0,STRONG:!0,U:!0};return function($link){if($link){var $lastEl,parents=$link.parents(),validParents=!0;if(_.find(parents,function(parent){var $parent=$(parent);return"message"===$parent.attr("data-role")?!0:TAG_WHITELIST[parent.tagName]?void($lastEl=$parent):(validParents=!1,!0)}),validParents)return $lastEl}}}()});return withCollapsing.call(PostContentView.prototype,{maxHeight:115,hiddenClass:"hidden",expandedClass:"expanded"}),PostContentView}),define("home/templates/post",["handlebars","handlebars.partials"],function(Handlebars){return Handlebars.template(function(Handlebars,depth0,helpers,partials,data){function program1(depth0,data){var stack1,helper,buffer="";return buffer+='\n            <span class="label label-danger">',(helper=helpers.hiddenExplanation)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.hiddenExplanation,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"</span>\n        "}function program3(){return"hidden"}this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),partials=this.merge(partials,Handlebars.partials),data=data||{};var stack1,helper,buffer="",functionType="function",escapeExpression=this.escapeExpression,self=this;return stack1=self.invokePartial(partials.userAvatar,"userAvatar",depth0&&depth0.author,helpers,partials,data),(stack1||0===stack1)&&(buffer+=stack1),buffer+='\n<div class="comment-body">\n    <header class="comment-header">\n        ',stack1=self.invokePartial(partials.userName,"userName",depth0&&depth0.author,helpers,partials,data),(stack1||0===stack1)&&(buffer+=stack1),buffer+=' <a class="link-gray time" href="/home/',(helper=helpers.discussionRoute)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.discussionRoute,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"#comment-",(helper=helpers.id)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.id,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'">',(helper=helpers.relativeTime)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.relativeTime,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"</a>\n        ",stack1=helpers["if"].call(depth0,depth0&&depth0.isHidden,{hash:{},inverse:self.noop,fn:self.program(1,program1,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+='\n    </header>\n    <div data-role="post-content"></div>\n    <footer class="comment-actions ',stack1=helpers["if"].call(depth0,depth0&&depth0.isHidden,{hash:{},inverse:self.noop,fn:self.program(3,program3,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+='" data-role="post-actions">\n    </footer>\n</div>\n'})}),define("home/views/PostView",["jquery","underscore","backbone","backbone-marionette","home/views/PostActionsView","home/views/PostContentView","home/utils/datetimeUtils","home/RichMediaViewFactory","home/WrapperlessRegion","home/templates/post","home/utils/cardUtils"],function($,_,Backbone,Marionette,PostActionsView,PostContentView,datetimeUtils,RichMediaViewFactory,WrapperlessRegion,postTemplate){var PostView=Marionette.Layout.extend({className:"card-comment",template:postTemplate,templateHelpers:function(){var state=this.model.get("state");return{isHidden:"visible"!==state,hiddenExplanation:{flagged:"Pending",pending:"Pending",spam:"Detected as spam",deleted:"Removed"}[state],discussionRoute:this.model.thread.getDiscussionRoute(),relativeTime:datetimeUtils.getRelativeDatetime(this.model.get("createdAt"))}},regions:{postActionsRegion:{selector:"[data-role=post-actions]",regionType:WrapperlessRegion},postContentRegion:{selector:"[data-role=post-content]",regionType:WrapperlessRegion}},initialize:function(options){this.hideActions=options.hideActions},onDomRefresh:function(){this.hideActions||this.postActionsRegion.show(new PostActionsView({model:this.model,parentPostView:this})),this.postContentRegion.show(new PostContentView({model:this.model}))}});return PostView}),define("home/utils/domUtils",["jquery"],function($){var $scratchpad=$("<div>"),htmlBreaks=/<\/?p>|<br\/?>/g;return{stripHtmlTags:function(html){return html=html.replace(htmlBreaks,"$& "),$scratchpad.html(html).text()}}}),define("home/templates/truncatedPost",["handlebars","handlebars.partials"],function(Handlebars){return Handlebars.template(function(Handlebars,depth0,helpers,partials,data){function program1(depth0,data){var stack1,helper,buffer="";return buffer+='\n            <span class="label label-danger">',(helper=helpers.hiddenExplanation)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.hiddenExplanation,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"</span>\n        "}function program3(depth0,data){var stack1,helper,buffer="";return buffer+="\n            ",(helper=helpers.plaintext)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.plaintext,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"\n        "}function program5(){return'\n            <span class="icon-images"></span>\n        '}function program7(){return"hidden"}this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),partials=this.merge(partials,Handlebars.partials),data=data||{};var stack1,helper,buffer="",functionType="function",escapeExpression=this.escapeExpression,self=this;return stack1=self.invokePartial(partials.userAvatar,"userAvatar",depth0&&depth0.author,helpers,partials,data),(stack1||0===stack1)&&(buffer+=stack1),buffer+='\n<div class="comment-body">\n    <header class="comment-header">\n        ',stack1=self.invokePartial(partials.userName,"userName",depth0&&depth0.author,helpers,partials,data),(stack1||0===stack1)&&(buffer+=stack1),buffer+=' <a class="link-gray time" href="/home/',(helper=helpers.discussionRoute)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.discussionRoute,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"#comment-",(helper=helpers.id)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.id,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'">',(helper=helpers.relativeTime)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.relativeTime,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"</a>\n        ",stack1=helpers["if"].call(depth0,depth0&&depth0.isHidden,{hash:{},inverse:self.noop,fn:self.program(1,program1,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+='\n    </header>\n    <a href="/home/',(helper=helpers.discussionRoute)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.discussionRoute,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"#comment-",(helper=helpers.id)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.id,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'" class="card-comment-truncated truncate-line">\n        ',stack1=helpers["if"].call(depth0,depth0&&depth0.plaintext,{hash:{},inverse:self.program(5,program5,data),fn:self.program(3,program3,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+='\n    </a>\n\n    <footer class="comment-actions ',stack1=helpers["if"].call(depth0,depth0&&depth0.isHidden,{hash:{},inverse:self.noop,fn:self.program(7,program7,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+='" data-role="post-actions">\n    </footer>\n</div>\n'})}),define("home/views/TruncatedPostView",["underscore","home/utils/domUtils","home/views/PostView","home/templates/truncatedPost"],function(_,domUtils,PostView,truncatedPostTemplate){var TruncatedPostView=PostView.extend({template:truncatedPostTemplate,templateHelpers:function(){var _templateHelpers=PostView.prototype.templateHelpers;return _.isFunction(_templateHelpers)&&(_templateHelpers=_templateHelpers.call(this)),_.defaults({plaintext:domUtils.stripHtmlTags(this.model.get("message"))},_templateHelpers)}});return TruncatedPostView}),define("home/templates/replyActivity",["handlebars","handlebars.partials"],function(Handlebars){return Handlebars.template(function(Handlebars,depth0,helpers,partials,data){return this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{},'<div data-role="parent-post" class="parent"></div>\n<div data-role="child-post" class="child"></div>\n'})}),define("home/views/ReplyActivityView",["backbone-marionette","home/views/PostView","home/views/TruncatedPostView","home/templates/replyActivity"],function(Marionette,PostView,TruncatedPostView,replyActivityTemplate){var ReplyActivityView=Marionette.Layout.extend({className:"card-reply",template:replyActivityTemplate,regions:{parentPostRegion:"[data-role=parent-post]",childPostRegion:"[data-role=child-post]"},onDomRefresh:function(){this.parentPostRegion.show(new TruncatedPostView({model:this.model.target})),this.childPostRegion.show(new PostView({model:this.model.object}))}});return ReplyActivityView}),define("home/views/PostActivityCollectionView",["underscore","backbone-marionette","home/views/PostView","home/views/ReplyActivityView"],function(_,Marionette,PostView,ReplyActivityView){var PostActivityCollectionView=Marionette.CollectionView.extend({getItemView:function(activity){return"reply"===activity.get("verb")?ReplyActivityView:PostView},itemViewOptions:function(activity,index){var model=activity;"post"===activity.get("verb")&&(model=activity.object);var existingClassName=this.getItemView(activity).prototype.className;existingClassName=_.isFunction(existingClassName)?existingClassName.call({model:activity}):existingClassName||"";var className=existingClassName;return index>0&&(className+=" collapsible"),{model:model,className:className}}});return PostActivityCollectionView}),define("home/views/common/ActivityCardPostBaseView",["underscore","backbone","backbone-marionette","home/views/PostActivityCollectionView"],function(_,Backbone,Marionette,PostActivityCollectionView){var ActivityCardPostBaseView=Marionette.Layout.extend({regions:{postsRegion:"[data-role=posts]",footerRegion:"[data-role=footer]"},buildPostsView:function(){return new PostActivityCollectionView({collection:new Backbone.Collection(this.model.activities)})}});return ActivityCardPostBaseView}),define("home/templates/activityFooterPost",["handlebars","handlebars.partials"],function(Handlebars){return Handlebars.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),partials=this.merge(partials,Handlebars.partials),data=data||{};var stack1,buffer="",self=this;return buffer+='<ul class="actions">\n    ',stack1=self.invokePartial(partials.activityFooterDefaultActions,"activityFooterDefaultActions",depth0,helpers,partials,data),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n</ul>\n"})}),define("home/views/ActivityFooterPostView",["underscore","home/views/common/ActivityFooterView","home/templates/activityFooterPost"],function(_,ActivityFooterView,activityFooterPostTemplate){var ActivityFooterPostView=ActivityFooterView.extend({template:activityFooterPostTemplate,templateHelpers:function(){return _.defaults({hasMultiplePosts:this.model.activities.length>1},ActivityFooterView.prototype.templateHelpers.apply(this,arguments))}});return ActivityFooterPostView}),define("home/templates/activityCardPost",["handlebars","handlebars.partials"],function(Handlebars){return Handlebars.template(function(Handlebars,depth0,helpers,partials,data){function program1(depth0,data){var stack1,helper,options,buffer="";return buffer+="\n        ",helper=helpers.getPartial||depth0&&depth0.getPartial,options={hash:{},data:data},stack1=helper?helper.call(depth0,"userGroup",options):helperMissing.call(depth0,"getPartial","userGroup",options),buffer+=escapeExpression(helpers.gettext.call(depth0,"%(group)s commented %(numOccurance)s times",{hash:{group:stack1,numOccurance:depth0&&depth0.numOccurance},data:data}))+"\n    "}function program3(depth0,data){var stack1,helper,options,buffer="";return buffer+="\n        ",helper=helpers.getPartial||depth0&&depth0.getPartial,options={hash:{},data:data},stack1=helper?helper.call(depth0,"userGroup",options):helperMissing.call(depth0,"getPartial","userGroup",options),buffer+=escapeExpression(helpers.gettext.call(depth0,"%(group)s commented",{hash:{group:stack1},data:data}))+"\n    "}function program5(depth0,data){var buffer="";return buffer+='\n    <div class="expandable">\n        <div class="card-grouped-actions">\n            <a href="#" data-action="toggle-collapsed" class="expandable card-expand">\n                <div class="icon-more-vert"></div>\n                '+escapeExpression(helpers.gettext.call(depth0,"See More",{hash:{},data:data}))+"\n            </a>\n        </div>\n    </div>\n"}function program7(depth0,data){var stack1,helper,buffer="";return buffer+='\n<div class="collapsible">\n    <div class="card-grouped-actions">\n        <a class="collapsible btn btn-light btn-follow" href="/home/',(helper=helpers.discussionRoute)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.discussionRoute,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'">\n            '+escapeExpression(helpers.gettext.call(depth0,"See All Comments",{hash:{},data:data}))+"\n        </a>\n    </div>\n</div>\n"
}this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),partials=this.merge(partials,Handlebars.partials),data=data||{};var stack1,helper,buffer="",helperMissing=helpers.helperMissing,escapeExpression=this.escapeExpression,functionType="function",self=this;return buffer+='<div class="card-reason">\n    ',stack1=helpers["if"].call(depth0,depth0&&depth0.numOccurances,{hash:{},inverse:self.program(3,program3,data),fn:self.program(1,program1,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+='<span class="time">',(helper=helpers.relativeTime)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.relativeTime,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"</span>\n</div>\n",stack1=self.invokePartial(partials.cardTitle,"cardTitle",depth0,helpers,partials,data),(stack1||0===stack1)&&(buffer+=stack1),buffer+='\n<div data-role="posts"></div>\n',stack1=helpers["if"].call(depth0,depth0&&depth0.shouldCollapse,{hash:{},inverse:self.noop,fn:self.program(5,program5,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n",stack1=helpers["if"].call(depth0,depth0&&depth0.hasOverflowPosts,{hash:{},inverse:self.noop,fn:self.program(7,program7,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+='\n<footer class="card-footer" data-role="footer"></div>\n'})}),define("home/views/ActivityCardPostView",["home/mixins/withReasonOld","home/views/common/ActivityCardPostBaseView","home/views/ActivityFooterPostView","home/templates/activityCardPost"],function(withReason,ActivityCardPostBaseView,ActivityFooterPostView,activityCardPostTemplate){var ActivityCardPostView=ActivityCardPostBaseView.extend({template:activityCardPostTemplate,templateHelpers:function(){return{hasOverflowPosts:this.model.get("totalActivities")>this.model.activities.length,shouldCollapse:this.shouldCollapse(),discussionRoute:this.model.thread.getDiscussionRoute()}},onDomRefresh:function(){this.postsRegion.show(this.buildPostsView()),this.footerRegion.show(new ActivityFooterPostView({model:this.model}))},shouldCollapse:function(){return this.model.activities.length>1}});return withReason.call(ActivityCardPostView.prototype),ActivityCardPostView}),define("home/templates/activityFooterReply",["handlebars","handlebars.partials"],function(Handlebars){return Handlebars.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),partials=this.merge(partials,Handlebars.partials),data=data||{};var stack1,buffer="",self=this;return buffer+='<ul class="actions">\n    ',stack1=self.invokePartial(partials.activityFooterDefaultActions,"activityFooterDefaultActions",depth0,helpers,partials,data),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n</ul>\n"})}),define("home/views/ActivityFooterReplyView",["home/views/common/ActivityFooterView","home/templates/activityFooterReply"],function(ActivityFooterView,activityFooterReplyTemplate){var ActivityFooterReplyView=ActivityFooterView.extend({template:activityFooterReplyTemplate});return ActivityFooterReplyView}),define("home/templates/activityCardReply",["handlebars","handlebars.partials"],function(Handlebars){return Handlebars.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),partials=this.merge(partials,Handlebars.partials),data=data||{};var stack1,helper,buffer="",self=this,functionType="function",escapeExpression=this.escapeExpression;return buffer+='<div class="card-reason">\n    ',stack1=self.invokePartial(partials.userGroup,"userGroup",depth0,helpers,partials,data),(stack1||0===stack1)&&(buffer+=stack1),buffer+='<span class="icon-forward"></span>',stack1=self.invokePartial(partials.userPreview,"userPreview",(stack1=depth0&&depth0.target,null==stack1||stack1===!1?stack1:stack1.author),helpers,partials,data),(stack1||0===stack1)&&(buffer+=stack1),buffer+=' <span class="time">',(helper=helpers.relativeTime)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.relativeTime,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"</span>\n</div>\n",stack1=self.invokePartial(partials.cardTitle,"cardTitle",depth0,helpers,partials,data),(stack1||0===stack1)&&(buffer+=stack1),buffer+='\n<div class="card-reply" data-role="posts"></div>\n<footer class="card-footer" data-role="footer"></div>\n'})}),define("home/views/ActivityCardReplyView",["home/mixins/withReasonOld","home/views/common/ActivityCardPostBaseView","home/views/ActivityFooterReplyView","home/templates/activityCardReply"],function(withReason,ActivityCardPostBaseView,ActivityFooterReplyView,activityCardReplyTemplate){var ActivityCardReplyView=ActivityCardPostBaseView.extend({template:activityCardReplyTemplate,templateHelpers:function(){return{target:this.model.activities[0].target.toJSON()}},onDomRefresh:function(){this.postsRegion.show(this.buildPostsView()),this.footerRegion.show(new ActivityFooterReplyView({model:this.model}))}});return withReason.call(ActivityCardReplyView.prototype),ActivityCardReplyView}),define("home/templates/activityFooterTrending",["handlebars","handlebars.partials"],function(Handlebars){return Handlebars.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),partials=this.merge(partials,Handlebars.partials),data=data||{};var stack1,buffer="",self=this;return buffer+='<ul class="actions">\n    ',stack1=self.invokePartial(partials.activityFooterDefaultActions,"activityFooterDefaultActions",depth0,helpers,partials,data),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n</ul>\n"})}),define("home/views/ActivityFooterTrendingView",["home/views/common/ActivityFooterView","home/templates/activityFooterTrending"],function(ActivityFooterView,activityFooterTrendingTemplate){var ActivityFooterTrendingView=ActivityFooterView.extend({template:activityFooterTrendingTemplate});return ActivityFooterTrendingView}),define("home/templates/activityCardTrending",["handlebars","handlebars.partials"],function(Handlebars){return Handlebars.template(function(Handlebars,depth0,helpers,partials,data){function program1(depth0,data){var stack1,buffer="";return buffer+='\n        <a href="/home/forums/'+escapeExpression((stack1=depth0&&depth0.thread,stack1=null==stack1||stack1===!1?stack1:stack1.forum,stack1=null==stack1||stack1===!1?stack1:stack1.id,typeof stack1===functionType?stack1.apply(depth0):stack1))+'" class="community link-gray-darker">',stack1=self.invokePartial(partials.forumName,"forumName",(stack1=depth0&&depth0.target,null==stack1||stack1===!1?stack1:stack1.forum),helpers,partials,data),(stack1||0===stack1)&&(buffer+=stack1),buffer+="</a>\n    "}function program3(depth0,data){var stack1,buffer="";return buffer+="\n        ",stack1=self.invokePartial(partials.forumAvatar,"forumAvatar",(stack1=depth0&&depth0.target,null==stack1||stack1===!1?stack1:stack1.forum),helpers,partials,data),(stack1||0===stack1)&&(buffer+=stack1),buffer+=' <a href="/home/forums/'+escapeExpression((stack1=depth0&&depth0.thread,stack1=null==stack1||stack1===!1?stack1:stack1.forum,stack1=null==stack1||stack1===!1?stack1:stack1.id,typeof stack1===functionType?stack1.apply(depth0):stack1))+'" class="community link-gray-darker">',stack1=self.invokePartial(partials.forumName,"forumName",(stack1=depth0&&depth0.target,null==stack1||stack1===!1?stack1:stack1.forum),helpers,partials,data),(stack1||0===stack1)&&(buffer+=stack1),buffer+="</a>\n    "}this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),partials=this.merge(partials,Handlebars.partials),data=data||{};var stack1,helper,buffer="",functionType="function",escapeExpression=this.escapeExpression,self=this;return buffer+='<div class="card-reason">\n    ',stack1=helpers["if"].call(depth0,depth0&&depth0.hideForumFavicon,{hash:{},inverse:self.program(3,program3,data),fn:self.program(1,program1,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+='\n    <span class="time">'+escapeExpression(helpers.gettext.call(depth0,"Recent activity",{hash:{},data:data}))+" ",(helper=helpers.relativeTime)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.relativeTime,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"</span>\n</div>\n",stack1=self.invokePartial(partials.cardTitle,"cardTitle",depth0,helpers,partials,data),(stack1||0===stack1)&&(buffer+=stack1),buffer+='\n<div class="card-summary">\n    <div class="card-summary-content">\n        ',(helper=helpers.threadDescription)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.threadDescription,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),(stack1||0===stack1)&&(buffer+=stack1),buffer+='\n    </div>\n</div>\n<footer class="card-footer" data-role="footer"></div>\n'})}),define("home/views/ActivityCardTrendingView",["underscore","backbone-marionette","home/mixins/withReasonOld","home/views/ActivityFooterTrendingView","home/templates/activityCardTrending"],function(_,Marionette,withReason,ActivityFooterTrendingView,activityCardTrendingTemplate){var ActivityCardTrendingView=Marionette.Layout.extend({template:activityCardTrendingTemplate,templateHelpers:function(){var forumFavicon=this.model.thread.forum.get("favicon")&&this.model.thread.forum.get("favicon").cache,helpers={};return _.extend(helpers,{commenter:this.model.thread.getMostRecentCommenter(),target:this.model.activities[0].target.toJSON(),discussionRoute:this.model.thread.getDiscussionRoute(),threadDescription:this.model.thread.getDefaultDescription(),hideForumFavicon:!forumFavicon||/favicon-default/.test(forumFavicon)})},regions:{footerRegion:"[data-role=footer]"},initialize:function(){this.listenTo(this.model.thread,"change:content",this.render)},onDomRefresh:function(){this.footerRegion.show(new ActivityFooterTrendingView({model:this.model}))}});return withReason.call(ActivityCardTrendingView.prototype),ActivityCardTrendingView}),define("home/templates/activityFooterCreate",["handlebars","handlebars.partials"],function(Handlebars){return Handlebars.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),partials=this.merge(partials,Handlebars.partials),data=data||{};var stack1,buffer="",self=this;return buffer+='<ul class="actions">\n    ',stack1=self.invokePartial(partials.activityFooterDefaultActions,"activityFooterDefaultActions",depth0,helpers,partials,data),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n</ul>\n"})}),define("home/views/ActivityFooterCreateView",["home/views/common/ActivityFooterView","home/templates/activityFooterCreate"],function(ActivityFooterView,activityFooterCreateTemplate){var ActivityFooterCreateView=ActivityFooterView.extend({template:activityFooterCreateTemplate});return ActivityFooterCreateView}),define("home/views/FetchingView",["backbone-marionette"],function(Marionette){var FetchingView=Marionette.ItemView.extend({className:"spinner",template:function(){}});return FetchingView}),define("home/templates/loadError",["handlebars","handlebars.partials"],function(Handlebars){return Handlebars.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var buffer="",escapeExpression=this.escapeExpression;return buffer+='<div class="feed-wrapper">\n    '+escapeExpression(helpers.gettext.call(depth0,"Woops! Something went wrong.",{hash:{},data:data}))+' <a href="http://disqus.com/support">'+escapeExpression(helpers.gettext.call(depth0,"Get help",{hash:{},data:data}))+" &raquo;</a>\n</div>\n"})}),define("home/views/ErrorView",["backbone-marionette","home/templates/loadError"],function(Marionette,loadErrorTemplate){var ErrorView=Marionette.ItemView.extend({template:loadErrorTemplate});return ErrorView}),define("home/views/common/FetchableCollectionView",["underscore","backbone","backbone-marionette","home/views/FetchingView","home/views/ErrorView","home/utils/layoutUtils"],function(_,Backbone,Marionette,FetchingView,ErrorView,layoutUtils){var FetchableCollectionView=Marionette.CollectionView.extend({fetchingView:FetchingView,errorView:ErrorView,initialize:function(){this.listenable=this.model||this.collection,this.listenTo(this.listenable,"change:fetching",this.render),this.listenTo(this.collection,"add",this.closeNonItemViews),this.listenTo(this.collection,"reset",this.closeViews),this.bindViewClose()},onCollectionBeforeClose:function(){this._showingEmptyView=!0},onCollectionClosed:function(){this._showingEmptyView=!1},render:function(){var isEmpty=!this.collection.length,isFetching=this.isFetching(),isError=this.isError();isError?this.showErrorView():isEmpty?isFetching?this.showFetchingView():this._showingEmptyView||Marionette.CollectionView.prototype.render.apply(this,arguments):(!this.children.length||this.isShowingNonItemView())&&(this.closeViews(),Marionette.CollectionView.prototype.render.apply(this,arguments)),layoutUtils.scrollShownChanged()},buildItemView:function(item,ItemViewType,itemViewOptions){return this._showingEmptyView&&this.emptyViewOptions&&(itemViewOptions=Marionette.getOption(this,"emptyViewOptions"),_.isFunction(itemViewOptions)&&(itemViewOptions=itemViewOptions.call(this))),Marionette.CollectionView.prototype.buildItemView.call(this,item,ItemViewType,itemViewOptions)},isFetching:function(){return this.checkState("fetching")},isError:function(){return this.checkState("error")},checkState:function(state){return this.listenable.get?this.listenable.get(state):_.result(this.listenable,state)},bindViewClose:function(){var self=this,FetchingView=Marionette.getOption(this,"fetchingView"),ErrorView=Marionette.getOption(this,"errorView");_.each({_showingFetchingView:FetchingView,_showingErrorView:ErrorView},function(View,propertyName){if(View){var origOnClose=View.prototype.onClose;View.prototype.onClose=function(){self[propertyName]=!1,origOnClose&&origOnClose.apply(this,arguments)}}})},closeNonItemViews:function(){this.isShowingNonItemView()&&this.closeViews()},isShowingNonItemView:function(){return this._showingFetchingView||this._showingErrorView||this._showingEmptyView},closeViews:function(){this._showingEmptyView=!0,this.closeChildren(),this._showingEmptyView=!1,this._showingFetchingView=!1,this._showingErrorView=!1},showFetchingView:function(){var FetchingView=Marionette.getOption(this,"fetchingView");if(FetchingView&&!this._showingFetchingView){this.closeViews(),this._showingFetchingView=!0;var model=this.model||new Backbone.Model;this.addItemView(model,FetchingView,0)}},showErrorView:function(){var ErrorView=Marionette.getOption(this,"errorView");if(ErrorView&&!this._showingErrorView){this.closeViews(),this._showingErrorView=!0;var model=this.model||new Backbone.Model;this.addItemView(model,ErrorView,0)}}});return FetchableCollectionView}),define("home/views/PostCollectionView",["home/views/common/FetchableCollectionView","home/views/PostView"],function(FetchableCollectionView,PostView){return FetchableCollectionView.extend({itemView:PostView})}),define("home/templates/activityCardCreate",["handlebars","handlebars.partials"],function(Handlebars){return Handlebars.template(function(Handlebars,depth0,helpers,partials,data){function program1(depth0,data){var stack1,buffer="";return buffer+='\n    <div class="card-discussion-comments-title">Recent Comments</div>\n    <div class="card-discussion-comments" data-role="posts"></div>\n    ',stack1=helpers["if"].call(depth0,depth0&&depth0.shouldCollapse,{hash:{},inverse:self.noop,fn:self.program(2,program2,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n"}function program2(depth0,data){var buffer="";return buffer+='\n        <div class="expandable">\n            <div class="card-grouped-actions">\n                <a href="#" data-action="toggle-collapsed" class="expandable card-expand">\n                    <div class="icon-more-vert"></div>\n                    '+escapeExpression(helpers.gettext.call(depth0,"See More",{hash:{},data:data}))+"\n                </a>\n            </div>\n        </div>\n    "}function program4(depth0,data){var stack1,helper,buffer="";return buffer+='\n    <div class="card-summary">\n        <div class="card-summary-content">\n            ',(helper=helpers.threadDescription)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.threadDescription,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n        </div>\n    </div>\n"}this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),partials=this.merge(partials,Handlebars.partials),data=data||{};var stack1,helper,options,buffer="",escapeExpression=this.escapeExpression,self=this,functionType="function",helperMissing=helpers.helperMissing;return buffer+='<div class="card-reason">\n    ',helper=helpers.getPartial||depth0&&depth0.getPartial,options={hash:{},data:data},stack1=helper?helper.call(depth0,"userGroup",options):helperMissing.call(depth0,"getPartial","userGroup",options),buffer+=escapeExpression(helpers.gettext.call(depth0,"%(group)s started a discussion",{hash:{group:stack1},data:data}))+'\n    <span class="time">',(helper=helpers.relativeTime)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.relativeTime,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"</span>\n</div>\n",stack1=self.invokePartial(partials.cardTitle,"cardTitle",depth0,helpers,partials,data),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n\n",stack1=helpers["if"].call(depth0,depth0&&depth0.recentPostCount,{hash:{},inverse:self.program(4,program4,data),fn:self.program(1,program1,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+='\n\n<footer class="card-footer" data-role="footer"></div>\n'})}),define("home/views/ActivityCardCreateView",["underscore","backbone-marionette","home/mixins/withReasonOld","home/views/ActivityFooterCreateView","home/views/PostCollectionView","home/templates/activityCardCreate"],function(_,Marionette,withReason,ActivityFooterCreateView,PostCollectionView,activityCardCreateTemplate){var ActivityCardCreateView=Marionette.Layout.extend({template:activityCardCreateTemplate,templateHelpers:function(){var forumFavicon=this.model.thread.forum.get("favicon")&&this.model.thread.forum.get("favicon").cache;return{target:this.model.activities[0].target.toJSON(),discussionRoute:this.model.thread.getDiscussionRoute(),threadDescription:this.model.thread.getDefaultDescription(),recentPostCount:this.model.thread.recentPosts.length,shouldCollapse:this.shouldCollapse(),hideForumFavicon:!forumFavicon||/favicon-default/.test(forumFavicon)}},regions:{postsRegion:"[data-role=posts]",footerRegion:"[data-role=footer]"},initialize:function(){this.listenTo(this.model.thread,"change:content",this.render)},onDomRefresh:function(){this.postsRegion.show(new PostCollectionView({collection:this.model.thread.recentPosts,itemViewOptions:function(activity,index){var existingClassName=this.getItemView(activity).prototype.className;existingClassName=_.isFunction(existingClassName)?existingClassName.call({model:activity}):existingClassName||"";var className=existingClassName;return index>0&&(className+=" collapsible"),{className:className}}}));var self=this,footerView=new ActivityFooterCreateView({model:this.model});footerView.listenTo(footerView,"toggle:collapsed",function(){self.trigger("toggle:collapsed")}),this.footerRegion.show(footerView)},shouldCollapse:function(){return this.model.thread.recentPosts.length>1}});return withReason.call(ActivityCardCreateView.prototype),ActivityCardCreateView}),define("home/templates/activityCard",["handlebars","handlebars.partials"],function(Handlebars){return Handlebars.template(function(Handlebars,depth0,helpers,partials,data){function program1(depth0,data){var stack1,buffer="";return buffer+="\n        ",stack1=self.invokePartial(partials.threadImage,"threadImage",depth0,helpers,partials,data),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n    "}this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),partials=this.merge(partials,Handlebars.partials),data=data||{};var stack1,buffer="",self=this;return buffer+='<div class="card-discussion">\n    <div class="card-aside" data-role="thread-image">\n    ',stack1=helpers["if"].call(depth0,depth0&&depth0.canShowThreadImage,{hash:{},inverse:self.noop,fn:self.program(1,program1,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+='\n    </div>\n    <div class="card-body">\n        <div data-role="card-content"></div>\n    </div>\n</div>\n'})}),define("home/views/ActivityCardView",["underscore","jquery","backbone-marionette","handlebars","home/WrapperlessRegion","home/utils/mixpanelUtils","home/utils/layoutUtils","home/mixins/asCollapsibleCard","home/views/ActivityCardFavoriteView","home/views/ActivityCardPostView","home/views/ActivityCardReplyView","home/views/ActivityCardTrendingView","home/views/ActivityCardCreateView","home/templates/activityCard"],function(_,$,Marionette,Handlebars,WrapperlessRegion,MixpanelUtils,layoutUtils,asCollapsibleCard,ActivityCardFavoriteView,ActivityCardPostView,ActivityCardReplyView,ActivityCardTrendingView,ActivityCardCreateView,ActivityCardTemplate){var ActivityCardView=Marionette.Layout.extend({className:function(){return"card card-"+this.model.get("verb")},template:ActivityCardTemplate,templateHelpers:function(){return{canShowThreadImage:this.canShowThreadImage(),discussionRoute:this.model.thread.getDiscussionRoute(),image:this.model.thread.getImage()}},regions:{contentRegion:{selector:"[data-role=card-content]",regionType:WrapperlessRegion}},events:{"click [data-role=thread-link]":"trackOpenedThread"},initialize:function(){this.canShowThreadImage()&&this.listenTo(this.model.thread,"change:content",this.renderThreadImage)},getContentView:function(){var CardViewClass;switch(this.model.get("verb")){case"favorite":CardViewClass=ActivityCardFavoriteView;break;case"post":CardViewClass=ActivityCardPostView;break;case"reply":CardViewClass=ActivityCardReplyView;break;case"trending":CardViewClass=ActivityCardTrendingView;break;case"create":CardViewClass=ActivityCardCreateView}return new CardViewClass({model:this.model})},canShowThreadImage:function(){return layoutUtils.getScreenWidth()>480},renderThreadImage:function(){if(this.canShowThreadImage()){var data=this.serializeData();data=this.mixinTemplateHelpers(data),this.$("[data-role=thread-image]").html(Handlebars.partials.threadImage(data))}},onDomRefresh:function(){this.contentRegion.currentView&&this.stopListening(this.contentRegion.currentView);var contentView=this.getContentView();this.contentRegion.show(contentView),contentView.shouldCollapse&&contentView.shouldCollapse()&&this.$el.addClass("card-collapsed")},trackOpenedThread:function(e){MixpanelUtils.track("click external article",e)}});return asCollapsibleCard.call(ActivityCardView.prototype),ActivityCardView}),define("home/templates/feedEmpty",["handlebars","handlebars.partials"],function(Handlebars){return Handlebars.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var buffer="",escapeExpression=this.escapeExpression;return buffer+=escapeExpression(helpers.gettext.call(depth0,"Woops, nothing is happening here.",{hash:{},data:data}))+"\n"})}),define("home/views/FeedEmptyView",["backbone-marionette","home/templates/feedEmpty"],function(Marionette,feedEmptyTemplate){var FeedEmptyView=Marionette.ItemView.extend({template:feedEmptyTemplate});return FeedEmptyView}),define("home/mixins/withViewFeedTracking",["underscore","core/bus"],function(_,bus){var withViewFeedTracking=function(){var _initialize=this.initialize;this.initialize=function(){_initialize.apply(this,arguments),this.listenTo(this,"after:item:added",this.trackView)},this.trackView=function(){this._showingFetchingView||(bus.trigger("viewFeed",this),this.stopListening(this,"after:item:added",this.trackView),_.defer(_.bind(function(){this.listenTo(this.collection,"sync",this.trackViewMore)},this)))},this.trackViewMore=function(){bus.trigger("viewMoreFeed",this.getNumPages())},this.getNumPages=function(){return this.model.get("numPages")}};return withViewFeedTracking}),define("home/views/ActivityCardCollectionView",["underscore","home/utils/layoutUtils","home/utils/mixpanelUtils","home/views/ActivityCardView","home/views/common/FetchableCollectionView","home/views/FeedEmptyView","home/mixins/withViewFeedTracking"],function(_,LayoutUtils,MixpanelUtils,ActivityCardView,FetchableCollectionView,FeedEmptyView,withViewFeedTracking){var ActivityCardCollectionView=FetchableCollectionView.extend({className:"cards",emptyView:FeedEmptyView,itemView:ActivityCardView,onAfterItemAdded:LayoutUtils.scrollShownChanged,onShow:function(){var self=this;_.defer(function(){MixpanelUtils.track("view feed",{target:self.$el})})}});return withViewFeedTracking.call(ActivityCardCollectionView.prototype),ActivityCardCollectionView}),define("home/collections/RecommendedForumCollection",["backbone","home/models/common/UniqueModel","home/models/Forum","core/api"],function(Backbone,UniqueModel,Forum,api){return Backbone.Collection.extend({url:api.getURL("users/recommendedForumsToFollow"),model:UniqueModel.boundModel(Forum),parse:function(resp){return resp.response}})}),define("home/templates/suggestions",["handlebars","handlebars.partials"],function(Handlebars){return Handlebars.template(function(Handlebars,depth0,helpers,partials,data){return this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{},'<div class="carousel" data-role="carousel">\n    <div data-role="cards-container">\n    </div>\n</div>\n'})}),function(factory){"function"==typeof define&&define.amd?define("slick",["jquery"],factory):"undefined"!=typeof exports?module.exports=factory(require("jquery")):factory(jQuery)}(function($){var Slick=window.Slick||{};Slick=function(){function Slick(element,settings){var responsiveSettings,breakpoint,_=this;if(_.defaults={accessibility:!0,adaptiveHeight:!1,appendArrows:$(element),appendDots:$(element),arrows:!0,asNavFor:null,prevArrow:'<button type="button" data-role="none" class="slick-prev">Previous</button>',nextArrow:'<button type="button" data-role="none" class="slick-next">Next</button>',autoplay:!1,autoplaySpeed:3e3,centerMode:!1,centerPadding:"50px",cssEase:"ease",customPaging:function(slider,i){return'<button type="button" data-role="none">'+(i+1)+"</button>"},dots:!1,dotsClass:"slick-dots",draggable:!0,easing:"linear",fade:!1,focusOnSelect:!1,infinite:!0,lazyLoad:"ondemand",onBeforeChange:null,onAfterChange:null,onInit:null,onReInit:null,pauseOnHover:!0,pauseOnDotsHover:!1,responsive:null,rtl:!1,slide:"div",slidesToShow:1,slidesToScroll:1,speed:300,swipe:!0,swipeToSlide:!1,touchMove:!0,touchThreshold:5,useCSS:!0,variableWidth:!1,vertical:!1,waitForAnimate:!0},_.initials={animating:!1,dragging:!1,autoPlayTimer:null,currentSlide:0,currentLeft:null,direction:1,$dots:null,listWidth:null,listHeight:null,loadIndex:0,$nextArrow:null,$prevArrow:null,slideCount:null,slideWidth:null,$slideTrack:null,$slides:null,sliding:!1,slideOffset:0,swipeLeft:null,$list:null,touchObject:{},transformsEnabled:!1},$.extend(_,_.initials),_.activeBreakpoint=null,_.animType=null,_.animProp=null,_.breakpoints=[],_.breakpointSettings=[],_.cssTransitions=!1,_.paused=!1,_.positionProp=null,_.$slider=$(element),_.$slidesCache=null,_.transformType=null,_.transitionType=null,_.windowWidth=0,_.windowTimer=null,_.options=$.extend({},_.defaults,settings),_.originalSettings=_.options,responsiveSettings=_.options.responsive||null,responsiveSettings&&responsiveSettings.length>-1){for(breakpoint in responsiveSettings)responsiveSettings.hasOwnProperty(breakpoint)&&(_.breakpoints.push(responsiveSettings[breakpoint].breakpoint),_.breakpointSettings[responsiveSettings[breakpoint].breakpoint]=responsiveSettings[breakpoint].settings);_.breakpoints.sort(function(a,b){return b-a})}_.autoPlay=$.proxy(_.autoPlay,_),_.autoPlayClear=$.proxy(_.autoPlayClear,_),_.changeSlide=$.proxy(_.changeSlide,_),_.selectHandler=$.proxy(_.selectHandler,_),_.setPosition=$.proxy(_.setPosition,_),_.swipeHandler=$.proxy(_.swipeHandler,_),_.dragHandler=$.proxy(_.dragHandler,_),_.keyHandler=$.proxy(_.keyHandler,_),_.autoPlayIterator=$.proxy(_.autoPlayIterator,_),_.instanceUid=instanceUid++,_.htmlExpr=/^(?:\s*(<[\w\W]+>)[^>]*)$/,_.init()}var instanceUid=0;return Slick}(),Slick.prototype.addSlide=function(markup,index,addBefore){var _=this;if("boolean"==typeof index)addBefore=index,index=null;else if(0>index||index>=_.slideCount)return!1;_.unload(),"number"==typeof index?0===index&&0===_.$slides.length?$(markup).appendTo(_.$slideTrack):addBefore?$(markup).insertBefore(_.$slides.eq(index)):$(markup).insertAfter(_.$slides.eq(index)):addBefore===!0?$(markup).prependTo(_.$slideTrack):$(markup).appendTo(_.$slideTrack),_.$slides=_.$slideTrack.children(this.options.slide),_.$slideTrack.children(this.options.slide).detach(),_.$slideTrack.append(_.$slides),_.$slides.each(function(index,element){$(element).attr("index",index)}),_.$slidesCache=_.$slides,_.reinit()},Slick.prototype.animateSlide=function(targetLeft,callback){var animProps={},_=this;if(1===_.options.slidesToShow&&_.options.adaptiveHeight===!0&&_.options.vertical===!1){var targetHeight=_.$slides.eq(_.currentSlide).outerHeight(!0);_.$list.animate({height:targetHeight},_.options.speed)}_.options.rtl===!0&&_.options.vertical===!1&&(targetLeft=-targetLeft),_.transformsEnabled===!1?_.options.vertical===!1?_.$slideTrack.animate({left:targetLeft},_.options.speed,_.options.easing,callback):_.$slideTrack.animate({top:targetLeft},_.options.speed,_.options.easing,callback):_.cssTransitions===!1?$({animStart:_.currentLeft}).animate({animStart:targetLeft},{duration:_.options.speed,easing:_.options.easing,step:function(now){_.options.vertical===!1?(animProps[_.animType]="translate("+now+"px, 0px)",_.$slideTrack.css(animProps)):(animProps[_.animType]="translate(0px,"+now+"px)",_.$slideTrack.css(animProps))},complete:function(){callback&&callback.call()}}):(_.applyTransition(),animProps[_.animType]=_.options.vertical===!1?"translate3d("+targetLeft+"px, 0px, 0px)":"translate3d(0px,"+targetLeft+"px, 0px)",_.$slideTrack.css(animProps),callback&&setTimeout(function(){_.disableTransition(),callback.call()},_.options.speed))},Slick.prototype.asNavFor=function(index){var _=this,asNavFor=null!=_.options.asNavFor?$(_.options.asNavFor).getSlick():null;null!=asNavFor&&asNavFor.slideHandler(index,!0)},Slick.prototype.applyTransition=function(slide){var _=this,transition={};transition[_.transitionType]=_.options.fade===!1?_.transformType+" "+_.options.speed+"ms "+_.options.cssEase:"opacity "+_.options.speed+"ms "+_.options.cssEase,_.options.fade===!1?_.$slideTrack.css(transition):_.$slides.eq(slide).css(transition)},Slick.prototype.autoPlay=function(){var _=this;_.autoPlayTimer&&clearInterval(_.autoPlayTimer),_.slideCount>_.options.slidesToShow&&_.paused!==!0&&(_.autoPlayTimer=setInterval(_.autoPlayIterator,_.options.autoplaySpeed))},Slick.prototype.autoPlayClear=function(){var _=this;_.autoPlayTimer&&clearInterval(_.autoPlayTimer)},Slick.prototype.autoPlayIterator=function(){var _=this;_.options.infinite===!1?1===_.direction?(_.currentSlide+1===_.slideCount-1&&(_.direction=0),_.slideHandler(_.currentSlide+_.options.slidesToScroll)):(_.currentSlide-1===0&&(_.direction=1),_.slideHandler(_.currentSlide-_.options.slidesToScroll)):_.slideHandler(_.currentSlide+_.options.slidesToScroll)
},Slick.prototype.buildArrows=function(){var _=this;_.options.arrows===!0&&_.slideCount>_.options.slidesToShow&&(_.$prevArrow=$(_.options.prevArrow),_.$nextArrow=$(_.options.nextArrow),_.htmlExpr.test(_.options.prevArrow)&&_.$prevArrow.appendTo(_.options.appendArrows),_.htmlExpr.test(_.options.nextArrow)&&_.$nextArrow.appendTo(_.options.appendArrows),_.options.infinite!==!0&&_.$prevArrow.addClass("slick-disabled"))},Slick.prototype.buildDots=function(){var i,dotString,_=this;if(_.options.dots===!0&&_.slideCount>_.options.slidesToShow){for(dotString='<ul class="'+_.options.dotsClass+'">',i=0;i<=_.getDotCount();i+=1)dotString+="<li>"+_.options.customPaging.call(this,_,i)+"</li>";dotString+="</ul>",_.$dots=$(dotString).appendTo(_.options.appendDots),_.$dots.find("li").first().addClass("slick-active")}},Slick.prototype.buildOut=function(){var _=this;_.$slides=_.$slider.children(_.options.slide+":not(.slick-cloned)").addClass("slick-slide"),_.slideCount=_.$slides.length,_.$slides.each(function(index,element){$(element).attr("index",index)}),_.$slidesCache=_.$slides,_.$slider.addClass("slick-slider"),_.$slideTrack=0===_.slideCount?$('<div class="slick-track"/>').appendTo(_.$slider):_.$slides.wrapAll('<div class="slick-track"/>').parent(),_.$list=_.$slideTrack.wrap('<div class="slick-list"/>').parent(),_.$slideTrack.css("opacity",0),_.options.centerMode===!0&&(_.options.slidesToScroll=1,_.options.slidesToShow%2===0&&(_.options.slidesToShow=3)),$("img[data-lazy]",_.$slider).not("[src]").addClass("slick-loading"),_.setupInfinite(),_.buildArrows(),_.buildDots(),_.updateDots(),_.options.accessibility===!0&&_.$list.prop("tabIndex",0),_.setSlideClasses("number"==typeof this.currentSlide?this.currentSlide:0),_.options.draggable===!0&&_.$list.addClass("draggable")},Slick.prototype.checkResponsive=function(){var breakpoint,targetBreakpoint,_=this;if(_.originalSettings.responsive&&_.originalSettings.responsive.length>-1&&null!==_.originalSettings.responsive){targetBreakpoint=null;for(breakpoint in _.breakpoints)_.breakpoints.hasOwnProperty(breakpoint)&&$(window).width()<_.breakpoints[breakpoint]&&(targetBreakpoint=_.breakpoints[breakpoint]);null!==targetBreakpoint?null!==_.activeBreakpoint?targetBreakpoint!==_.activeBreakpoint&&(_.activeBreakpoint=targetBreakpoint,_.options=$.extend({},_.options,_.breakpointSettings[targetBreakpoint]),_.refresh()):(_.activeBreakpoint=targetBreakpoint,_.options=$.extend({},_.options,_.breakpointSettings[targetBreakpoint]),_.refresh()):null!==_.activeBreakpoint&&(_.activeBreakpoint=null,_.options=$.extend({},_.options,_.originalSettings),_.refresh())}},Slick.prototype.changeSlide=function(event){var indexOffset,slideOffset,unevenOffset,_=this,$target=$(event.target);switch($target.is("a")&&event.preventDefault(),unevenOffset=_.slideCount%_.options.slidesToScroll!==0,indexOffset=unevenOffset?0:(_.slideCount-_.currentSlide)%_.options.slidesToScroll,event.data.message){case"previous":slideOffset=0===indexOffset?_.options.slidesToScroll:_.options.slidesToShow-indexOffset,_.slideCount>_.options.slidesToShow&&_.slideHandler(_.currentSlide-slideOffset);break;case"next":slideOffset=0===indexOffset?_.options.slidesToScroll:indexOffset,_.slideCount>_.options.slidesToShow&&_.slideHandler(_.currentSlide+slideOffset);break;case"index":var index=0===event.data.index?0:event.data.index||$(event.target).parent().index()*_.options.slidesToScroll;_.slideHandler(index);default:return!1}},Slick.prototype.destroy=function(){var _=this;_.autoPlayClear(),_.touchObject={},$(".slick-cloned",_.$slider).remove(),_.$dots&&_.$dots.remove(),_.$prevArrow&&(_.$prevArrow.remove(),_.$nextArrow.remove()),_.$slides.parent().hasClass("slick-track")&&_.$slides.unwrap().unwrap(),_.$slides.removeClass("slick-slide slick-active slick-visible").css("width",""),_.$slider.removeClass("slick-slider"),_.$slider.removeClass("slick-initialized"),_.$list.off(".slick"),$(window).off(".slick-"+_.instanceUid),$(document).off(".slick-"+_.instanceUid)},Slick.prototype.disableTransition=function(slide){var _=this,transition={};transition[_.transitionType]="",_.options.fade===!1?_.$slideTrack.css(transition):_.$slides.eq(slide).css(transition)},Slick.prototype.fadeSlide=function(oldSlide,slideIndex,callback){var _=this;_.cssTransitions===!1?(_.$slides.eq(slideIndex).css({zIndex:1e3}),_.$slides.eq(slideIndex).animate({opacity:1},_.options.speed,_.options.easing,callback),_.$slides.eq(oldSlide).animate({opacity:0},_.options.speed,_.options.easing)):(_.applyTransition(slideIndex),_.applyTransition(oldSlide),_.$slides.eq(slideIndex).css({opacity:1,zIndex:1e3}),_.$slides.eq(oldSlide).css({opacity:0}),callback&&setTimeout(function(){_.disableTransition(slideIndex),_.disableTransition(oldSlide),callback.call()},_.options.speed))},Slick.prototype.filterSlides=function(filter){var _=this;null!==filter&&(_.unload(),_.$slideTrack.children(this.options.slide).detach(),_.$slidesCache.filter(filter).appendTo(_.$slideTrack),_.reinit())},Slick.prototype.getCurrent=function(){var _=this;return _.currentSlide},Slick.prototype.getDotCount=function(){var dotLimit,_=this,breaker=0,dotCounter=0,dotCount=0;for(dotLimit=_.options.infinite===!0?_.slideCount+_.options.slidesToShow-_.options.slidesToScroll:_.slideCount;dotLimit>breaker;)dotCount++,dotCounter+=_.options.slidesToScroll,breaker=dotCounter+_.options.slidesToShow;return dotCount},Slick.prototype.getLeft=function(slideIndex){var targetLeft,verticalHeight,targetSlide,_=this,verticalOffset=0;return _.slideOffset=0,verticalHeight=_.$slides.first().outerHeight(),_.options.infinite===!0?(_.slideCount>_.options.slidesToShow&&(_.slideOffset=_.slideWidth*_.options.slidesToShow*-1,verticalOffset=verticalHeight*_.options.slidesToShow*-1),_.slideCount%_.options.slidesToScroll!==0&&slideIndex+_.options.slidesToScroll>_.slideCount&&_.slideCount>_.options.slidesToShow&&(_.slideOffset=_.slideCount%_.options.slidesToShow*_.slideWidth*-1,verticalOffset=_.slideCount%_.options.slidesToShow*verticalHeight*-1)):_.slideCount%_.options.slidesToShow!==0&&slideIndex+_.options.slidesToScroll>_.slideCount&&_.slideCount>_.options.slidesToShow&&(_.slideOffset=_.options.slidesToShow*_.slideWidth-_.slideCount%_.options.slidesToShow*_.slideWidth,verticalOffset=_.slideCount%_.options.slidesToShow*verticalHeight),_.slideCount<=_.options.slidesToShow&&(_.slideOffset=0,verticalOffset=0),_.options.centerMode===!0&&_.options.infinite===!0?_.slideOffset+=_.slideWidth*Math.floor(_.options.slidesToShow/2)-_.slideWidth:_.options.centerMode===!0&&(_.slideOffset+=_.slideWidth*Math.floor(_.options.slidesToShow/2)),targetLeft=_.options.vertical===!1?slideIndex*_.slideWidth*-1+_.slideOffset:slideIndex*verticalHeight*-1+verticalOffset,_.options.variableWidth===!0&&(targetSlide=_.$slideTrack.children(".slick-slide").eq(_.slideCount<=_.options.slidesToShow||_.options.infinite===!1?slideIndex:slideIndex+_.options.slidesToShow),targetLeft=targetSlide[0]?-1*targetSlide[0].offsetLeft:0,_.options.centerMode===!0&&(targetSlide=_.$slideTrack.children(".slick-slide").eq(_.options.infinite===!1?slideIndex:slideIndex+_.options.slidesToShow+1),targetLeft=targetSlide[0]?-1*targetSlide[0].offsetLeft:0,targetLeft+=(_.$list.width()-targetSlide.outerWidth())/2)),targetLeft},Slick.prototype.init=function(){var _=this;$(_.$slider).hasClass("slick-initialized")||($(_.$slider).addClass("slick-initialized"),_.buildOut(),_.setProps(),_.startLoad(),_.loadSlider(),_.initializeEvents(),_.checkResponsive()),null!==_.options.onInit&&_.options.onInit.call(this,_)},Slick.prototype.initArrowEvents=function(){var _=this;_.options.arrows===!0&&_.slideCount>_.options.slidesToShow&&(_.$prevArrow.on("click.slick",{message:"previous"},_.changeSlide),_.$nextArrow.on("click.slick",{message:"next"},_.changeSlide))},Slick.prototype.initDotEvents=function(){var _=this;_.options.dots===!0&&_.slideCount>_.options.slidesToShow&&$("li",_.$dots).on("click.slick",{message:"index"},_.changeSlide),_.options.dots===!0&&_.options.pauseOnDotsHover===!0&&_.options.autoplay===!0&&$("li",_.$dots).on("mouseenter.slick",_.autoPlayClear).on("mouseleave.slick",_.autoPlay)},Slick.prototype.initializeEvents=function(){var _=this;_.initArrowEvents(),_.initDotEvents(),_.$list.on("touchstart.slick mousedown.slick",{action:"start"},_.swipeHandler),_.$list.on("touchmove.slick mousemove.slick",{action:"move"},_.swipeHandler),_.$list.on("touchend.slick mouseup.slick",{action:"end"},_.swipeHandler),_.$list.on("touchcancel.slick mouseleave.slick",{action:"end"},_.swipeHandler),_.options.pauseOnHover===!0&&_.options.autoplay===!0&&(_.$list.on("mouseenter.slick",_.autoPlayClear),_.$list.on("mouseleave.slick",_.autoPlay)),_.options.accessibility===!0&&_.$list.on("keydown.slick",_.keyHandler),_.options.focusOnSelect===!0&&$(_.options.slide,_.$slideTrack).on("click.slick",_.selectHandler),$(window).on("orientationchange.slick.slick-"+_.instanceUid,function(){_.checkResponsive(),_.setPosition()}),$(window).on("resize.slick.slick-"+_.instanceUid,function(){$(window).width()!==_.windowWidth&&(clearTimeout(_.windowDelay),_.windowDelay=window.setTimeout(function(){_.windowWidth=$(window).width(),_.checkResponsive(),_.setPosition()},50))}),$(window).on("load.slick.slick-"+_.instanceUid,_.setPosition),$(document).on("ready.slick.slick-"+_.instanceUid,_.setPosition)},Slick.prototype.initUI=function(){var _=this;_.options.arrows===!0&&_.slideCount>_.options.slidesToShow&&(_.$prevArrow.show(),_.$nextArrow.show()),_.options.dots===!0&&_.slideCount>_.options.slidesToShow&&_.$dots.show(),_.options.autoplay===!0&&_.autoPlay()},Slick.prototype.keyHandler=function(event){var _=this;37===event.keyCode?_.changeSlide({data:{message:"previous"}}):39===event.keyCode&&_.changeSlide({data:{message:"next"}})},Slick.prototype.lazyLoad=function(){function loadImages(imagesScope){$("img[data-lazy]",imagesScope).each(function(){var image=$(this),imageSource=$(this).attr("data-lazy");image.load(function(){image.animate({opacity:1},200)}).css({opacity:0}).attr("src",imageSource).removeAttr("data-lazy").removeClass("slick-loading")})}var loadRange,cloneRange,rangeStart,rangeEnd,_=this;_.options.centerMode===!0?_.options.infinite===!0?(rangeStart=_.currentSlide+(_.options.slidesToShow/2+1),rangeEnd=rangeStart+_.options.slidesToShow+2):(rangeStart=Math.max(0,_.currentSlide-(_.options.slidesToShow/2+1)),rangeEnd=2+(_.options.slidesToShow/2+1)+_.currentSlide):(rangeStart=_.options.infinite?_.options.slidesToShow+_.currentSlide:_.currentSlide,rangeEnd=rangeStart+_.options.slidesToShow,_.options.fade===!0&&(rangeStart>0&&rangeStart--,rangeEnd<=_.slideCount&&rangeEnd++)),loadRange=_.$slider.find(".slick-slide").slice(rangeStart,rangeEnd),loadImages(loadRange),_.slideCount<=_.options.slidesToShow?(cloneRange=_.$slider.find(".slick-slide"),loadImages(cloneRange)):_.currentSlide>=_.slideCount-_.options.slidesToShow?(cloneRange=_.$slider.find(".slick-cloned").slice(0,_.options.slidesToShow),loadImages(cloneRange)):0===_.currentSlide&&(cloneRange=_.$slider.find(".slick-cloned").slice(-1*_.options.slidesToShow),loadImages(cloneRange))},Slick.prototype.loadSlider=function(){var _=this;_.setPosition(),_.$slideTrack.css({opacity:1}),_.$slider.removeClass("slick-loading"),_.initUI(),"progressive"===_.options.lazyLoad&&_.progressiveLazyLoad()},Slick.prototype.postSlide=function(index){var _=this;null!==_.options.onAfterChange&&_.options.onAfterChange.call(this,_,index),_.animating=!1,_.setPosition(),_.swipeLeft=null,_.options.autoplay===!0&&_.paused===!1&&_.autoPlay()},Slick.prototype.progressiveLazyLoad=function(){var imgCount,targetImage,_=this;imgCount=$("img[data-lazy]").length,imgCount>0&&(targetImage=$("img[data-lazy]",_.$slider).first(),targetImage.attr("src",targetImage.attr("data-lazy")).removeClass("slick-loading").load(function(){targetImage.removeAttr("data-lazy"),_.progressiveLazyLoad()}).error(function(){targetImage.removeAttr("data-lazy"),_.progressiveLazyLoad()}))},Slick.prototype.refresh=function(){var _=this,currentSlide=_.currentSlide;_.destroy(),$.extend(_,_.initials),_.currentSlide=currentSlide,_.init()},Slick.prototype.reinit=function(){var _=this;_.$slides=_.$slideTrack.children(_.options.slide).addClass("slick-slide"),_.slideCount=_.$slides.length,_.currentSlide>=_.slideCount&&0!==_.currentSlide&&(_.currentSlide=_.currentSlide-_.options.slidesToScroll),_.slideCount<=_.options.slidesToShow&&(_.currentSlide=0),_.setProps(),_.setupInfinite(),_.buildArrows(),_.updateArrows(),_.initArrowEvents(),_.buildDots(),_.updateDots(),_.initDotEvents(),_.options.focusOnSelect===!0&&$(_.options.slide,_.$slideTrack).on("click.slick",_.selectHandler),_.setSlideClasses(0),_.setPosition(),null!==_.options.onReInit&&_.options.onReInit.call(this,_)},Slick.prototype.removeSlide=function(index,removeBefore){var _=this;return"boolean"==typeof index?(removeBefore=index,index=removeBefore===!0?0:_.slideCount-1):index=removeBefore===!0?--index:index,_.slideCount<1||0>index||index>_.slideCount-1?!1:(_.unload(),_.$slideTrack.children(this.options.slide).eq(index).remove(),_.$slides=_.$slideTrack.children(this.options.slide),_.$slideTrack.children(this.options.slide).detach(),_.$slideTrack.append(_.$slides),_.$slidesCache=_.$slides,void _.reinit())},Slick.prototype.setCSS=function(position){var x,y,_=this,positionProps={};_.options.rtl===!0&&(position=-position),x="left"==_.positionProp?position+"px":"0px",y="top"==_.positionProp?position+"px":"0px",positionProps[_.positionProp]=position,_.transformsEnabled===!1?_.$slideTrack.css(positionProps):(positionProps={},_.cssTransitions===!1?(positionProps[_.animType]="translate("+x+", "+y+")",_.$slideTrack.css(positionProps)):(positionProps[_.animType]="translate3d("+x+", "+y+", 0px)",_.$slideTrack.css(positionProps)))},Slick.prototype.setDimensions=function(){var _=this;_.options.vertical===!1?_.options.centerMode===!0&&_.$list.css({padding:"0px "+_.options.centerPadding}):(_.$list.height(_.$slides.first().outerHeight(!0)*_.options.slidesToShow),_.options.centerMode===!0&&_.$list.css({padding:_.options.centerPadding+" 0px"})),_.listWidth=_.$list.width(),_.listHeight=_.$list.height(),_.options.vertical===!1&&_.options.variableWidth===!1?(_.slideWidth=Math.ceil(_.listWidth/_.options.slidesToShow),_.$slideTrack.width(Math.ceil(_.slideWidth*_.$slideTrack.children(".slick-slide").length))):_.options.variableWidth===!0?(_.slideWidth=0,_.$slideTrack.children(".slick-slide").each(function(){_.slideWidth+=Math.ceil($(this).outerWidth(!0))}),_.$slideTrack.width(Math.ceil(_.slideWidth)+1)):(_.slideWidth=Math.ceil(_.listWidth),_.$slideTrack.height(Math.ceil(_.$slides.first().outerHeight(!0)*_.$slideTrack.children(".slick-slide").length)));var offset=_.$slides.first().outerWidth(!0)-_.$slides.first().width();_.options.variableWidth===!1&&_.$slideTrack.children(".slick-slide").width(_.slideWidth-offset)},Slick.prototype.setFade=function(){var targetLeft,_=this;_.$slides.each(function(index,element){targetLeft=_.slideWidth*index*-1,$(element).css({position:"relative",left:targetLeft,top:0,zIndex:800,opacity:0})}),_.$slides.eq(_.currentSlide).css({zIndex:900,opacity:1})},Slick.prototype.setHeight=function(){var _=this;if(1===_.options.slidesToShow&&_.options.adaptiveHeight===!0&&_.options.vertical===!1){var targetHeight=_.$slides.eq(_.currentSlide).outerHeight(!0);_.$list.css("height",targetHeight)}},Slick.prototype.setPosition=function(){var _=this;_.setDimensions(),_.setHeight(),_.options.fade===!1?_.setCSS(_.getLeft(_.currentSlide)):_.setFade()},Slick.prototype.setProps=function(){var _=this,bodyStyle=document.body.style;_.positionProp=_.options.vertical===!0?"top":"left","top"===_.positionProp?_.$slider.addClass("slick-vertical"):_.$slider.removeClass("slick-vertical"),(void 0!==bodyStyle.WebkitTransition||void 0!==bodyStyle.MozTransition||void 0!==bodyStyle.msTransition)&&_.options.useCSS===!0&&(_.cssTransitions=!0),void 0!==bodyStyle.OTransform&&(_.animType="OTransform",_.transformType="-o-transform",_.transitionType="OTransition",void 0===bodyStyle.perspectiveProperty&&void 0===bodyStyle.webkitPerspective&&(_.animType=!1)),void 0!==bodyStyle.MozTransform&&(_.animType="MozTransform",_.transformType="-moz-transform",_.transitionType="MozTransition",void 0===bodyStyle.perspectiveProperty&&void 0===bodyStyle.MozPerspective&&(_.animType=!1)),void 0!==bodyStyle.webkitTransform&&(_.animType="webkitTransform",_.transformType="-webkit-transform",_.transitionType="webkitTransition",void 0===bodyStyle.perspectiveProperty&&void 0===bodyStyle.webkitPerspective&&(_.animType=!1)),void 0!==bodyStyle.msTransform&&(_.animType="msTransform",_.transformType="-ms-transform",_.transitionType="msTransition",void 0===bodyStyle.msTransform&&(_.animType=!1)),void 0!==bodyStyle.transform&&_.animType!==!1&&(_.animType="transform",_.transformType="transform",_.transitionType="transition"),_.transformsEnabled=null!==_.animType&&_.animType!==!1},Slick.prototype.setSlideClasses=function(index){var centerOffset,allSlides,indexOffset,remainder,_=this;_.$slider.find(".slick-slide").removeClass("slick-active").removeClass("slick-center"),allSlides=_.$slider.find(".slick-slide"),_.options.centerMode===!0?(centerOffset=Math.floor(_.options.slidesToShow/2),_.options.infinite===!0&&(index>=centerOffset&&index<=_.slideCount-1-centerOffset?_.$slides.slice(index-centerOffset,index+centerOffset+1).addClass("slick-active"):(indexOffset=_.options.slidesToShow+index,allSlides.slice(indexOffset-centerOffset+1,indexOffset+centerOffset+2).addClass("slick-active")),0===index?allSlides.eq(allSlides.length-1-_.options.slidesToShow).addClass("slick-center"):index===_.slideCount-1&&allSlides.eq(_.options.slidesToShow).addClass("slick-center")),_.$slides.eq(index).addClass("slick-center")):index>=0&&index<=_.slideCount-_.options.slidesToShow?_.$slides.slice(index,index+_.options.slidesToShow).addClass("slick-active"):allSlides.length<=_.options.slidesToShow?allSlides.addClass("slick-active"):(remainder=_.slideCount%_.options.slidesToShow,indexOffset=_.options.infinite===!0?_.options.slidesToShow+index:index,_.options.slidesToShow==_.options.slidesToScroll&&_.slideCount-index<_.options.slidesToShow?allSlides.slice(indexOffset-(_.options.slidesToShow-remainder),indexOffset+remainder).addClass("slick-active"):allSlides.slice(indexOffset,indexOffset+_.options.slidesToShow).addClass("slick-active")),"ondemand"===_.options.lazyLoad&&_.lazyLoad()},Slick.prototype.setupInfinite=function(){var i,slideIndex,infiniteCount,_=this;if((_.options.fade===!0||_.options.vertical===!0)&&(_.options.centerMode=!1),_.options.infinite===!0&&_.options.fade===!1&&(slideIndex=null,_.slideCount>_.options.slidesToShow)){for(infiniteCount=_.options.centerMode===!0?_.options.slidesToShow+1:_.options.slidesToShow,i=_.slideCount;i>_.slideCount-infiniteCount;i-=1)slideIndex=i-1,$(_.$slides[slideIndex]).clone(!0).attr("id","").attr("index",slideIndex-_.slideCount).prependTo(_.$slideTrack).addClass("slick-cloned");for(i=0;infiniteCount>i;i+=1)slideIndex=i,$(_.$slides[slideIndex]).clone(!0).attr("id","").attr("index",slideIndex+_.slideCount).appendTo(_.$slideTrack).addClass("slick-cloned");_.$slideTrack.find(".slick-cloned").find("[id]").each(function(){$(this).attr("id","")})}},Slick.prototype.selectHandler=function(event){var _=this,index=parseInt($(event.target).parents(".slick-slide").attr("index"));index||(index=0),_.slideCount<=_.options.slidesToShow||_.slideHandler(index)},Slick.prototype.slideHandler=function(index,sync){var targetSlide,animSlide,oldSlide,slideLeft,unevenOffset,targetLeft=null,_=this;return sync=sync||!1,_.animating===!0&&_.options.waitForAnimate===!0?!1:(sync===!1&&_.asNavFor(index),targetSlide=index,targetLeft=_.getLeft(targetSlide),slideLeft=_.getLeft(_.currentSlide),unevenOffset=_.slideCount%_.options.slidesToScroll!==0?_.options.slidesToScroll:0,_.currentLeft=null===_.swipeLeft?slideLeft:_.swipeLeft,_.options.infinite===!1&&_.options.centerMode===!1&&(0>index||index>_.slideCount-_.options.slidesToShow+unevenOffset)?(_.options.fade===!1&&(targetSlide=_.currentSlide,_.animateSlide(slideLeft,function(){_.postSlide(targetSlide)})),!1):_.options.infinite===!1&&_.options.centerMode===!0&&(0>index||index>_.slideCount-_.options.slidesToScroll)?(_.options.fade===!1&&(targetSlide=_.currentSlide,_.animateSlide(slideLeft,function(){_.postSlide(targetSlide)})),!1):(_.options.autoplay===!0&&clearInterval(_.autoPlayTimer),animSlide=0>targetSlide?_.slideCount%_.options.slidesToScroll!==0?_.slideCount-_.slideCount%_.options.slidesToScroll:_.slideCount+targetSlide:targetSlide>=_.slideCount?_.slideCount%_.options.slidesToScroll!==0?0:targetSlide-_.slideCount:targetSlide,_.animating=!0,null!==_.options.onBeforeChange&&index!==_.currentSlide&&_.options.onBeforeChange.call(this,_,_.currentSlide,animSlide),oldSlide=_.currentSlide,_.currentSlide=animSlide,_.setSlideClasses(_.currentSlide),_.updateDots(),_.updateArrows(),_.options.fade===!0?(_.fadeSlide(oldSlide,animSlide,function(){_.postSlide(animSlide)}),!1):void _.animateSlide(targetLeft,function(){_.postSlide(animSlide)})))},Slick.prototype.startLoad=function(){var _=this;_.options.arrows===!0&&_.slideCount>_.options.slidesToShow&&(_.$prevArrow.hide(),_.$nextArrow.hide()),_.options.dots===!0&&_.slideCount>_.options.slidesToShow&&_.$dots.hide(),_.$slider.addClass("slick-loading")},Slick.prototype.swipeDirection=function(){var xDist,yDist,r,swipeAngle,_=this;return xDist=_.touchObject.startX-_.touchObject.curX,yDist=_.touchObject.startY-_.touchObject.curY,r=Math.atan2(yDist,xDist),swipeAngle=Math.round(180*r/Math.PI),0>swipeAngle&&(swipeAngle=360-Math.abs(swipeAngle)),45>=swipeAngle&&swipeAngle>=0?"left":360>=swipeAngle&&swipeAngle>=315?"left":swipeAngle>=135&&225>=swipeAngle?"right":"vertical"},Slick.prototype.swipeEnd=function(event){var slideCount,slidesTraversed,_=this;if(_.dragging=!1,void 0===_.touchObject.curX)return!1;if(_.touchObject.swipeLength>=_.touchObject.minSwipe)switch($(event.target).on("click.slick",function(event){event.stopImmediatePropagation(),event.stopPropagation(),event.preventDefault(),$(event.target).off("click.slick")}),_.options.swipeToSlide===!0?(slidesTraversed=Math.round(_.touchObject.swipeLength/_.slideWidth),slideCount=slidesTraversed):slideCount=_.options.slidesToScroll,_.swipeDirection()){case"left":_.slideHandler(_.currentSlide+slideCount),_.touchObject={};break;case"right":_.slideHandler(_.currentSlide-slideCount),_.touchObject={}}else _.touchObject.startX!==_.touchObject.curX&&(_.slideHandler(_.currentSlide),_.touchObject={})},Slick.prototype.swipeHandler=function(event){var _=this;if(!(_.options.swipe===!1||"ontouchend"in document&&_.options.swipe===!1||_.options.draggable===!1&&-1!==event.type.indexOf("mouse")))switch(_.touchObject.fingerCount=event.originalEvent&&void 0!==event.originalEvent.touches?event.originalEvent.touches.length:1,_.touchObject.minSwipe=_.listWidth/_.options.touchThreshold,event.data.action){case"start":_.swipeStart(event);break;case"move":_.swipeMove(event);break;case"end":_.swipeEnd(event)}},Slick.prototype.swipeMove=function(event){var curLeft,swipeDirection,positionOffset,touches,_=this;return touches=void 0!==event.originalEvent?event.originalEvent.touches:null,curLeft=_.getLeft(_.currentSlide),!_.dragging||touches&&1!==touches.length?!1:(_.touchObject.curX=void 0!==touches?touches[0].pageX:event.clientX,_.touchObject.curY=void 0!==touches?touches[0].pageY:event.clientY,_.touchObject.swipeLength=Math.round(Math.sqrt(Math.pow(_.touchObject.curX-_.touchObject.startX,2))),swipeDirection=_.swipeDirection(),"vertical"!==swipeDirection?(void 0!==event.originalEvent&&_.touchObject.swipeLength>4&&event.preventDefault(),positionOffset=_.touchObject.curX>_.touchObject.startX?1:-1,_.swipeLeft=_.options.vertical===!1?curLeft+_.touchObject.swipeLength*positionOffset:curLeft+_.touchObject.swipeLength*(_.$list.height()/_.listWidth)*positionOffset,_.options.fade===!0||_.options.touchMove===!1?!1:_.animating===!0?(_.swipeLeft=null,!1):void _.setCSS(_.swipeLeft)):void 0)},Slick.prototype.swipeStart=function(event){var touches,_=this;return 1!==_.touchObject.fingerCount||_.slideCount<=_.options.slidesToShow?(_.touchObject={},!1):(void 0!==event.originalEvent&&void 0!==event.originalEvent.touches&&(touches=event.originalEvent.touches[0]),_.touchObject.startX=_.touchObject.curX=void 0!==touches?touches.pageX:event.clientX,_.touchObject.startY=_.touchObject.curY=void 0!==touches?touches.pageY:event.clientY,void(_.dragging=!0))},Slick.prototype.unfilterSlides=function(){var _=this;null!==_.$slidesCache&&(_.unload(),_.$slideTrack.children(this.options.slide).detach(),_.$slidesCache.appendTo(_.$slideTrack),_.reinit())},Slick.prototype.unload=function(){var _=this;$(".slick-cloned",_.$slider).remove(),_.$dots&&_.$dots.remove(),_.$prevArrow&&(_.$prevArrow.remove(),_.$nextArrow.remove()),_.$slides.removeClass("slick-slide slick-active slick-visible").css("width","")},Slick.prototype.updateArrows=function(){var _=this;_.options.arrows===!0&&_.options.infinite!==!0&&_.slideCount>_.options.slidesToShow&&(_.$prevArrow.removeClass("slick-disabled"),_.$nextArrow.removeClass("slick-disabled"),0===_.currentSlide?(_.$prevArrow.addClass("slick-disabled"),_.$nextArrow.removeClass("slick-disabled")):_.currentSlide>=_.slideCount-_.options.slidesToShow&&(_.$nextArrow.addClass("slick-disabled"),_.$prevArrow.removeClass("slick-disabled")))},Slick.prototype.updateDots=function(){var _=this;null!==_.$dots&&(_.$dots.find("li").removeClass("slick-active"),_.$dots.find("li").eq(Math.floor(_.currentSlide/_.options.slidesToScroll)).addClass("slick-active"))},$.fn.slick=function(options){var _=this;return _.each(function(index,element){element.slick=new Slick(element,options)})},$.fn.slickAdd=function(slide,slideIndex,addBefore){var _=this;return _.each(function(index,element){element.slick.addSlide(slide,slideIndex,addBefore)})},$.fn.slickCurrentSlide=function(){var _=this;return _.get(0).slick.getCurrent()},$.fn.slickFilter=function(filter){var _=this;return _.each(function(index,element){element.slick.filterSlides(filter)})},$.fn.slickGoTo=function(slide){var _=this;return _.each(function(index,element){element.slick.changeSlide({data:{message:"index",index:parseInt(slide)}})})},$.fn.slickNext=function(){var _=this;return _.each(function(index,element){element.slick.changeSlide({data:{message:"next"}})})},$.fn.slickPause=function(){var _=this;return _.each(function(index,element){element.slick.autoPlayClear(),element.slick.paused=!0})},$.fn.slickPlay=function(){var _=this;return _.each(function(index,element){element.slick.paused=!1,element.slick.autoPlay()})},$.fn.slickPrev=function(){var _=this;return _.each(function(index,element){element.slick.changeSlide({data:{message:"previous"}})})},$.fn.slickRemove=function(slideIndex,removeBefore){var _=this;return _.each(function(index,element){element.slick.removeSlide(slideIndex,removeBefore)})},$.fn.slickGetOption=function(option){var _=this;return _.get(0).slick.options[option]},$.fn.slickSetOption=function(option,value,refresh){var _=this;return _.each(function(index,element){element.slick.options[option]=value,refresh===!0&&(element.slick.unload(),element.slick.reinit())})},$.fn.slickUnfilter=function(){var _=this;return _.each(function(index,element){element.slick.unfilterSlides()})},$.fn.unslick=function(){var _=this;return _.each(function(index,element){element.slick&&element.slick.destroy()})},$.fn.getSlick=function(){var s=null,_=this;return _.each(function(index,element){s=element.slick}),s}}),define("home/views/CarouselView",["jquery","underscore","backbone-marionette","home/templates/suggestions","slick"],function($,_,Marionette,suggestionsTemplate){var CarouselView=Marionette.CompositeView.extend({template:suggestionsTemplate,itemViewContainer:"[data-role=cards-container]",collectionEvents:{reset:"render"},ui:{carousel:"[data-role=carousel]",left:"[data-action=scroll-left]",right:"[data-action=scroll-right]"},onRender:function(){this.collection.length&&this.$(this.itemViewContainer).slick({infinite:!1,appendArrows:this.ui.carousel,prevArrow:'<div class="carousel-nav left" data-action="scroll-left"></div>',nextArrow:'<div class="carousel-nav right" data-action="scroll-right"></div>',slidesToShow:3,slidesToScroll:3,responsive:[{breakpoint:1024,settings:{slidesToShow:3,slidesToScroll:3}},{breakpoint:768,settings:{slidesToShow:2,slidesToScroll:2}},{breakpoint:480,settings:{slidesToShow:1,slidesToScroll:1}}]})}});return CarouselView}),define("home/views/BaseSuggestionCardView",["underscore","backbone-marionette","handlebars","home/WrapperlessRegion","home/views/CarouselView"],function(_,Marionette,Handlebars,WrapperlessRegion,CarouselView){return Marionette.Layout.extend({className:"card suggestions",regions:{suggestionsRegion:{selector:"[data-role=suggestions]",regionType:WrapperlessRegion}},hideIfEmpty:function(){this.collection.length||this.$el.hide()},onDomRefresh:function(){this.suggestionsRegion.show(new CarouselView({collection:this.collection,itemView:this.CollectionItemViewClass,itemViewOptions:{className:"carousel-card"}})),this.collection.fetch({reset:!0,success:_.bind(this.hideIfEmpty,this)})}})}),define("home/views/BaseSuggestionView",["backbone-marionette","home/utils/mixpanelUtils"],function(Marionette,MixpanelUtils){return Marionette.ItemView.extend({events:{"click [data-action=toggle-follow]":"toggleFollow"},modelEvents:{"change:name":"render","change:followed change:isFollowing":"handleFollowedClass"},handleFollowedClass:function(){this.$("[data-action=toggle-follow]").toggleClass("active",this.model.get("followed"))},toggleFollow:function(e,eventName){e&&e.preventDefault(),MixpanelUtils.track(eventName,e,{properties:{follow:!this.model.get("followed")}}),this.model.toggleFollowed()}})}),define("home/templates/forumSuggestion",["handlebars","handlebars.partials"],function(Handlebars){return Handlebars.template(function(Handlebars,depth0,helpers,partials,data){function program1(depth0,data){var stack1,buffer="";return buffer+="\n    ",stack1=self.invokePartial(partials.forumAvatar,"forumAvatar",depth0,helpers,partials,data),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n"}function program3(depth0,data){var stack1,buffer="";return buffer+="\n    ",stack1=self.invokePartial(partials.defaultForumAvatar,"defaultForumAvatar",depth0,helpers,partials,data),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n"}function program5(){return" active"}this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),partials=this.merge(partials,Handlebars.partials),data=data||{};var stack1,helper,buffer="",self=this,functionType="function",escapeExpression=this.escapeExpression;return buffer+='<div class="avatar-forum-big">',stack1=helpers["if"].call(depth0,depth0&&depth0.hasFavicon,{hash:{},inverse:self.program(3,program3,data),fn:self.program(1,program1,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+='</div>\n<h3 class="name"><a class="link-gray-dark" href="/home/forums/',(helper=helpers.id)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.id,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'">',stack1=self.invokePartial(partials.forumName,"forumName",depth0,helpers,partials,data),(stack1||0===stack1)&&(buffer+=stack1),buffer+='</a></h3>\n<button class="btn btn-light btn-follow',stack1=helpers["if"].call(depth0,depth0&&depth0.followed,{hash:{},inverse:self.noop,fn:self.program(5,program5,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+='" data-action="toggle-follow"><span class="symbol-default"><span class="icon-plus"></span></span><span class="text-default">Follow</span><span class="symbol-following"><span class="icon-checkmark"></span></span><span class="text-following">Following</span></button>\n'})}),define("home/views/ForumSuggestionView",["home/views/BaseSuggestionView","home/templates/forumSuggestion"],function(BaseSuggestionView,forumSuggestionTemplate){var ForumSuggestionView=BaseSuggestionView.extend({template:forumSuggestionTemplate,templateHelpers:function(){return{hasFavicon:this.model.hasFavicon()}
},toggleFollow:function(e){this.constructor.__super__.toggleFollow.call(this,e,"follow forum")}});return ForumSuggestionView}),define("home/templates/forumSuggestionCard",["handlebars","handlebars.partials"],function(Handlebars){return Handlebars.template(function(Handlebars,depth0,helpers,partials,data){return this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{},'<header class="suggestions-header">\n    Recommended Communities\n</header>\n<div class="carousel-wrapper" data-role="suggestions"></div>\n'})}),define("home/views/ForumSuggestionCardView",["underscore","home/collections/RecommendedForumCollection","home/views/BaseSuggestionCardView","home/views/ForumSuggestionView","home/templates/forumSuggestionCard"],function(_,RecommendedForumCollection,BaseSuggestionCardView,ForumSuggestionView,forumSuggestionCardTemplate){var ForumSuggestionCardView=BaseSuggestionCardView.extend({attributes:{"data-mix-location":"forum suggestion card"},template:forumSuggestionCardTemplate,initialize:function(){this.collection=new RecommendedForumCollection,this.CollectionItemViewClass=ForumSuggestionView}});return ForumSuggestionCardView}),define("home/collections/RecommendedUserCollection",["backbone","home/models/common/UniqueModel","home/models/User","core/api"],function(Backbone,UniqueModel,User,api){return Backbone.Collection.extend({url:api.getURL("users/recommendedUsersToFollow"),model:UniqueModel.boundModel(User),parse:function(resp){return resp.response}})}),define("home/templates/userSuggestion",["handlebars","handlebars.partials"],function(Handlebars){return Handlebars.template(function(Handlebars,depth0,helpers,partials,data){function program1(){return" active"}this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),partials=this.merge(partials,Handlebars.partials),data=data||{};var stack1,buffer="",self=this;return stack1=self.invokePartial(partials.userAvatar,"userAvatar",depth0,helpers,partials,data),(stack1||0===stack1)&&(buffer+=stack1),buffer+='\n<h3 class="name"><a class="link-gray-dark" href="#">',stack1=self.invokePartial(partials.userName,"userName",depth0,helpers,partials,data),(stack1||0===stack1)&&(buffer+=stack1),buffer+='</a></h3>\n<button class="btn btn-light btn-follow',stack1=helpers["if"].call(depth0,depth0&&depth0.isFollowing,{hash:{},inverse:self.noop,fn:self.program(1,program1,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+='" data-action="toggle-follow"><span class="symbol-default"><span class="icon-plus"></span></span><span class="text-default">Follow</span><span class="symbol-following"><span class="icon-checkmark"></span></span><span class="text-following">Following</span></button>\n'})}),define("home/views/UserSuggestionView",["home/views/BaseSuggestionView","home/templates/userSuggestion"],function(BaseSuggestionView,userSuggestionTemplate){return BaseSuggestionView.extend({template:userSuggestionTemplate,toggleFollow:function(e){this.constructor.__super__.toggleFollow.call(this,e,"follow user")}})}),define("home/templates/userSuggestionCard",["handlebars","handlebars.partials"],function(Handlebars){return Handlebars.template(function(Handlebars,depth0,helpers,partials,data){return this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{},'<header class="suggestions-header">\n    Recommended People\n</header>\n<div class="carousel-wrapper" data-role="suggestions"></div>\n'})}),define("home/views/UserSuggestionCardView",["underscore","home/collections/RecommendedUserCollection","home/views/BaseSuggestionCardView","home/views/UserSuggestionView","home/templates/userSuggestionCard"],function(_,RecommendedUserCollection,BaseSuggestionCardView,UserSuggestionView,userSuggestionCardTemplate){return BaseSuggestionCardView.extend({attributes:{"data-mix-location":"user suggestion card"},template:userSuggestionCardTemplate,initialize:function(){this.collection=new RecommendedUserCollection,this.CollectionItemViewClass=UserSuggestionView}})}),define("home/utils/trackingUtils",["jquery","underscore","home/models/Session","home/utils/mixpanelUtils","home/utils/iframeUtils","home/utils/inspectletUtils","core/analytics/jester","core/bus"],function($,_,Session,MixpanelUtils,IframeUtils,inspectletUtils,jester,bus){var listeners={viewFeed:function(fetchableCollectionView){var params={verb:"view",object_type:"section",object_id:jester.client.get("zone")+"/"+jester.client.get("section")};fetchableCollectionView._showingEmptyView?params.adjective="empty":fetchableCollectionView._showingErrorView&&(params.adjective="error"),jester.client.emit(params)},viewMoreFeed:function(numPages){jester.client.emit({verb:"open",object_type:"section",object_id:jester.client.get("zone")+"/"+jester.client.get("section")+"/page-"+numPages})},"uiCallback:postCreated":function(post,params){params=params||{},_.extend(params,{object_type:"post",object_id:post.id,verb:"post"}),post.has("parent")&&(params.target_type="comment",params.target_id=post.get("parent")),jester.client.emit(params),inspectletUtils.tagSession("posted a comment")},"uiAction:postUpvote":function(post){jester.client.emit({verb:"like",object_type:"post",object_id:post.id}),inspectletUtils.tagSession("upvoted")},"uiAction:postUnvote":function(post){jester.client.emit({verb:"unlike",object_type:"post",object_id:post.id})},"uiAction:postDownvote":function(post){jester.client.emit({verb:"dislike",object_type:"post",object_id:post.id})}},jesterZoneNames={user:"profile",inbox:"notifications",discussion:"thread",forum:"community",topic:"topic",channel:"channel"},defaultZoneName="activityfeed";return{init:function(){var settings={experiment:"V2",variant:"active",product:this.productName()};jester.client.set(settings),bus.on(listeners)},productName:function(){return IframeUtils.isIframed(window)?"bridge":"home"},pageChanged:function(){this.urlChanged(),this.setSection()},urlChanged:function(){var url=document.location.href,zone=_.find(jesterZoneNames,function(zone,regex){return new RegExp(regex).test(url)})||defaultZoneName;jester.client.set({page_url:url,zone:zone})},setSection:function(sectionName){jester.client.set({section:sectionName||"default"})},initUser:function(userId){jester.client.set("user_id",userId)},trackVisit:function(){MixpanelUtils.track(IframeUtils.isIframed(window)?"visit_homeception":"visit",{target:$("body")}),jester.client.has("zone")||this.urlChanged();var productName=this.productName(),jesterTrack=function(){jester.client.emit({verb:"view",object_type:"product",object_id:productName})},session=new Session;session.isAnonymous()?session.once("change:id",jesterTrack):jesterTrack()}}}),define("home/views/common/TabbedView",["jquery","backbone","backbone-marionette","home/utils/layoutUtils","home/utils/trackingUtils"],function($,Backbone,Marionette,LayoutUtils,trackingUtils){var TabbedView=Marionette.Layout.extend({defaultTab:void 0,getTabView:function(){throw"Not implemented"},getTrackingSection:function(){return null},regions:{contentRegion:"[data-role=content-area]"},events:{"click [data-action=switch-tab]":"switchTab"},initialize:function(options){this.activeTab=options&&options.activeTab},switchTab:function(e){if(e){e.preventDefault();var requestedTab=$(e.currentTarget).data("tab");if(requestedTab!==this.activeTab){this.activeTab=requestedTab||this.defaultTab;var href=$(e.target).closest("a").attr("href");if(href&&!/^#/.test(href)){var route=href.replace(new RegExp("^"+Backbone.history.root),"");Backbone.history.navigate(route),trackingUtils.urlChanged()}return this.updateTab(),!1}}},updateTab:function(){this.activeTab||(this.activeTab=this.defaultTab);var activeTab=this.activeTab;trackingUtils.setSection(this.getTrackingSection(activeTab)),this.updateTabContent(activeTab),this.$(".active[data-action=switch-tab]").removeClass("active"),this.$("[data-tab="+activeTab+"]").addClass("active"),LayoutUtils.scrollShownChanged()},updateTabContent:function(activeTab){var oldView=this.contentRegion.currentView,newView=this.getTabView(activeTab);if(oldView){oldView.onBeforeClose=function(){return!1};var scrollTop=$(window).scrollTop();if(scrollTop){var minHeight=scrollTop+$(window).height()-oldView.$el.offset().top;newView.$el.css("minHeight",minHeight)}}this.contentRegion.show(newView),oldView&&(oldView.onBeforeClose=null,oldView.close())},onDomRefresh:function(){this.$(this.contentRegion.el).length&&this.updateTab()}});return TabbedView}),define("home/templates/homeFeedEmptyCover",["handlebars","handlebars.partials"],function(Handlebars){return Handlebars.template(function(Handlebars,depth0,helpers,partials,data){function program1(){return'\n            <h3 class="headline">You fed your feed <span class="face face-happy">:)</span></h3>\n            <p class="description">Refresh to see your newly filled feed.</p>\n        '}function program3(){return'\n            <h3 class="headline">Your feed\'s empty! <span class="face face-sad">:(</span></h3>\n            <p class="description">To get the best experience, follow some communities. We recommend these:</p>\n        '}this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var stack1,buffer="",self=this;return buffer+='<div class="cover">\n    <div class="cover-message">\n        ',stack1=helpers["if"].call(depth0,depth0&&depth0.numTotalFollowing,{hash:{},inverse:self.program(3,program3,data),fn:self.program(1,program1,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n    </div>\n</div>\n"})}),define("home/views/HomeFeedEmptyCoverView",["backbone-marionette","home/models/Session","home/templates/homeFeedEmptyCover"],function(Marionette,Session,homeFeedEmptyCoverTemplate){var HomeFeedEmptyCoverView=Marionette.ItemView.extend({template:homeFeedEmptyCoverTemplate,templateHelpers:function(){var sessionUser=!this.model.isAnonymous()&&this.model.user;return{numTotalFollowing:sessionUser?sessionUser.get("numFollowing")+sessionUser.get("numForumsFollowing"):0}},modelEvents:{"change:numFollowing":"render","change:numForumsFollowing":"render","change:id":"render"}});return HomeFeedEmptyCoverView}),define("home/templates/homeFeedEmpty",["handlebars","handlebars.partials"],function(Handlebars){return Handlebars.template(function(Handlebars,depth0,helpers,partials,data){return this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{},'<div data-role="cover-area"></div>\n<header class="nav-tabs-container">\n    <ul class="nav-tabs">\n        <li class="active" data-action="switch-tab" data-tab="forums">\n            <a href="#"><span class="text-wide">Communities</span></a>\n        </li>\n        <li data-action="switch-tab" data-tab="people">\n            <a href="#">People</a>\n        </li>\n    </ul>\n</header>\n<div data-role="content-area"></div>\n'})}),define("home/views/HomeFeedEmptyView",["jquery","underscore","home/views/common/TabbedView","home/views/HomeFeedEmptyCoverView","home/views/ForumSuggestionCardView","home/views/UserSuggestionCardView","home/models/Session","home/templates/homeFeedEmpty"],function($,_,TabbedView,HomeFeedEmptyCoverView,ForumSuggestionCardView,UserSuggestionCardView,Session,homeFeedEmptyTemplate){var HomeFeedEmptyView=TabbedView.extend({className:"home-empty",defaultTab:"forums",template:homeFeedEmptyTemplate,regions:_.defaults({coverRegion:"[data-role=cover-area]"},TabbedView.prototype.regions),onDomRefresh:function(){this.$(this.coverRegion.el).length&&this.coverRegion.show(new HomeFeedEmptyCoverView({model:new Session})),TabbedView.prototype.onDomRefresh.apply(this,arguments),this.trigger("toggleHeight","content")},getTabView:function(activeTab){switch(activeTab){case"forums":return new ForumSuggestionCardView;case"people":return new UserSuggestionCardView}}});return HomeFeedEmptyView}),define("home/views/HomeCardCollectionView",["jquery","underscore","home/utils/layoutUtils","home/utils/mixpanelUtils","home/views/ActivityCardCollectionView","home/views/ForumSuggestionCardView","home/views/UserSuggestionCardView","home/views/HomeFeedEmptyView"],function($,_,LayoutUtils,MixpanelUtils,ActivityCardCollectionView,ForumSuggestionCardView,UserSuggestionCardView,HomeFeedEmptyView){var HomeCardCollectionView=ActivityCardCollectionView.extend({emptyView:HomeFeedEmptyView,attributes:{"data-mix-location":"home"},initialize:function(){ActivityCardCollectionView.prototype.initialize.apply(this,arguments),this.listenTo(this,"after:item:added",this.onShowCard)},onClose:function(){this.handleOnScroll&&_.each(this.handleOnScroll,function(handler){$(window).off("scroll",handler)})},onShowCard:function(){var insertionPoint=this.insertionPoint=this.insertionPoint||Math.floor(.75*this.collection.length);this.forumSuggestionCardView||this.children.length!==insertionPoint||(this.forumSuggestionCardView=this.insertSuggestionCard(ForumSuggestionCardView)),this.userSuggestionCardView||this.children.length!==2*insertionPoint||(this.userSuggestionCardView=this.insertSuggestionCard(UserSuggestionCardView))},insertSuggestionCard:function(ViewClass){var view=this.addItemView(this.model,ViewClass);this.handleOnScroll||(this.handleOnScroll={});var handler=_.debounce(_.bind(this.trackViewSuggestionCard,this,view),200);return this.handleOnScroll[view.cid]=handler,$(window).scroll(handler),view},trackViewSuggestionCard:function(view){if(LayoutUtils.isElementInViewport(view.$el)){MixpanelUtils.track("view infeed suggestion",{target:view.$el});var handler=this.handleOnScroll[view.cid];$(window).off("scroll",handler)}}});return HomeCardCollectionView}),define("home/templates/spinner",["handlebars","handlebars.partials"],function(Handlebars){return Handlebars.template(function(Handlebars,depth0,helpers,partials,data){return this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{},'<div class="spinner"></div>\n'})}),define("home/templates/moreButton",["handlebars","handlebars.partials"],function(Handlebars){return Handlebars.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var buffer="",escapeExpression=this.escapeExpression;return buffer+='<a href="#" class="btn btn-default btn-block" data-action="more-feed">\n    <span>'+escapeExpression(helpers.gettext.call(depth0,"More",{hash:{},data:data}))+"</span>\n</a>\n"})}),define("home/templates/endOfItems",["handlebars","handlebars.partials"],function(Handlebars){return Handlebars.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var buffer="",escapeExpression=this.escapeExpression;return buffer+='<div class="feed-end" data-role="end-message">\n    '+escapeExpression(helpers.gettext.call(depth0,"That's the end. Want more?",{hash:{},data:data}))+' <a href="http://disqus.com/follow/facebook/">'+escapeExpression(helpers.gettext.call(depth0,"Find and follow friends on Disqus",{hash:{},data:data}))+" &raquo;</a>\n</div>\n"})}),define("home/views/common/FetchableCollectionFooterView",["backbone-marionette","home/templates/spinner","home/templates/moreButton","home/templates/endOfItems"],function(Marionette,spinnerTemplate,moreButtonTemplate,endOfItemsTemplate){var FetchableCollectionFooterView=Marionette.ItemView.extend({template:function(data){return!data.collection.length||data.error?"":data.fetching?spinnerTemplate(data):data.hasNext?moreButtonTemplate(data):endOfItemsTemplate(data)},templateHelpers:function(){return{collection:this.collection}},className:"more-wrapper feed-wrapper",events:{"click [data-action=more-feed]":"moreClicked"},modelEvents:{"change:fetching":"render"},moreClicked:function(e){e.preventDefault(),this.model.fetchItems()}});return FetchableCollectionFooterView}),define("home/templates/fetchableCollectionLayout",["handlebars","handlebars.partials"],function(Handlebars){return Handlebars.template(function(Handlebars,depth0,helpers,partials,data){return this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{},"<div data-role='content-area'></div>\n<div data-role='footer-area'></div>\n"})}),define("home/views/common/FetchableCollectionLayout",["underscore","backbone-marionette","home/views/common/FetchableCollectionView","home/views/common/FetchableCollectionFooterView","home/views/FetchingView","home/utils/layoutUtils","home/templates/fetchableCollectionLayout"],function(_,Marionette,FetchableCollectionView,FetchableCollectionFooterView,FetchingView,layoutUtils,fetchableCollectionLayoutTemplate){var FetchableCollectionLayout=Marionette.Layout.extend({itemViewEventPrefix:"collectionview",template:fetchableCollectionLayoutTemplate,regions:{contentRegion:"[data-role=content-area]",footerRegion:"[data-role=footer-area]"},initialize:function(options){if(options.fetchableCollectionView&&(this.fetchableCollectionView=options.fetchableCollectionView),!this.fetchableCollectionView||!(this.fetchableCollectionView===FetchableCollectionView||this.fetchableCollectionView.prototype instanceof FetchableCollectionView))throw"A FetchableCollectionLayout must define a fetchableCollectionView";if(!this.contentRegion||!this.footerRegion)throw"A template for a FetchableCollectionLayout must define a content region and a footer region";this.options=options},onDomRefresh:function(){this.contentRegion.currentView&&this.stopListening(this.contentRegion.currentView);var view=new this.fetchableCollectionView(_.extend({},this.options));Marionette.CollectionView.prototype.addChildViewEventForwarding.call(this,view),this.contentRegion.show(new FetchingView),_.defer(_.bind(function(){this.contentRegion.show(view),this.trigger("showCollection"),this.footerRegion.show(new FetchableCollectionFooterView({model:this.model,collection:this.collection})),layoutUtils.scrollShownChanged()},this))},getItemEvents:Marionette.CollectionView.prototype.getItemEvents});return FetchableCollectionLayout}),define("home/templates/activityFeed",["handlebars","handlebars.partials"],function(Handlebars){return Handlebars.template(function(Handlebars,depth0,helpers,partials,data){return this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{},'<div class="section-contained">\n    <div class="cover" data-role="cover-area"></div>\n</div>\n<div class="section-contained" id="container-content" data-role="content-area"></div>\n<div class="section-contained" data-role="footer-area"></div>\n'})}),define("home/views/ActivityFeedView",["underscore","home/views/ActivityCardCollectionView","home/views/common/FetchableCollectionLayout","home/templates/activityFeed"],function(_,ActivityCardCollectionView,FetchableCollectionLayout,activityFeedTemplate){var ActivityFeedView=FetchableCollectionLayout.extend({template:activityFeedTemplate,attributes:{"data-mix-location":"feed"},regions:_.defaults({coverRegion:"[data-role=cover-area]"},FetchableCollectionLayout.prototype.regions),fetchableCollectionView:ActivityCardCollectionView,initialize:function(options){FetchableCollectionLayout.prototype.initialize.apply(this,arguments),options.coverView&&(this.coverView=options.coverView)},onDomRefresh:function(){if(FetchableCollectionLayout.prototype.onDomRefresh.apply(this,arguments),this.coverView){var coverModel=this.coverView.getModel?this.coverView.getModel(this.model):this.model;this.coverRegion.show(new this.coverView({model:coverModel}))}},getTitle:function(){var cover=this.coverRegion.currentView;return cover&&cover.getTitle&&cover.getTitle()||""}});return ActivityFeedView}),define("home/mixins/withReason",["underscore","home/views/ActivityActorsHoverCard","core/utils"],function(_,ActivityActorsHoverCard,utils){var initHoverCard=function(){if(!utils.isPhone(window)){var target=this.$("[data-role=actors]");target.length&&(this.hoverCard&&this.hoverCard.remove(),this.hoverCard=ActivityActorsHoverCard.create({targetElement:target,activityFeedItem:this.model,activityId:this.model.id,numShownActors:1}))}},getNumOccurences=function(){if(!this.model.actors||1!==this.model.actors.length)return 0;var numOccurences=this.model.get("totalActivities");return numOccurences>1?numOccurences:0},withReason=function(){this.initialize=_.wrap(this.initialize,function(_initialize){_initialize.apply(this,_.rest(arguments)),this.listenTo(this,"render",initHoverCard)});var _templateHelpers=this.templateHelpers;this.templateHelpers=function(){return _.extend({relativeTime:this.model.getRelativeTimestamp(),numRemainingActors:this.model.get("totalActors")-1,numOccurences:getNumOccurences.call(this),firstActor:this.model.actors[0]&&this.model.actors[0].toJSON()},_templateHelpers?_templateHelpers.apply(this,arguments):{})}};return withReason}),define("home/mixins/asNotificationCard",["underscore"],function(_){var asNotificationCard=function(){var _className=this.className;this.className=function(){var existingClassName=_.isFunction(_className)?_className.apply(this,arguments):_className||"";return"card card-notif "+existingClassName};var _initialize=this.initialize;this.initialize=function(){_initialize.apply(this,arguments),this.listenTo(this.model,"change:isUnread",this.updateUnreadClass),this.updateUnreadClass()},this.updateUnreadClass=function(){this.$el.toggleClass("unread",!!this.model.get("isUnread"))};var _serializeData=this.serializeData;this.serializeData=function(){var data=_serializeData.apply(this,arguments);return _.defaults(data,{discussionRoute:this.model.thread&&this.model.thread.getDiscussionRoute()})}};return asNotificationCard}),define("home/templates/notificationCardUpvote",["handlebars","handlebars.partials"],function(Handlebars){return Handlebars.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var stack1,helper,options,buffer="",helperMissing=helpers.helperMissing,escapeExpression=this.escapeExpression,functionType="function";return buffer+='<div class="card-reason">\n    <svg class="icon icon-notif-upvote" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 12 7" enable-background="new 0 0 12 7" xml:space="preserve"><path d="M11 7c-0.3 0-0.5-0.1-0.7-0.3L6 2.4L1.7 6.7c-0.4 0.4-1 0.4-1.4 0c-0.4-0.4-0.4-1 0-1.4l5-5 c0.4-0.4 1-0.4 1.4 0l5 5c0.4 0.4 0.4 1 0 1.4C11.5 6.9 11.3 7 11 7z" class="style0"/></svg>',helper=helpers.getPartial||depth0&&depth0.getPartial,options={hash:{},data:data},stack1=helper?helper.call(depth0,"userGroupNames",options):helperMissing.call(depth0,"getPartial","userGroupNames",options),buffer+=escapeExpression(helpers.gettext.call(depth0,"%(userNames)s upvoted you",{hash:{userNames:stack1},data:data}))+'\n\n    on\n\n    <a href="/home/',(helper=helpers.discussionRoute)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.discussionRoute,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'"\n        class="name-thread"\n        data-role="article-link"\n        data-mix-location="title">\n\n        ',stack1=depth0&&depth0.thread,stack1=null==stack1||stack1===!1?stack1:stack1.clean_title,stack1=typeof stack1===functionType?stack1.apply(depth0):stack1,(stack1||0===stack1)&&(buffer+=stack1),buffer+='\n    </a>\n\n    <span class="time">',(helper=helpers.relativeTime)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.relativeTime,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'</span>\n</div>\n<div class="card-body">\n    <div data-role="post"></div>\n</div>\n'})}),define("home/views/NotificationCardUpvoteView",["underscore","backbone-marionette","home/mixins/withReason","home/mixins/asNotificationCard","home/views/TruncatedPostView","home/templates/notificationCardUpvote"],function(_,Marionette,withReason,asNotificationCard,TruncatedPostView,notificationCardUpvoteTemplate){var NotificationCardUpvoteView=Marionette.Layout.extend({className:"card-notif-upvote",regions:{postRegion:"[data-role=post]"},template:notificationCardUpvoteTemplate,onDomRefresh:function(){this.postRegion.show(new TruncatedPostView({model:this.model.activities[0].target}))}});return withReason.call(NotificationCardUpvoteView.prototype),asNotificationCard.call(NotificationCardUpvoteView.prototype),NotificationCardUpvoteView}),define("home/templates/notificationCardReply",["handlebars","handlebars.partials"],function(Handlebars){return Handlebars.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var stack1,helper,options,buffer="",helperMissing=helpers.helperMissing,escapeExpression=this.escapeExpression,functionType="function";return buffer+='<div class="card-reason">\n    <svg class="icon icon-notif-reply" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 13 10" enable-background="new 0 0 13 10" xml:space="preserve"><path d="M7.8 6.5v3.2L13 4.8L7.8 0v2.8C1.4 2.8 0 10 0 10 C1.8 6.8 4.3 6.5 7.8 6.5z" class="style0"/></svg>',helper=helpers.getPartial||depth0&&depth0.getPartial,options={hash:{},data:data},stack1=helper?helper.call(depth0,"userName",depth0&&depth0.firstActor,options):helperMissing.call(depth0,"getPartial","userName",depth0&&depth0.firstActor,options),buffer+=escapeExpression(helpers.gettext.call(depth0,"%(userName)s replied to you",{hash:{userName:stack1},data:data}))+'\n\n    on\n\n    <a href="/home/',(helper=helpers.discussionRoute)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.discussionRoute,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'"\n        class="name-thread"\n        data-role="article-link"\n        data-mix-location="title">\n\n        ',stack1=depth0&&depth0.thread,stack1=null==stack1||stack1===!1?stack1:stack1.clean_title,stack1=typeof stack1===functionType?stack1.apply(depth0):stack1,(stack1||0===stack1)&&(buffer+=stack1),buffer+='\n    </a>\n\n     <span class="time">',(helper=helpers.relativeTime)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.relativeTime,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'</span>\n</div>\n<div class="card-body">\n    <div class="card-comment" data-role=\'post\'></div>\n</div>\n'})}),define("home/views/NotificationCardReplyView",["underscore","backbone","backbone-marionette","home/mixins/withReason","home/mixins/asNotificationCard","home/views/PostActivityCollectionView","home/views/PostView","home/utils/domUtils","home/templates/notificationCardReply"],function(_,Backbone,Marionette,withReason,asNotificationCard,PostActivityCollectionView,PostView,domUtils,notificationCardReplyTemplate){var NotificationCardReplyView=Marionette.Layout.extend({className:"card-notif-reply",template:notificationCardReplyTemplate,serializeData:function(){var data=Marionette.Layout.prototype.serializeData.apply(this,arguments),target=data.activities[0].target;return _.extend(data,{plaintextParent:domUtils.stripHtmlTags(target.message)})},regions:{postRegion:"[data-role=post]"},onDomRefresh:function(){this.postRegion.show(new PostActivityCollectionView({collection:new Backbone.Collection(this.model.activities)}))}});return withReason.call(NotificationCardReplyView.prototype),asNotificationCard.call(NotificationCardReplyView.prototype),NotificationCardReplyView}),define("home/templates/userCard",["handlebars","handlebars.partials"],function(Handlebars){return Handlebars.template(function(Handlebars,depth0,helpers,partials,data){function program1(depth0,data){var stack1,buffer="";return buffer+="\n            \n            ",stack1=helpers["if"].call(depth0,depth0&&depth0.isPrivate,{hash:{},inverse:self.program(4,program4,data),fn:self.program(2,program2,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n        "}function program2(depth0,data){var buffer="";return buffer+='\n                <a href="#" class="btn btn-disabled">'+escapeExpression(helpers.gettext.call(depth0,"Private",{hash:{},data:data}))+' <span class="icon-lock"></span></a>\n            '}function program4(depth0,data){var stack1,buffer="";return buffer+='\n                <button class="btn btn-light btn-follow',stack1=helpers["if"].call(depth0,depth0&&depth0.isFollowing,{hash:{},inverse:self.noop,fn:self.program(5,program5,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+='" data-action="toggle-follow">\n                    \n                    <span class="symbol-default"><span class="icon-plus"></span></span><span class="text-default">'+escapeExpression(helpers.gettext.call(depth0,"Follow",{hash:{},data:data}))+'</span><span class="symbol-following"><span class="icon-checkmark"></span></span><span class="text-following">'+escapeExpression(helpers.gettext.call(depth0,"Following",{hash:{},data:data}))+"</span>\n                </button>\n            "}function program5(){return" active"}function program7(depth0,data){var stack1,helper,buffer="";return buffer+='\n                <p class="description truncate-line">',(helper=helpers.about)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.about,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"</p>\n            "}this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),partials=this.merge(partials,Handlebars.partials),data=data||{};var stack1,buffer="",escapeExpression=this.escapeExpression,self=this,functionType="function";return buffer+='<div class="card-user">\n    <div class="card-aside">\n        ',stack1=helpers.unless.call(depth0,depth0&&depth0.isSessionUser,{hash:{},inverse:self.noop,fn:self.program(1,program1,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+='\n    </div>\n    <div class="card-body">\n        ',stack1=self.invokePartial(partials.userAvatar,"userAvatar",depth0,helpers,partials,data),(stack1||0===stack1)&&(buffer+=stack1),buffer+='\n        <div class="user-info">\n            ',stack1=self.invokePartial(partials.userName,"userName",depth0,helpers,partials,data),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n            ",stack1=helpers["if"].call(depth0,depth0&&depth0.about,{hash:{},inverse:self.noop,fn:self.program(7,program7,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n        </div>\n    </div>\n</div>\n"})}),define("home/views/UserCardView",["backbone-marionette","home/utils/mixpanelUtils","home/templates/userCard","core/bus"],function(Marionette,MixpanelUtils,userCardTemplate,bus){var UserCardView=Marionette.ItemView.extend({template:userCardTemplate,templateHelpers:function(){return{isSessionUser:this.model.isSessionUser()}},className:"card",events:{"click [data-action=toggle-follow]":"toggleFollow"},modelEvents:{"change:isFollowing":"handleFollowedClass"},handleFollowedClass:function(){this.$("[data-action=toggle-follow]").toggleClass("active",this.model.get("isFollowing"))},toggleFollow:function(e){e&&e.preventDefault(),MixpanelUtils.track("follow user",e,{properties:{follow:!this.model.get("isFollowing")}}),this.model.get("isFollowing")?bus.trigger("uiAction:unfollowUser",this.model,e):bus.trigger("uiAction:followUser",this.model,e),this.model.toggleFollowed()}});return UserCardView}),define("home/templates/notificationCardFollow",["handlebars","handlebars.partials"],function(Handlebars){return Handlebars.template(function(Handlebars,depth0,helpers,partials,data){function program1(depth0,data){var buffer="";return buffer+='\n<div class="expandable">\n    <div class="card-grouped-actions">\n        <a href="#" data-action="toggle-collapsed" class="expandable card-expand">\n            <div class="icon-more-vert"></div>\n            '+escapeExpression(helpers.gettext.call(depth0,"See More",{hash:{},data:data}))+"\n        </a>\n    </div>\n</div>\n"
}function program3(depth0,data){var stack1,helper,buffer="";return buffer+='\n<div class="collapsible">\n    <div class="card-grouped-actions">\n        <a class="collapsible btn btn-light btn-follow" href="/home/user/',(helper=helpers.sessionUsername)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.sessionUsername,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'/followers">\n            '+escapeExpression(helpers.gettext.call(depth0,"See All Followers",{hash:{},data:data}))+"\n        </a>\n    </div>\n</div>\n"}this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var stack1,helper,options,buffer="",escapeExpression=this.escapeExpression,functionType="function",helperMissing=helpers.helperMissing,self=this;return buffer+='<div class="card-reason">\n    <svg class="icon icon-notif-follow" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 18 15" enable-background="new 0 0 18 15" xml:space="preserve"><path d="M11.6 11.2c-2.1-0.8-2.8-1.4-2.8-2.7c0-0.8 0.6-0.5 0.9-2 c0.1-0.6 0.7 0 0.8-1.4c0-0.6-0.3-0.7-0.3-0.7s0.2-0.8 0.2-1.5C10.5 2.1 9.9 0 7 0S3.5 2.1 3.6 2.8c0.1 0.6 0.2 1.5 0.2 1.5 S3.5 4.5 3.5 5c0.1 1.4 0.7 0.8 0.8 1.4c0.3 1.5 0.9 1.2 0.9 2c0 1.4-0.7 2-2.8 2.7C0.3 12 0 12.7 0 13.2V15h7h7v-1.8 C14 12.7 13.7 12 11.6 11.2z" class="style0"/><polygon points="18,7 16,7 16,5 15,5 15,7 13,7 13,8 15,8 15,10 16,10 16,8 18,8"/></svg>',helper=helpers.getPartial||depth0&&depth0.getPartial,options={hash:{},data:data},stack1=helper?helper.call(depth0,"userGroupNames",options):helperMissing.call(depth0,"getPartial","userGroupNames",options),buffer+=escapeExpression(helpers.gettext.call(depth0,"%(userNames)s followed you",{hash:{userNames:stack1},data:data}))+'\n\n    <span class="time">',(helper=helpers.relativeTime)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.relativeTime,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'</span>\n</div>\n<div data-role="users"></div>\n\n',stack1=helpers["if"].call(depth0,depth0&&depth0.shouldCollapse,{hash:{},inverse:self.noop,fn:self.program(1,program1,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n",stack1=helpers["if"].call(depth0,depth0&&depth0.hasOverflowActors,{hash:{},inverse:self.noop,fn:self.program(3,program3,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n"})}),define("home/views/NotificationCardFollowView",["underscore","backbone","backbone-marionette","home/mixins/withReason","home/mixins/asNotificationCard","home/mixins/asCollapsibleCard","home/models/Session","home/views/UserCardView","home/templates/notificationCardFollow"],function(_,Backbone,Marionette,withReason,asNotificationCard,asCollapsibleCard,Session,UserCardView,notificationCardFollowTemplate){var NotificationCardFollowView=Marionette.Layout.extend({className:function(){return"card-notif-follow"+(this.shouldCollapse()?" card-collapsed":"")},regions:{usersRegion:"[data-role=users]"},initialize:function(){this.session=new Session,this.initializeShownActors()},initializeShownActors:function(){this.shownActors||(this.shownActors=_.pluck(this.model.activities,"actor"))},shouldCollapse:function(){return this.initializeShownActors(),this.shownActors.length>3},template:notificationCardFollowTemplate,templateHelpers:function(){return{hasOverflowActors:this.model.get("totalActors")>this.model.actors.length,sessionUsername:this.session.user.get("username"),shouldCollapse:this.shouldCollapse()}},onDomRefresh:function(){this.usersRegion.show(new Marionette.CollectionView({itemView:UserCardView,itemViewOptions:function(item,index){return{className:"card-user-notif"+(index>2?" collapsible":"")}},collection:new Backbone.Collection(this.shownActors)}))}});return withReason.call(NotificationCardFollowView.prototype),asNotificationCard.call(NotificationCardFollowView.prototype),asCollapsibleCard.call(NotificationCardFollowView.prototype),NotificationCardFollowView}),define("home/views/NotificationCardNoteView",["jquery","underscore","backbone-marionette","home/mixins/withReason","home/mixins/asNotificationCard","home/utils/navigationUtils","core/analytics/jester","core/bus"],function($,_,Marionette,withReason,asNotificationCard,NavigationUtils,jester){var urlFragmentReg=/\#.*/,appendStyles=function(stylesMap){var $head=$("head");_.each(stylesMap,function(css,cssScope){$head.find("#"+cssScope).length||$head.append('<style type="text/css" id="'+cssScope+'">'+css+"</style>")})},NotificationCardNoteView=Marionette.ItemView.extend({initialize:function(){this.activity=this.model.activities[0],this.object=this.activity.object},events:{"click a":"trackClick"},className:"card-notif-note",getTemplate:function(){return"<div>"+_.reduce(NotificationCardNoteView.TEMPLATE_INTERPOLATION_TABLE,function(body,fn,key){return body.replace(new RegExp(key,"g"),fn.call(this))},this.object.get("body"),this)+"</div>"},trackClick:function(evt){var $elem=$(evt.currentTarget);if(this.shouldTrackClick(evt,$elem)){var trackXhr=jester.client.emit({object_type:"note",object_id:this.activity.get("backendId"),verb:"click"});if(trackXhr&&this.shouldDelayNavigation(evt,$elem)){evt.preventDefault(),evt.stopPropagation();var navigate=_.once(function(){window.top.location=$elem[0].href});_.delay(navigate,1e3),trackXhr.always(navigate)}}},shouldTrackClick:function(evt,$elem){if(evt.isDefaultPrevented())return!1;var href=($elem.attr("href")||"").replace(urlFragmentReg,"");return href?!0:!1},shouldDelayNavigation:function(evt,$elem){return NavigationUtils.isInboundLinkClick(evt)?!1:!("_blank"===$elem.attr("target")||evt.ctrlKey||evt.metaKey||evt.shiftKey||evt.altKey)},onRender:function(){appendStyles(this.object.get("styles")),this.activity.get("isUnread")&&jester.client.emit({verb:"view",object_type:"note",object_id:this.activity.get("backendId")})}},{TEMPLATE_INTERPOLATION_TABLE:{ACTIVITY_ID:function(){return this.activity.get("backendId")},RELATIVE_TIME:function(){return this.model.getRelativeTimestamp()}}});return withReason.call(NotificationCardNoteView.prototype),asNotificationCard.call(NotificationCardNoteView.prototype),NotificationCardNoteView}),define("home/templates/notificationFeedEmpty",["handlebars","handlebars.partials"],function(Handlebars){return Handlebars.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var buffer="",escapeExpression=this.escapeExpression;return buffer+='\n<div class="empty-message">\n\n    \n    <svg class="art-empty-notifications" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 164.8 50" enable-background="new 0 0 164.8 50" xml:space="preserve"><path d="M0 11h13.7v3.6H0V11z" class="arm"/><path d="M15.4 11h4.2l18.1 37h-4.2L15.4 11z" class="arm"/><path d="M39 44.2h24.2V48H39V44.2z" class="arm"/><path d="M101.6 44.2h24.2V48h-24.2V44.2z" class="arm"/><path d="M145 11h4.2l-18.1 37h-4.2L145 11z" class="arm"/><path d="M151.1 11h13.7v3.6h-13.7V11z" class="arm"/><path d="M57.9 25c0-13.8 11.2-25 25-25s25 11.2 25 25s-11.2 25-25 25 S57.9 38.8 57.9 25z" class="body"/><path d="M71.1 20.7C71.8 26.5 76.8 31 82.9 31s11-4.5 11.8-10.3c-2.3 2.2-6.7 3-11.8 3S73.4 22.9 71.1 20.7z" class="mouth"/><path d="M63.3 16c0-2.1 1.8-3.9 4-3.9c2.2 0 4 1.7 4 3.9s-1.8 3.9-4 3.9 C65.1 19.9 63.3 18.1 63.3 16z" class="eye"/><path d="M94.4 15.6c0-2.1 1.8-3.8 4-3.8c2.2 0 4 1.7 4 3.8 c0 2.1-1.8 3.8-4 3.8C96.2 19.5 94.4 17.8 94.4 15.6z" class="eye"/></svg>\n\n    <div class="notifications-empty-headline">'+escapeExpression(helpers.gettext.call(depth0,"No Notifications",{hash:{},data:data}))+"</div>\n    "+escapeExpression(helpers.gettext.call(depth0,"You must be new. Or quiet.",{hash:{},data:data}))+"\n</div>\n"})}),define("home/views/NotificationFeedEmptyView",["backbone-marionette","home/templates/notificationFeedEmpty"],function(Marionette,notificationFeedEmptyTemplate){var NotificationFeedEmptyView=Marionette.ItemView.extend({template:notificationFeedEmptyTemplate});return NotificationFeedEmptyView}),define("home/views/NotificationCardCollectionView",["jquery","home/views/ActivityCardCollectionView","home/views/NotificationCardUpvoteView","home/views/NotificationCardReplyView","home/views/NotificationCardFollowView","home/views/NotificationCardNoteView","home/views/NotificationFeedEmptyView"],function($,ActivityCardCollectionView,NotificationCardUpvoteView,NotificationCardReplyView,NotificationCardFollowView,NotificationCardNoteView,NotificationFeedEmptyView){var NotificationCardCollectionView=ActivityCardCollectionView.extend({itemView:function(options){switch(options.model.get("verb")){case"favorite":return new NotificationCardUpvoteView({model:options.model});case"reply":return new NotificationCardReplyView({model:options.model});case"follow":return new NotificationCardFollowView({model:options.model});case"send":return new NotificationCardNoteView({model:options.model})}},emptyView:NotificationFeedEmptyView,initialize:function(){ActivityCardCollectionView.prototype.initialize.apply(this,arguments),this.listenTo(this,"after:item:added",this.onShowNotification)},onShowNotification:function(){this.isShowingNonItemView()||(this.model.trigger("clearUnreadCount"),this.stopListening(this,"after:item:added",this.onShowNotification))},appendHtml:function(collectionView,itemView,index){collectionView.isBuffering&&collectionView._bufferedChildren.push(itemView);var childrenContainer=collectionView.isBuffering?$(collectionView.elBuffer):collectionView.$el,children=childrenContainer.children();children.size()<=index?childrenContainer.append(itemView.el):children.eq(index).before(itemView.el)}});return NotificationCardCollectionView}),define("home/templates/notifications",["handlebars","handlebars.partials"],function(Handlebars){return Handlebars.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var buffer="",escapeExpression=this.escapeExpression;return buffer+='<div class="section-contained">\n    <div class="nav-notifs">\n        <div class="nav-notifs-body">\n            <h2 class="nav-notifs-title">'+escapeExpression(helpers.gettext.call(depth0,"Notifications",{hash:{},data:data}))+'</h2>\n            <div class="nav-notifs-settings dropdown" data-action="toggle-dropdown" data-dropdown="notif-settings">\n                <a data-toggle="dropdown" class="dropdown-toggle" href="#">\n                    <span class="icon-cog"></span>\n                </a>\n                <div class="dropdown-menu dropdown-notifs-settings">\n                    <header class="dropdown-notifs-settings-header">\n                        <h6>'+escapeExpression(helpers.gettext.call(depth0,"Control Your Notifications",{hash:{},data:data}))+'</h6>\n                        <p>Use these settings to control what notifications you see from Disqus. To change email notifications <a href="#" data-action="notification-settings">head here</a>.</p>\n                    </header>\n                    <ul class="dropdown-notifs-settings-options">\n                        <li class="dropdown-notifs-settings-option">\n                            <label><input data-action="filter-toggle" data-filter="likepost" type="checkbox" name="upvotes" value="upvotes">Hide upvotes</label>\n                        </li>\n                    </ul>\n                </div>\n            </div>\n        </div>\n        <ul class="nav-tabs">\n            <li class="active" data-action="switch-tab" data-tab="all"><a class="truncate-line" href="#">'+escapeExpression(helpers.gettext.call(depth0,"Most Recent",{hash:{},data:data}))+'</a></li>\n            <li  data-action="switch-tab" data-tab="replies"><a class="truncate-line" href="#"><span class="icon-forward"></span>'+escapeExpression(helpers.gettext.call(depth0,"Replies",{hash:{},data:data}))+'</a></li>\n        </ul>\n    </div>\n    <div data-role="content-area" data-mix-location="notifications"></div>\n</div>\n'})}),define("home/views/NotificationsView",["underscore","jquery","home/views/common/TabbedView","home/views/common/FetchableCollectionLayout","home/views/NotificationCardCollectionView","home/models/Session","home/utils/settingsUtils","home/utils/releaseUtils","home/templates/notifications"],function(_,$,TabbedView,FetchableCollectionLayout,NotificationCardCollectionView,Session,settingsUtils,releaseUtils,notificationsTemplate){var NotificationsView=TabbedView.extend({defaultTab:"all",events:_.defaults({"click [data-action=filter-toggle]":"handleClickFilterCheckmark","click [data-action=notification-settings]":"openNotificationSettings"},TabbedView.prototype.events),template:notificationsTemplate,initialize:function(){TabbedView.prototype.initialize.apply(this,arguments),this.listenTo(this.model.filters,"sync",this.handleFiltersUpdate),this.model.filters.fetch()},openNotificationSettings:function(e){settingsUtils.openNotificationPane(e)},handleClickFilterCheckmark:function(evt){var target=$(evt.currentTarget),method=target.is(":checked")?"addFilter":"removeFilter",filterName=target.attr("data-filter");this.model.filters[method](filterName).done(_.bind(this.model.refetch,this.model))},handleFiltersUpdate:function(){var self=this;this.$("[data-action=filter-toggle]").each(function(){var target=$(this),filter=target.attr("data-filter");target.attr("checked",!!self.model.filters.get(filter))})},getTrackingSection:function(activeTab){return"replies"===activeTab&&activeTab},getTitle:function(){return"Notifications"},getTabView:function(activeTab){var view=new FetchableCollectionLayout({model:this.model[activeTab],collection:this.model[activeTab].get("items"),fetchableCollectionView:NotificationCardCollectionView});return view.$el.attr({"data-mix-location":activeTab}),view}});return NotificationsView}),define("home/templates/forumCover",["handlebars","handlebars.partials"],function(Handlebars){return Handlebars.template(function(Handlebars,depth0,helpers,partials,data){function program1(){return" active"}function program3(depth0,data){var stack1,helper,buffer="";return buffer+='\n    <h1 class="cover-title"><a href="',(helper=helpers.url)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.url,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'" target="_blank">',stack1=self.invokePartial(partials.forumName,"forumName",depth0,helpers,partials,data),(stack1||0===stack1)&&(buffer+=stack1),buffer+='</a></h1>\n    <div class="cover-community-url"><a href="',(helper=helpers.url)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.url,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'" target="_blank">',(helper=helpers.friendlyUrl)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.friendlyUrl,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"</a></div>\n    "}function program5(depth0,data){var stack1,buffer="";return buffer+='\n    <h1 class="cover-title">',stack1=self.invokePartial(partials.forumName,"forumName",depth0,helpers,partials,data),(stack1||0===stack1)&&(buffer+=stack1),buffer+='</h1>\n    <p class="cover-description">Trending discussions</p>\n    '}this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),partials=this.merge(partials,Handlebars.partials),data=data||{};var stack1,buffer="",functionType="function",escapeExpression=this.escapeExpression,self=this;return buffer+='<div class="cover-body-right">\n    <a href="#" class="btn btn-primary btn-follow',stack1=helpers["if"].call(depth0,depth0&&depth0.followed,{hash:{},inverse:self.noop,fn:self.program(1,program1,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+='" data-action="toggle-follow"><span class="symbol-default"><span class="icon-plus"></span></span><span class="text-default">Follow</span><span class="symbol-following"><span class="icon-checkmark"></span></span><span class="text-following">'+escapeExpression(helpers.gettext.call(depth0,"Following",{hash:{},data:data}))+'</span></a>\n</div>\n<div class="cover-body-left">\n    ',stack1=helpers["if"].call(depth0,depth0&&depth0.url,{hash:{},inverse:self.program(5,program5,data),fn:self.program(3,program3,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n</div>\n"})}),define("home/views/ForumCoverView",["underscore","backbone-marionette","home/utils/mixpanelUtils","home/utils/backboneUtils","home/models/Session","home/templates/forumCover"],function(_,Marionette,MixpanelUtils,backboneUtils,Session,forumCoverTemplate){var ForumCoverView=Marionette.ItemView.extend({attributes:{"data-mix-location":"cover"},className:"cover-body",template:forumCoverTemplate,templateHelpers:function(){return{friendlyUrl:this.model.getFriendlyUrl()}},events:{"click [data-action=toggle-follow]":"toggleFollow"},modelEvents:{"change:name":"render","change:followed":"handleFollowedClass"},initialize:function(){this.session=new Session,this.listenTo(this.session,"setModeratedForums",this.render)},handleFollowedClass:function(){this.$("[data-action=toggle-follow]").toggleClass("active",this.model.get("followed"))},toggleFollow:function(e){e&&e.preventDefault(),MixpanelUtils.track("follow forum",e,{properties:{follow:!this.model.get("followed")}}),this.model.toggleFollowed()},getTitle:function(){return backboneUtils.getPromiseFor(this.model,"name").then(function(forumName){return"Conversations - "+forumName})}},{getModel:function(model){return model.forum||model}});return ForumCoverView}),define("home/templates/topicCover",["handlebars","handlebars.partials"],function(Handlebars){return Handlebars.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var stack1,helper,buffer="",functionType="function",escapeExpression=this.escapeExpression;return buffer+='<div class="cover-body-left">\n    <h1 class="cover-title">',(helper=helpers.name)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.name,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'</h1>\n    <p class="cover-description">Trending discussions</p>\n</div>\n'})}),define("home/views/TopicCoverView",["backbone-marionette","home/utils/backboneUtils","home/templates/topicCover"],function(Marionette,backboneUtils,topicCoverTemplate){var TopicCoverView=Marionette.ItemView.extend({className:"cover-body",template:topicCoverTemplate,getTitle:function(){return backboneUtils.getPromiseFor(this.model,"name").then(function(topicName){return topicName.charAt(0).toUpperCase()+topicName.slice(1)})}},{getModel:function(model){return model.topic||model}});return TopicCoverView}),define("home/templates/profileCover",["handlebars","handlebars.partials"],function(Handlebars){return Handlebars.template(function(Handlebars,depth0,helpers,partials,data){function program1(depth0,data){var stack1,helper,buffer="";return buffer+='\n            <img src="'+escapeExpression((stack1=depth0&&depth0.avatar,stack1=null==stack1||stack1===!1?stack1:stack1.cache,typeof stack1===functionType?stack1.apply(depth0):stack1))+'" alt="',(helper=helpers.username)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.username,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'" />\n        '}function program3(depth0,data){var stack1,helper,buffer="";return buffer+='\n            <img src="',(helper=helpers.CDN_ROOT)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.CDN_ROOT,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'/img/avatar-default.png" />\n        '}function program5(depth0,data){var stack1,buffer="";return buffer+="\n        ",stack1=helpers["if"].call(depth0,depth0&&depth0.isPrivate,{hash:{},inverse:self.program(8,program8,data),fn:self.program(6,program6,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n    "}function program6(){return'\n            <a href="#" class="btn btn-disabled">Private <span class="icon-lock"></span></a>\n        '}function program8(depth0,data){var stack1,buffer="";return buffer+='\n            <a href="#" class="btn btn-primary btn-follow',stack1=helpers["if"].call(depth0,depth0&&depth0.isFollowing,{hash:{},inverse:self.noop,fn:self.program(9,program9,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+='" data-action="toggle-follow">\n                <span class="symbol-default">\n                    <span class="icon-plus"></span>\n                </span><span class="text-default">Follow</span><span class="symbol-following"><span class="icon-checkmark"></span></span><span class="text-following">Following</span>\n            </a>\n        '}function program9(){return" active"}function program11(){return'\n        <a href="#" class="btn btn-default"\n           data-action="show-edit-profile">Edit Profile</a>\n    '}function program13(depth0,data){var stack1,helper,buffer="";return buffer+='\n            <p class="cover-description">\n                ',(helper=helpers.about)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.about,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"\n            </p>\n        "}function program15(depth0,data){var stack1,helper,buffer="";return buffer+="\n                        ",(helper=helpers.numPosts)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.numPosts,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"\n                    "}function program17(){return"\n                        &nbsp;\n                    "}function program19(depth0,data){var stack1,helper,buffer="";return buffer+="\n                        ",(helper=helpers.numFollowers)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.numFollowers,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"\n                    "}function program21(depth0,data){var stack1,helper,buffer="";return buffer+="\n                        ",(helper=helpers.numTotalFollowing)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.numTotalFollowing,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"\n                    "}this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),partials=this.merge(partials,Handlebars.partials),data=data||{};var stack1,helper,buffer="",functionType="function",escapeExpression=this.escapeExpression,self=this;return buffer+='<div class="cover-user-avatar">\n    \n    <a href="/home/user/',(helper=helpers.username)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.username,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'" data-action="switch-tab">\n        ',stack1=helpers["if"].call(depth0,(stack1=depth0&&depth0.avatar,null==stack1||stack1===!1?stack1:stack1.cache),{hash:{},inverse:self.program(3,program3,data),fn:self.program(1,program1,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+='\n    </a>\n</div>\n<div class="cover-body">\n    <div class="cover-body-right">\n    ',stack1=helpers.unless.call(depth0,depth0&&depth0.isSessionUser,{hash:{},inverse:self.program(11,program11,data),fn:self.program(5,program5,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+='\n    </div>\n\n    <div class="cover-body-left">\n        \n        <a href="/home/user/',(helper=helpers.username)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.username,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'" data-action="switch-tab">\n            <h1 class="cover-title">',(helper=helpers.name)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.name,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"</h1>\n        </a>\n        ",stack1=helpers["if"].call(depth0,depth0&&depth0.about,{hash:{},inverse:self.noop,fn:self.program(13,program13,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n\n        ",stack1=self.invokePartial(partials.profileCoverAttributes,"profileCoverAttributes",depth0,helpers,partials,data),(stack1||0===stack1)&&(buffer+=stack1),buffer+='\n    </div>\n</div>\n<footer class="cover-meta">\n    <div class="cover-meta-right">\n        <ul class="cover-stats">\n            <li class="cover-stat active" data-action="switch-tab" data-tab="comments">\n                <a href="/home/user/',(helper=helpers.username)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.username,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'/comments">\n                    <strong>\n                    ',stack1=helpers["if"].call(depth0,depth0&&depth0.showNumPosts,{hash:{},inverse:self.program(17,program17,data),fn:self.program(15,program15,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+='\n                    </strong>\n                    <small>Comments</small>\n                </a>\n            </li>\n            <li class="cover-stat" data-action="switch-tab" data-tab="followers">\n                <a href="/home/user/',(helper=helpers.username)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.username,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'/followers">\n                    <strong data-role="num-followers">\n                    ',stack1=helpers["if"].call(depth0,depth0&&depth0.showNumFollowers,{hash:{},inverse:self.program(17,program17,data),fn:self.program(19,program19,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+='\n                    </strong>\n                    <small>Followers</small>\n                </a>\n            </li>\n            <li class="cover-stat" data-action="switch-tab" data-tab="following">\n                <a href="/home/user/',(helper=helpers.username)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.username,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'/following">\n                    <strong data-role="num-following">\n                    ',stack1=helpers["if"].call(depth0,depth0&&depth0.showNumTotalFollowing,{hash:{},inverse:self.program(17,program17,data),fn:self.program(21,program21,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+='\n                    </strong>\n                    <small>Following</small>\n                </a>\n            </li>\n        </ul>\n    </div>\n    <div class="cover-meta-left">\n        ',stack1=self.invokePartial(partials.profileCoverAttributes,"profileCoverAttributes",depth0,helpers,partials,data),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n    </div>\n</footer>\n"})}),define("home/templates/spinnerTall",["handlebars","handlebars.partials"],function(Handlebars){return Handlebars.template(function(Handlebars,depth0,helpers,partials,data){return this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{},'<div class="spinner-wrapper tall">\n    <div class="spinner tall"></div>\n</div>\n'})}),define("home/views/ProfileCoverView",["jquery","backbone-marionette","home/utils/mixpanelUtils","home/utils/settingsUtils","home/templates/profileCover","home/templates/spinnerTall"],function($,Marionette,MixpanelUtils,settingsUtils,profileCoverTemplate,spinnerTallTemplate){var ProfileCoverView=Marionette.ItemView.extend({attributes:{"data-mix-location":"profile cover"},template:function(data){return data.name?profileCoverTemplate(data):spinnerTallTemplate(data)},templateHelpers:function(){return{isSessionUser:this.model.isSessionUser(),numTotalFollowing:this.model.get("numFollowing")+this.model.get("numForumsFollowing"),showNumPosts:this.model.has("numPosts"),showNumFollowers:this.model.has("numFollowers"),showNumTotalFollowing:this.model.has("numFollowing")&&this.model.has("numForumsFollowing")}},events:{"click [data-action=toggle-follow]":"toggleFollow","click [data-action=show-edit-profile]":settingsUtils.openProfilePane},modelEvents:{"change:name":"render","change:isFollowing":"handleFollowedClass","change:numFollowers":"updateNumFollowers","change:numFollowing":"updateNumFollowing","change:numForumsFollowing":"updateNumFollowing"},handleFollowedClass:function(){this.$("[data-action=toggle-follow]").toggleClass("active",this.model.get("isFollowing"))},updateNumFollowers:function(){this.$("[data-role=num-followers]").text(this.model.get("numFollowers"))},updateNumFollowing:function(){this.$("[data-role=num-following]").text(this.model.get("numFollowing")+this.model.get("numForumsFollowing"))},toggleFollow:function(e){e&&e.preventDefault(),MixpanelUtils.track("follow user",e,{properties:{follow:!this.model.get("isFollowing")}}),this.model.toggleFollowed()},onDomRefresh:function(){$(".tooltipped").tooltip()}});return ProfileCoverView}),define("home/mixins/withItemRemovalSkipped",[],function(){var withItemRemovalSkipped=function(){var _addItemView=this.addItemView;this.addItemView=function(item){return this.children.findByModel(item)?void 0:_addItemView.apply(this,arguments)};var _removeItemView=this.removeItemView;this.removeItemView=function(){return this.isShowingNonItemView&&this.isShowingNonItemView()?_removeItemView.apply(this,arguments):void 0}};return withItemRemovalSkipped}),define("home/views/UserCollectionView",["underscore","home/utils/layoutUtils","home/utils/mixpanelUtils","home/mixins/withItemRemovalSkipped","home/views/UserCardView","home/views/common/FetchableCollectionView","home/mixins/withViewFeedTracking"],function(_,LayoutUtils,MixpanelUtils,withItemRemovalSkipped,UserCardView,FetchableCollectionView,withViewFeedTracking){var UserCollectionView=FetchableCollectionView.extend({itemView:UserCardView,onAfterItemAdded:LayoutUtils.scrollShownChanged,onShow:function(){var self=this;_.defer(function(){MixpanelUtils.track("view feed",{target:self.$el})})}});return withItemRemovalSkipped.call(UserCollectionView.prototype),withViewFeedTracking.call(UserCollectionView.prototype),UserCollectionView}),define("home/templates/userFeedEmpty",["handlebars","handlebars.partials"],function(Handlebars){return Handlebars.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var stack1,helper,buffer="",functionType="function",escapeExpression=this.escapeExpression;return buffer+='\n<div class="empty-message">\n\n    \n    <svg class="art-empty-user" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 284 78" enable-background="new 0 0 284 78" xml:space="preserve"><path d="M202.9 42.3c-9.2-24.6-33-42.2-60.9-42.2S90.4 17.7 81.1 42.3H91c0-0.2 0-0.3 0-0.5c0-5.5 4.7-10 10.5-10 c2.9 0 5.6 1.2 7.5 3c1.9 1.8 3 4.3 3 7c0 0.1 0 0.1 0 0.2c0 0.1 0 0.2 0 0.3h60.1h0c-0.1-0.5-0.1-1-0.1-1.5c0-2.6 1-4.9 2.7-6.6 c1.9-2.1 4.7-3.4 7.8-3.4c5.8 0 10.5 4.5 10.5 10c0 0.5-0.1 1-0.1 1.5H202.9z"/><path class="finger" d="M39 42c0-3.3 2.7-6 6-6H45c3.3 0 6 2.7 6 6v20.9c0 3.3-2.7 6-6 6 H45c-3.3 0-6-2.7-6-6V42z" /><path class="finger" d="M58.2 51.8c-3.3 0-6-2.6-6-5.9v-0.3c0-3.2 2.7-5.9 6-5.9H66 c3.3 0 6 2.6 6 5.9V46c0 3.2-2.7 5.9-6 5.9H58.2z" /><path class="finger" d="M0 42.7c0-3.3 2.7-6 5.9-6h0.1c3.3 0 5.9 2.7 5.9 6v15.4 c0 3.3-2.7 6-5.9 6H5.9c-3.3 0-5.9-2.7-5.9-6V42.7z" /><path class="finger" d="M13 42c0-3.3 2.7-6 6-6H19c3.3 0 6 2.7 6 6v20.9c0 3.3-2.7 6-6 6 H19c-3.3 0-6-2.7-6-6V42z" /><path class="finger" d="M26 39.8c0-3.3 2.7-6 6-6H32c3.3 0 6 2.7 6 6v32.1 c0 3.3-2.7 6-6 6H32c-3.3 0-6-2.7-6-6V39.8z" /><path class="finger" d="M245 42c0-3.3-2.7-6-5.9-6h-0.1c-3.3 0-5.9 2.7-5.9 6v20.9 c0 3.3 2.7 6 5.9 6h0.1c3.3 0 5.9-2.7 5.9-6V42z" /><path class="finger" d="M225.8 51.8c3.3 0 6-2.6 6-5.9v-0.3c0-3.2-2.7-5.9-6-5.9H218 c-3.3 0-6 2.6-6 5.9V46c0 3.2 2.7 5.9 6 5.9H225.8z" /><path class="finger" d="M284 42.7c0-3.3-2.7-6-6-6H278c-3.3 0-6 2.7-6 6v15.4 c0 3.3 2.7 6 6 6h0.1c3.3 0 6-2.7 6-6V42.7z" /><path class="finger" d="M271 42c0-3.3-2.7-6-6-6H265c-3.3 0-6 2.7-6 6v20.9 c0 3.3 2.7 6 6 6h0.1c3.3 0 6-2.7 6-6V42z" /><path class="finger" d="M258 39.8c0-3.3-2.7-6-5.9-6h-0.1c-3.3 0-5.9 2.7-5.9 6v32.1 c0 3.3 2.7 6 5.9 6h0.1c3.3 0 5.9-2.7 5.9-6V39.8z" /></svg>\n\n    \n    <div class="empty-user-line"></div>\n\n    <div> \n        ',(helper=helpers.name)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.name,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+' is a quiet soul. <a href="//disqus.com/follow/facebook/">Find and follow more vocal friends on Disqus &raquo;</a>\n    </div>\n</div>\n'
})}),define("home/views/UserActivityCardCollectionView",["underscore","home/views/ActivityCardCollectionView","home/views/FeedEmptyView","home/templates/userFeedEmpty"],function(_,ActivityCardCollectionView,FeedEmptyView,userFeedEmptyTemplate){return ActivityCardCollectionView.extend({initialize:function(options){ActivityCardCollectionView.prototype.initialize.apply(this,arguments),this.user=options.user},emptyViewOptions:function(){return{model:this.user}},emptyView:FeedEmptyView.extend({template:userFeedEmptyTemplate})})}),define("home/templates/forumCard",["handlebars","handlebars.partials"],function(Handlebars){return Handlebars.template(function(Handlebars,depth0,helpers,partials,data){function program1(){return" active"}this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),partials=this.merge(partials,Handlebars.partials),data=data||{};var stack1,helper,buffer="",self=this,escapeExpression=this.escapeExpression,functionType="function";return buffer+='<div class="card-forum">\n    <div class="card-aside">\n        \n        <button class="btn btn-light btn-follow',stack1=helpers["if"].call(depth0,depth0&&depth0.followed,{hash:{},inverse:self.noop,fn:self.program(1,program1,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+='" data-action="toggle-follow">\n            \n            <span class="symbol-default"><span class="icon-plus"></span></span><span class="text-default">Follow</span><span class="symbol-following"><span class="icon-checkmark"></span></span><span class="text-following">'+escapeExpression(helpers.gettext.call(depth0,"Following",{hash:{},data:data}))+'</span>\n        </button>\n    </div>\n    <div class="card-body">\n        ',stack1=self.invokePartial(partials.forumAvatar,"forumAvatar",depth0,helpers,partials,data),(stack1||0===stack1)&&(buffer+=stack1),buffer+='\n        <div class="forum-info">\n            <a class="link-gray-dark name" href="/home/forums/',(helper=helpers.id)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.id,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'">',stack1=self.invokePartial(partials.forumName,"forumName",depth0,helpers,partials,data),(stack1||0===stack1)&&(buffer+=stack1),buffer+='</a>\n            <p class="description">\n                <a href="',(helper=helpers.url)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.url,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'" target="_blank" class="link-gray">',(helper=helpers.url)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.url,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"</a>\n            </p>\n        </div>\n    </div>\n</div>\n"})}),define("home/views/ForumCardView",["backbone-marionette","home/utils/mixpanelUtils","home/templates/forumCard"],function(Marionette,MixpanelUtils,forumCardTemplate){var ForumCardView=Marionette.ItemView.extend({template:forumCardTemplate,className:"card",events:{"click [data-action=toggle-follow]":"toggleFollow"},modelEvents:{"change:followed":"handleFollowedClass"},handleFollowedClass:function(){this.$("[data-action=toggle-follow]").toggleClass("active",this.model.get("followed"))},toggleFollow:function(e){e&&e.preventDefault(),MixpanelUtils.track("follow forum",e,{properties:{follow:!this.model.get("followed")}}),this.model.toggleFollowed()}});return ForumCardView}),define("home/views/ForumCardCollectionView",["underscore","home/utils/layoutUtils","home/utils/mixpanelUtils","home/mixins/withItemRemovalSkipped","home/mixins/withViewFeedTracking","home/views/ForumCardView","home/views/common/FetchableCollectionView"],function(_,LayoutUtils,MixpanelUtils,withItemRemovalSkipped,withViewFeedTracking,ForumCardView,FetchableCollectionView){var ForumCollectionView=FetchableCollectionView.extend({itemView:ForumCardView,onAfterItemAdded:LayoutUtils.scrollShownChanged,onShow:function(){var self=this;_.defer(function(){MixpanelUtils.track("view feed",{target:self.$el})})}});return withItemRemovalSkipped.call(ForumCollectionView.prototype),withViewFeedTracking.call(ForumCollectionView.prototype),ForumCollectionView}),define("home/templates/profileFollowing",["handlebars","handlebars.partials"],function(Handlebars){return Handlebars.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var stack1,helper,buffer="",functionType="function",escapeExpression=this.escapeExpression;return buffer+='<ul class="nav-tabs">\n    <li class="active" data-action="switch-tab" data-tab="following">\n        <a href="#">\n            People\n            <span class="nav-tab-stat" data-role="num-following">',(helper=helpers.numFollowing)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.numFollowing,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'</span>\n        </a>\n    </li>\n    <li data-action="switch-tab" data-tab="forumsFollowing">\n        <a href="#">\n            Communities\n            <span class="nav-tab-stat" data-role="num-forums-following">',(helper=helpers.numForumsFollowing)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.numForumsFollowing,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'</span>\n        </a>\n    </li>\n</ul>\n<div data-role="content-area" data-mix-location="following"></div>\n<div data-role="footer-area"></div>\n'})}),define("home/views/ProfileFollowingView",["jquery","underscore","home/utils/layoutUtils","home/utils/trackingUtils","home/views/common/TabbedView","home/views/UserCollectionView","home/views/ForumCardCollectionView","home/views/common/FetchableCollectionFooterView","home/templates/profileFollowing"],function($,_,LayoutUtils,trackingUtils,TabbedView,UserCollectionView,ForumCardCollectionView,FetchableCollectionFooterView,profileFollowingTemplate){var ProfileFollowingView=TabbedView.extend({defaultTab:"following",template:profileFollowingTemplate,regions:_.defaults({footerRegion:"[data-role=footer-area]"},TabbedView.prototype.regions),modelEvents:{"change:numFollowing":"updateNumFollowing","change:numForumsFollowing":"updateNumForumsFollowing"},initialize:function(options){TabbedView.prototype.initialize.apply(this,arguments),this.userProfile=options.userProfile},getDefaultOptions:function(activeTab){return{model:this.userProfile[activeTab],collection:this.userProfile[activeTab].get("items")}},updateTabContent:function(activeTab){TabbedView.prototype.updateTabContent.apply(this,arguments),this.footerRegion.show(new FetchableCollectionFooterView(this.getDefaultOptions(activeTab)))},updateNumFollowing:function(){this.$("[data-role=num-following]").text(this.model.get("numFollowing"))},updateNumForumsFollowing:function(){this.$("[data-role=num-forums-following]").text(this.model.get("numForumsFollowing"))},getTrackingSection:function(activeTab){return"forumsFollowing"===activeTab?"following-communities":"following-default"},getTabView:function(activeTab){var view,defaultOptions=this.getDefaultOptions(activeTab);switch(activeTab){case"following":return view=new UserCollectionView(defaultOptions),view.$el.attr({"data-mix-location":"users"}),view;case"forumsFollowing":return view=new ForumCardCollectionView(defaultOptions),view.$el.attr({"data-mix-location":"forums"}),view}}});return ProfileFollowingView}),define("home/templates/profileView",["handlebars","handlebars.partials"],function(Handlebars){return Handlebars.template(function(Handlebars,depth0,helpers,partials,data){return this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{},'<div class="section-contained">\n    <div class="cover user" data-role="cover-area"></div>\n    <div id="container-content" data-role="content-area" data-mix-location="feed"></div>\n</div>\n'})}),define("home/templates/privateProfile",["handlebars","handlebars.partials"],function(Handlebars){return Handlebars.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var buffer="";return buffer+='<div class="empty-message empty-message-private">\n    <div class="empty-message-private-face-wrapper">\n        <svg class="art-private-sunglasses"xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 150.5 25" enable-background="new 0 0 150.5 25" xml:space="preserve">\n            <polygon points="10.5,0 10.5,5 31.5,5 31.5,10 35.5,10 35.5,15 40.5,15 40.5,20 45.5,20 45.5,25 80.5,25 80.5,20 85.5,20 85.5,15 90.5,15 90.5,10 100.5,10 100.5,15 105.5,15 105.5,20 140.5,20 140.5,15 145.5,15 145.5,10 150.5,10 150.5,5 150.5,0"/>\n            <rect x="0.5" y="5" width="10" height="5"/>\n            <rect x="40.5" y="5" width="5" height="5" class="shading"/>\n            <rect x="45.5" y="10" width="5" height="5" class="shading"/>\n            <rect x="50.5" y="15" width="5" height="5" class="shading"/>\n            <rect x="60.5" y="15" width="5" height="5" class="shading"/>\n            <rect x="55.5" y="10" width="5" height="5" class="shading"/>\n            <rect x="110.5" y="10" width="5" height="5" class="shading"/>\n            <rect x="120.5" y="10" width="5" height="5" class="shading"/>\n            <rect x="50.5" y="5" width="5" height="5" class="shading"/>\n            <rect x="105.5" y="5" width="5" height="5" class="shading"/>\n            <rect x="115.5" y="5" width="5" height="5" class="shading"/>\n        </svg>\n        <svg class="art-private-face" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 130 130" enable-background="new 0 0 130 130" xml:space="preserve"><circle cx="65" cy="65" r="65"/><path d="M14 41.6c0-5.5 4.7-10 10.5-10S35 36.1 35 41.6s-4.7 10-10.5 10 S14 47.2 14 41.6z"/><path d="M95 40.6c0-5.5 4.7-10 10.5-10s10.5 4.5 10.5 10s-4.7 10-10.5 10 S95 46.2 95 40.6z"/><rect x="51" y="62.6" width="46" height="4"/></svg>\n    </div>\n    <div> \n        <svg class="art-private-text" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 240 35" enable-background="new 0 0 240 35" xml:space="preserve">\n            <rect x="80" width="5" height="35"/>\n            <polygon points="165,0 160,0 160,10 155,10 155,15 160,15 160,35 165,35 165,15 170,15 170,10 165,10"/>\n            <polygon points="180,10 180,0 175,0 175,35 180,35 180,15 190,15 190,10"/>\n            <rect x="190" y="15" width="5" height="20"/>\n            <polygon points="5,30 5,5 20,5 20,0 0,0 0,35 20,35 20,30"/>\n            <polygon points="45,20 35,20 35,15 30,15 30,30 35,30 35,25 50,25 50,15 45,15"/>\n            <rect x="35" y="10" width="10" height="5"/>\n            <polygon points="60,10 60,15 70,15 70,30 60,30 60,35 75,35 75,10"/>\n            <rect x="105" y="10" width="5" height="20"/>\n            <rect x="120" y="10" width="5" height="20"/>\n            <rect x="135" y="10" width="5" height="20"/>\n            <rect x="145" y="10" width="5" height="25"/>\n            <rect x="145" width="5" height="5"/>\n            <polygon points="235,10 235,0 230,0 230,10 225,10 225,15 230,15 230,35 235,35 235,15 240,15 240,10"/>\n            <rect x="215" y="10" width="5" height="25"/>\n            <rect x="215" width="5" height="5"/>\n            <rect x="110" y="30" width="10" height="5"/>\n            <rect x="125" y="30" width="10" height="5"/>\n            <rect x="35" y="30" width="10" height="5"/>\n            <rect x="55" y="15" width="5" height="15"/>\n            <rect x="20" y="5" width="5" height="25"/>\n        </svg>\n    </div>\n    This user\'s activity is private <span class="icon-lock"></span>\n</div>\n'})}),define("home/views/ProfileView",["underscore","backbone","backbone-marionette","home/utils/layoutUtils","home/utils/backboneUtils","home/views/common/TabbedView","home/views/ProfileCoverView","home/views/common/FetchableCollectionLayout","home/views/UserCollectionView","home/views/UserActivityCardCollectionView","home/views/ProfileFollowingView","home/templates/profileView","home/templates/spinnerTall","home/templates/privateProfile"],function(_,Backbone,Marionette,LayoutUtils,backboneUtils,TabbedView,ProfileCoverView,FetchableCollectionLayout,UserCollectionView,UserActivityCardCollectionView,ProfileFollowingView,profileViewTemplate,spinnerTallTemplate,privateProfileTemplate){var ProfileView=TabbedView.extend({defaultTab:"comments",template:function(data){return data.user.name?profileViewTemplate:spinnerTallTemplate},regions:_.defaults({coverRegion:"[data-role=cover-area]"},TabbedView.prototype.regions),initialize:function(){TabbedView.prototype.initialize.apply(this,arguments),this.listenTo(this.model.user,"sync",this.render)},getTitle:function(){return backboneUtils.getPromiseFor(this.model.user,"name").then(function(userDisplayName){return"Profile - "+userDisplayName})},updateTabContent:function(){if(this.model.isPrivate()){this.contentRegion.show(new Marionette.ItemView({template:privateProfileTemplate}));var self=this;_.defer(function(){self.$(".empty-message-private").addClass("loaded")})}else TabbedView.prototype.updateTabContent.apply(this,arguments)},onDomRefresh:function(){this.$(this.coverRegion.el).length&&this.coverRegion.show(new ProfileCoverView({model:this.model.user})),TabbedView.prototype.onDomRefresh.apply(this,arguments)},getTrackingSection:function(activeTab){switch(activeTab){case"following":return"following";case"followers":return"followers"}},getTabView:function(activeTab){var view;switch(activeTab){case"following":return new ProfileFollowingView({model:this.model.user,userProfile:this.model});case"followers":return view=new FetchableCollectionLayout({model:this.model.followers,collection:this.model.followers.get("items"),fetchableCollectionView:UserCollectionView}),view.$el.attr({"data-mix-location":"followers"}),view;case"comments":return view=new FetchableCollectionLayout({model:this.model.posts,collection:this.model.posts.get("items"),user:this.model.user,fetchableCollectionView:UserActivityCardCollectionView}),view.$el.attr({"data-mix-location":"profile"}),view;case"profileFeed":return view=new FetchableCollectionLayout({model:this.model.profileFeed,collection:this.model.profileFeed.get("items"),user:this.model.user,fetchableCollectionView:UserActivityCardCollectionView}),view.$el.attr({"data-mix-location":"profile"}),view}}});return ProfileView}),define("home/templates/discussionForm",["handlebars","handlebars.partials"],function(Handlebars){return Handlebars.template(function(Handlebars,depth0,helpers,partials,data){function program1(){return'\n                <div class="discussion-guidelines">\n                    <button class="btn btn-light" data-action="show-guidelines">Guidelines</button>\n                </div>\n                '}function program3(depth0,data){var buffer="";return buffer+="\n                            "+escapeExpression(helpers.gettext.call(depth0,"Post a new Discussion",{hash:{},data:data}))+"\n                        "}function program5(depth0,data){var buffer="";return buffer+="\n                            "+escapeExpression(helpers.gettext.call(depth0,"Update your Discussion",{hash:{},data:data}))+"\n                        "}function program7(depth0,data){var buffer="";return buffer+='\n                                <span class="text-desktop">'+escapeExpression(helpers.gettext.call(depth0,"Create Discussion",{hash:{},data:data}))+'</span><span class="text-mobile">'+escapeExpression(helpers.gettext.call(depth0,"Create",{hash:{},data:data}))+"</span>\n                            "}function program9(depth0,data){var buffer="";return buffer+='\n                                <span class="text-desktop">'+escapeExpression(helpers.gettext.call(depth0,"Update Discussion",{hash:{},data:data}))+'</span><span class="text-mobile">'+escapeExpression(helpers.gettext.call(depth0,"Update",{hash:{},data:data}))+"</span>\n                            "}this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var stack1,helper,buffer="",escapeExpression=this.escapeExpression,self=this,functionType="function";return buffer+='<div class="discussion-form-wrapper">\n    <div class="section-contained">\n        <div class="container-3-col">\n            <div class="col-left">\n                <div class="discussion-meta">\n                    <h2 class="discussion-form-heading">Create a new Discussion</h2>\n                    <div data-role="creator-info"></div>\n                    <div data-role="channel-info"></div>\n                </div>\n                ',stack1=helpers["if"].call(depth0,(stack1=depth0&&depth0.forum,null==stack1||stack1===!1?stack1:stack1.guidelines),{hash:{},inverse:self.noop,fn:self.program(1,program1,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+='\n            </div>\n            <div class="col-middle">\n                <form class="discussion-form">\n                    <h2 class="discussion-form-heading">\n                        ',stack1=helpers["if"].call(depth0,depth0&&depth0.isNew,{hash:{},inverse:self.program(5,program5,data),fn:self.program(3,program3,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+='\n                    </h2>\n                    <h3 class="discussion-form-heading small">Title</h3>\n                    <section data-attribute="title" class="form-attribute-input">\n                        <input class="discussion-form-title" name="title" type="text" placeholder="Title your discussion" value="',(helper=helpers.title)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.title,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'">\n                        <div data-role="attribute-error" class="form-message-error"></div>\n                    </section>\n                    <h3 class="discussion-form-heading small">Caption or Link <small>(Optional)</small></h3>\n                    <div data-role="postbox"></div>\n                    <div class="discussion-form-actions">\n                        <div class="spinner-small"></div>\n                        <button type="submit" class="discussion-form-action discussion-form-post btn btn-default">\n                            ',stack1=helpers["if"].call(depth0,depth0&&depth0.isNew,{hash:{},inverse:self.program(9,program9,data),fn:self.program(7,program7,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+='\n                        </button>\n                        <button type="button" data-action="cancel-create" class="discussion-form-action btn btn-light-solid">Cancel</button>\n                    </div>\n                    <p class="discussion-form-explain">This post box is exactly like a regular Disqus comment box. Add images by pasting in a link (http://example.com/picture.png). You can also use basic HTML formatting tags including &lt;a&gt;, &lt;strong&gt;, and &lt;em&gt;.</br></br><strong>You must <a href="https://disqus.com/next/verify/?f=channel-discussdisqus">verify your email</a> address in order to post on this forum.</strong></p>\n                </form>\n            </div>\n        </div>\n    </div>\n</div>\n'})}),define("home/templates/discussionChannelInfo",["handlebars","handlebars.partials"],function(Handlebars){return Handlebars.template(function(Handlebars,depth0,helpers,partials,data){function program1(depth0,data){var stack1,helper,buffer="";return buffer+='\n        <img class="favicon" src="'+escapeExpression((stack1=depth0&&depth0.options,stack1=null==stack1||stack1===!1?stack1:stack1.favicon,typeof stack1===functionType?stack1.apply(depth0):stack1))+'" alt="',(helper=helpers.name)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.name,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'"/>\n    '}this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var stack1,helper,buffer="",functionType="function",escapeExpression=this.escapeExpression,self=this;return buffer+='<div class="discussion-origin-what">\n    '+escapeExpression(helpers.gettext.call(depth0,"Channel",{hash:{},data:data}))+'\n</div>\n<a class="discussion-origin-name truncate-line" href="/home/channel/',(helper=helpers.slug)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.slug,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'">\n    ',stack1=helpers["if"].call(depth0,(stack1=depth0&&depth0.options,null==stack1||stack1===!1?stack1:stack1.favicon),{hash:{},inverse:self.noop,fn:self.program(1,program1,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n    ",(helper=helpers.name)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.name,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"\n</a>\n"})}),define("home/templates/discussionUserInfo",["handlebars","handlebars.partials"],function(Handlebars){return Handlebars.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var stack1,helper,buffer="",escapeExpression=this.escapeExpression,functionType="function";return buffer+='<div class="discussion-origin-what">\n    '+escapeExpression(helpers.gettext.call(depth0,"Creator",{hash:{},data:data}))+'\n</div>\n<a class="discussion-origin-name truncate-line" href="/home/user/',(helper=helpers.username)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.username,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'">\n    <img class="favicon" src="'+escapeExpression((stack1=depth0&&depth0.avatar,stack1=null==stack1||stack1===!1?stack1:stack1.cache,typeof stack1===functionType?stack1.apply(depth0):stack1))+'" alt="',(helper=helpers.name)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.name,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'" />\n    ',(helper=helpers.name)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.name,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"\n</a>\n"})}),define("home/templates/guidelines",["handlebars","handlebars.partials"],function(Handlebars){return Handlebars.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),partials=this.merge(partials,Handlebars.partials),data=data||{};var stack1,buffer="",self=this,functionType="function",escapeExpression=this.escapeExpression;return buffer+='<div class="guidelines-modal">\n    <div class="guidelines-modal-header">\n        <div class="discussion-origin">\n            ',stack1=self.invokePartial(partials.channelAvatar,"channelAvatar",depth0,helpers,partials,data),(stack1||0===stack1)&&(buffer+=stack1),buffer+=" ",stack1=self.invokePartial(partials.channelLink,"channelLink",depth0,helpers,partials,data),(stack1||0===stack1)&&(buffer+=stack1),buffer+='\n        </div>\n        <h4>Community Guidelines</h4>\n    </div>\n    <div class="guidelines-modal-description">'+escapeExpression((stack1=depth0&&depth0.primaryForum,stack1=null==stack1||stack1===!1?stack1:stack1.guidelines,typeof stack1===functionType?stack1.apply(depth0):stack1))+"</div>\n</div>\n"})}),define("home/templates/threadSubmitError",["handlebars","handlebars.partials"],function(Handlebars){return Handlebars.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var stack1,buffer="",escapeExpression=this.escapeExpression,functionType="function";return buffer+='<div class="modal-header">\n    <h4 class="modal-title">'+escapeExpression(helpers.gettext.call(depth0,"Uh oh, we weren't unable to save your discussion",{hash:{},data:data}))+'</h4>\n</div>\n<div class="modal-body">\n    <p>'+escapeExpression((stack1=depth0&&depth0.responseJSON,stack1=null==stack1||stack1===!1?stack1:stack1.response,typeof stack1===functionType?stack1.apply(depth0):stack1))+"</p>\n</div>\n"})}),define("home/views/DiscussionFormView",["underscore","backbone","backbone-marionette","home/models/common/UniqueModel","home/models/Thread","home/templates/discussionForm","home/utils/features","home/utils/backboneUtils","home/utils/confirmModal","home/models/Post","home/views/PostReplyView","home/utils/releaseUtils","home/templates/discussionChannelInfo","home/templates/discussionUserInfo","home/templates/guidelines","home/templates/threadSubmitError"],function(_,Backbone,Marionette,UniqueModel,Thread,discussionFormTemplate,featureUtils,backboneUtils,confirmModal,Post,PostReplyView,releaseUtils,discussionChannelInfoTmpl,discussionUserInfoTmpl,guidelinesTemplate,threadSubmitErrorTemplate){return Marionette.Layout.extend({template:discussionFormTemplate,templateHelpers:function(){return{isNew:this.model.isNew()}},events:{submit:"submitThread","click [data-action=show-guidelines]":"showGuidelines","click [data-action=cancel-create]":"navigateBack","blur input[name=title]":"updateTitle"},ui:{title:"[name=title]"},regions:{postboxRegion:"[data-role=postbox]",creatorRegion:"[data-role=creator-info]",channelRegion:"[data-role=channel-info]"},initialize:function(options){this.model=options.thread?options.thread:new Thread({forum:options.forum}),this.listenTo(this.model,"invalid",this.handleValidationError),this.session=options.session,this.model.forum.shouldFetch()&&this.model.forum.fetch(),this.listenToOnce(this.model,"change:id",function(){UniqueModel.set(Thread,this.model)})},getThread:function(){return this.model},getTitle:function(){return backboneUtils.getPromiseFor(this.model.forum,"name").then(function(name){return"- Create new discussion on "+name})},onDomRefresh:function(){return this.session.fetched?(this.postboxRegion.show(this.createPostbox()),this.creatorRegion.show(new Marionette.ItemView({model:this.session.user,template:discussionUserInfoTmpl,className:"discussion-origin"})),void(this.model.forum.channel&&this.channelRegion.show(new Marionette.ItemView({model:this.model.forum.channel,template:discussionChannelInfoTmpl,className:"discussion-origin"})))):void this.session.fetch().then(_.bind(this.onDomRefresh,this))},submitThread:function(ev){ev.preventDefault();var postbox,message;this._submitLocked||(postbox=this.postboxRegion.currentView,message=postbox.textarea.get(),this._submitLocked=this.model.save({title:this.ui.title.val(),message:message},{success:_.bind(this.handleThreadCreate,this),error:_.bind(this.handleSaveError,this)}),this._submitLocked&&this.$el.find("form").addClass("is-submitting"))},createPostbox:function(){var post=new Post({thread:this.model,author:this.session.user.id,message:this.model.get("raw_message")||this.model.get("message")});return new PostReplyView({model:post,placeholder:"Have something to say or share?",session:this.session,canUseContentEditable:featureUtils.canUseContentEditable(),showSubmitButton:!1,showAvatar:!1})},handleThreadCreate:function(){this.trigger("createThread")},updateTitle:function(){this.model.set({title:this.ui.title.val()}),this.updateValidationErrors()},updateValidationErrors:function(){this.$(".form-attribute-input").removeClass("is-errored"),this.model.isValid()},handleValidationError:function(model,err){this.$(".form-attribute-input[data-attribute="+err.attrName+"]").addClass("is-errored").find("[data-role=attribute-error]").text(err.message)},handleSaveError:function(thread,response){this._submitLocked=!1,this.$("form").removeClass("is-submitting"),confirmModal.confirmationPromise(confirmModal.TYPES.CLOSE,threadSubmitErrorTemplate(response))},showGuidelines:function(){confirmModal.confirmationPromise(confirmModal.TYPES.CLOSE,guidelinesTemplate(this.model.forum.channel.toJSON()))},navigateBack:function(){window.history.back()}})}),define("home/models/ForumFeed",["underscore","backbone","home/collections/FeedItemCollection","home/models/common/UniqueModel","home/models/Forum","home/models/Feed","core/api"],function(_,Backbone,FeedItemCollection,UniqueModel,Forum,Feed,api){var ForumFeed=Feed.extend({initialize:function(attrs,options){this.initializeRelated("forum",_.defaults({forum:{id:this.id}},options),Forum),Feed.prototype.initialize.call(this,{},{collectionClass:FeedItemCollection,collectionUrl:api.getURL("timelines/activities?type=profile")}),this.set({fetchOptions:{target:"forum:"+this.id}})},shouldFetch:function(){return this.forum.shouldFetch()||!this.get("items").length&&!this.get("fetching")},fetch:function(options){this.forum.shouldFetch()&&this.forum.fetch(options),this.get("items").length||this.get("fetching")||this.fetchItems(options)},parse:function(response){return response.response}});return UniqueModel.addType("ForumFeed",ForumFeed),ForumFeed}),define("home/models/Channel",["underscore","backbone","home/models/common/UniqueModel","home/models/Feed","home/models/Forum","home/collections/FeedItemCollection","home/collections/UserCollection","home/collections/ForumCollection","core/api"],function(_,Backbone,UniqueModel,Feed,Forum,FeedItemCollection,UserCollection,ForumCollection,api){var Channel=Backbone.Model.extend({defaults:{primaryForum:{},slug:null,name:null,options:{}},idAttribute:"slug",url:function(){return api.getURL("channels/details?channel="+this.id)},parse:function(response){return response.response||response},initialize:function(attrs,options){this.buildPrimaryForum(options)},buildPrimaryForum:function(options){var forum=options&&options.primaryForum||this.get("primaryForum");return _.isEmpty(forum)?void this.listenToOnce(this,"change:primaryForum",_.bind(this.buildPrimaryForum,this,options)):(Forum||(Forum=require("home/models/Forum")),this.initializeRelated("primaryForum",_.defaults({channel:this},options),Forum),void this.trigger("changeRelated:primaryForum"))},shouldFetch:function(){return!this.get("name")||!this.primaryForum},toJSON:function(){var json=Backbone.Model.prototype.toJSON.apply(this,arguments);return _.defaults({primaryForum:this.primaryForum?this.primaryForum.toJSON():{}},json)},ensureFetched:function(){this.shouldFetch()&&this.fetch()}});return UniqueModel.addType("Channel",Channel),Channel}),define("home/models/ChannelProfile",["underscore","backbone","home/models/common/UniqueModel","home/models/Feed","home/models/Channel","home/collections/FeedItemCollection","home/collections/UserCollection","home/collections/ForumCollection","core/api"],function(_,Backbone,UniqueModel,Feed,Channel,FeedItemCollection,UserCollection,ForumCollection,api){var ChannelProfile=Backbone.Model.extend({defaults:{channel:void 0},initialize:function(attrs,options){this.initializeRelated("channel",options,Channel);var fetchOptions={target:"channel:"+this.channel.id};this.recentActivities=new Feed({fetchOptions:fetchOptions},{collectionClass:FeedItemCollection,collectionUrl:api.getURL("timelines/activities?type=profile")}),this.topActivities=new Feed({fetchOptions:fetchOptions},{collectionClass:FeedItemCollection,collectionUrl:api.getURL("timelines/ranked?type=profile")}),this.createActivities=new Feed({fetchOptions:fetchOptions},{collectionClass:FeedItemCollection,collectionUrl:api.getURL("timelines/activities?type=profile&index=user_created_threads")}),fetchOptions={channel:this.channel.id},this.userSources=new Feed({fetchOptions:fetchOptions},{collectionClass:UserCollection,collectionUrl:api.getURL("channels/listSourceUsers")}),this.forumSources=new Feed({fetchOptions:fetchOptions},{collectionClass:ForumCollection,collectionUrl:api.getURL("channels/listSourceForums")})
},toJSON:function(){var json=Backbone.Model.prototype.toJSON.apply(this,arguments);return _.defaults({channel:this.channel.toJSON(),recentActivities:this.recentActivities.toJSON(),topActivities:this.topActivities.toJSON(),createActivities:this.createActivities.toJSON()},json)},ensureFetched:function(){this.channel.shouldFetch()&&this.channel.fetch(),this.recentActivities.get("items").fetched||this.recentActivities.fetchItems(),this.ensureFetchedTopActivities(),this.createActivities.get("items").fetched||this.createActivities.fetchItems(),this.userSources.get("items").fetched||(this.userSourcesPromise=this.userSources.fetchItems()),this.forumSources.get("items").fetched||(this.forumSourcesPromise=this.forumSources.fetchItems())},ensureFetchedTopActivities:function(){this.topActivities.get("items").fetched||this.topActivities.fetchItems()}});return UniqueModel.addType("ChannelProfile",ChannelProfile),ChannelProfile}),define("home/collections/common/SelectiveCollection",["jquery","underscore","backbone"],function($,_,Backbone){var SelectiveCollection=Backbone.Collection.extend({initialize:function(models,options){if(models)throw"SelectiveCollection should be initialized with undefined models to be allowed to populate itself from a given toSelect collection";if(!(options&&options.toSelect&&options.toSelect instanceof Backbone.Collection))throw"SelectiveCollection must be initialized with a toSelect collection";this.toSelect=options.toSelect,this.shouldSelect=options.shouldSelect||this.shouldSelect,this.maxSize=options.maxSize,this.order=options.order||this.order,this.selectFrom(this.toSelect)},selectFrom:function(collection){if(!collection.length)return void collection.once("sync",this.selectFrom,this);this.maxSize=_.isNumber(this.maxSize)?this.maxSize:collection.length;var stack=this.order(collection);this.resolveSelectability(stack.shift(),stack)},resolveSelectability:function(item,rest){if(item){var self=this;$.when(this.shouldSelect(item)).then(function(shouldSelect){shouldSelect&&self.select(item),self.length<self.maxSize&&self.resolveSelectability(rest.shift(),rest)})}},select:function(model){this.length>=this.maxSize||this.add(model)},shouldSelect:function(){return!0},order:function(collection){return collection.toArray()}});return SelectiveCollection}),define("home/views/common/DiscussionCoverBaseView",["jquery","backbone-marionette"],function($,Marionette){var DiscussionCoverBaseView=Marionette.ItemView.extend({modelEvents:{sync:"render","change:extending":"render"},templateHelpers:function(){var channel=this.channel;return{relativeTime:this.model.getRelativeCreatedAt(),channel:channel&&channel.toJSON(),image:this.model.getImage()}},initialize:function(options){this.channel=options.channel,this.channel&&this.listenTo(this.channel,"change",this.render)},onDomRefresh:function(){this.$(".truncate").each(function(index,el){$(el).trunk8({lines:$(el).data("truncateLines")||1})})}});return DiscussionCoverBaseView}),define("home/templates/networkDiscussionCover",["handlebars","handlebars.partials"],function(Handlebars){return Handlebars.template(function(Handlebars,depth0,helpers,partials,data){function program1(depth0){var stack1,buffer="";return buffer+="\n                                <img class='favicon' src=\""+escapeExpression((stack1=depth0&&depth0.forum,stack1=null==stack1||stack1===!1?stack1:stack1.favicon,stack1=null==stack1||stack1===!1?stack1:stack1.cache,typeof stack1===functionType?stack1.apply(depth0):stack1))+"\" alt='"+escapeExpression((stack1=depth0&&depth0.forum,stack1=null==stack1||stack1===!1?stack1:stack1.name,typeof stack1===functionType?stack1.apply(depth0):stack1))+"'/>\n                            "}function program3(depth0,data){var stack1,buffer="";return buffer+='\n                    <div class="discussion-origin">\n                        <div class="discussion-origin-what">\n                            '+escapeExpression(helpers.gettext.call(depth0,"Channel",{hash:{},data:data}))+'\n                        </div>\n                        <a class="discussion-origin-name truncate-line" href="/home/channel/'+escapeExpression((stack1=depth0&&depth0.channel,stack1=null==stack1||stack1===!1?stack1:stack1.slug,typeof stack1===functionType?stack1.apply(depth0):stack1))+'">\n                            ',stack1=helpers["if"].call(depth0,(stack1=depth0&&depth0.channel,stack1=null==stack1||stack1===!1?stack1:stack1.options,null==stack1||stack1===!1?stack1:stack1.favicon),{hash:{},inverse:self.noop,fn:self.program(4,program4,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n                            "+escapeExpression((stack1=depth0&&depth0.channel,stack1=null==stack1||stack1===!1?stack1:stack1.name,typeof stack1===functionType?stack1.apply(depth0):stack1))+"\n                        </a>\n                    </div>\n                    "}function program4(depth0){var stack1,buffer="";return buffer+='\n                                <img class="favicon" src="'+escapeExpression((stack1=depth0&&depth0.channel,stack1=null==stack1||stack1===!1?stack1:stack1.options,stack1=null==stack1||stack1===!1?stack1:stack1.favicon,typeof stack1===functionType?stack1.apply(depth0):stack1))+'" alt="'+escapeExpression((stack1=depth0&&depth0.channel,stack1=null==stack1||stack1===!1?stack1:stack1.name,typeof stack1===functionType?stack1.apply(depth0):stack1))+'"/>\n                            '}function program6(depth0,data){var buffer="";return buffer+="\n                            "+escapeExpression(helpers.gettext.call(depth0,"1 Comment",{hash:{},data:data}))+"\n                        "}function program8(depth0,data){var buffer="";return buffer+="\n                            "+escapeExpression(helpers.gettext.call(depth0,"%(number)s Comments",{hash:{number:depth0&&depth0.posts},data:data}))+"\n                        "}function program10(){return" no-image"}function program12(depth0){var stack1,buffer="";return buffer+='\n                    <div class="card-link-aside">\n                        <div class="card-link-image-wrap">\n                            <img class="card-link-image" src="'+escapeExpression((stack1=depth0&&depth0.image,stack1=null==stack1||stack1===!1?stack1:stack1.src,typeof stack1===functionType?stack1.apply(depth0):stack1))+'" alt="'+escapeExpression((stack1=depth0&&depth0.image,stack1=null==stack1||stack1===!1?stack1:stack1.title,typeof stack1===functionType?stack1.apply(depth0):stack1))+'">\n                        </div>\n                    </div>\n                    '}function program14(depth0,data){var stack1,helper,buffer="";return buffer+='\n                            <div>\n                                <p class="card-link-description truncate" data-truncate-lines="3">\n                                    ',(helper=helpers.description)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.description,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"\n                                </p>\n                            </div>\n                            ",stack1=helpers["if"].call(depth0,depth0&&depth0.forumFriendlyUrl,{hash:{},inverse:self.noop,fn:self.program(15,program15,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n                        "}function program15(depth0,data){var stack1,helper,buffer="";return buffer+='\n                                <div class="card-link-forum-url">(',(helper=helpers.forumFriendlyUrl)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.forumFriendlyUrl,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+")</div>\n                            "}this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var stack1,helper,options,buffer="",functionType="function",escapeExpression=this.escapeExpression,self=this,helperMissing=helpers.helperMissing;return buffer+='<div class="discussion-cover-wrapper network">\n    <div class="section-contained">\n        <div class="container-3-col discussion-cover">\n\n            <div class="col-left">\n                <div class="discussion-meta">\n                    <div class="discussion-origin">\n                        <div class="discussion-origin-what">\n                            '+escapeExpression(helpers.gettext.call(depth0,"Community",{hash:{},data:data}))+'\n                        </div>\n                        <a class="discussion-origin-name truncate-line" href="/home/forums/'+escapeExpression((stack1=depth0&&depth0.forum,stack1=null==stack1||stack1===!1?stack1:stack1.id,typeof stack1===functionType?stack1.apply(depth0):stack1))+'" data-role="publisher-link">\n                            ',stack1=helpers["if"].call(depth0,depth0&&depth0.hasFavicon,{hash:{},inverse:self.noop,fn:self.program(1,program1,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n                            "+escapeExpression((stack1=depth0&&depth0.forum,stack1=null==stack1||stack1===!1?stack1:stack1.name,typeof stack1===functionType?stack1.apply(depth0):stack1))+"\n                        </a>\n                    </div>\n                    ",stack1=helpers["if"].call(depth0,depth0&&depth0.channel,{hash:{},inverse:self.noop,fn:self.program(3,program3,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+='\n                </div>\n            </div>\n\n            <div class="col-middle">\n\n                <span class="discussion-post-count">\n                    <a href="#disqus_thread">\n                        ',helper=helpers.eq||depth0&&depth0.eq,options={hash:{},data:data},stack1=helper?helper.call(depth0,depth0&&depth0.posts,1,options):helperMissing.call(depth0,"eq",depth0&&depth0.posts,1,options),stack1=helpers["if"].call(depth0,stack1,{hash:{},inverse:self.program(8,program8,data),fn:self.program(6,program6,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+='\n                    </a>\n                </span>\n                <span class="discussion-timestamp time">\n                    Created ',(helper=helpers.relativeTime)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.relativeTime,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'\n                </span>\n\n                <a href="',(helper=helpers.link)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.link,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'"\n                    target="_blank"\n                    class="card-link',stack1=helpers.unless.call(depth0,depth0&&depth0.image,{hash:{},inverse:self.noop,fn:self.program(10,program10,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+='"\n                    data-role="article-link"\n                    data-mix-location="title">\n\n                    ',stack1=helpers["if"].call(depth0,depth0&&depth0.image,{hash:{},inverse:self.noop,fn:self.program(12,program12,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+='\n\n                    <div class="card-link-body">\n                        <h3 class="card-link-title">',(helper=helpers.clean_title)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.clean_title,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),(stack1||0===stack1)&&(buffer+=stack1),buffer+="</h3>\n                        ",stack1=helpers["if"].call(depth0,depth0&&depth0.description,{hash:{},inverse:self.noop,fn:self.program(14,program14,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n                    </div>\n                </a>\n\n            </div>\n        </div>\n    </div>\n</div>\n"})}),define("home/views/NetworkDiscussionCoverView",["underscore","home/views/common/DiscussionCoverBaseView","home/templates/networkDiscussionCover"],function(_,DiscussionCoverBaseView,networkDiscussionCoverTemplate){var NetworkDiscussionCoverView=DiscussionCoverBaseView.extend({template:networkDiscussionCoverTemplate,templateHelpers:function(){var existing=DiscussionCoverBaseView.prototype.templateHelpers.apply(this,arguments);return _.defaults({hasFavicon:this.model.forum.hasFavicon(),forumFriendlyUrl:this.model.forum.getFriendlyUrl(),description:this.model.getShortDescription()},existing)}});return NetworkDiscussionCoverView}),define("home/templates/userGeneratedDiscussionCover",["handlebars","handlebars.partials"],function(Handlebars){return Handlebars.template(function(Handlebars,depth0,helpers,partials,data){function program1(){return"is-deleted"}function program3(depth0,data){var stack1,buffer="";return buffer+='\n                    <div class="discussion-origin">\n                        <div class="discussion-origin-what">\n                            '+escapeExpression(helpers.gettext.call(depth0,"Channel",{hash:{},data:data}))+'\n                        </div>\n                        <a class="discussion-origin-name truncate-line" href="/home/channel/'+escapeExpression((stack1=depth0&&depth0.channel,stack1=null==stack1||stack1===!1?stack1:stack1.slug,typeof stack1===functionType?stack1.apply(depth0):stack1))+'">\n                            ',stack1=helpers["if"].call(depth0,(stack1=depth0&&depth0.channel,stack1=null==stack1||stack1===!1?stack1:stack1.options,null==stack1||stack1===!1?stack1:stack1.favicon),{hash:{},inverse:self.noop,fn:self.program(4,program4,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n                            "+escapeExpression((stack1=depth0&&depth0.channel,stack1=null==stack1||stack1===!1?stack1:stack1.name,typeof stack1===functionType?stack1.apply(depth0):stack1))+"\n                        </a>\n                    </div>\n                    "}function program4(depth0){var stack1,buffer="";return buffer+='\n                                <img class="favicon" src="'+escapeExpression((stack1=depth0&&depth0.channel,stack1=null==stack1||stack1===!1?stack1:stack1.options,stack1=null==stack1||stack1===!1?stack1:stack1.favicon,typeof stack1===functionType?stack1.apply(depth0):stack1))+'" alt="'+escapeExpression((stack1=depth0&&depth0.channel,stack1=null==stack1||stack1===!1?stack1:stack1.name,typeof stack1===functionType?stack1.apply(depth0):stack1))+'"/>\n                            '}function program6(){return'\n                    <div class="discussion-guidelines">\n                        <button class="btn btn-light" data-action="show-guidelines">Read Guidelines</button>\n                    </div>\n                    '}function program8(depth0,data){var buffer="";return buffer+="\n                            "+escapeExpression(helpers.gettext.call(depth0,"1 Comment",{hash:{},data:data}))+"\n                        "}function program10(depth0,data){var buffer="";return buffer+="\n                            "+escapeExpression(helpers.gettext.call(depth0,"%(number)s Comments",{hash:{number:depth0&&depth0.posts},data:data}))+"\n                        "}function program12(depth0,data){var stack1,helper,buffer="";return buffer+='\n                    <div class="discussion-description" data-role="message">\n                        ',(helper=helpers.description)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.description,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n                    </div>\n                "}function program14(depth0,data){var stack1,helper,buffer="";return buffer+='\n                <a href="',(helper=helpers.embedlyLink)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.embedlyLink,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'"\n                    target="_blank"\n                    class="card-link',stack1=helpers.unless.call(depth0,depth0&&depth0.image,{hash:{},inverse:self.noop,fn:self.program(15,program15,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+='"\n                    data-role="article-link"\n                    data-mix-location="title">\n\n                    ',stack1=helpers["if"].call(depth0,depth0&&depth0.image,{hash:{},inverse:self.noop,fn:self.program(17,program17,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+='\n\n                    <div class="card-link-body">\n                        ',stack1=helpers["if"].call(depth0,(stack1=depth0&&depth0.content,null==stack1||stack1===!1?stack1:stack1.title),{hash:{},inverse:self.noop,fn:self.program(19,program19,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n                        ",stack1=helpers["if"].call(depth0,(stack1=depth0&&depth0.content,null==stack1||stack1===!1?stack1:stack1.description),{hash:{},inverse:self.noop,fn:self.program(21,program21,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n                        ",stack1=helpers["if"].call(depth0,depth0&&depth0.forumFriendlyUrl,{hash:{},inverse:self.noop,fn:self.program(23,program23,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n                    </div>\n                </a>\n                "}function program15(){return" no-image"}function program17(depth0){var stack1,buffer="";return buffer+='\n                    <div class="card-link-aside">\n                        <div class="card-link-image-wrap">\n                            <img class="card-link-image" src="'+escapeExpression((stack1=depth0&&depth0.image,stack1=null==stack1||stack1===!1?stack1:stack1.src,typeof stack1===functionType?stack1.apply(depth0):stack1))+'" alt="'+escapeExpression((stack1=depth0&&depth0.image,stack1=null==stack1||stack1===!1?stack1:stack1.title,typeof stack1===functionType?stack1.apply(depth0):stack1))+'">\n                        </div>\n                    </div>\n                    '}function program19(depth0){var stack1,buffer="";return buffer+='\n                            <h3 class="card-link-title">'+escapeExpression((stack1=depth0&&depth0.content,stack1=null==stack1||stack1===!1?stack1:stack1.title,typeof stack1===functionType?stack1.apply(depth0):stack1))+"</h3>\n                        "}function program21(depth0){var stack1,buffer="";return buffer+='\n                            <div>\n                                <p class="card-link-description truncate" data-truncate-lines="3">\n                                    '+escapeExpression((stack1=depth0&&depth0.content,stack1=null==stack1||stack1===!1?stack1:stack1.description,typeof stack1===functionType?stack1.apply(depth0):stack1))+"\n                                </p>\n                            </div>\n                        "}function program23(depth0,data){var stack1,helper,buffer="";return buffer+='\n                            <div class="card-link-forum-url">(',(helper=helpers.forumFriendlyUrl)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.forumFriendlyUrl,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+")</div>\n                        "}function program25(depth0,data){var stack1,helper,buffer="";return buffer+='\n                    <div class="discussion-action">\n                        <a href="/home/edit/'+escapeExpression((stack1=depth0&&depth0.forum,stack1=null==stack1||stack1===!1?stack1:stack1.id,typeof stack1===functionType?stack1.apply(depth0):stack1))+"/",(helper=helpers.slug)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.slug,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'" class="btn btn-light-solid">Edit Post</a>\n                    </div>\n                '}function program27(){return'\n                    <div class="discussion-action">\n                        <a href="#" data-action="delete-thread" class="btn btn-light-solid">Remove</a>\n                    </div>\n                '}function program29(){return'\n                    <div class="alert-message alert-message-red alert-message-side">\n                        <h4>This discussion has been removed</h4>\n                        <p>Seem wrong? Contact <a href="http://disqus.com/support">Disqus Support</a>.</p>\n                    </div>\n                '}this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var stack1,helper,options,buffer="",functionType="function",escapeExpression=this.escapeExpression,self=this,helperMissing=helpers.helperMissing;return buffer+='<div class="discussion-cover-wrapper">\n    <div class="section-contained">\n        <div class="container-3-col discussion-cover ',stack1=helpers["if"].call(depth0,depth0&&depth0.isDeleted,{hash:{},inverse:self.noop,fn:self.program(1,program1,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+='">\n\n            <div class="col-left">\n                <div class="discussion-meta">\n                    <div class="discussion-origin">\n                        <div class="discussion-origin-what">\n                            '+escapeExpression(helpers.gettext.call(depth0,"Creator",{hash:{},data:data}))+'\n                        </div>\n                        <a class="discussion-origin-name truncate-line" href="/home/user/'+escapeExpression((stack1=depth0&&depth0.author,stack1=null==stack1||stack1===!1?stack1:stack1.username,typeof stack1===functionType?stack1.apply(depth0):stack1))+'">\n                            <img class="favicon" src="'+escapeExpression((stack1=depth0&&depth0.author,stack1=null==stack1||stack1===!1?stack1:stack1.avatar,stack1=null==stack1||stack1===!1?stack1:stack1.cache,typeof stack1===functionType?stack1.apply(depth0):stack1))+'" alt="'+escapeExpression((stack1=depth0&&depth0.author,stack1=null==stack1||stack1===!1?stack1:stack1.name,typeof stack1===functionType?stack1.apply(depth0):stack1))+'" />\n                            '+escapeExpression((stack1=depth0&&depth0.author,stack1=null==stack1||stack1===!1?stack1:stack1.name,typeof stack1===functionType?stack1.apply(depth0):stack1))+"\n                        </a>\n                    </div>\n                    ",stack1=helpers["if"].call(depth0,depth0&&depth0.channel,{hash:{},inverse:self.noop,fn:self.program(3,program3,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n                    ",stack1=helpers["if"].call(depth0,(stack1=depth0&&depth0.forum,null==stack1||stack1===!1?stack1:stack1.guidelines),{hash:{},inverse:self.noop,fn:self.program(6,program6,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+='\n                </div>\n            </div>\n\n            <div class="col-middle">\n                <span class="discussion-post-count">\n                    <a href="#disqus_thread">\n                        ',helper=helpers.eq||depth0&&depth0.eq,options={hash:{},data:data},stack1=helper?helper.call(depth0,depth0&&depth0.posts,1,options):helperMissing.call(depth0,"eq",depth0&&depth0.posts,1,options),stack1=helpers["if"].call(depth0,stack1,{hash:{},inverse:self.program(10,program10,data),fn:self.program(8,program8,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+='\n                    </a>\n                </span>\n                <span class="discussion-timestamp time">\n                    Created ',(helper=helpers.relativeTime)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.relativeTime,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'\n                </span>\n                <h1 class="discussion-page-title">',(helper=helpers.clean_title)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.clean_title,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),(stack1||0===stack1)&&(buffer+=stack1),buffer+="</h1>\n\n                ",stack1=helpers["if"].call(depth0,depth0&&depth0.description,{hash:{},inverse:self.noop,fn:self.program(12,program12,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n\n                ",stack1=helpers["if"].call(depth0,depth0&&depth0.hasEmbedlyData,{hash:{},inverse:self.noop,fn:self.program(14,program14,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+='\n\n            </div>\n\n            <div class="col-right discussion-actions">\n                ',stack1=helpers["if"].call(depth0,depth0&&depth0.canEdit,{hash:{},inverse:self.noop,fn:self.program(25,program25,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n                ",stack1=helpers["if"].call(depth0,depth0&&depth0.canDelete,{hash:{},inverse:self.noop,fn:self.program(27,program27,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n                ",stack1=helpers["if"].call(depth0,depth0&&depth0.isDeleted,{hash:{},inverse:self.noop,fn:self.program(29,program29,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n            </div>\n        </div>\n    </div>\n</div>\n"})}),define("core/models/LegacyMedia",["backbone"],function(Backbone){var LegacyMedia=Backbone.Model.extend({defaults:{type:null,location:"",metadata:{}}});return LegacyMedia}),define("core/models/RichMedia",["backbone"],function(Backbone){var RichMedia=Backbone.Model.extend({idAttribute:"url",defaults:{mediaType:null,html:"",htmlWidth:null,htmlHeight:null,thumbnailUrl:"",thumbnailWidth:null,thumbnailHeight:null,url:"",resolvedUrl:"",title:"",description:"",providerName:""}});return RichMedia}),define("core/models/Media",["underscore","backbone","core/models/LegacyMedia","core/models/RichMedia"],function(_,Backbone,LegacyMedia,RichMedia){var Media=Backbone.Model.extend(_.extend({},RichMedia.prototype,LegacyMedia.prototype,{idAttribute:"id"}),{MEDIA_TYPES:{IMAGE:"1",IMAGE_UPLOAD:"2",YOUTUBE_VIDEO:"3",WEBPAGE:"4",TWITTER_STATUS:"5",FACEBOOK_PAGE:"6",FACEBOOK_POST:"7",FACEBOOK_PHOTO:"8",FACEBOOK_VIDEO:"9",SOUNDCLOUD_SOUND:"10",GOOGLE_MAP:"11",VIMEO_VIDEO:"12",VINE_VIDEO:"14"},WEBPAGE_TYPES:["4","6","7"]});return Media}),define("core/collections/MediaCollection",["backbone","core/models/Media"],function(Backbone,Media){var MediaCollection=Backbone.Collection.extend({model:Media});return MediaCollection}),define("core/mediaConfig",["underscore","backbone"],function(_,Backbone){function findClosestThumbnailSize(){var width=document.body.offsetWidth,thumbnailsWidths=MEDIA_PERSISTED_WIDTHS,len=thumbnailsWidths.length;return _.find(thumbnailsWidths,function(w,i){return i+1===len||Math.abs(thumbnailsWidths[i+1]-width)>Math.abs(thumbnailsWidths[i]-width)})}var MEDIA_PERSISTED_WIDTHS=[320,480,600,800],config=new Backbone.Model({collapsed:!1,defaultIframeHeight:300,mediaPersistedWidths:MEDIA_PERSISTED_WIDTHS,loadedThumbnailWidth:findClosestThumbnailSize()});return config.findClosestThumbnailSize=findClosestThumbnailSize,config}),define("core/models/RichMediaViewModel",["backbone"],function(Backbone){return Backbone.Model.extend({defaults:{deferred:!0,showButtons:!0,activated:!1,kind:"image",deferredHeight:0,providerExpandMessage:"",providerCollapseMessage:"",providerIcon:"icon-proceed",respectSettings:!0}})}),define("core/templates/postMediaInlineLink",["handlebars","handlebars.partials"],function(Handlebars){return Handlebars.template(function(Handlebars,depth0,helpers,partials,data){function program1(depth0,data){var stack1,helper,buffer="";return buffer+='\n    \n    <a href="',(helper=helpers.href)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.href,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'" rel="nofollow">',(helper=helpers.text)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.text,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"</a>\n"}function program3(depth0,data){var stack1,helper,buffer="";return buffer+='\n    \n    <a href="',(helper=helpers.href)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.href,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'" class="post-media-link" data-action="expand-collapse-media" rel="nofollow">',stack1=helpers["if"].call(depth0,(stack1=depth0&&depth0.model,null==stack1||stack1===!1?stack1:stack1.providerIcon),{hash:{},inverse:self.noop,fn:self.program(4,program4,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),(helper=helpers.mediaLinkText)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.mediaLinkText,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1),stack1=helpers["if"].call(depth0,depth0&&depth0.domain,{hash:{},inverse:self.noop,fn:self.program(6,program6,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="</a>\n"}function program4(depth0){var stack1,buffer="";return buffer+='<i class="'+escapeExpression((stack1=depth0&&depth0.model,stack1=null==stack1||stack1===!1?stack1:stack1.providerIcon,typeof stack1===functionType?stack1.apply(depth0):stack1))+'"></i>'}function program6(depth0,data){var stack1,helper,buffer="";return buffer+='<span class="post-media-link-domain"> &mdash; ',(helper=helpers.domain)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.domain,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"</span>"}this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var stack1,buffer="",functionType="function",escapeExpression=this.escapeExpression,self=this;return stack1=helpers["if"].call(depth0,(stack1=depth0&&depth0.model,null==stack1||stack1===!1?stack1:stack1.deferred),{hash:{},inverse:self.program(3,program3,data),fn:self.program(1,program1,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n"})}),define("core/views/RichMediaLinkView",["backbone","handlebars","core/utils","core/templates/postMediaInlineLink"],function(Backbone,Handlebars,utils,postMediaInlineLinkTemplate){return Backbone.View.extend({tagName:"span",events:{"click [data-action=expand-collapse-media]":"handleToggle"},initialize:function(options){this.media=options.media;var $link=options.$link;this.linkText=$link.text(),this.linkHref=$link.attr("href"),this.linkDomain=utils.getDomain(this.linkHref);var isUserText=this.isUserText($link);this.hasGenericMessage=!1,isUserText?this.mediaLinkText=this.linkText:this.media.get("title")?this.mediaLinkText=utils.niceTruncate(this.media.get("title"),60):(this.hasGenericMessage=!0,this.mediaLinkText=this.model.get("providerExpandMessage")),this.listenTo(this.model,"change:deferred",this.render),this.listenTo(this.model,"change:activated",this.onChangeActivated)},isUserText:function($link){if("A"!==$link[0].nodeName)return!1;var text=($link.text()||"").toLowerCase();if(!text)return!1;if(0===text.indexOf("http")||0===text.indexOf("www"))return!1;text=text.replace(/\.\.\.$/,"");var href=($link.attr("href")||"").toLowerCase();return-1===href.indexOf(text)},render:function(){var mediaLinkText=this.mediaLinkText;this.hasGenericMessage&&this.model.get("activated")&&(mediaLinkText=this.model.get("providerCollapseMessage")),this.$el.html(postMediaInlineLinkTemplate({model:this.model.toJSON(),text:this.linkText,href:this.linkHref,mediaLinkText:mediaLinkText,domain:this.linkDomain}))},onChangeActivated:function(){this.hasGenericMessage&&this.render()},handleToggle:function(evt){this.model.get("deferred")||(this.model.set("activated",!this.model.get("activated")),evt&&evt.preventDefault&&evt.preventDefault())}})
}),define("core/templates/postMedia",["handlebars","handlebars.partials"],function(Handlebars){return Handlebars.template(function(Handlebars,depth0,helpers,partials,data){function program1(depth0,data){var stack1,buffer="";return stack1=helpers["if"].call(depth0,(stack1=depth0&&depth0.media,null==stack1||stack1===!1?stack1:stack1.providerName),{hash:{},inverse:self.noop,fn:self.program(2,program2,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+=escapeExpression((stack1=depth0&&depth0.media,stack1=null==stack1||stack1===!1?stack1:stack1.title,typeof stack1===functionType?stack1.apply(depth0):stack1))}function program2(depth0){var stack1,buffer="";return buffer+=escapeExpression((stack1=depth0&&depth0.media,stack1=null==stack1||stack1===!1?stack1:stack1.providerName,typeof stack1===functionType?stack1.apply(depth0):stack1))+" &ndash; "}function program4(depth0){var stack1,buffer="";return buffer+='<i class="'+escapeExpression((stack1=depth0&&depth0.model,stack1=null==stack1||stack1===!1?stack1:stack1.providerIcon,typeof stack1===functionType?stack1.apply(depth0):stack1))+' publisher-background-color"></i>'}this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var stack1,buffer="",functionType="function",escapeExpression=this.escapeExpression,self=this;return buffer+='\n\n\n<a class="media-button media-button-expand publisher-color publisher-border-color" href="'+escapeExpression((stack1=depth0&&depth0.media,stack1=null==stack1||stack1===!1?stack1:stack1.url,typeof stack1===functionType?stack1.apply(depth0):stack1))+'" rel="nofollow" target="_blank" data-action="expand"\n        title="',stack1=helpers["if"].call(depth0,(stack1=depth0&&depth0.media,null==stack1||stack1===!1?stack1:stack1.title),{hash:{},inverse:self.noop,fn:self.program(1,program1,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+='">\n    ',stack1=helpers["if"].call(depth0,(stack1=depth0&&depth0.model,null==stack1||stack1===!1?stack1:stack1.providerIcon),{hash:{},inverse:self.noop,fn:self.program(4,program4,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n    "+escapeExpression((stack1=depth0&&depth0.model,stack1=null==stack1||stack1===!1?stack1:stack1.providerExpandMessage,typeof stack1===functionType?stack1.apply(depth0):stack1))+'\n</a>\n<a class="media-button media-button-contract publisher-color publisher-border-color" href="#" target="_blank" data-action="contract">\n    <i class="icon-cancel publisher-background-color"></i> '+escapeExpression((stack1=depth0&&depth0.model,stack1=null==stack1||stack1===!1?stack1:stack1.providerCollapseMessage,typeof stack1===functionType?stack1.apply(depth0):stack1))+'\n</a>\n\n<div class="media-content-loader" data-role="content-loader"></div>\n\n<div data-role="content-placeholder" class="media-content-placeholder"></div>\n'})}),define("core/templates/postMediaPlaceholder",["handlebars","handlebars.partials"],function(Handlebars){return Handlebars.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var stack1,buffer="",functionType="function",escapeExpression=this.escapeExpression;return buffer+='<a href="#" class="media-force-load" data-action="force-load"><i class="'+escapeExpression((stack1=depth0&&depth0.model,stack1=null==stack1||stack1===!1?stack1:stack1.providerIcon,typeof stack1===functionType?stack1.apply(depth0):stack1))+'"></i></a>\n'})}),define("core/views/RichMediaView",["underscore","jquery","backbone","core/utils","core/mediaConfig","core/views/RichMediaLinkView","core/templates/postMedia","core/templates/postMediaPlaceholder"],function(_,$,Backbone,utils,mediaConfig,RichMediaLinkView,postMediaTemplate,postMediaPlaceholderTemplate){var handler=utils.preventDefaultHandler,classFromModelAttr=function($el,model,attribute,cls){$el[model.get(attribute)?"addClass":"removeClass"](cls)};return Backbone.View.extend({className:"media-container",events:{"click [data-action=expand]":"handleExpand","click [data-action=contract]":"handleContract","click [data-action=force-load]":"handleForceLoad"},template:postMediaTemplate,initialize:function(options){this.options=options,this.media=options.media,this.template=options.template||this.template,this.$linkEl=null,this.setupMode(),this.listenTo(this.model,"change:activated",this.applyState),this.listenTo(this.model,"change:deferredHeight",this.onChangeDeferredHeight),this.listenTo(this.model,"change:showButtons",this.updateElementClass),this.listenTo(this.model,"change:deferred",this.render),this.listenTo(mediaConfig,"change:collapsed",this.setupMode)},getMediaDimensions:function(){return{width:null,height:null}},getAvailableWidth:function(){return this.$el.parent().width()||mediaConfig.get("loadedThumbnailWidth")},updateDeferredHeight:function(){this.model.set("deferredHeight",this.calculateDeferredHeight())},calculateDeferredHeight:function(){var dimensions=this.getMediaDimensions(),width=dimensions.width,height=dimensions.height;if(!width||!height)return height;var availableWidth=this.getAvailableWidth(),expectedHeight=availableWidth*height/width;return expectedHeight},convertToButton:function($link){this.model.set("showButtons",!1),this.linkSubview&&this.linkSubview.remove(),this.linkSubview=new RichMediaLinkView({model:this.model,media:this.media,$link:$link}),$link.replaceWith(this.linkSubview.$el),this.linkSubview.render()},applyContentNodeHeight:function(height){this.contentNode.height(height||"auto")},shouldAutoplay:function(){return!this.model.get("deferred")},generateContentHtml:function(){return this.media.get("html")},createContentNode:function(html){return $(html)},insertContentNode:function($node){this.contentNode.html($node)},prepareElementEvents:function(){},displayContent:function(){this.updateDeferredHeight();var html=this.generateContentHtml(),$node=this.createContentNode(html);this.prepareElementEvents($node),this.insertContentNode($node),this.applyContentNodeHeight(null)},configureDeferred:function(){this.enterViewport()},configureContentFromActivated:function(){this.model.get("activated")?this.displayContent():this.displayPlaceholder()},displayPlaceholder:function(){this.contentNode.html(postMediaPlaceholderTemplate({model:this.model.toJSON()}))},updateElementClass:function(){var $el=this.$el,model=this.model;classFromModelAttr($el,model,"deferred","media-mode-deferred"),classFromModelAttr($el,model,"activated","media-activated"),classFromModelAttr($el,model,"showButtons","media-show-buttons")},applyState:function(){this.configureDeferred(),this.configureContentFromActivated(),this.updateElementClass()},render:function(){this.$el.html(this.template({model:this.model.toJSON(),media:this.media.toJSON()})),this.contentNode=this.$el.find("[data-role=content-placeholder]"),this.applyState()},remove:function(){this.linkSubview&&this.linkSubview.remove(),Backbone.View.prototype.remove.apply(this,arguments)},enterViewport:function(){this.model.get("deferred")&&this.activate()},activate:function(){this.model.set("activated",!0)},setupMode:function(){if(this.model.get("respectSettings")){this.model.set("activated",!1);var collapse=mediaConfig.get("collapsed");collapse?this.model.set("deferred",!1):this.model.set("deferred",!0)}},onChangeDeferredHeight:function(){this.model.get("deferred")&&!this.model.get("activated")&&this.applyContentNodeHeight(this.model.get("deferredHeight"))},handleExpand:handler(function(){this.model.set("activated",!0)}),handleContract:handler(function(){this.model.set("activated",!1)}),handleForceLoad:handler(function(){this.model.get("deferred")&&this.model.set("activated",!0)})})}),define("core/templates/postMediaImage",["handlebars","handlebars.partials"],function(Handlebars){return Handlebars.template(function(Handlebars,depth0,helpers,partials,data){function program1(depth0){var stack1,buffer="";return buffer+=' height="'+escapeExpression((stack1=depth0&&depth0.model,stack1=null==stack1||stack1===!1?stack1:stack1.deferredHeight,typeof stack1===functionType?stack1.apply(depth0):stack1))+'" '}this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var stack1,helper,buffer="",functionType="function",escapeExpression=this.escapeExpression,self=this;return buffer+='<a href="',(helper=helpers.imageUrl)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.imageUrl,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'" target="_blank" rel="nofollow">\n    \n    <img src="',(helper=helpers.thumbnailUrl)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.thumbnailUrl,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'" alt="'+escapeExpression(helpers.gettext.call(depth0,"Thumbnail",{hash:{},data:data}))+'" ',stack1=helpers["if"].call(depth0,(stack1=depth0&&depth0.model,null==stack1||stack1===!1?stack1:stack1.deferredHeight),{hash:{},inverse:self.noop,fn:self.program(1,program1,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+=">\n</a>\n"})}),define("core/views/ImageRichMediaView",["core/views/RichMediaView","core/utils","core/config","core/mediaConfig","core/templates/postMediaImage"],function(RichMediaView,utils,config,mediaConfig,postMediaImageTemplate){return RichMediaView.extend({getMediaDimensions:function(){return{width:this.media.get("thumbnailWidth"),height:this.media.get("thumbnailHeight")}},getImageUrl:function(){return this.media.get("resolvedUrl")||this.media.get("url")||this.media.get("thumbnailUrl")},getImageThumbnailUrl:function(){var url=this.media.get("thumbnailUrl");return utils.getDomain(url)===utils.getDomain(config.urls.media)&&(url=utils.serialize(url,{w:mediaConfig.get("loadedThumbnailWidth"),h:this.model.get("deferredHeight")})),url},generateContentHtml:function(){return postMediaImageTemplate({model:this.model.toJSON(),media:this.media.toJSON(),thumbnailUrl:this.getImageThumbnailUrl(),imageUrl:this.getImageUrl()})},prepareElementEvents:function($node){var self=this,$img=$node.find("img"),generateHandler=function(name){return function(){self.trigger(name),$img.off(".richMediaView")}};$img.on("load.richMediaView",generateHandler("load")),$img.on("error.richMediaView",generateHandler("error"))},calculateDeferredHeight:function(){var deferredHeight=RichMediaView.prototype.calculateDeferredHeight.apply(this,arguments),mediaHeight=this.getMediaDimensions().height;return Math.min(mediaHeight,deferredHeight)||null}})}),define("core/views/IframeRichMediaView",["underscore","core/mediaConfig","core/views/RichMediaView"],function(_,mediaConfig,RichMediaView){return RichMediaView.extend({getMediaDimensions:function(){return{width:this.media.get("htmlWidth"),height:this.media.get("htmlHeight")}},_findIframe:function($el){return $el.is("iframe")?$el:$el.find("iframe")},configureContentFromActivated:function(){RichMediaView.prototype.configureContentFromActivated.apply(this,arguments),this.model.get("activated")||this.$el.removeClass("media-loading")},createContentNode:function(){var $node=RichMediaView.prototype.createContentNode.apply(this,arguments);return $node.attr({width:"100%",height:this.model.get("deferredHeight")}),$node},insertContentNode:function($node){this.loaderNode=this.$el.find("[data-role=content-loader]"),this.loaderHeight=this.model.get("deferredHeight")||mediaConfig.get("defaultIframeHeight"),this.loaderNode.height(this.loaderHeight),this.$el.addClass("media-loading"),RichMediaView.prototype.insertContentNode.call(this,$node)},prepareElementEvents:function($node){var $iframe=this._findIframe($node);$iframe.one("load",_.bind(this.finishLoad,this,$iframe))},finishLoad:function($iframe){this.$el.removeClass("media-loading"),$iframe.height(this.loaderHeight),this.trigger("load")}})}),define("core/views/FacebookPhotoRichMediaView",["core/views/ImageRichMediaView"],function(ImageRichMediaView){return ImageRichMediaView.extend({getImageThumbnailUrl:function(){return this.media.get("metadata").imageUrl||ImageRichMediaView.prototype.getImageThumbnailUrl.call(this)}})}),define("core/views/AutoplayRichMediaView",["underscore","jquery","core/utils","core/views/IframeRichMediaView"],function(_,$,utils,IframeRichMediaView){return IframeRichMediaView.extend({createContentNode:function(){var $node=IframeRichMediaView.prototype.createContentNode.apply(this,arguments),src=$node.attr("src");return this.shouldAutoplay()&&src&&!this.model.get("playerjs")&&(src=utils.serialize(src,{auto_play:!0,autoplay:1}),$node.attr("src",src)),$node},insertContentNode:function($node){if(this.model.get("playerjs")){var $iframe=this._findIframe($node),src=$iframe.attr("src");"//"===src.substr(0,2)&&(src=window.location.protocol+src);var origin=src.split("/");origin=origin[0]+"//"+origin[2],this.playerjs={ready:!1,queue:[],origin:origin,$iframe:$iframe},this.model.get("mute")&&this.send("mute"),this.shouldAutoplay()&&this.send("play");var readyFn=_.once(_.bind(function(){this.playerjs.ready=!0;var queue=this.playerjs.queue;this.playerjs.queue=[],_.each(queue,this.send,this)},this));$(window).on("message",function(event){if(event=event.originalEvent,event.origin===origin){var data;try{data=JSON.parse(event.data)}catch(e){return}"ready"===data.event&&data.value&&data.value.src===src&&readyFn()}})}return IframeRichMediaView.prototype.insertContentNode.apply(this,arguments)},send:function(method){if(this.playerjs){if(!this.playerjs.ready)return void this.playerjs.queue.push(method);var data={context:"player.js",version:"0.0.10",method:method};this.playerjs.$iframe[0].contentWindow.postMessage(JSON.stringify(data),this.playerjs.origin)}}})}),define("core/views/DynamicHeightRichMediaView",["underscore","core/views/RichMediaView"],function(_,RichMediaView){return RichMediaView.extend({insertContentNode:function(){RichMediaView.prototype.insertContentNode.apply(this,arguments),this.finishLoad()},finishLoad:function(){var self=this,callCount=0,CALL_RATE=150,MAX_CALLS=20,updateFunction=function(){++callCount,MAX_CALLS>callCount?_.delay(updateFunction,CALL_RATE):self.trigger("load")};updateFunction()}})}),define("core/templates/postMediaTwitterContent",["handlebars","handlebars.partials"],function(Handlebars){return Handlebars.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var stack1,helper,buffer="",functionType="function",escapeExpression=this.escapeExpression;return buffer+='<meta name="twitter:widgets:csp" content="on">\n<blockquote class="twitter-tweet" data-theme="',(helper=helpers.theme)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.theme,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'" data-link-color="',(helper=helpers.linkColor)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.linkColor,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'" lang="',(helper=helpers.language)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.language,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'">\n    <a href="',(helper=helpers.url)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.url,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'"></a>\n</blockquote>\n<script src="//platform.twitter.com/widgets.js"></script>\n'})}),define("core/views/TwitterRichMediaView",["underscore","core/views/DynamicHeightRichMediaView","core/templates/postMediaTwitterContent","core/utils"],function(_,DynamicHeightRichMediaView,postMediaTwitterContentTemplate,utils){var TwitterRichMediaView=DynamicHeightRichMediaView.extend({generateContentHtml:function(){var language=document.documentElement.lang;language=language&&language.substring(0,2);var url=this.media.get("url");return-1!==this.media.get("resolvedUrl").indexOf("/status")&&(url=this.media.get("resolvedUrl")),postMediaTwitterContentTemplate({url:url,theme:_.result(TwitterRichMediaView,"theme"),linkColor:utils.escapeColor(_.result(TwitterRichMediaView,"linkColor")),language:language})}},{theme:"light",linkColor:"rgb(46, 159, 255)"});return TwitterRichMediaView}),define("core/views/SoundCloudRichMediaView",["core/views/AutoplayRichMediaView"],function(AutoplayRichMediaView){return AutoplayRichMediaView.extend({getMediaDimensions:function(){return{width:null,height:this.media.get("htmlHeight")}}})}),define("core/views/VineRichMediaView",["core/views/AutoplayRichMediaView","core/utils"],function(AutoplayRichMediaView,utils){return AutoplayRichMediaView.extend({createContentNode:function(){var $node=AutoplayRichMediaView.prototype.createContentNode.apply(this,arguments),src=$node.attr("src");return this.shouldAutoplay()&&src&&(src=utils.serialize(src,{audio:1}),$node.attr("src",src)),$node}})}),define("core/templates/unknownMediaIframe",["handlebars","handlebars.partials"],function(Handlebars){return Handlebars.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var stack1,helper,buffer="",functionType="function",escapeExpression=this.escapeExpression;return buffer+='<iframe src="',(helper=helpers.url)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.url,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'" frameborder="0"></iframe>\n'})}),define("core/views/UnknownRichMediaView",["core/views/IframeRichMediaView","core/templates/unknownMediaIframe"],function(IframeRichMediaView,unknownMediaIframeTemplate){return IframeRichMediaView.extend({generateContentHtml:function(){return unknownMediaIframeTemplate({url:this.media.get("url")})}})}),define("core/media",["underscore","core/strings","core/mediaConfig","core/models/Media","core/models/RichMediaViewModel","core/views/RichMediaView","core/views/ImageRichMediaView","core/views/IframeRichMediaView","core/views/FacebookPhotoRichMediaView","core/views/AutoplayRichMediaView","core/views/TwitterRichMediaView","core/views/SoundCloudRichMediaView","core/views/VineRichMediaView","core/views/UnknownRichMediaView"],function(_,strings,mediaConfig,MediaModel,RichMediaViewModel,RichMediaView,ImageRichMediaView,IframeRichMediaView,FacebookPhotoRichMediaView,AutoplayRichMediaView,TwitterRichMediaView,SoundCloudRichMediaView,VineRichMediaView,UnknownRichMediaView){var gettext=strings.get,getRichMediaViewConfig=function(model){var PROVIDER_MESSAGES={PLAY_HIDE:{kind:"html",providerExpandMessage:gettext("Play"),providerCollapseMessage:gettext("Hide")},VIEW_HIDE:{kind:"html",providerExpandMessage:gettext("View"),providerCollapseMessage:gettext("Hide")},VIEW_IMAGE:{kind:"image",providerIcon:"icon-images",providerExpandMessage:gettext("View"),providerCollapseMessage:gettext("Hide")}},extendMessage=function(name,icon){return _.extend(PROVIDER_MESSAGES[name],{providerIcon:icon})},providerConstant=null,Cls=null,PROVIDER=MediaModel.MEDIA_TYPES;switch(model.get("mediaType")){case PROVIDER.IMAGE:case PROVIDER.IMAGE_UPLOAD:providerConstant=PROVIDER_MESSAGES.VIEW_IMAGE;break;case PROVIDER.FACEBOOK_PHOTO:Cls=FacebookPhotoRichMediaView,providerConstant=PROVIDER_MESSAGES.VIEW_IMAGE;break;case PROVIDER.VIMEO_VIDEO:case PROVIDER.YOUTUBE_VIDEO:Cls=AutoplayRichMediaView,providerConstant=extendMessage("PLAY_HIDE","icon-video");break;case PROVIDER.TWITTER_STATUS:Cls=TwitterRichMediaView,providerConstant=extendMessage("VIEW_HIDE","icon-twitter");break;case PROVIDER.VINE_VIDEO:Cls=VineRichMediaView,providerConstant=extendMessage("PLAY_HIDE","icon-video");break;case PROVIDER.FACEBOOK_VIDEO:providerConstant=extendMessage("VIEW_HIDE","icon-video");break;case PROVIDER.SOUNDCLOUD_SOUND:Cls=SoundCloudRichMediaView,providerConstant=extendMessage("PLAY_HIDE","icon-music");break;case PROVIDER.GOOGLE_MAP:providerConstant=extendMessage("VIEW_HIDE","icon-map");break;case PROVIDER.UNKNOWN:Cls=UnknownRichMediaView,providerConstant=extendMessage("VIEW_HIDE");break;default:return null}if(null===Cls)switch(providerConstant.kind){case"webpage":return null;case"html":Cls=IframeRichMediaView;break;case"image":Cls=ImageRichMediaView}var mediaViewModel=new RichMediaViewModel(providerConstant);return{Cls:Cls,mediaViewModel:mediaViewModel}},instantiateRichMediaView=function(model){var config=getRichMediaViewConfig(model);return config?new config.Cls({model:config.mediaViewModel,media:model}):null};return{instantiateRichMediaView:instantiateRichMediaView,getRichMediaViewConfig:getRichMediaViewConfig}}),define("home/mixins/withRichMedia",["underscore","jquery","core/collections/MediaCollection","core/media"],function(_,$,MediaCollection,coreMedia){function withRichMediaView(){_.extend(this,RichMediaRenderableView)}var RichMediaRenderableView={getLinks:function($fragment){var links={};return $fragment.length?($fragment.find("a").each(function(i,link){var url=link.href;links[url]||(links[url]=$(link))}),links):links},renderRichMedia:function(media){var links=this.getLinks(this.$("[data-role=message]"));media=new MediaCollection(media),media.each(function(m){var url=m.get("url"),view=coreMedia.instantiateRichMediaView(m);if(view){var $link=links[url];$link?$link.replaceWith(view.$el):$("<li>").append(view.$el).appendTo(this.$(["data-role=post-media-list"])),view.render()}},this)},getHighestAncestor:function($link){return $link.closest("[data-role=message] > *")}};return withRichMediaView}),define("home/views/UserGeneratedDiscussionCoverView",["underscore","home/models/Session","home/views/common/DiscussionCoverBaseView","home/templates/userGeneratedDiscussionCover","home/templates/guidelines","home/mixins/withRichMedia","home/utils/confirmModal"],function(_,Session,DiscussionCoverBaseView,userGeneratedDiscussionCoverTemplate,guidelinesTemplate,withRichMedia,confirmModal){var UserGeneratedDiscussionCoverView=DiscussionCoverBaseView.extend({template:userGeneratedDiscussionCoverTemplate,templateHelpers:function(){var existing=DiscussionCoverBaseView.prototype.templateHelpers.apply(this,arguments),embedlyData=this.model.get("content"),isAuthor=this.model.author&&this.model.author===this.session.user,canEdit=isAuthor&&!this.model.get("isDeleted");return _.defaults({description:this.model.getFullDescription(),hasEmbedlyData:embedlyData.title||embedlyData.description||embedlyData.image.url,embedlyLink:this.model.getLinks()[0],canEdit:canEdit,canDelete:canEdit&&_.contains(this.session.moderatedForums,this.model.forum.id)},existing)},modelEvents:_.defaults({"changeRelated:author":"bindToAuthor"},DiscussionCoverBaseView.modelEvents),events:{"click [data-action=delete-thread]":"deleteThread","click [data-action=show-guidelines]":"showGuidelines"},initialize:function(){DiscussionCoverBaseView.prototype.initialize.apply(this,arguments),this.session=new Session,this.listenTo(this.session,"setModeratedForums",this.render)},bindToAuthor:function(){this.model.author&&(this.listenTo(this.model.author,"change",this.render),this.render())},onRender:function(){var media=this.model.get("message")?this.model.get("media"):this.model.post&&this.model.post.get("media");media&&media.length&&this.renderRichMedia(media)},deleteThread:function(){this.model.confirmDelete()},showGuidelines:function(){confirmModal.confirmationPromise(confirmModal.TYPES.CLOSE,guidelinesTemplate(this.model.forum.channel.toJSON()))}});return withRichMedia.call(UserGeneratedDiscussionCoverView.prototype),UserGeneratedDiscussionCoverView}),define("home/apps/dashboard/mixpanelUtils",["home/utils/mixpanelUtils"],function(mixpanelUtils){return mixpanelUtils}),define("home/models/common/BaseSession",["underscore","backbone","require","home/models/common/UniqueModel","home/models/AnonUser"],function(_,Backbone,require,UniqueModel,AnonUser){var User,BaseSession=Backbone.Model.extend({initialize:function(){this.set({user:new AnonUser}),this.user=this.get("user")},_setUser:function(user){this.get("user")&&(this.get("user").off("change",this._userChanged),this.isAnonymous()||this.trigger("session:logout",user)),this.user=user,this.set({user:user}),this.listenTo(user,"all",this.trigger),this.get("user").on("change",this._userChanged,this),this.isAnonymous()||this.trigger("session:login",user)},isAnonymous:function(){return this.get("user").get("isAnonymous")},_userChanged:function(){this.trigger("change:user",this.get("user"))},fetchUser:function(options){if(this.fetchPromise)return this.fetchPromise;User||(User=require("home/models/User"));var user=new User;return this.fetchPromise=user.fetch(options).then(_.bind(function(userResponse){return this.fetchPromise=null,this._setUser(UniqueModel.set(User,user)),userResponse},this)),this.fetchPromise},logout:function(){this._setUser(new AnonUser),window.location="//disqus.com/logout/?redirect=http%3A%2F%2Fdisqus.com"}});return BaseSession}),define("home/models/ThreadFeed",["underscore","backbone","home/models/common/UniqueModel","home/models/Feed"],function(_,Backbone,UniqueModel,Feed){var ThreadFeed=Feed.extend({defaults:_.extend({},Feed.prototype.defaults,{followed:!1}),initialize:function(attrs,options){var CommonCollections=require("home/apps/common/collections"),Collections=require("home/apps/dashboard/collections");Feed.prototype.initialize.call(this,{},{collectionClass:Collections.ThreadCollection}),this.get("items").url=CommonCollections.buildUrl(options.urlPart),options.fetchOptions&&this.set({fetchOptions:options.fetchOptions})},_changeFollowingState:function(url){var self=this;Backbone.ajax({url:url,type:"POST",data:{target:self.get("id")},success:function(){self.trigger("sync:change:followed",self,self.get("followed"))}})},follow:function(){return this.set("followed",!0),this._changeFollowingState(this.get("followUrl"))},unfollow:function(){return this.set("followed",!1),this._changeFollowingState(this.get("unfollowUrl"))},toggleFollowed:function(){return this.get("followed")?this.unfollow():this.follow()}});return ThreadFeed}),define("home/apps/dashboard/models",["underscore","backbone","require","handlebars","core/utils/cookies","home/utils/releaseUtils","home/apps/common/backboneUtils","home/models/common/UniqueModel","home/models/common/BaseSession","home/models/ThreadFeed","home/models/Feed","home/models/Post","home/models/Thread","home/models/Forum","home/models/User","home/models/Topic","home/models/Activity"],function(_,Backbone,require,Handlebars,Cookies,releaseUtils,BackboneUtils,UniqueModel,BaseSession,ThreadFeed,Feed,Post,Thread,Forum,User,Topic,Activity){var FeedsManager=Backbone.Model.extend({initialize:function(attrs,options){this.setInitialActiveFeed(attrs),this.feeds={},_.each(options.feeds,function(feed){this.feeds[feed.get("name")]=feed},this),this.setActive(this.get("activeFeed"))},setInitialActiveFeed:function(attrs){if(!attrs.activeFeed&&attrs.initialActiveFeedChoices){var initialFeed=Cookies.read(FeedsManager.activeFeedCookie);_.contains(attrs.initialActiveFeedChoices,initialFeed)||(initialFeed=attrs.initialActiveFeedChoices[0]),this.attributes.activeFeed=initialFeed}},setActive:function(feedName){var activeFeed=this.getActiveFeed(),newActiveFeed=this.feeds[feedName];newActiveFeed&&(activeFeed&&activeFeed.set({active:!1}),newActiveFeed.set({active:!0}),this.set({activeFeed:feedName}),this.updateActiveFeedCookie(feedName))},updateActiveFeedCookie:function(feedName){Cookies.create(FeedsManager.activeFeedCookie,feedName,{path:"/home",expiresIn:2592e6})},getActiveFeed:function(){return this.feeds[this.get("activeFeed")]},getFeed:function(name){return this.feeds[name]}},{activeFeedCookie:"dhome_default_feed"}),UserTopicForum=ThreadFeed.extend({initialize:function(attrs,options){ThreadFeed.prototype.initialize.call(this,attrs,{urlPart:"feeds/listUserHomeFeed",fetchOptions:{order:"time"}}),this.changingForums=[],this.followingForums=options.followingForums,this.listenTo(this.followingForums,"change:followed",this.handleForumFollowingChange)},handleForumFollowingChange:function(forum){this.changingForums.push(forum),this.listenToOnce(forum,"sync:change:followed",function(forum){var i=this.changingForums.indexOf(forum);this.changingForums.splice(i,1),this.changingForums.length||this.trigger("needsReset")},this)},refresh:function(){var currentForums=this.getFollowingForumIds();_.difference(currentForums,this.syncedForums).length&&this.forceRefresh()},forceRefresh:function(options){var currentForums=this.getFollowingForumIds();_.isEqual(currentForums,this.syncedForums)||(this.get("items").reset([]),options=options||{},this.get("fetching")?this.listenToOnce(this.get("items"),"sync",_.bind(this.refresh,this,options)):this.fetchItems(_.extend({reset:!0},options)))},updateSyncedForums:function(){this.syncedForums=this.getFollowingForumIds()},fetchItems:function(){var promise=this.followingForums.fetchPromise;promise?promise.then(_.bind(this.updateSyncedForums,this)):this.updateSyncedForums(),ThreadFeed.prototype.fetchItems.apply(this,arguments)},getFollowingForumIds:function(){return this.followingForums.chain().pluck("id").sort().value()}}),CombinedUserFeed=Feed.extend({initialize:function(){var CommonCollections=require("home/apps/common/collections"),Collections=require("home/apps/dashboard/collections");Feed.prototype.initialize.call(this,{},{collectionClass:Collections.CombinedCollection}),this.get("items").url=CommonCollections.buildUrl("feeds/listCombinedUserHomeFeed")}}),Bundle=Backbone.Model.extend({defaults:{name:"",description:"",models:[]},initialize:function(attributes,options){options.CollectionClass&&(this.feedCollection=new options.CollectionClass(this.attributes.models)),this.attributes.iconUrl=options.CDN_ROOT+"/img/dashboard/bundle-icons/"+this.attributes.name.toLowerCase()+".jpg"},toggleFollowed:function(){this.get("followed")?(this.set("followed",!1),this.feedCollection.invoke("unfollow")):(this.set("followed",!0),this.feedCollection.invoke("follow"))}}),Session=function(){var _session;return function(){return _session||(_session=new BaseSession,_session.forget=function(){_session=null}),_session}}();return{UniqueModel:UniqueModel,Session:Session,Feed:Feed,FeedsManager:FeedsManager,ActivityItem:Activity,Bundle:Bundle,User:User,Forum:Forum,Thread:Thread,Post:Post,Topic:Topic,UserTopicForum:UserTopicForum,CombinedUserFeed:CombinedUserFeed}}),define("home/utils/embed",["jquery","home/apps/dashboard/mixpanelUtils","home/apps/dashboard/models"],function($,MixpanelUtils,Models){var onEmbedComment=function(){var user=(new Models.Session).user;user.set({numPosts:user.get("numPosts")+1}),MixpanelUtils.track("post post",{target:$("[data-role=embed]")})},onEmbedLoaded=function(){};return{onEmbedComment:onEmbedComment,onEmbedLoaded:onEmbedLoaded}}),define("home/templates/embedContainer",["handlebars","handlebars.partials"],function(Handlebars){return Handlebars.template(function(Handlebars,depth0,helpers,partials,data){return this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{},'<div class="story-thread" id="disqus_thread" data-role="embed" data-mix-location="embed"></div>\n'})}),define("home/views/EmbedContainerView",["underscore","backbone-marionette","core/utils/cookies","home/utils/embed","home/utils/layoutUtils","home/templates/embedContainer"],function(_,Marionette,cookies,embedUtils,layoutUtils,embedContainerTemplate){function disqusConfig(thread){var embedConfig=this;embedConfig.discovery={disable_all:!0},embedConfig.forum=thread.forum.id,embedConfig.page.slug=thread.get("slug"),embedConfig.page.title=thread.get("title"),embedConfig.page.url=thread.get("link"),embedConfig.experiment.force_auto_styles=!0,embedConfig.experiment.enable_scroll_container=!0,embedConfig.callbacks.onNewComment.push(embedUtils.onEmbedComment),embedConfig.callbacks.onReady.push(layoutUtils.scrollShownChanged)
}return Marionette.ItemView.extend({className:"col-middle",template:embedContainerTemplate,onShow:function(){window.DISQUS.reset({reload:!0,config:_.partial(disqusConfig,this.model)})}})}),define("home/templates/threadCardDefaultFooter",["handlebars","handlebars.partials"],function(Handlebars){return Handlebars.template(function(Handlebars,depth0,helpers,partials,data){function program1(depth0,data){var buffer="";return buffer+="\n                "+escapeExpression(helpers.gettext.call(depth0,"1 Comment",{hash:{},data:data}))+"\n            "}function program3(depth0,data){var stack1,buffer="";return buffer+="\n                "+escapeExpression(helpers.gettext.call(depth0,"%(posts)s Comments",{hash:{posts:(stack1=depth0&&depth0.thread,null==stack1||stack1===!1?stack1:stack1.posts)},data:data}))+"\n            "}function program5(depth0,data){var stack1,buffer="";return buffer+='\n        <li class="action">\n            <a class="action-favorite',stack1=helpers["if"].call(depth0,depth0&&depth0.favorited,{hash:{},inverse:self.noop,fn:self.program(6,program6,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+='" href="#" data-action="favorite">\n                Favorite<span class="active-text">d</span> <span class="icon icon-star"></span>\n            </a>\n        </li>\n    '}function program6(){return" active"}this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var stack1,helper,options,buffer="",escapeExpression=this.escapeExpression,self=this,functionType="function",helperMissing=helpers.helperMissing;return buffer+='<ul class="actions">\n    <li class="action">\n        <a href="/home/',(helper=helpers.discussionRoute)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.discussionRoute,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'">\n            ',helper=helpers.eq||depth0&&depth0.eq,options={hash:{},data:data},stack1=helper?helper.call(depth0,(stack1=depth0&&depth0.thread,null==stack1||stack1===!1?stack1:stack1.posts),1,options):helperMissing.call(depth0,"eq",(stack1=depth0&&depth0.thread,null==stack1||stack1===!1?stack1:stack1.posts),1,options),stack1=helpers["if"].call(depth0,stack1,{hash:{},inverse:self.program(3,program3,data),fn:self.program(1,program1,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+='\n            <span class="icon icon-comment"></span>\n        </a>\n    </li>\n    ',stack1=helpers["if"].call(depth0,depth0&&depth0.authenticated,{hash:{},inverse:self.noop,fn:self.program(5,program5,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n</ul>\n"})}),define("home/views/ThreadCardDefaultFooterView",["backbone-marionette","home/utils/mixpanelUtils","home/utils/inspectletUtils","home/models/Session","home/templates/threadCardDefaultFooter"],function(Marionette,MixpanelUtils,inspectletUtils,Session,threadCardDefaultFooterTemplate){var ThreadCardDefaultFooterView=Marionette.ItemView.extend({template:threadCardDefaultFooterTemplate,templateHelpers:function(){var session=new Session;return{favorited:this.model.thread.get("userScore")>0,discussionRoute:this.model.thread.getDiscussionRoute(this.channel),authenticated:!session.isAnonymous()}},events:{"click [data-action=favorite]":"toggleThreadFavorited"},initialize:function(options){this.listenTo(this.model.thread,"change:userScore",this.render),this.channel=options&&options.channel},toggleThreadFavorited:function(e){e&&e.preventDefault(),this.model.thread.get("userScore")<1&&(MixpanelUtils.track("like thread",e),inspectletUtils.tagSession("favorited")),this.model.thread.toggleFavorited()}});return ThreadCardDefaultFooterView}),define("home/mixins/asChannelCard",["jquery","underscore","home/utils/layoutUtils","home/views/ThreadCardDefaultFooterView","home/WrapperlessRegion"],function($,_,layoutUtils,ThreadCardDefaultFooterView,WrapperlessRegion){var canShowThreadImage=function(){return layoutUtils.getScreenWidth()>480},asChannelCard=function(){var _className=this.className;this.className=function(){var existingClassName=_.isFunction(_className)?_className.apply(this,arguments):_className||"";return"card card-channel card-channel-"+this.model.get("verb")+" "+existingClassName};var _regions=this.regions;this.regions=function(){var existingRegions=_.isFunction(_regions)?_regions.apply(this,arguments):_regions||{};return _.defaults(existingRegions,{footerRegion:{selector:"[data-role=footer]",regionType:WrapperlessRegion}})},this.initialize=_.wrap(this.initialize,function(_initialize,options){_initialize.apply(this,_.rest(arguments)),this.channel=options&&options.channel,this.listenTo(this.model.thread,"change:content",this.render),this.numTitleLines=options&&options.numTitleLines||3}),this.serializeData=_.wrap(this.serializeData,function(_serializeData){var data=_serializeData.apply(this,_.rest(arguments)),thread=this.model.thread;return _.defaults(data,{discussionRoute:this.model.thread&&this.model.thread.getDiscussionRoute(this.channel),canShowThreadImage:canShowThreadImage(),threadDescription:thread.getDefaultDescription(),image:thread.getImage(),numTitleLines:this.numTitleLines})}),this.onDomRefresh=_.wrap(this.onDomRefresh,function(_onDomRefresh){_.isFunction(_onDomRefresh)&&_onDomRefresh.apply(this,_.rest(arguments)),this.footerRegion.show(new ThreadCardDefaultFooterView({model:this.model,channel:this.channel})),this.$(".truncate").each(function(index,el){$(el).trunk8({lines:$(el).data("truncateLines")})})})};return asChannelCard}),define("home/templates/channelCardCreate",["handlebars","handlebars.partials"],function(Handlebars){return Handlebars.template(function(Handlebars,depth0,helpers,partials,data){function program1(){return" no-image"}function program3(depth0,data){var stack1,buffer="";return buffer+="\n        ",stack1=helpers["if"].call(depth0,depth0&&depth0.image,{hash:{},inverse:self.noop,fn:self.program(4,program4,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n    "}function program4(depth0){var stack1,buffer="";return buffer+='\n            <a href="'+escapeExpression((stack1=depth0&&depth0.thread,stack1=null==stack1||stack1===!1?stack1:stack1.link,typeof stack1===functionType?stack1.apply(depth0):stack1))+'" class="discussion-image" target="_blank">\n                <img src="'+escapeExpression((stack1=depth0&&depth0.image,stack1=null==stack1||stack1===!1?stack1:stack1.src,typeof stack1===functionType?stack1.apply(depth0):stack1))+'" alt="'+escapeExpression((stack1=depth0&&depth0.image,stack1=null==stack1||stack1===!1?stack1:stack1.title,typeof stack1===functionType?stack1.apply(depth0):stack1))+'">\n            </a>\n        '}function program6(depth0,data){var stack1,helper,buffer="";return buffer+='\n            <a class="card-avatar" href="/home/user/',(helper=helpers.username)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.username,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'">\n                <img\n                    src="'+escapeExpression((stack1=depth0&&depth0.avatar,stack1=null==stack1||stack1===!1?stack1:stack1.cache,typeof stack1===functionType?stack1.apply(depth0):stack1))+'"\n                    alt="',stack1=helpers["if"].call(depth0,depth0&&depth0.name,{hash:{},inverse:self.program(9,program9,data),fn:self.program(7,program7,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+='" />\n            </a>\n        '}function program7(depth0,data){var stack1,helper;return(helper=helpers.name)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.name,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),escapeExpression(stack1)}function program9(depth0,data){var stack1;return stack1=helpers["if"].call(depth0,depth0&&depth0.username,{hash:{},inverse:self.program(12,program12,data),fn:self.program(10,program10,data),data:data}),stack1||0===stack1?stack1:""}function program10(depth0,data){var stack1,helper;return(helper=helpers.username)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.username,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),escapeExpression(stack1)}function program12(){return"Guest"}function program14(){return'\n            <div class="card-discussion-comments-title">Recent Comments</div>\n            <div class="card-discussion-comments" data-role="posts"></div>\n        '}function program16(depth0,data){var stack1,helper,buffer="";return buffer+='\n            <div class="card-summary">\n                <div class="card-summary-content truncate" data-truncate-lines="3">\n                    ',(helper=helpers.threadDescription)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.threadDescription,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n                </div>\n            </div>\n        "}this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var stack1,helper,options,buffer="",functionType="function",escapeExpression=this.escapeExpression,self=this,helperMissing=helpers.helperMissing;return buffer+='<div class="card-discussion',stack1=helpers.unless.call(depth0,depth0&&depth0.image,{hash:{},inverse:self.noop,fn:self.program(1,program1,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+='">\n    <div class="card-aside">\n    ',stack1=helpers["if"].call(depth0,depth0&&depth0.canShowThreadImage,{hash:{},inverse:self.noop,fn:self.program(3,program3,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+='\n    </div>\n    <div class="card-body">\n        ',stack1=helpers["with"].call(depth0,depth0&&depth0.firstActor,{hash:{},inverse:self.noop,fn:self.program(6,program6,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+='\n        <div class="card-reason">\n            ',helper=helpers.getPartial||depth0&&depth0.getPartial,options={hash:{},data:data},stack1=helper?helper.call(depth0,"userGroupNames",options):helperMissing.call(depth0,"getPartial","userGroupNames",options),buffer+=escapeExpression(helpers.gettext.call(depth0,"%(group)s started a Discussion",{hash:{group:stack1},data:data}))+'\n        </div>\n        <h2 class="discussion-title">\n            <a href="'+escapeExpression((stack1=depth0&&depth0.thread,stack1=null==stack1||stack1===!1?stack1:stack1.link,typeof stack1===functionType?stack1.apply(depth0):stack1))+'"\n                class="link-gray-darker truncate"\n                data-truncate-lines="',(helper=helpers.numTitleLines)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.numTitleLines,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'"\n                target="_blank"\n                data-role="thread-link">\n\n                ',stack1=depth0&&depth0.thread,stack1=null==stack1||stack1===!1?stack1:stack1.clean_title,stack1=typeof stack1===functionType?stack1.apply(depth0):stack1,(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n            </a>\n        </h2>\n        ",stack1=helpers["if"].call(depth0,depth0&&depth0.recentPostCount,{hash:{},inverse:self.program(16,program16,data),fn:self.program(14,program14,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+='\n        <footer class="card-footer" data-role="footer"></div>\n    </div>\n</div>\n'})}),define("home/views/ChannelCardCreateView",["backbone-marionette","home/mixins/asChannelCard","home/mixins/withReason","home/views/PostCollectionView","home/templates/channelCardCreate"],function(Marionette,asChannelCard,withReason,PostCollectionView,channelCardCreateTemplate){var ChannelCardCreateView=Marionette.Layout.extend({template:channelCardCreateTemplate,templateHelpers:function(){return{recentPostCount:this.model.thread.recentPosts.length}},regions:{postsRegion:"[data-role=posts]"},onDomRefresh:function(){this.postsRegion.show(new PostCollectionView({collection:this.model.thread.recentPosts}))}});return asChannelCard.call(ChannelCardCreateView.prototype),withReason.call(ChannelCardCreateView.prototype),ChannelCardCreateView}),define("home/templates/channelCardFavorite",["handlebars","handlebars.partials"],function(Handlebars){return Handlebars.template(function(Handlebars,depth0,helpers,partials,data){function program1(){return" no-image"}function program3(depth0,data){var stack1,buffer="";return buffer+="\n        ",stack1=helpers["if"].call(depth0,depth0&&depth0.image,{hash:{},inverse:self.noop,fn:self.program(4,program4,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n    "}function program4(depth0){var stack1,buffer="";return buffer+='\n            <a href="'+escapeExpression((stack1=depth0&&depth0.thread,stack1=null==stack1||stack1===!1?stack1:stack1.link,typeof stack1===functionType?stack1.apply(depth0):stack1))+'" class="discussion-image" target="_blank">\n                <img src="'+escapeExpression((stack1=depth0&&depth0.image,stack1=null==stack1||stack1===!1?stack1:stack1.src,typeof stack1===functionType?stack1.apply(depth0):stack1))+'" alt="'+escapeExpression((stack1=depth0&&depth0.image,stack1=null==stack1||stack1===!1?stack1:stack1.title,typeof stack1===functionType?stack1.apply(depth0):stack1))+'">\n            </a>\n        '}function program6(depth0,data){var stack1,helper,buffer="";return buffer+='\n            <a class="card-avatar" href="/home/user/',(helper=helpers.username)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.username,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'">\n                <img\n                    src="'+escapeExpression((stack1=depth0&&depth0.avatar,stack1=null==stack1||stack1===!1?stack1:stack1.cache,typeof stack1===functionType?stack1.apply(depth0):stack1))+'"\n                    alt="',stack1=helpers["if"].call(depth0,depth0&&depth0.name,{hash:{},inverse:self.program(9,program9,data),fn:self.program(7,program7,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+='" />\n            </a>\n        '}function program7(depth0,data){var stack1,helper;return(helper=helpers.name)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.name,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),escapeExpression(stack1)}function program9(depth0,data){var stack1;return stack1=helpers["if"].call(depth0,depth0&&depth0.username,{hash:{},inverse:self.program(12,program12,data),fn:self.program(10,program10,data),data:data}),stack1||0===stack1?stack1:""}function program10(depth0,data){var stack1,helper;return(helper=helpers.username)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.username,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),escapeExpression(stack1)}function program12(){return"Guest"}this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),partials=this.merge(partials,Handlebars.partials),data=data||{};var stack1,helper,options,buffer="",functionType="function",escapeExpression=this.escapeExpression,self=this,helperMissing=helpers.helperMissing;return buffer+='<div class="card-discussion',stack1=helpers.unless.call(depth0,depth0&&depth0.image,{hash:{},inverse:self.noop,fn:self.program(1,program1,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+='">\n    <div class="card-aside">\n    ',stack1=helpers["if"].call(depth0,depth0&&depth0.canShowThreadImage,{hash:{},inverse:self.noop,fn:self.program(3,program3,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+='\n    </div>\n    <div class="card-body">\n        ',stack1=helpers["with"].call(depth0,depth0&&depth0.firstActor,{hash:{},inverse:self.noop,fn:self.program(6,program6,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+='\n        <div class="card-reason">\n            ',helper=helpers.getPartial||depth0&&depth0.getPartial,options={hash:{},data:data},stack1=helper?helper.call(depth0,"userGroupNames",options):helperMissing.call(depth0,"getPartial","userGroupNames",options),buffer+=escapeExpression(helpers.gettext.call(depth0,"%(group)s favorited",{hash:{group:stack1},data:data}))+'\n            on\n            <a class="name-community" href="/home/forums/'+escapeExpression((stack1=depth0&&depth0.thread,stack1=null==stack1||stack1===!1?stack1:stack1.forum,stack1=null==stack1||stack1===!1?stack1:stack1.id,typeof stack1===functionType?stack1.apply(depth0):stack1))+'">',stack1=self.invokePartial(partials.forumName,"forumName",(stack1=depth0&&depth0.thread,null==stack1||stack1===!1?stack1:stack1.forum),helpers,partials,data),(stack1||0===stack1)&&(buffer+=stack1),buffer+='</a>\n        </div>\n        <h2 class="discussion-title">\n            <a href="'+escapeExpression((stack1=depth0&&depth0.thread,stack1=null==stack1||stack1===!1?stack1:stack1.link,typeof stack1===functionType?stack1.apply(depth0):stack1))+'"\n                class="link-gray-darker truncate"\n                data-truncate-lines="',(helper=helpers.numTitleLines)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.numTitleLines,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'"\n                target="_blank"\n                data-role="thread-link">\n\n                ',stack1=depth0&&depth0.thread,stack1=null==stack1||stack1===!1?stack1:stack1.clean_title,stack1=typeof stack1===functionType?stack1.apply(depth0):stack1,(stack1||0===stack1)&&(buffer+=stack1),buffer+='\n            </a>\n        </h2>\n        <div class="card-summary">\n            <div class="card-summary-content truncate" data-truncate-lines="3">\n                ',(helper=helpers.threadDescription)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.threadDescription,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),(stack1||0===stack1)&&(buffer+=stack1),buffer+='\n            </div>\n        </div>\n        <footer class="card-footer" data-role="footer"></div>\n    </div>\n</div>\n'})}),define("home/views/ChannelCardFavoriteView",["backbone-marionette","home/mixins/asChannelCard","home/mixins/withReason","home/templates/channelCardFavorite"],function(Marionette,asChannelCard,withReason,channelCardFavoriteTemplate){var ChannelCardFavoriteView=Marionette.Layout.extend({template:channelCardFavoriteTemplate});return asChannelCard.call(ChannelCardFavoriteView.prototype),withReason.call(ChannelCardFavoriteView.prototype),ChannelCardFavoriteView}),define("home/templates/channelCardTrending",["handlebars","handlebars.partials"],function(Handlebars){return Handlebars.template(function(Handlebars,depth0,helpers,partials,data){function program1(){return" no-image"}function program3(depth0,data){var stack1,buffer="";return buffer+="\n        ",stack1=helpers["if"].call(depth0,depth0&&depth0.image,{hash:{},inverse:self.noop,fn:self.program(4,program4,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="\n    "}function program4(depth0){var stack1,buffer="";return buffer+='\n            <a href="'+escapeExpression((stack1=depth0&&depth0.thread,stack1=null==stack1||stack1===!1?stack1:stack1.link,typeof stack1===functionType?stack1.apply(depth0):stack1))+'" class="discussion-image" target="_blank">\n                <img src="'+escapeExpression((stack1=depth0&&depth0.image,stack1=null==stack1||stack1===!1?stack1:stack1.src,typeof stack1===functionType?stack1.apply(depth0):stack1))+'" alt="'+escapeExpression((stack1=depth0&&depth0.image,stack1=null==stack1||stack1===!1?stack1:stack1.title,typeof stack1===functionType?stack1.apply(depth0):stack1))+'">\n            </a>\n        '}function program6(depth0,data){var stack1,helper,buffer="";return buffer+='\n            <a class="card-avatar" href="/home/forums/',(helper=helpers.id)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.id,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'">\n                <img src="'+escapeExpression((stack1=depth0&&depth0.favicon,stack1=null==stack1||stack1===!1?stack1:stack1.cache,typeof stack1===functionType?stack1.apply(depth0):stack1))+'" alt="',stack1=self.invokePartial(partials.forumName,"forumName",depth0,helpers,partials,data),(stack1||0===stack1)&&(buffer+=stack1),buffer+='" />\n            </a>\n        '}this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),partials=this.merge(partials,Handlebars.partials),data=data||{};var stack1,helper,options,buffer="",functionType="function",escapeExpression=this.escapeExpression,self=this,helperMissing=helpers.helperMissing;return buffer+='<div class="card-discussion',stack1=helpers.unless.call(depth0,depth0&&depth0.image,{hash:{},inverse:self.noop,fn:self.program(1,program1,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+='">\n    <div class="card-aside">\n    ',stack1=helpers["if"].call(depth0,depth0&&depth0.canShowThreadImage,{hash:{},inverse:self.noop,fn:self.program(3,program3,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+='\n    </div>\n    <div class="card-body">\n        ',stack1=helpers["with"].call(depth0,(stack1=depth0&&depth0.thread,null==stack1||stack1===!1?stack1:stack1.forum),{hash:{},inverse:self.noop,fn:self.program(6,program6,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+='\n        <div class="card-reason">\n            ',helper=helpers.getPartial||depth0&&depth0.getPartial,options={hash:{},data:data},stack1=helper?helper.call(depth0,"forumLink",(stack1=depth0&&depth0.thread,null==stack1||stack1===!1?stack1:stack1.forum),options):helperMissing.call(depth0,"getPartial","forumLink",(stack1=depth0&&depth0.thread,null==stack1||stack1===!1?stack1:stack1.forum),options),buffer+=escapeExpression(helpers.gettext.call(depth0,"%(forum)s recently published",{hash:{forum:stack1},data:data}))+'\n        </div>\n        <h2 class="discussion-title">\n            <a href="'+escapeExpression((stack1=depth0&&depth0.thread,stack1=null==stack1||stack1===!1?stack1:stack1.link,typeof stack1===functionType?stack1.apply(depth0):stack1))+'"\n                class="link-gray-darker truncate"\n                data-truncate-lines="',(helper=helpers.numTitleLines)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.numTitleLines,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'"\n                target="_blank"\n                data-role="thread-link">\n\n                ',stack1=depth0&&depth0.thread,stack1=null==stack1||stack1===!1?stack1:stack1.clean_title,stack1=typeof stack1===functionType?stack1.apply(depth0):stack1,(stack1||0===stack1)&&(buffer+=stack1),buffer+='\n            </a>\n        </h2>\n        <div class="card-summary">\n            <div class="card-summary-content truncate" data-truncate-lines="3">\n                ',(helper=helpers.threadDescription)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.threadDescription,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),(stack1||0===stack1)&&(buffer+=stack1),buffer+='\n            </div>\n        </div>\n        <footer class="card-footer" data-role="footer"></div>\n    </div>\n</div>\n'})}),define("home/views/ChannelCardTrendingView",["backbone-marionette","home/mixins/asChannelCard","home/templates/channelCardTrending"],function(Marionette,asChannelCard,channelCardTrendingTemplate){var ChannelCardTrendingView=Marionette.Layout.extend({template:channelCardTrendingTemplate});return asChannelCard.call(ChannelCardTrendingView.prototype),ChannelCardTrendingView}),define("home/views/ChannelCardCollectionView",["jquery","underscore","backbone","home/utils/layoutUtils","home/utils/mixpanelUtils","home/mixins/withViewFeedTracking","home/views/common/FetchableCollectionView","home/views/ChannelCardCreateView","home/views/ChannelCardFavoriteView","home/views/ChannelCardTrendingView"],function($,_,Backbone,LayoutUtils,MixpanelUtils,withViewFeedTracking,FetchableCollectionView,ChannelCardCreateView,ChannelCardFavoriteView,ChannelCardTrendingView){var ChannelCardCollectionView=FetchableCollectionView.extend({itemView:function(options){switch(options.model.get("verb")){case"favorite":return new ChannelCardFavoriteView(options);case"create":return new ChannelCardCreateView(options);case"trending":return new ChannelCardTrendingView(options);default:return new Backbone.View}},itemViewOptions:function(){var existingOptions=FetchableCollectionView.prototype.itemViewOptions;return _.isFunction(existingOptions)&&(existingOptions=existingOptions.apply(this,arguments)),_.defaults({channel:this.channel},existingOptions)},initialize:function(options){this.channel=options&&options.channel,FetchableCollectionView.prototype.initialize.apply(this,arguments)},onAfterItemAdded:LayoutUtils.scrollShownChanged,onShow:function(){var self=this;_.defer(function(){MixpanelUtils.track("view feed",{target:self.$el})})}});return withViewFeedTracking.call(ChannelCardCollectionView.prototype),ChannelCardCollectionView}),define("home/templates/relatedWrapper",["handlebars","handlebars.partials"],function(Handlebars){return Handlebars.template(function(Handlebars,depth0,helpers,partials,data){function program1(depth0,data){var stack1,helper,options,buffer="";return buffer+="\n            ",helper=helpers.getPartial||depth0&&depth0.getPartial,options={hash:{},data:data},stack1=helper?helper.call(depth0,"channelLink",depth0,options):helperMissing.call(depth0,"getPartial","channelLink",depth0,options),buffer+=escapeExpression(helpers.gettext.call(depth0,"More from %(source)s",{hash:{source:stack1},data:data}))+"\n        "}function program3(depth0,data){var stack1,helper,options,buffer="";return buffer+="\n            ",helper=helpers.getPartial||depth0&&depth0.getPartial,options={hash:{},data:data},stack1=helper?helper.call(depth0,"forumLink",depth0,options):helperMissing.call(depth0,"getPartial","forumLink",depth0,options),buffer+=escapeExpression(helpers.gettext.call(depth0,"More from %(source)s",{hash:{source:stack1},data:data}))+"\n        "}this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var stack1,buffer="",helperMissing=helpers.helperMissing,escapeExpression=this.escapeExpression,self=this;return buffer+='<div class="cards-featured-header">\n    <h2 data-role="featured-title">\n        ',stack1=helpers["if"].call(depth0,depth0&&depth0.hasChannel,{hash:{},inverse:self.program(3,program3,data),fn:self.program(1,program1,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+='\n    </h2>\n</div>\n<div class="cards-featured" data-role="cards" style="margin-top: 0"></div>\n'})}),define("home/views/RelatedWrapperView",["backbone-marionette","home/views/ChannelCardCollectionView","home/templates/relatedWrapper"],function(Marionette,ChannelCardCollectionView,relatedWrapperTemplate){var RelatedWrapperView=Marionette.Layout.extend({className:"threads-related",regions:{cardRegion:"[data-role=cards]"},template:relatedWrapperTemplate,templateHelpers:function(){return{hasChannel:this.channel}},modelEvents:{change:"render"},initialize:function(options){this.channel=options.channel,this.relatedCollection=options.relatedCollection},onDomRefresh:function(){this.cardRegion.show(new ChannelCardCollectionView({channel:this.channel,collection:this.relatedCollection}))}});return RelatedWrapperView}),define("home/templates/discussionPage",["handlebars","handlebars.partials"],function(Handlebars){return Handlebars.template(function(Handlebars,depth0,helpers,partials,data){return this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{},'<section id="discussion-cover"></section>\n<div class="section-contained">\n    <section class="container-3-col discussion-comments" id="discussion-comments"></section>\n    <section data-role="related"></section>\n</div>\n'})}),define("home/views/DiscussionPageView",["jquery","backbone-marionette","home/models/common/UniqueModel","home/models/ForumFeed","home/models/ChannelProfile","home/collections/common/SelectiveCollection","home/utils/backboneUtils","home/utils/layoutUtils","home/views/NetworkDiscussionCoverView","home/views/UserGeneratedDiscussionCoverView","home/views/EmbedContainerView","home/views/FetchingView","home/views/RelatedWrapperView","home/templates/discussionPage"],function($,Marionette,UniqueModel,ForumFeed,ChannelProfile,SelectiveCollection,backboneUtils,layoutUtils,NetworkDiscussionCoverView,UserGeneratedDiscussionCoverView,EmbedContainerView,FetchingView,RelatedWrapperView,discussionPageTemplate){return Marionette.Layout.extend({template:discussionPageTemplate,regions:{cover:"#discussion-cover",comments:"#discussion-comments",relatedRegion:"[data-role=related]"},initialize:function(options){this.channel=options.channel},modelEvents:{sync:"render"},onDomRefresh:function(){this.showCover(),this.comments.show(new EmbedContainerView({model:this.model})),this.showRelated()},showCover:function(){if(this.model.shouldFetch())return void this.cover.show(new FetchingView);var CoverView=this.model.get("isUserGenerated")?UserGeneratedDiscussionCoverView:NetworkDiscussionCoverView;this.cover.show(new CoverView({model:this.model,channel:this.getChannel()}))},getChannel:function(){return this.channel||this.model.forum.channel},getRelatedThreads:function(){var relatedThreads,channelProfile,forumFeed,channel=this.getChannel();return channel?(channelProfile=new UniqueModel(ChannelProfile,{channel:channel}),channelProfile.ensureFetchedTopActivities(),relatedThreads=channelProfile.topActivities.get("items")):(forumFeed=new UniqueModel(ForumFeed,{id:this.model.forum.id}),forumFeed.fetch(),relatedThreads=forumFeed.get("items")),relatedThreads},showRelated:function(){var self=this,relatedCollection=new SelectiveCollection(void 0,{toSelect:this.getRelatedThreads(),maxSize:3,shouldSelect:function(activityFeedItem){return activityFeedItem.thread!==self.model&&activityFeedItem.hasThreadImage()},order:function(collection){return collection.shuffle()}});this.relatedRegion.show(new RelatedWrapperView({relatedCollection:relatedCollection,model:this.getChannel()||this.model.forum,channel:this.getChannel()}))},getTitle:function(){return $.when(backboneUtils.getPromiseFor(this.model,"title"),backboneUtils.getPromiseFor(this.model.forum,"name")).then(function(threadTitle,forumName){return"- "+threadTitle+" - "+forumName})}})}),define("home/apps/common/collections",["underscore","backbone","jquery","home/apps/dashboard/mixpanelUtils","core/collections/PaginatedCollection","home/collections/common/ExtensibleCollection"],function(_,Backbone,$,MixpanelUtils,PaginatedCollection,ExtensibleCollection){var buildUrl=function(suffix){return"//disqus.com/api/3.0/"+suffix};return{PaginatedCollection:PaginatedCollection,ExtensibleCollection:ExtensibleCollection,buildUrl:buildUrl}}),define("home/apps/dashboard/collections",["underscore","backbone","jquery","home/apps/common/collections","home/apps/dashboard/models","home/apps/common/backboneUtils","home/collections/ForumCollection","home/collections/FollowingForumCollection"],function(_,Backbone,$,CommonCollections,Models,BackboneUtils,ForumCollection,FollowingForumCollection){var ActivityItemCollection=CommonCollections.ExtensibleCollection.extend({url:CommonCollections.buildUrl("activity/list"),parse:function(response){return response.response=_.chain(response.response).map(ActivityItemCollection.transform,this).compact().value(),CommonCollections.ExtensibleCollection.prototype.parse.call(this,response)
}},{transform:function(item){var actor,verb,object,target,thread;if(!item||!item.target)return void Raven.captureMessage("Invalid data from endpoint",item);switch(item.type){case"activity.FollowingUserThreadVoteEvent":case"activity.SelfThreadVoteEvent":verb="star",actor=new Models.UniqueModel(Models.User,item.target.user),target=new Models.UniqueModel(Models.Thread,item.target.thread,{forum:item.target.forum}),thread=target;break;case"activity.FollowingUserPostEvent":case"activity.SelfPostEvent":if(verb="comment",actor=new Models.UniqueModel(Models.User,item.target.author),target=new Models.UniqueModel(Models.Thread,item.target.thread,{forum:item.target.forum}),thread=target,object=new Models.UniqueModel(Models.Post,item.target,{author:actor,thread:thread}),!item.target.parent_post)break;case"activity.ReplyPostEvent":verb="reply",actor=new Models.UniqueModel(Models.User,item.target.author),thread=new Models.UniqueModel(Models.Thread,item.target.thread,{forum:item.target.forum}),object=new Models.UniqueModel(Models.Post,item.target,{author:actor,thread:thread}),target=new Models.UniqueModel(Models.Post,item.target.parent_post,{thread:thread})}var modelId=Models.ActivityItem.buildId(actor,verb,object,target),model=new Models.UniqueModel(Models.ActivityItem,{id:modelId,verb:verb});return model.actor=actor,model.object=object,model.target=target,model.thread=thread,model}}),TopicCollection=Backbone.Collection.extend({model:Models.Topic}),ThreadCollection=CommonCollections.ExtensibleCollection.extend({model:Models.Thread,parse:function(response){return response.response=_.map(response.response,ThreadCollection.transform,this),CommonCollections.ExtensibleCollection.prototype.parse.call(this,response)}},{transform:function(item){var thread=new Models.UniqueModel(Models.Thread,item,{forum:item.forum});return thread}}),ActiveForumCollection=ForumCollection.extend({url:"//disqus.com/api/3.0/users/listActiveForums"}),CombinedCollection=CommonCollections.ExtensibleCollection.extend({parse:function(response){return response.response=_.chain(response.response).map(function(group){var transform="trending"===group.type?ThreadCollection.transform:ActivityItemCollection.transform;return _.map(group.feed,transform)}).flatten().value(),CommonCollections.ExtensibleCollection.prototype.parse.call(this,response)}}),ForumFeedCollection=Backbone.Collection.extend({model:function(){var constructor=_.bind(Models.UniqueModel,Models.UniqueModel,Models.Forum);return constructor.prototype=Models.Forum.prototype,constructor}()}),BundleCollection=Backbone.Collection.extend({model:Models.Bundle});return{TopicCollection:TopicCollection,ActivityItemCollection:ActivityItemCollection,ForumFeedCollection:ForumFeedCollection,BundleCollection:BundleCollection,ThreadCollection:ThreadCollection,ActiveForumCollection:ActiveForumCollection,FollowingForumCollection:FollowingForumCollection,CombinedCollection:CombinedCollection}}),define("home/templates/partials/dashboard/bundle",["handlebars"],function(Handlebars){Handlebars.registerPartial("bundle",Handlebars.template(function(Handlebars,depth0,helpers,partials,data){function program1(){return"btn-opaque"}function program3(){return"followed"}this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var stack1,helper,buffer="",functionType="function",escapeExpression=this.escapeExpression,self=this;return buffer+='<img class="avatar" src="',(helper=helpers.iconUrl)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.iconUrl,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'">\n<h4>\n  ',(helper=helpers.name)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.name,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+'\n  <a href="#"\n  class="btn btn-follow btn-small ',stack1=helpers["if"].call(depth0,depth0&&depth0.applyBtnOpaque,{hash:{},inverse:self.noop,fn:self.program(1,program1,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+=" ",stack1=helpers["if"].call(depth0,depth0&&depth0.followed,{hash:{},inverse:self.noop,fn:self.program(3,program3,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+='"\n  data-action="follow-bundle">\n    <span class="text-default">Follow</span>\n    <span class="text-followed text-following">\n        <span class="symbol-following">\n            <span class="icon-checkmark"></span>\n        </span>\n    </span>\n  </a>\n</h4>\n<p>',(helper=helpers.description)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.description,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"</p>\n"}))}),define("home/apps/dashboard/views/bundleCollection",["backbone-marionette","handlebars","home/templates/partials/dashboard/bundle"],function(Marionette,Handlebars){var BundleItemView=Marionette.ItemView.extend({tagName:"li",className:"followable",template:Handlebars.partials.bundle,templateHelpers:function(){return{applyBtnOpaque:this.applyBtnOpaque}},events:{"click [data-action=follow-bundle]":"handleFollowBundle"},initialize:function(options){this.applyBtnOpaque=options.applyBtnOpaque},handleFollowBundle:function(ev){ev.preventDefault(),this.$(ev.currentTarget).toggleClass("followed").toggleClass("active"),this.model.toggleFollowed()}}),BundleCollectionView=Marionette.CollectionView.extend({tagName:"ul",className:"followables",itemView:BundleItemView});return BundleCollectionView}),define("home/apps/dashboard/fixtures/bundles",[],function(){return[{name:"Hack",shortname:"disqus-hack",description:"What's hot in technology and startups",shortDescription:"Technology and startups",models:[{id:"disqus-hack"},{id:"avc"},{id:"wiredgadgetlab"},{id:"wireddesign"},{id:"wiredscience"},{id:"wiredthreatlevel"},{id:"thewirecutter"},{id:"bgr"},{id:"thenextweb"},{id:"firstroundcapital"},{id:"marketingland"}]},{name:"Taste",shortname:"disqus-taste",description:"Eat, drink, and travel",shortDescription:"Eat, drink, travel",models:[{id:"disqus-taste"},{id:"theatlanticcities"},{id:"nomnompaleo"},{id:"amateurgourmet"},{id:"budgettravel"},{id:"inanotherlangua"},{id:"dianeabroad"},{id:"theveggiemama"}]},{name:"Watch",shortname:"disqus-watch",description:"Talk about the best in movies and TV",shortDescription:"Best in movies and TV",models:[{id:"disqus-watch"},{id:"avclub"},{id:"slashfilm"},{id:"thedissolve"},{id:"rollingstone"},{id:"hollywoodreporter"},{id:"ewm"},{id:"latinoreview"},{id:"aintitcoolnews"}]},{name:"Game",shortname:"disqus-game",description:"The latest in games: consoles, PC, mobile, online",shortDescription:"The latest in games",models:[{id:"disqus-game"},{id:"destructoid"},{id:"qt3"},{id:"lazygamer"},{id:"majornelson"},{id:"gamingbolt"},{id:"susd"}]},{name:"Live",shortname:"disqus-live",description:"Style and culture add to a life worth living",shortDescription:"Style and culture",models:[{id:"disqus-live"},{id:"thoughtcatalog"},{id:"xojane"},{id:"shefinds"},{id:"mommyishcom"},{id:"intothegloss"},{id:"tomandlorenzo"},{id:"themanrepeller"},{id:"cupcakesandcashmere"}]}]}),define("home/apps/dashboard/views/boundBundleCollection",["underscore","home/apps/dashboard/collections","home/apps/dashboard/views/bundleCollection","home/apps/dashboard/fixtures/bundles"],function(_,Collections,BundleCollectionView,bundleModels){function boundBundleCollectionView(options){return new BundleCollectionView(_.defaults({collection:new Collections.BundleCollection(bundleModels,{CDN_ROOT:DISQUS.home.app.CDN_ROOT,CollectionClass:Collections.ForumFeedCollection})},options))}return boundBundleCollectionView}),define("home/templates/onboarding",["handlebars","handlebars.partials"],function(Handlebars){return Handlebars.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var buffer="";return buffer+='\n<div class="welcome-page-wrapper">\n  <div class="welcome-page">\n    <header>\n        <h2>A Home for <img src="//a.disquscdn.com/dotcom/current/img/brand/disqus-logo-light-transparent.png" alt="DISQUS"></h2>\n        <p>The web\'s community of communities now has one central hub.</p>\n    </header>\n    <ul class="marketing-blocks thirds">\n        <li>\n            <svg class="icon-notif" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 40 40" enable-background="new 0 0 40 40" xml:space="preserve"><path class="outline" d="M20.7 40c-4.4 0-8.7-1.6-12.1-4.4l-7.2 1c-0.4 0.1-0.9-0.1-1.2-0.5c-0.3-0.3-0.3-0.8-0.2-1.2l2.8-7.1 c-1-2.5-1.5-5.1-1.5-7.8C1.4 9 10 0 20.7 0C31.3 0 40 9 40 20S31.3 40 20.7 40z M9 33.1c0.3 0 0.6 0.1 0.8 0.3 c3 2.7 6.9 4.1 10.9 4.1c9.3 0 16.8-7.9 16.8-17.5S30 2.5 20.7 2.5C11.4 2.5 3.9 10.4 3.9 20c0 2.5 0.5 5 1.5 7.3 c0.1 0.3 0.1 0.7 0 1l-2.2 5.6l5.6-0.8C8.9 33.1 8.9 33.1 9 33.1z"/><path class="fill" d="M20.7 0C10 0 1.4 9 1.4 20c0 2.7 0.5 5.3 1.5 7.8l-2.8 7.1c-0.2 0.4-0.1 0.9 0.2 1.2 c0.3 0.3 0.7 0.5 1.2 0.5l7.2-1C12 38.4 16.3 40 20.7 40C31.3 40 40 31 40 20S31.3 0 20.7 0z"/><path class="dot" d="M11.2 20c0-1.4 1.1-2.5 2.5-2.5s2.5 1.1 2.5 2.5s-1.1 2.5-2.5 2.5 S11.2 21.4 11.2 20z"/><path class="dot" d="M18.7 20c0-1.4 1.1-2.5 2.5-2.5s2.5 1.1 2.5 2.5s-1.1 2.5-2.5 2.5 S18.7 21.4 18.7 20z"/><path class="dot" d="M26.2 20c0-1.4 1.1-2.5 2.5-2.5s2.5 1.1 2.5 2.5s-1.1 2.5-2.5 2.5 S26.2 21.4 26.2 20z"/></svg>\n            <h3>Notifications</h3>\n            <p>All of your notifications, including upvotes, replies, and new followers.</p>\n        </li>\n        <li>\n            <svg class="icon-home-line" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 35 32" enable-background="new 0 0 35 32" xml:space="preserve"><path d="M28.7 32h-7.5c-0.6 0-1-0.4-1-1V20.5h-5.5V31c0 0.6-0.4 1-1 1H6.6c-2.5 0-2.5-1.8-2.5-2.5V19H2 c-1.3 0-1.8-0.7-1.9-1c-0.1-0.3-0.3-1.1 0.6-2.1l14.7-15c1.1-1.1 3.1-1.2 4.2 0l14.7 15c0.9 1 0.7 1.8 0.6 2.1 c-0.1 0.3-0.6 1-1.9 1h-2.1v10.5C30.9 30.2 30.9 32 28.7 32z M22.2 30h6.5c0.1 0 0.1 0 0.1 0c0-0.1 0-0.4 0-0.5V18 c0-0.6 0.4-1 1-1h2.7L18.2 2.3c-0.4-0.4-1-0.4-1.3 0L2.4 17h2.7c0.6 0 1 0.4 1 1v11.5c0 0.1 0 0.4 0 0.5c0 0 0.2 0 0.5 0h6.1 V19.5c0-0.6 0.4-1 1-1h7.5c0.6 0 1 0.4 1 1V30z" /></svg>\n            <h3>One Feed</h3>\n            <p>All of the conversations you\'re interested in, all in one place.</p>\n        </li>\n        <li>\n            <svg class="icon-face-line" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 32 32" enable-background="new 0 0 32 32" xml:space="preserve"><path d="M16 0C7.2 0 0 7.2 0 16s7.2 16 16 16s16-7.2 16-16S24.8 0 16 0z M16 30C8.3 30 2 23.7 2 16S8.3 2 16 2s14 6.3 14 14S23.7 30 16 30z"/><path d="M9.4 14.6c0.4 3.3 3.2 5.8 6.6 5.8s6.2-2.5 6.6-5.8 c-1.3 1.3-3.8 1.7-6.6 1.7S10.7 15.8 9.4 14.6z"/><ellipse cx="7.3" cy="12" rx="2.3" ry="2.1"/><path d="M24.7 9.6c-1.2 0-2.3 1-2.3 2.2c0 1.2 1 2.1 2.3 2.1 s2.3-1 2.3-2.1C27 10.6 26 9.6 24.7 9.6z"/></svg>\n            <h3>Discovery</h3>\n            <p>Find discussions and communities about whatever you\'re interested in.</p>\n        </li>\n    </ul>\n  </div>\n</div>\n'})}),define("home/views/OnboardingView",["backbone-marionette","home/apps/dashboard/views/boundBundleCollection","home/templates/onboarding"],function(Marionette,boundBundleCollectionView,onboardingTemplate){return Marionette.Layout.extend({template:onboardingTemplate,templateHelpers:function(){return{user:this.session.user.toJSON()}},regions:{bundlesRegion:"#followable-bundles"},initialize:function(options){this.session=options.session,this.listenTo(this.session,"change:id",this.render)},getTitle:function(){return"Welcome"},onDomRefresh:function(){this.bundlesRegion.getEl(this.bundlesRegion.el).length&&this.showBundlesRegion()},showBundlesRegion:function(){this.bundlesRegion.show(boundBundleCollectionView({itemViewOptions:{applyBtnOpaque:!0}}))}})}),define("home/templates/forumFeedEmpty",["handlebars","handlebars.partials"],function(Handlebars){return Handlebars.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var buffer="";return buffer+='<div class="empty-message">\n\n    \n    <svg class="art-empty-community" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 94 128" enable-background="new 0 0 94 128" xml:space="preserve"><path class="house" d="M61 118.4l-9.8-10c-0.5-0.5-1.3-0.5-1.8 0l-9.8 10c-0.5 0.5-0.3 1 0.4 1h2v7.7c0 0.6 0 1 1 1h4.8v-7.7h5 v7.7h5c0.8 0 0.8-0.4 0.8-1v-7.7h2C61.3 119.3 61.5 118.9 61 118.4z" /><path class="bubble-top" d="M75.2 21C75.2 9.4 66.2 0 55 0C43.8 0 34.8 9.4 34.8 21c0 3.1 0.7 6.1 1.8 8.7l-3.4 8.5l8.7-1.2 c3.5 3.1 8.1 5 13.1 5C66.2 42 75.2 32.6 75.2 21z M56.4 26.6h-1.9V22h-5.1v4.5h-1.9V15.8h1.9v4.5h5.1v-4.5h1.9V26.6z M60.9 26.6 h-1.9v-8.1h1.9V26.6z M61 17.2h-2v-1.8h2V17.2z"/><path class="bubble-left" d="M79.3 47c-8 0-14.5 6.7-14.5 15c0 2.2 0.5 4.3 1.3 6.2l-2.4 6.1l6.2-0.9c2.5 2.2 5.8 3.6 9.3 3.6 c8 0 14.5-6.7 14.5-15S87.3 47 79.3 47z M80.5 66.6H79v-3.7h-4.2v3.7h-1.6v-8.9h1.6v3.7H79v-3.7h1.6V66.6z M84.3 66.6h-1.5v-6.7h1.5 V66.6z M84.3 58.9h-1.6v-1.5h1.6V58.9z" /><path class="bubble-right" d="M48.4 72c0-13.8-10.8-25-24.1-25C11 47 0.2 58.2 0.2 72S11 97 24.3 97c5.9 0 11.4-2.2 15.6-5.9l10.3 1.5 l-4-10.2C47.7 79.2 48.4 75.7 48.4 72z M26.4 78.6h-2.2v-5.3h-6v5.3H16V66h2.2v5.3h6V66h2.2V78.6z M31.7 78.6h-2.2v-9.5h2.2V78.6z M31.8 67.6h-2.3v-2.1h2.3V67.6z"/></svg>\n\n    This community hasn\'t been busy recently.</br><a href="/home/">Head back home to find interesting discussions &raquo;</a>\n</div>\n'})}),define("home/views/ForumFeedEmptyView",["backbone-marionette","home/templates/forumFeedEmpty"],function(Marionette,forumFeedEmptyTemplate){return Marionette.ItemView.extend({template:forumFeedEmptyTemplate})}),define("home/models/SearchManager",["underscore","backbone","home/models/common/UniqueModel","home/models/Feed","home/models/ActivityFeedItem","home/models/Thread","home/models/User","home/models/Forum","home/models/Post","home/models/activities/TrendingThreadActivity","home/collections/FeedItemCollection","core/api"],function(_,Backbone,UniqueModel,Feed,ActivityFeedItem,Thread,User,Forum,Post,TrendingThreadActivity,FeedItemCollection,api){var SearchCollection=Backbone.Collection.extend({parse:function(resp){return resp.response}}),transformThread=function(thread){thread=new Thread(thread);var model=new ActivityFeedItem({verb:"trending"},{activities:[new TrendingThreadActivity({id:thread.id,target:thread})]});return model.thread=thread,model},ThreadSearchCollection=FeedItemCollection.extend({parse:function(resp){return _.map(resp.response,transformThread)},fetch:function(options){return Backbone.Collection.prototype.fetch.call(this,options)}});return Backbone.Model.extend({initialize:function(attrs){var searchUrl=api.getURL("users/search"),query=attrs.query;this.threads=new Feed({fetchOptions:{obj_type:"thread",query:query}},{collection:new ThreadSearchCollection,collectionUrl:searchUrl}),this.forums=new Feed({fetchOptions:{obj_type:"forum",query:query}},{collection:new SearchCollection(null,{model:UniqueModel.boundModel(Forum)}),collectionUrl:searchUrl}),this.users=new Feed({fetchOptions:{obj_type:"user",query:query}},{collection:new SearchCollection(null,{model:UniqueModel.boundModel(User)}),collectionUrl:searchUrl}),this.posts=new Feed({fetchOptions:{obj_type:"post",query:query}},{collection:new SearchCollection(null,{model:UniqueModel.boundModel(Post)}),collectionUrl:searchUrl}),this.myposts=new Feed({fetchOptions:{obj_type:"post",query:query,user:attrs.userId}},{collection:new SearchCollection(null,{model:UniqueModel.boundModel(Post)}),collectionUrl:searchUrl})},fetchSearchResults:function(){this.threads.fetchItems({reset:!0}),this.forums.fetchItems({reset:!0}),this.users.fetchItems({reset:!0}),this.posts.fetchItems({reset:!0}),this.myposts.fetchItems({reset:!0})}})}),define("home/templates/searchResults",["handlebars","handlebars.partials"],function(Handlebars){return Handlebars.template(function(Handlebars,depth0,helpers,partials,data){return this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{},'<ul class="nav-tabs tabs-5">\n    <li data-action="switch-tab" data-tab="threads" class="active">\n        <a href="#">\n            Threads\n        </a>\n    </li>\n    <li data-action="switch-tab" data-tab="forums">\n        <a href="#">\n            Communities\n        </a>\n    </li>\n    <li data-action="switch-tab" data-tab="users">\n        <a href="#">\n            Users\n        </a>\n    </li>\n    <li data-action="switch-tab" data-tab="posts">\n        <a href="#">\n            Comments\n        </a>\n    </li>\n    <li data-action="switch-tab" data-tab="myposts">\n        <a href="#">\n            My Comments\n        </a>\n    </li>\n</ul>\n\n<div data-role="content-area"></div>\n<div data-role="footer-area"></div>\n'})}),define("home/views/SearchResultsView",["home/views/common/TabbedView","home/views/ForumCardCollectionView","home/views/UserCollectionView","home/views/FeedEmptyView","home/views/ActivityCardView","home/views/PostCollectionView","home/views/ActivityCardCollectionView","home/templates/searchResults"],function(TabbedView,ForumCardCollectionView,UserCollectionView,FeedEmptyView,ActivityCardView,PostCollectionView,ActivityCardCollectionView,searchResultsTemplate){return TabbedView.extend({defaultTab:"threads",template:searchResultsTemplate,getTabView:function(tab){var feed=this.model[tab];switch(tab){case"threads":return new ActivityCardCollectionView({itemView:ActivityCardView.extend({className:"card"}),model:feed,collection:feed.get("items")});case"forums":return new ForumCardCollectionView({emptyView:FeedEmptyView,model:feed,collection:feed.get("items")});case"users":return new UserCollectionView({emptyView:FeedEmptyView,model:feed,collection:feed.get("items")});case"posts":return new PostCollectionView({className:"cards",emptyView:FeedEmptyView,model:feed,collection:feed.get("items")});case"myposts":return new PostCollectionView({className:"cards",emptyView:FeedEmptyView,model:feed,collection:feed.get("items")})}}})}),define("home/templates/searchPage",["handlebars","handlebars.partials"],function(Handlebars){return Handlebars.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var buffer="";return buffer+='\n<div class="cover section-contained" data-role="cover-area">\n    <div class="cover-body search">\n    <form>\n        <span class="icon-search"></span>\n        <input class="search-input" type="text" placeholder="Search" data-role="search-query">\n    </div>\n    </form>\n</div>\n<div id="container-content" class="section-contained">\n    <div data-role="search-results"></div>\n</div>\n'})}),define("home/views/SearchPageLayout",["backbone-marionette","home/models/SearchManager","home/views/SearchResultsView","home/templates/searchPage"],function(Marionette,SearchManager,SearchResultsView,searchPageTemplate){return Marionette.Layout.extend({template:searchPageTemplate,ui:{query:"[data-role=search-query]"},events:{submit:"handleSearchRequest"},regions:{resultsRegion:"[data-role=search-results]"},initialize:function(options){this.session=options.session},getTitle:function(){return"Search"},handleSearchRequest:function(ev){ev.preventDefault();var searchManager=new SearchManager({query:this.ui.query.val(),userId:this.session.user.get("id")});searchManager.fetchSearchResults(),this.resultsRegion.show(new SearchResultsView({model:searchManager}))}})}),define("home/templates/channelCover",["handlebars","handlebars.partials"],function(Handlebars){return Handlebars.template(function(Handlebars,depth0,helpers,partials,data){function program1(depth0){var stack1,buffer="";return buffer+='\n    <img class="channel-logo" src="'+escapeExpression((stack1=depth0&&depth0.options,stack1=null==stack1||stack1===!1?stack1:stack1.titleLogo,stack1=null==stack1||stack1===!1?stack1:stack1.cache,typeof stack1===functionType?stack1.apply(depth0):stack1))+'" />\n'}function program3(depth0,data){var stack1,helper,buffer="";return buffer+='\n    <h1 class="channel-name">',(helper=helpers.name)?stack1=helper.call(depth0,{hash:{},data:data}):(helper=depth0&&depth0.name,stack1=typeof helper===functionType?helper.call(depth0,{hash:{},data:data}):helper),buffer+=escapeExpression(stack1)+"</h1>\n"}this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var stack1,buffer="",functionType="function",escapeExpression=this.escapeExpression,self=this;return stack1=helpers["if"].call(depth0,(stack1=depth0&&depth0.options,null==stack1||stack1===!1?stack1:stack1.titleLogo),{hash:{},inverse:self.program(3,program3,data),fn:self.program(1,program1,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+='\n<a href="/home/discuss/'+escapeExpression((stack1=depth0&&depth0.primaryForum,stack1=null==stack1||stack1===!1?stack1:stack1.id,typeof stack1===functionType?stack1.apply(depth0):stack1))+'" class="btn btn-primary discussion-create">Create Discussion <span class="icon-pencil"></span></a>\n'})}),define("home/views/ChannelCoverView",["backbone-marionette","home/models/Session","home/templates/channelCover"],function(Marionette,Session,channelCoverTemplate){var ChannelCoverView=Marionette.ItemView.extend({className:"channel-cover",template:channelCoverTemplate,initialize:function(){this.session=new Session,this.listenTo(this.session,"change:id",this.render)},modelEvents:{sync:"render"},onRender:function(){var image=this.model.get("options").coverImage;image&&this.$el.css({"background-image":"url("+image.cache+")","background-position":"0% 0px;"}).addClass("cover-image")}});return ChannelCoverView}),define("home/views/UserAvatarView",["backbone-marionette","handlebars"],function(Marionette,Handlebars){var UserAvatarView=Marionette.ItemView.extend({tagName:"li",template:Handlebars.partials.userAvatar});return UserAvatarView}),define("home/views/UserAvatarCollectionView",["underscore","backbone","backbone-marionette","home/views/UserAvatarView"],function(_,Backbone,Marionette,UserAvatarView){var UserAvatarCollectionView=Marionette.CollectionView.extend({itemView:UserAvatarView,tagName:"ul",initialize:function(options){this.showLimit=_.isNumber(options.showLimit)?options.showLimit:1/0},addItemView:function(item,ItemView,index){index>=this.showLimit||Marionette.CollectionView.prototype.addItemView.apply(this,arguments)}});return UserAvatarCollectionView}),define("home/templates/channelGuidelines",["handlebars","handlebars.partials"],function(Handlebars){return Handlebars.template(function(Handlebars,depth0,helpers,partials,data){function program1(depth0){var stack1,buffer="";return buffer+=escapeExpression((stack1=depth0&&depth0.primaryForum,stack1=null==stack1||stack1===!1?stack1:stack1.guidelines,typeof stack1===functionType?stack1.apply(depth0):stack1))+"\n        "}function program3(){return"\n            Do no harm.\n        "}this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var stack1,buffer="",functionType="function",escapeExpression=this.escapeExpression,self=this;return buffer+='<div class="section-contained" style="background-color: #FFF; padding: 20px">\n    <h4 class="modal-title">Community Guidelines</h4>\n    <div style="margin-top: 15px; white-space: pre-wrap">',stack1=helpers["if"].call(depth0,(stack1=depth0&&depth0.primaryForum,null==stack1||stack1===!1?stack1:stack1.guidelines),{hash:{},inverse:self.program(3,program3,data),fn:self.program(1,program1,data),data:data}),(stack1||0===stack1)&&(buffer+=stack1),buffer+="</div>\n</div>\n"})}),define("home/views/ChannelGuidelinesView",["underscore","backbone-marionette","home/templates/channelGuidelines"],function(_,Marionette,channelGuidelinesTemplate){var ChannelGuidelinesView=Marionette.ItemView.extend({template:channelGuidelinesTemplate,initialize:function(){this.bindPrimaryForum()},bindPrimaryForum:function(){this.model.primaryForum?this.listenTo(this.model.primaryForum,"change:guidelines",this.render):this.listenToOnce(this.model,"changeRelated:primaryForum",function(){this.bindPrimaryForum(),this.render()})}});return ChannelGuidelinesView}),define("home/templates/channelProfile",["handlebars","handlebars.partials"],function(Handlebars){return Handlebars.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var stack1,buffer="",functionType="function",escapeExpression=this.escapeExpression;return buffer+='<div class="section-expanded">\n    <section data-role="cover"></section>\n</div>\n<div class="section-contained">\n    <div class="cards-featured" data-role="top-featured"></div>\n</div>\n<div class="nav-channel section-contained">\n    <section class="channel-experts hidden" data-role="experts">\n        <a data-action="switch-tab" data-tab="experts" href="/home/channels/'+escapeExpression((stack1=depth0&&depth0.channel,stack1=null==stack1||stack1===!1?stack1:stack1.slug,typeof stack1===functionType?stack1.apply(depth0):stack1))+'/experts" class="experts-label">\n            <span data-role="channel-name">'+escapeExpression((stack1=depth0&&depth0.channel,stack1=null==stack1||stack1===!1?stack1:stack1.name,typeof stack1===functionType?stack1.apply(depth0):stack1))+'</span> Creators\n        </a>\n        <div class="channel-experts-avatars" data-role="user-sources"></div>\n        <a class="channel-experts-more" data-action="switch-tab" data-tab="experts" href="/home/channels/'+escapeExpression((stack1=depth0&&depth0.channel,stack1=null==stack1||stack1===!1?stack1:stack1.slug,typeof stack1===functionType?stack1.apply(depth0):stack1))+'/experts">\n            <svg class="icon-more-options" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 32 32" enable-background="new 0 0 32 32" xml:space="preserve"><path d="M16 2c7.7 0 14 6.3 14 14s-6.3 14-14 14S2 23.7 2 16S8.3 2 16 2 M16 0C7.2 0 0 7.2 0 16s7.2 16 16 16 s16-7.2 16-16S24.8 0 16 0L16 0z"/><path d="M7 16c0-1.1 0.9-2 2-2s2 0.9 2 2s-0.9 2-2 2S7 17.1 7 16z"/><path d="M14 16c0-1.1 0.9-2 2-2s2 0.9 2 2s-0.9 2-2 2S14 17.1 14 16z"/><path d="M21 16c0-1.1 0.9-2 2-2s2 0.9 2 2s-0.9 2-2 2S21 17.1 21 16z"/></svg>\n        </a>\n    </section>\n    <ul class="nav-tabs-narrow">\n        <li data-action="switch-tab" data-tab="top">\n            <a href="/home/channels/'+escapeExpression((stack1=depth0&&depth0.channel,stack1=null==stack1||stack1===!1?stack1:stack1.slug,typeof stack1===functionType?stack1.apply(depth0):stack1))+'/top">\n                Top Stories\n            </a>\n        </li>\n        <li data-action="switch-tab" data-tab="recent">\n            <a href="/home/channels/'+escapeExpression((stack1=depth0&&depth0.channel,stack1=null==stack1||stack1===!1?stack1:stack1.slug,typeof stack1===functionType?stack1.apply(depth0):stack1))+'/recent">\n                Most Recent\n            </a>\n        </li>\n        <li data-action="switch-tab" data-tab="discussions" class="hidden">\n            <a href="/home/channels/'+escapeExpression((stack1=depth0&&depth0.channel,stack1=null==stack1||stack1===!1?stack1:stack1.slug,typeof stack1===functionType?stack1.apply(depth0):stack1))+'/discussions">\n                By Creators\n            </a>\n        </li>\n    </ul>\n</div>\n<section data-role="content-area" class="section-contained"></section>\n'})}),define("home/views/ChannelProfileView",["jquery","underscore","backbone","backbone-marionette","home/utils/layoutUtils","home/utils/backboneUtils","home/collections/common/SelectiveCollection","home/views/common/TabbedView","home/views/ChannelCoverView","home/views/ChannelCardCollectionView","home/views/UserAvatarCollectionView","home/views/common/FetchableCollectionLayout","home/views/UserCollectionView","home/views/ChannelGuidelinesView","home/templates/channelProfile"],function($,_,Backbone,Marionette,layoutUtils,backboneUtils,SelectiveCollection,TabbedView,ChannelCoverView,ChannelCardCollectionView,UserAvatarCollectionView,FetchableCollectionLayout,UserCollectionView,ChannelGuidelinesView,channelProfileTemplate){var ChannelProfileView=TabbedView.extend({defaultTab:"top",template:channelProfileTemplate,regions:_.defaults({coverRegion:"[data-role=cover]",topFeaturedRegion:"[data-role=top-featured]",userSourcesRegion:"[data-role=user-sources]"},TabbedView.prototype.regions),initialize:function(){TabbedView.prototype.initialize.apply(this,arguments),this.listenTo(this.contentRegion,"show",this.bindFeaturedDedup)},modelEvents:{"change:name":"updateChannelName"},bindFeaturedDedup:function(feedView){this.listenTo(feedView,"showCollection",this.hideAlreadyFeatured),this.listenToOnce(this.contentRegion,"close",function(){this.stopListening(feedView)})},updateChannelName:function(){this.$("[data-role=channel-name]").text(this.model.channel.get("name"))},fillFeaturedRegion:function(){var itemViewOptions=function(){var existingOptions=ChannelCardCollectionView.prototype.itemViewOptions;return _.isFunction(existingOptions)&&(existingOptions=existingOptions.apply(this,arguments)),_.defaults({numTitleLines:3},existingOptions)},featuredCollection=new SelectiveCollection(void 0,{toSelect:this.model.topActivities.get("items"),maxSize:3,shouldSelect:function(activityFeedItem){return activityFeedItem.hasThreadImage()}});this.listenTo(featuredCollection,"add",this.hideActivityFeedItem),this.topFeaturedRegion.show(new ChannelCardCollectionView({channel:this.model.channel,itemViewOptions:itemViewOptions,collection:featuredCollection}))},getCardFromMainFeed:function(activityFeedItem){var feedView=this.contentRegion.currentView;if(feedView.contentRegion){var cardsCollectionView=feedView.contentRegion.currentView;return cardsCollectionView.children?cardsCollectionView.children.findByModel(activityFeedItem):null}},hideAlreadyFeatured:function(){var featured=this.topFeaturedRegion.currentView.children.map(function(view){return view.model});_.each(featured,this.hideActivityFeedItem,this)},hideActivityFeedItem:function(activityFeedItem){var card=this.getCardFromMainFeed(activityFeedItem);card&&card.$el.addClass("is-featured")},onDomRefresh:function(){this.coverRegion.show(new ChannelCoverView({model:this.model.channel}));var userSourcesView=new UserAvatarCollectionView({collection:this.model.userSources.get("items"),showLimit:3});this.listenToOnce(userSourcesView,"after:item:added",this.showExperts),this.userSourcesRegion.show(userSourcesView),TabbedView.prototype.onDomRefresh.apply(this,arguments),this.fillFeaturedRegion();var self=this;$.when(this.model.userSourcesPromise,this.model.forumSourcesPromise).then(function(){(self.model.userSources.get("items").length||self.model.forumSources.get("items").length)&&self.$("[data-action=switch-tab][data-tab=discussions]").removeClass("hidden")})},showExperts:function(){this.$("[data-role=experts]").removeClass("hidden")},getTabView:function(activeTab){var view;switch(activeTab){case"recent":return view=new FetchableCollectionLayout({model:this.model.recentActivities,collection:this.model.recentActivities.get("items"),fetchableCollectionView:ChannelCardCollectionView,channel:this.model.channel}),view.$el.attr({"data-mix-location":"recent"}),view;case"top":return view=new FetchableCollectionLayout({model:this.model.topActivities,collection:this.model.topActivities.get("items"),fetchableCollectionView:ChannelCardCollectionView,channel:this.model.channel}),view.$el.attr({"data-mix-location":"top"}),view;
case"discussions":return view=new FetchableCollectionLayout({model:this.model.createActivities,collection:this.model.createActivities.get("items"),fetchableCollectionView:ChannelCardCollectionView,channel:this.model.channel}),view.$el.attr({"data-mix-location":"discussions"}),view;case"experts":return view=new FetchableCollectionLayout({model:this.model.userSources,collection:this.model.userSources.get("items"),fetchableCollectionView:UserCollectionView}),view.$el.attr({"data-mix-location":"experts"}),view;case"guidelines":return new ChannelGuidelinesView({model:this.model.channel})}},getTitle:function(){return backboneUtils.getPromiseFor(this.model.channel,"name").then(function(channelName){return"Channel - "+channelName})}});return ChannelProfileView}),define("home/collections/TopicCollection",["backbone","home/models/common/UniqueModel","home/models/Topic"],function(Backbone,UniqueModel,Topic){var TopicCollection=Backbone.Collection.extend({model:UniqueModel.boundModel(Topic)});return TopicCollection}),define("home/mixins/asEmbedApp",["jquery","underscore","backbone","modernizr","core/api","core/frameBus","home/utils/mixpanelUtils"],function($,_,Backbone,Modernizr,api,FrameBus,MixpanelUtils){var asEmbedApp=function(){var _initialize=this.initialize;this.initialize=function(){var trackVisitHomeception=_.bind(MixpanelUtils.track,MixpanelUtils,"visit_homeception",{target:$("body")});MixpanelUtils.trackError=$.noop,MixpanelUtils.track=$.noop,this.mainLayoutIsRendered=new $.Deferred,this.listenTo(FrameBus,"mainlayoutRendered",this.mainLayoutIsRendered.resolve),this.showPathReceived=new $.Deferred,this.showPathReceived.done(trackVisitHomeception),_initialize.apply(this,arguments),this.listenTo(FrameBus,"showPath",this.loadPath),this.listenTo(FrameBus,"open",this.openDrawer),FrameBus.sendHostMessage("ready")};var _initUserProfile=this.initUserProfile;this.initUserProfile=function(){this.showPathReceived.done(_initUserProfile)};var _fetchModeratedForums=this.fetchModeratedForums;this.fetchModeratedForums=function(){this.showPathReceived.done(_fetchModeratedForums)},this.loadSessionFromStorage=function(){var sessionStr=Modernizr.sessionstorage&&sessionStorage.getItem("home.session"),sessionAttrs=null;if(sessionStr){try{sessionAttrs=JSON.parse(sessionStr),this.session.setUser(this.session.getUserInstance(sessionAttrs))}catch(e){}sessionStorage.removeItem("home.session")}},this.setSsoHeaders=function(sso){api.headers({"X-Disqus-Publisher-API-Key":sso.apiKey,"X-Disqus-Remote-Auth":sso.remoteAuthS3})},this.loadPath=function(data){data.sso&&data.sso.apiKey&&data.sso.remoteAuthS3&&this.setSsoHeaders(data.sso),this.showPathReceived.resolveWith(this);var path=data.path,self=this;this.mainLayoutIsRendered.done(function(){self.navigateToPath(path),FrameBus.sendHostMessage("openReady")})},this.openDrawer=function(){$("body").addClass("active")},this.navigateToPath=function(path){var pathName="/home/"+path;window.location.pathname!==pathName&&Backbone.history.navigate("/"+path,!0)}};return asEmbedApp}),define("home/models/ActivityFeed",["underscore","home/models/Feed","home/collections/FeedItemCollection"],function(_,Feed,FeedItemCollection){var ActivityFeed=Feed.extend({initialize:function(options){Feed.prototype.initialize.call(this,{},_.extend({collectionClass:FeedItemCollection},options))}});return ActivityFeed}),define("home/models/TopicFeed",["underscore","backbone","home/collections/FeedItemCollection","home/models/common/UniqueModel","home/models/Topic","home/models/Feed","core/api"],function(_,Backbone,FeedItemCollection,UniqueModel,Topic,Feed,api){var TopicFeed=Feed.extend({initialize:function(attrs,options){this.initializeRelated("topic",_.defaults({topic:{id:this.id}},options),Topic),Feed.prototype.initialize.call(this,{},{collectionClass:FeedItemCollection,collectionUrl:api.getURL("timelines/activities?type=profile")}),this.set({fetchOptions:{target:"topic:"+this.id}})},shouldFetch:function(){return!this.get("items").length},fetch:function(options){this.get("items").length||this.fetchItems(options)},parse:function(response){return response.response}});return UniqueModel.addType("TopicFeed",TopicFeed),TopicFeed}),define("core/extensions/handlebars.helpers",["handlebars","core/strings","core/config/urls"],function(Handlebars,strings,urls){var Utils=Handlebars.Utils;return Handlebars.registerHelper("any",function(){for(var len=arguments.length,i=0;len-1>i;i++)if(arguments[i])return arguments[i]}),Handlebars.registerHelper("eq",function(a,b){return a===b}),Handlebars.registerHelper("ne",function(a,b){return a!==b}),Handlebars.registerHelper("gt",function(a,b){return a>b}),Handlebars.registerHelper("lt",function(a,b){return b>a}),Handlebars.registerHelper("ge",function(a,b){return a>=b}),Handlebars.registerHelper("le",function(a,b){return b>=a}),Handlebars.registerHelper("typeof",function(a,b){return typeof a===b}),Handlebars.registerHelper("notNull",function(a){return null!==a}),Handlebars.registerHelper("if_any",function(){for(var len=arguments.length,options=arguments[len-1],i=0;len-1>i;i++)if(arguments[i])return options.fn(this);return options.inverse(this)}),Handlebars.registerHelper("if_all",function(){for(var len=arguments.length,options=arguments[len-1],i=0;len-1>i;i++)if(!arguments[i])return options.inverse(this);return options.fn(this)}),Handlebars.registerHelper("getPartial",function(name,context,options){return"undefined"==typeof options&&(options=context,context=this),new Handlebars.SafeString(Handlebars.partials[name](context,options))}),Handlebars.registerHelper("gettext",function(){var html,regex,key,isPartial,len=arguments.length,options=arguments[len-1],hash=options.hash,value=arguments[0],partials=window.Handlebars.partials;value=strings.get(value);for(key in hash)hash.hasOwnProperty(key)&&(regex=new RegExp("%\\(("+key+")\\)s","gm"),html=hash[key],isPartial=html&&html.executePartial,isPartial&&(html=partials[html.partial].call(this,html.context,options)),void 0===html||null===html||"number"==typeof html&&isNaN(html)?html="":isPartial||(html=Utils.escapeExpression(html)),value=value.replace(regex,html.toString()));return new Handlebars.SafeString(value)}),Handlebars.registerHelper("urlfor",function(propName){for(var path=propName.split("."),len=path.length,url=urls,i=0;url.hasOwnProperty(path[i])&&len>i;)url=url[path[i]],i++;return url}),Handlebars.registerHelper("html",function(value){return new Handlebars.SafeString(value||"")}),Handlebars.registerHelper("partial",function(name,options){Handlebars.registerPartial(name,options.fn)}),Handlebars.registerHelper("with",function(){var len=arguments.length,options=arguments[len-1],context=arguments[0];return 3===len?(context={},context[arguments[0]]=arguments[1]):"_window_"===context&&(context=window),options.fn(context)}),Handlebars.registerHelper("each",function(context,options){var data,fn=options.fn,inverse=options.inverse,i=0,ret="";if(options.data&&(data=Handlebars.createFrame(options.data)),context&&"object"==typeof context)if("[object Array]"===Object.prototype.toString.call(context))for(var j=context.length;j>i;i++)data&&(data.index=i,data.length=context.length),ret+=fn(context[i],{data:data});else for(var key in context)context.hasOwnProperty(key)&&(data&&(data.key=key),ret+=fn(context[key],{data:data}),i++);return 0===i&&(ret=inverse(this)),ret}),Handlebars.registerHelper("log",function(name){window.console.log(name,this)}),Handlebars.registerHelper("debug",function(){}),Handlebars.registerHelper("geturl",function(url){return url}),Handlebars.registerHelper("truncate",function(str,len){return str.length<=len?str:new Handlebars.SafeString(Utils.escapeExpression(str.slice(0,len))+"&hellip;")}),Handlebars}),define("home/backbone.overrides",["underscore","backbone","core/api","home/models/common/UniqueModel"],function(_,Backbone,api,UniqueModel){Backbone.ajax=_.wrap(Backbone.ajax,function(originalAjax,options){return options.traditional=!0,/disqus\.com\/api/.test(options.url)?api.call(options.url,options):originalAjax(options)}),Backbone.Model.prototype.initializeRelated=function(name,options,ModelClass){var obj=options&&options[name]||this.get(name);if(!obj)throw"missing the id, attributes, or model for related model "+name;if(_.isString(obj)||_.isNumber(obj)){var id=obj;obj={},obj[ModelClass.prototype.idAttribute||"id"]=id}obj instanceof ModelClass||(obj=new UniqueModel(ModelClass,obj,options)),this.unset(name),this[name]=obj}}),define("home/overrides/marionette.overrides",["jquery","backbone-marionette"],function($,Marionette){Marionette.CompositeView.prototype.rerenderModel=function(){var $itemViewContainer=this.$(this.itemViewContainer).detach();this.$el.html(this.renderModel()),this.$(this.itemViewContainer).replaceWith($itemViewContainer),this.triggerMethod("render",this)}}),define("Router",["underscore","jquery","modernizr","backbone","backbone-marionette","home/templates/main","home/templates/preload","home/views/MainLayout","home/views/HomeFeedCoverView","home/views/HomeCardCollectionView","home/views/ActivityFeedView","home/views/NotificationsView","home/views/ForumCoverView","home/views/TopicCoverView","home/views/ProfileView","home/views/DiscussionFormView","home/views/DiscussionPageView","home/views/OnboardingView","home/views/ForumFeedEmptyView","home/views/SearchPageLayout","home/views/ChannelProfileView","home/collections/common/ExtensibleCollection","home/collections/TopicCollection","home/collections/FollowingUserCollection","home/mixins/asEmbedApp","home/models/Session","home/models/common/UniqueModel","home/models/ActivityFeed","home/models/Notifications","home/models/UserProfile","home/models/ForumFeed","home/models/TopicFeed","home/models/Topic","home/models/Thread","home/models/Forum","home/models/Channel","home/models/ChannelProfile","home/utils/mixpanelUtils","home/utils/iframeUtils","home/utils/inspectletUtils","home/utils/settingsUtils","home/utils/navigationUtils","home/utils/trackingUtils","home/utils/releaseUtils","core/utils/cookies","core/api","remote/config","core/extensions/handlebars.helpers","home/backbone.overrides","home/overrides/marionette.overrides","disqus.sdk"],function(_,$,Modernizr,Backbone,Marionette,mainTemplate,preloadTemplate,MainLayout,HomeFeedCoverView,HomeCardCollectionView,ActivityFeedView,NotificationsView,ForumCoverView,TopicCoverView,ProfileView,DiscussionFormView,DiscussionPageView,OnboardingView,ForumFeedEmptyView,SearchPageLayout,ChannelProfileView,ExtensibleCollection,TopicCollection,FollowingUserCollection,asEmbedApp,Session,UniqueModel,ActivityFeed,Notifications,UserProfile,ForumFeed,TopicFeed,Topic,Thread,Forum,Channel,ChannelProfile,MixpanelUtils,IframeUtils,inspectletUtils,settingsUtils,NavigationUtils,TrackingUtils,releaseUtils,cookies,api,config){Modernizr.touch;var Router=Backbone.Router.extend({routes:_.defaults({"discuss/:forum(/)":"startDiscussion","edit/:forum/:thread(/)":"editDiscussion","search(/)":"search","static(/)":"static","user(s)(/:username)(/:feed)(/)":"profile","inbox(/)":"inbox","preload(/)":"preload","account(/)":"account","notifications(/)":"notifications","topic(s)/:topicId(/)":"topics","forum(s)/:forumId(/)":"forums","discussion(s)/:forum/:thread(/:permalink)(/)":"discussion","channel(s)/:channelId(/:feed)(/)":"channels","channel(s)/:channelId/discussion(s)/:forumId/:thread(/:permalink)(/)":"channelDiscussion","welcome(/)":"onboarding","":"home","*notExists":"notFound"}),TOPICS:["Business","Celebrity","Culture","Entertainment","Games","Living","News","Sports","Style","Tech"],initialize:function(options){this.root="/home/",this.CDN_ROOT=options.CDN_ROOT,this.feeds={},this.initSession(),this.initTopics(),TrackingUtils.init(),TrackingUtils.trackVisit(),inspectletUtils.init(),NavigationUtils.init()},getLoggedInUsername:function(){var authStr=cookies.read("disqusauth");if(authStr)return authStr.split("|")[1]},initSession:function(){var session=this.session=new Session;return this.loadSessionFromStorage?this.loadSessionFromStorage():session.fetch(),this.initUserProfile(),session.on("change:id",function(user){Raven.setUser({id:user.get("id"),username:user.get("username")}),TrackingUtils.initUser(user.get("id"))}),session.on("change:id",_.bind(this.fetchModeratedForums,this)),session},fetchModeratedForums:function(){this.session.fetchModeratedForums()},initUserProfile:function(){var username=this.getLoggedInUsername();username?this.session.initUserProfile(username):this.session.once("change:id",function(user){this.session.initUserProfile(user.get("username"))},this)},initTopics:function(){_.each(this.TOPICS,function(topicName){return new UniqueModel(Topic,{id:topicName.toLowerCase(),name:topicName})})},execute:function(){api.off("error",NavigationUtils.navigateToLoginOnAuthFail),TrackingUtils.pageChanged(),Backbone.Router.prototype.execute.apply(this,arguments)},ensureAuthenicated:function(callback){return api.off("error",NavigationUtils.navigateToLoginOnAuthFail),this.isLoggedOut()?this.navigateToOnboarding():(api.on("error",NavigationUtils.navigateToLoginOnAuthFail),void(this.session.fetched?callback.apply(this,_.tail(arguments)):this.session.fetch().done(_.bind(callback,this,_.tail(arguments)))))},ensureHasChannel:function(callback,forumId){var forum=new UniqueModel(Forum,{id:forumId});return forum.shouldFetch()?(forum.fetch(),void this.listenToOnce(forum,"sync",_.bind.apply(_,[this.ensureHasChannel,this].concat(_.toArray(arguments))))):forum.channel||"gabalafou-test"===forumId?void callback.apply(this,_.tail(arguments)):this.notFound()},preventBlacklisted:function(options){_.contains(config.timelines.BLACKLISTED_FORUMS,options.forum)&&(window.location="https://help.disqus.com/customer/portal/articles/1689402-redirected-from-home")},"static":function(){this.staticView||(this.staticView=new(Marionette.ItemView.extend({template:mainTemplate}))),this.showViews(MainLayout,{content:this.staticView})},preload:function(){this.preloadView=new(Marionette.ItemView.extend({template:preloadTemplate})),this.showViews(MainLayout,{content:this.preloadView})},navigateToOnboarding:function(){window.location="https://disqus.com/profile/login/?next="+encodeURIComponent("https://disqus.com/home/")},onboarding:function(){MixpanelUtils.track("view welcome page",{target:$("body")},{skipUserProperties:this.isLoggedOut()}),this.showViews(MainLayout,{content:new OnboardingView({session:this.session})})},renavigateToProfile:function(user){var username=user.get("username");return username?(this.navigate("/user/"+username,{replace:!0}),void this.profile(username)):(this.navigate("/",{replace:!0}),void this.home())},search:function(){this.showViews(MainLayout,{content:new SearchPageLayout({session:this.session})})},profile:function(username,feedName){if(!username)return this.ensureAuthenicated(function(){var session=this.session,sessionUser=session.user;return sessionUser.get("username")?void this.renavigateToProfile(sessionUser):void this.listenToOnce(session,"change:id",this.renavigateToProfile)});var userProfile=_.find(UniqueModel.pool(UserProfile),function(userProfile){return userProfile.user.get("username")===username});userProfile||(userProfile=new UniqueModel(UserProfile,{username:username})),userProfile.ensureFetched(),MixpanelUtils.track("view user profile",{target:$("body")}),inspectletUtils.tagSession("viewed a user profile"),this.showViews(MainLayout,{content:new ProfileView({model:userProfile,activeTab:feedName})})},home:function(){this.ensureAuthenicated(function(){var model=this.feeds.activityFeed;model||(model=this.feeds.activityFeed=new ActivityFeed,model.fetchItems({reset:!0})),this.showViews(MainLayout,{content:new ActivityFeedView({model:model,collection:model.get("items"),coverView:HomeFeedCoverView,fetchableCollectionView:HomeCardCollectionView})})})},account:function(){this.home(),settingsUtils.openProfilePane()},notifications:function(){this.home(),settingsUtils.openNotificationPane()},ensureAdmin:function(routeHandler,args){var session=this.session;return session.fetched?releaseUtils.isDisqusAdmin(session.user)?routeHandler.apply(this,args):this.notFound():void session.fetch().then(_.bind(this.ensureAdmin,this,routeHandler,args),_.bind(this.notFound,this))},channels:function(channelId){return"disqusfun"===channelId?this.ensureAdmin(this._channels,arguments):this._channels.apply(this,arguments)},_channels:function(channelId,feedName){var channelProfile=new UniqueModel(ChannelProfile,{id:channelId,channel:channelId});channelProfile.ensureFetched(),MixpanelUtils.track("view channel profile",{target:$("body")}),inspectletUtils.tagSession("viewed a channel profile"),this.showViews(MainLayout,{content:new ChannelProfileView({model:channelProfile,activeTab:feedName})})},_forums:function(forumId){var forumFeed=new UniqueModel(ForumFeed,{id:forumId});if(forumFeed.shouldFetch()&&forumFeed.fetch(),forumFeed.forum.shouldFetch()&&this.listenToOnce(forumFeed.forum,"sync",_.bind(function(forum){forum.channel&&this._forums(forumId)},this)),forumFeed.forum.channel)return void this.navigate("channel/"+forumFeed.forum.channel.id,{trigger:!0,replace:!0});MixpanelUtils.track("view forum profile",{target:$("body")}),inspectletUtils.tagSession("viewed a community profile");var view=new ActivityFeedView({coverView:ForumCoverView,model:forumFeed,collection:forumFeed.get("items"),emptyView:ForumFeedEmptyView});view.$el.attr({"data-mix-location":"feed forum"}),this.showViews(MainLayout,{content:view})},forums:function(forumId){return this.preventBlacklisted({forum:forumId}),"disqus-disqusfun"===forumId?this.ensureAdmin(this._forums,arguments):this._forums.apply(this,arguments)},topics:function(topicId){var topicFeed=new UniqueModel(TopicFeed,{id:topicId});topicFeed.shouldFetch()&&topicFeed.fetch(),MixpanelUtils.track("view forum profile",{target:$("body")});var view=new ActivityFeedView({coverView:TopicCoverView,model:topicFeed,collection:topicFeed.get("items")});view.$el.attr({"data-mix-location":"feed topic"}),this.showViews(MainLayout,{content:view})},inbox:function(){this.ensureAuthenicated(function(){var notifications=this.session.getOrCreateNotifications();MixpanelUtils.track("view notifications",{target:$("body")}),inspectletUtils.tagSession("viewed notifications"),this.showViews(MainLayout,{content:new NotificationsView({model:notifications})})})},_showDiscussionForm:function(forumId,options){var discussionForm=new DiscussionFormView(_.extend({forum:forumId,session:this.session},options));this.listenTo(discussionForm,"createThread",function(){(new ExtensibleCollection).add(discussionForm.getThread()),this.navigate("/discussion/"+forumId+"/"+discussionForm.model.get("slug"),{trigger:!0})}),this.showViews(MainLayout,{content:discussionForm})},startDiscussion:function(forumId){return this.ensureAuthenicated(function(){this.ensureHasChannel(function(){this._showDiscussionForm.apply(this,arguments)},forumId)},arguments)},editDiscussion:function(forumId,threadSlug){var session=this.session,thread=this.getOrCreateThread(forumId,threadSlug),fetchPromises=[];if(session.fetched||fetchPromises.push(session.fetch()),thread.shouldFetch()&&fetchPromises.push(thread.fetch()),fetchPromises.length)return void $.when.apply($,fetchPromises).then(_.bind(this.editDiscussion,this,forumId,threadSlug),_.bind(this.notFound,this));var authorId=thread.author&&thread.author.get("id")||thread.get("author");return session.user.get("id")!==authorId?this.navigate(thread.getDiscussionRoute(),{trigger:!0,replace:!0}):void this._showDiscussionForm(forumId,{thread:thread})},discussionPage:function(forumId,threadSlug,options){var thread=this.getOrCreateThread(forumId,threadSlug);MixpanelUtils.track("view discussion thread",{target:$("body")}),inspectletUtils.tagSession("viewed a discussion page"),this.showViews(MainLayout,{content:new DiscussionPageView(_.extend({model:thread,session:this.session},options))})},_discussion:function(forumId,threadSlug){this.discussionPage(forumId,threadSlug)},discussion:function(forumId){return this.preventBlacklisted({forum:forumId}),"disqus-disqusfun"===forumId?this.ensureAdmin(this._discussion,arguments):this._discussion.apply(this,arguments)},channelDiscussion:function(channelId,forumId,threadSlug){var channel=new UniqueModel(Channel,{slug:channelId});return channel.shouldFetch()&&channel.fetch(),this.discussionPage(forumId,threadSlug,{channel:channel})},showLayout:function(LayoutClass){this.layout instanceof LayoutClass||(this.layout&&this.layout.close(),this.layout=new LayoutClass({session:this.session,app:this}).render(),$("body").html(this.layout.$el),this.layout.trigger("show"))},isLoggedOut:function(){return"disqus.com"===window.location.host&&!cookies.read("disqusauth")},getOrCreateThread:function(forumId,threadSlug,fetchOptions){var threads=UniqueModel.pool(Thread),thread=_.find(threads,function(t){return t.get("slug")===threadSlug&&t.forum.get("id")===forumId});if(!thread){var directThreads=new ExtensibleCollection;thread=new Thread({slug:threadSlug,forum:{id:forumId}}),directThreads.add(thread),thread.fetch(fetchOptions).then(function(){UniqueModel.set(Thread,thread)})}return thread},notFound:function(){this.navigate("",{trigger:!0,replace:!0})},showViews:function(layoutClass,views){this.showLayout(layoutClass),this.layout.showViews(views),views.content.getTitle&&$.when(views.content.getTitle()).then(function(titleText){document.title="Disqus"+(titleText?" "+titleText:"")})}});return IframeUtils.isIframed(window)&&asEmbedApp.call(Router.prototype),Router}),+function($){function clearMenus(e){$(backdrop).remove(),$(toggle).each(function(){var $parent=getParent($(this)),relatedTarget={relatedTarget:this};$parent.hasClass("open")&&($parent.trigger(e=$.Event("hide.bs.dropdown",relatedTarget)),e.isDefaultPrevented()||$parent.removeClass("open").trigger("hidden.bs.dropdown",relatedTarget))})}function getParent($this){var selector=$this.attr("data-target");selector||(selector=$this.attr("href"),selector=selector&&/#[A-Za-z]/.test(selector)&&selector.replace(/.*(?=#[^\s]*$)/,""));var $parent=selector&&$(selector);return $parent&&$parent.length?$parent:$this.parent()}var backdrop=".dropdown-backdrop",toggle="[data-toggle=dropdown]",Dropdown=function(element){$(element).on("click.bs.dropdown",this.toggle)};Dropdown.prototype.toggle=function(e){var $this=$(this);if(!$this.is(".disabled, :disabled")){var $parent=getParent($this),isActive=$parent.hasClass("open");if(clearMenus(),!isActive){"ontouchstart"in document.documentElement&&!$parent.closest(".navbar-nav").length&&$('<div class="dropdown-backdrop"/>').insertAfter($(this)).on("click",clearMenus);var relatedTarget={relatedTarget:this};if($parent.trigger(e=$.Event("show.bs.dropdown",relatedTarget)),e.isDefaultPrevented())return;$parent.toggleClass("open").trigger("shown.bs.dropdown",relatedTarget),$this.focus()}return!1}},Dropdown.prototype.keydown=function(e){if(/(38|40|27)/.test(e.keyCode)){var $this=$(this);if(e.preventDefault(),e.stopPropagation(),!$this.is(".disabled, :disabled")){var $parent=getParent($this),isActive=$parent.hasClass("open");if(!isActive||isActive&&27==e.keyCode)return 27==e.which&&$parent.find(toggle).focus(),$this.click();var desc=" li:not(.divider):visible a",$items=$parent.find("[role=menu]"+desc+", [role=listbox]"+desc);if($items.length){var index=$items.index($items.filter(":focus"));38==e.keyCode&&index>0&&index--,40==e.keyCode&&index<$items.length-1&&index++,~index||(index=0),$items.eq(index).focus()}}}};var old=$.fn.dropdown;$.fn.dropdown=function(option){return this.each(function(){var $this=$(this),data=$this.data("bs.dropdown");data||$this.data("bs.dropdown",data=new Dropdown(this)),"string"==typeof option&&data[option].call($this)})},$.fn.dropdown.Constructor=Dropdown,$.fn.dropdown.noConflict=function(){return $.fn.dropdown=old,this},$(document).on("click.bs.dropdown.data-api",clearMenus).on("click.bs.dropdown.data-api",".dropdown form",function(e){e.stopPropagation()}).on("click.bs.dropdown.data-api",toggle,Dropdown.prototype.toggle).on("keydown.bs.dropdown.data-api",toggle+", [role=menu], [role=listbox]",Dropdown.prototype.keydown)}(jQuery),define("bootstrap/dropdown",["jquery"],function(){}),+function($){var Tooltip=function(element,options){this.type=this.options=this.enabled=this.timeout=this.hoverState=this.$element=null,this.init("tooltip",element,options)};Tooltip.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1},Tooltip.prototype.init=function(type,element,options){this.enabled=!0,this.type=type,this.$element=$(element),this.options=this.getOptions(options);for(var triggers=this.options.trigger.split(" "),i=triggers.length;i--;){var trigger=triggers[i];if("click"==trigger)this.$element.on("click."+this.type,this.options.selector,$.proxy(this.toggle,this));else if("manual"!=trigger){var eventIn="hover"==trigger?"mouseenter":"focusin",eventOut="hover"==trigger?"mouseleave":"focusout";this.$element.on(eventIn+"."+this.type,this.options.selector,$.proxy(this.enter,this)),this.$element.on(eventOut+"."+this.type,this.options.selector,$.proxy(this.leave,this))}}this.options.selector?this._options=$.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},Tooltip.prototype.getDefaults=function(){return Tooltip.DEFAULTS},Tooltip.prototype.getOptions=function(options){return options=$.extend({},this.getDefaults(),this.$element.data(),options),options.delay&&"number"==typeof options.delay&&(options.delay={show:options.delay,hide:options.delay}),options},Tooltip.prototype.getDelegateOptions=function(){var options={},defaults=this.getDefaults();return this._options&&$.each(this._options,function(key,value){defaults[key]!=value&&(options[key]=value)}),options},Tooltip.prototype.enter=function(obj){var self=obj instanceof this.constructor?obj:$(obj.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type);return clearTimeout(self.timeout),self.hoverState="in",self.options.delay&&self.options.delay.show?void(self.timeout=setTimeout(function(){"in"==self.hoverState&&self.show()},self.options.delay.show)):self.show()},Tooltip.prototype.leave=function(obj){var self=obj instanceof this.constructor?obj:$(obj.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type);return clearTimeout(self.timeout),self.hoverState="out",self.options.delay&&self.options.delay.hide?void(self.timeout=setTimeout(function(){"out"==self.hoverState&&self.hide()},self.options.delay.hide)):self.hide()},Tooltip.prototype.show=function(){var e=$.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){if(this.$element.trigger(e),e.isDefaultPrevented())return;var that=this,$tip=this.tip();this.setContent(),this.options.animation&&$tip.addClass("fade");var placement="function"==typeof this.options.placement?this.options.placement.call(this,$tip[0],this.$element[0]):this.options.placement,autoToken=/\s?auto?\s?/i,autoPlace=autoToken.test(placement);autoPlace&&(placement=placement.replace(autoToken,"")||"top"),$tip.detach().css({top:0,left:0,display:"block"}).addClass(placement),this.options.container?$tip.appendTo(this.options.container):$tip.insertAfter(this.$element);var pos=this.getPosition(),actualWidth=$tip[0].offsetWidth,actualHeight=$tip[0].offsetHeight;if(autoPlace){var $parent=this.$element.parent(),orgPlacement=placement,docScroll=document.documentElement.scrollTop||document.body.scrollTop,parentWidth="body"==this.options.container?window.innerWidth:$parent.outerWidth(),parentHeight="body"==this.options.container?window.innerHeight:$parent.outerHeight(),parentLeft="body"==this.options.container?0:$parent.offset().left;placement="bottom"==placement&&pos.top+pos.height+actualHeight-docScroll>parentHeight?"top":"top"==placement&&pos.top-docScroll-actualHeight<0?"bottom":"right"==placement&&pos.right+actualWidth>parentWidth?"left":"left"==placement&&pos.left-actualWidth<parentLeft?"right":placement,$tip.removeClass(orgPlacement).addClass(placement)}var calculatedOffset=this.getCalculatedOffset(placement,pos,actualWidth,actualHeight);this.applyPlacement(calculatedOffset,placement),this.hoverState=null;var complete=function(){that.$element.trigger("shown.bs."+that.type)};$.support.transition&&this.$tip.hasClass("fade")?$tip.one($.support.transition.end,complete).emulateTransitionEnd(150):complete()}},Tooltip.prototype.applyPlacement=function(offset,placement){var replace,$tip=this.tip(),width=$tip[0].offsetWidth,height=$tip[0].offsetHeight,marginTop=parseInt($tip.css("margin-top"),10),marginLeft=parseInt($tip.css("margin-left"),10);isNaN(marginTop)&&(marginTop=0),isNaN(marginLeft)&&(marginLeft=0),offset.top=offset.top+marginTop,offset.left=offset.left+marginLeft,$.offset.setOffset($tip[0],$.extend({using:function(props){$tip.css({top:Math.round(props.top),left:Math.round(props.left)})}},offset),0),$tip.addClass("in");var actualWidth=$tip[0].offsetWidth,actualHeight=$tip[0].offsetHeight;if("top"==placement&&actualHeight!=height&&(replace=!0,offset.top=offset.top+height-actualHeight),/bottom|top/.test(placement)){var delta=0;offset.left<0&&(delta=-2*offset.left,offset.left=0,$tip.offset(offset),actualWidth=$tip[0].offsetWidth,actualHeight=$tip[0].offsetHeight),this.replaceArrow(delta-width+actualWidth,actualWidth,"left")}else this.replaceArrow(actualHeight-height,actualHeight,"top");replace&&$tip.offset(offset)},Tooltip.prototype.replaceArrow=function(delta,dimension,position){this.arrow().css(position,delta?50*(1-delta/dimension)+"%":"")},Tooltip.prototype.setContent=function(){var $tip=this.tip(),title=this.getTitle();$tip.find(".tooltip-inner")[this.options.html?"html":"text"](title),$tip.removeClass("fade in top bottom left right")},Tooltip.prototype.hide=function(){function complete(){"in"!=that.hoverState&&$tip.detach(),that.$element.trigger("hidden.bs."+that.type)}var that=this,$tip=this.tip(),e=$.Event("hide.bs."+this.type);return this.$element.trigger(e),e.isDefaultPrevented()?void 0:($tip.removeClass("in"),$.support.transition&&this.$tip.hasClass("fade")?$tip.one($.support.transition.end,complete).emulateTransitionEnd(150):complete(),this.hoverState=null,this)},Tooltip.prototype.fixTitle=function(){var $e=this.$element;($e.attr("title")||"string"!=typeof $e.attr("data-original-title"))&&$e.attr("data-original-title",$e.attr("title")||"").attr("title","")},Tooltip.prototype.hasContent=function(){return this.getTitle()},Tooltip.prototype.getPosition=function(){var el=this.$element[0];return $.extend({},"function"==typeof el.getBoundingClientRect?el.getBoundingClientRect():{width:el.offsetWidth,height:el.offsetHeight},this.$element.offset())},Tooltip.prototype.getCalculatedOffset=function(placement,pos,actualWidth,actualHeight){return"bottom"==placement?{top:pos.top+pos.height,left:pos.left+pos.width/2-actualWidth/2}:"top"==placement?{top:pos.top-actualHeight,left:pos.left+pos.width/2-actualWidth/2}:"left"==placement?{top:pos.top+pos.height/2-actualHeight/2,left:pos.left-actualWidth}:{top:pos.top+pos.height/2-actualHeight/2,left:pos.left+pos.width}},Tooltip.prototype.getTitle=function(){var title,$e=this.$element,o=this.options;return title=$e.attr("data-original-title")||("function"==typeof o.title?o.title.call($e[0]):o.title)},Tooltip.prototype.tip=function(){return this.$tip=this.$tip||$(this.options.template)},Tooltip.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},Tooltip.prototype.validate=function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},Tooltip.prototype.enable=function(){this.enabled=!0},Tooltip.prototype.disable=function(){this.enabled=!1},Tooltip.prototype.toggleEnabled=function(){this.enabled=!this.enabled},Tooltip.prototype.toggle=function(e){var self=e?$(e.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type):this;self.tip().hasClass("in")?self.leave(self):self.enter(self)
},Tooltip.prototype.destroy=function(){clearTimeout(this.timeout),this.hide().$element.off("."+this.type).removeData("bs."+this.type)};var old=$.fn.tooltip;$.fn.tooltip=function(option){return this.each(function(){var $this=$(this),data=$this.data("bs.tooltip"),options="object"==typeof option&&option;(data||"destroy"!=option)&&(data||$this.data("bs.tooltip",data=new Tooltip(this,options)),"string"==typeof option&&data[option]())})},$.fn.tooltip.Constructor=Tooltip,$.fn.tooltip.noConflict=function(){return $.fn.tooltip=old,this}}(jQuery),define("bootstrap/tooltip",["jquery"],function(){}),+function($){var Modal=function(element,options){this.options=options,this.$element=$(element),this.$backdrop=this.isShown=null,this.options.remote&&this.$element.find(".modal-content").load(this.options.remote,$.proxy(function(){this.$element.trigger("loaded.bs.modal")},this))};Modal.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},Modal.prototype.toggle=function(_relatedTarget){return this[this.isShown?"hide":"show"](_relatedTarget)},Modal.prototype.show=function(_relatedTarget){var that=this,e=$.Event("show.bs.modal",{relatedTarget:_relatedTarget});this.$element.trigger(e),this.isShown||e.isDefaultPrevented()||(this.isShown=!0,this.escape(),this.$element.on("click.dismiss.bs.modal",'[data-dismiss="modal"]',$.proxy(this.hide,this)),this.backdrop(function(){var transition=$.support.transition&&that.$element.hasClass("fade");that.$element.parent().length||that.$element.appendTo(document.body),that.$element.show().scrollTop(0),transition&&that.$element[0].offsetWidth,that.$element.addClass("in").attr("aria-hidden",!1),that.enforceFocus();var e=$.Event("shown.bs.modal",{relatedTarget:_relatedTarget});transition?that.$element.find(".modal-dialog").one($.support.transition.end,function(){that.$element.focus().trigger(e)}).emulateTransitionEnd(300):that.$element.focus().trigger(e)}))},Modal.prototype.hide=function(e){e&&e.preventDefault(),e=$.Event("hide.bs.modal"),this.$element.trigger(e),this.isShown&&!e.isDefaultPrevented()&&(this.isShown=!1,this.escape(),$(document).off("focusin.bs.modal"),this.$element.removeClass("in").attr("aria-hidden",!0).off("click.dismiss.bs.modal"),$.support.transition&&this.$element.hasClass("fade")?this.$element.one($.support.transition.end,$.proxy(this.hideModal,this)).emulateTransitionEnd(300):this.hideModal())},Modal.prototype.enforceFocus=function(){$(document).off("focusin.bs.modal").on("focusin.bs.modal",$.proxy(function(e){this.$element[0]===e.target||this.$element.has(e.target).length||this.$element.focus()},this))},Modal.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keyup.dismiss.bs.modal",$.proxy(function(e){27==e.which&&this.hide()},this)):this.isShown||this.$element.off("keyup.dismiss.bs.modal")},Modal.prototype.hideModal=function(){var that=this;this.$element.hide(),this.backdrop(function(){that.removeBackdrop(),that.$element.trigger("hidden.bs.modal")})},Modal.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},Modal.prototype.backdrop=function(callback){var animate=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var doAnimate=$.support.transition&&animate;if(this.$backdrop=$('<div class="modal-backdrop '+animate+'" />').appendTo(document.body),this.$element.on("click.dismiss.bs.modal",$.proxy(function(e){e.target===e.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus.call(this.$element[0]):this.hide.call(this))},this)),doAnimate&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!callback)return;doAnimate?this.$backdrop.one($.support.transition.end,callback).emulateTransitionEnd(150):callback()}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),$.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one($.support.transition.end,callback).emulateTransitionEnd(150):callback()):callback&&callback()};var old=$.fn.modal;$.fn.modal=function(option,_relatedTarget){return this.each(function(){var $this=$(this),data=$this.data("bs.modal"),options=$.extend({},Modal.DEFAULTS,$this.data(),"object"==typeof option&&option);data||$this.data("bs.modal",data=new Modal(this,options)),"string"==typeof option?data[option](_relatedTarget):options.show&&data.show(_relatedTarget)})},$.fn.modal.Constructor=Modal,$.fn.modal.noConflict=function(){return $.fn.modal=old,this},$(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(e){var $this=$(this),href=$this.attr("href"),$target=$($this.attr("data-target")||href&&href.replace(/.*(?=#[^\s]+$)/,"")),option=$target.data("bs.modal")?"toggle":$.extend({remote:!/#/.test(href)&&href},$target.data(),$this.data());$this.is("a")&&e.preventDefault(),$target.modal(option,this).one("hide",function(){$this.is(":visible")&&$this.focus()})}),$(document).on("show.bs.modal",".modal",function(){$(document.body).addClass("modal-open")}).on("hidden.bs.modal",".modal",function(){$(document.body).removeClass("modal-open")})}(jQuery),define("bootstrap/modal",["jquery"],function(){}),function($){function trunk8(element){this.$element=$(element),this.original_text=this.$element.html(),this.settings=$.extend({},$.fn.trunk8.defaults)}function stripHTML(html){var tmp=document.createElement("DIV");return tmp.innerHTML=html,tmp.textContent||tmp.innerText}function getHtmlArr(str){if(stripHTML(str)===str)return str.split(/\s/g);for(var lastI,ind,allResults=[],reg=/<([a-z]+)([^<]*)(?:>(.*?(?!<\1>)*)<\/\1>|\s+\/>)(['.?!,]*)|((?:[^<>\s])+['.?!,]*\w?|<br\s?\/?>)/gi,outArr=reg.exec(str);outArr&&lastI!==reg.lastIndex;)lastI=reg.lastIndex,outArr[5]?allResults.push(outArr[5]):outArr[1]&&allResults.push({tag:outArr[1],attribs:outArr[2],content:outArr[3],after:outArr[4]}),outArr=reg.exec(str);for(ind=0;ind<allResults.length;ind++)"string"!=typeof allResults[ind]&&allResults[ind].content&&(allResults[ind].content=getHtmlArr(allResults[ind].content));return allResults}function rebuildHtmlFromBite(bite,htmlObject,fill){bite=bite.replace(fill,"");var biteHelper=function(contentArr,tagInfo){var content,biteContent,biteLength,i,retStr="";for(i=0;i<contentArr.length;i++)content=contentArr[i],biteLength=$.trim(bite).split(" ").length,$.trim(bite).length&&("string"==typeof content?(/<br\s*\/?>/.test(content)||(1===biteLength&&$.trim(bite).length<=content.length?(content=bite,("p"===tagInfo||"div"===tagInfo)&&(content+=fill),bite=""):bite=bite.replace(content,"")),retStr+=$.trim(content)+(i===contentArr.length-1||1>=biteLength?"":" ")):(biteContent=biteHelper(content.content,content.tag),content.after&&(bite=bite.replace(content.after,"")),biteContent&&(content.after||(content.after=" "),retStr+="<"+content.tag+content.attribs+">"+biteContent+"</"+content.tag+">"+content.after)));return retStr},htmlResults=biteHelper(htmlObject);return htmlResults.slice(htmlResults.length-fill.length)===fill&&(htmlResults+=fill),htmlResults}function truncate(){var lower,upper,bite_size,bite,text,htmlObject,data=this.data("trunk8"),settings=data.settings,width=settings.width,side=settings.side,fill=settings.fill,parseHTML=settings.parseHTML,line_height=utils.getLineHeight(this)*settings.lines,str=data.original_text,length=str.length,max_bite="";if(this.html(str),text=this.text(),parseHTML&&stripHTML(str)!==str&&(htmlObject=getHtmlArr(str),str=stripHTML(str),length=str.length),width===WIDTH.auto){if(this.height()<=line_height)return;for(lower=0,upper=length-1;upper>=lower;)bite_size=lower+(upper-lower>>1),bite=utils.eatStr(str,side,length-bite_size,fill),parseHTML&&htmlObject&&(bite=rebuildHtmlFromBite(bite,htmlObject,fill)),this.html(bite),this.height()>line_height?upper=bite_size-1:(lower=bite_size+1,max_bite=max_bite.length>bite.length?max_bite:bite);this.html(""),this.html(max_bite),settings.tooltip&&this.attr("title",text)}else isNaN(width)?$.error('Invalid width "'+width+'".'):(bite_size=length-width,bite=utils.eatStr(str,side,bite_size,fill),this.html(bite),settings.tooltip&&this.attr("title",str))}var methods,utils,SIDES={center:"center",left:"left",right:"right"},WIDTH={auto:"auto"};trunk8.prototype.updateSettings=function(options){this.settings=$.extend(this.settings,options)},methods={init:function(options){return this.each(function(){var $this=$(this),data=$this.data("trunk8");data||$this.data("trunk8",data=new trunk8(this)),data.updateSettings(options),truncate.call($this)})},update:function(new_string){return this.each(function(){var $this=$(this);new_string&&($this.data("trunk8").original_text=new_string),truncate.call($this)})},revert:function(){return this.each(function(){var text=$(this).data("trunk8").original_text;$(this).html(text)})},getSettings:function(){return $(this.get(0)).data("trunk8").settings}},utils={eatStr:function(str,side,bite_size,fill){var half_length,half_bite_size,length=str.length,key=utils.eatStr.generateKey.apply(null,arguments);if(utils.eatStr.cache[key])return utils.eatStr.cache[key];if(("string"!=typeof str||0===length)&&$.error('Invalid source string "'+str+'".'),0>bite_size||bite_size>length)$.error('Invalid bite size "'+bite_size+'".');else if(0===bite_size)return str;switch("string"!=typeof(fill+"")&&$.error("Fill unable to be converted to a string."),side){case SIDES.right:return utils.eatStr.cache[key]=$.trim(str.substr(0,length-bite_size))+fill;case SIDES.left:return utils.eatStr.cache[key]=fill+$.trim(str.substr(bite_size));case SIDES.center:return half_length=length>>1,half_bite_size=bite_size>>1,utils.eatStr.cache[key]=$.trim(utils.eatStr(str.substr(0,length-half_length),SIDES.right,bite_size-half_bite_size,""))+fill+$.trim(utils.eatStr(str.substr(length-half_length),SIDES.left,half_bite_size,""));default:$.error('Invalid side "'+side+'".')}},getLineHeight:function(elem){var floats=$(elem).css("float");"none"!==floats&&$(elem).css("float","none");var pos=$(elem).css("position");"absolute"===pos&&$(elem).css("position","static");var line_height,html=$(elem).html();return $(elem).html("i"),line_height=$(elem).parent().innerHeight(),$(elem).html(html).css({"float":floats,position:pos}),line_height}},utils.eatStr.cache={},utils.eatStr.generateKey=function(){return Array.prototype.join.call(arguments,"")},$.fn.trunk8=function(method){return methods[method]?methods[method].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof method&&method?void $.error("Method "+method+" does not exist on jQuery.trunk8"):methods.init.apply(this,arguments)},$.fn.trunk8.defaults={fill:"&hellip;",lines:1,side:SIDES.right,tooltip:!0,width:WIDTH.auto,parseHTML:!1}}(jQuery),define("jquery.trunk8",["jquery"],function(){}),define("home/apps/dashboard/app",["home/apps/dashboard/layoutUtils","Router","jquery","backbone","bootstrap/dropdown","bootstrap/tooltip","bootstrap/modal","jquery.trunk8"],function(LayoutUtils,Router,$,Backbone){function transitionUrl(){var location=window.location,fragment=Backbone.history.getFragment();!fragment&&location.hash.length>1?Backbone.history.navigate(location.hash.slice(1),!0):Backbone.history.loadUrl()}var initFixtures=function(callback){"9000"===window.location.port?require(["fixtures/fixtures"],callback):callback()};return{_init:function(options){var app=new Router(options);LayoutUtils.getScreenWidth()<=480&&($.fn.tooltip=function(){}),window.DISQUS=window.DISQUS||{},window.DISQUS.home={app:app},initFixtures(function(){Backbone.history.start({pushState:!0,hashChange:!1,root:app.root,silent:!0}),transitionUrl()})},init:function(options){var self=this;$(function(){self._init(options)})}}});
//# sourceMappingURL=app.js.map